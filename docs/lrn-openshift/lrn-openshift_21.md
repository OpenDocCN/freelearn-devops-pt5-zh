# OpenShift 3.9 中的新特性是什么？

在上一章中，我们讨论了在一个或多个数据中心设计 OpenShift 集群时的主要网络方面。我们还讨论了常见的错误、解决方案和从网络角度的总体指导。

在本章中，我们将简要概述本书中已涵盖和未涵盖的 OpenShift 3.9 新特性。我们还将简要讨论 2018 年晚些时候对后续 OpenShift 版本的预期。

在本章中，我们将涵盖以下主题：

+   OpenShift 3.9 版本中的重大变化

+   预期的 OpenShift 版本更新内容

# OpenShift 3.9 版本中的重大变化

在撰写本书时，**OpenShift 容器平台**（**OCP**）3.9 刚刚发布。OCP 3.9 与其他版本有显著不同，早期版本的 OpenShift 与 Kubernetes 的版本不同步，这意味着 OpenShift 3.5 使用的是 Kubernetes 1.6，而 OpenShift 3.7 使用的是 Kubernetes 1.8。这也是红帽跳过 3.8 版本直接发布 3.9 版本并与 Kubernetes 1.9 同步的主要原因。这并不意味着 OpenShift 3.8 被重命名为 3.9，事实上，正好相反。OpenShift 3.9 包括了 3.8 和 3.9 的所有新特性，其中包括以下内容：

+   **CRI-O**：一个轻量级的**容器运行时接口**（**CRI**），原生支持 Kubernetes。它旨在为 Kubernetes 带来更多功能，包括以下内容：

    +   增强的安全性

    +   相较于传统的容器运行时接口，提供更好的可扩展性和性能

    +   与任何符合**开放容器倡议**（**OCI**）的兼容性，包括 Docker

+   **红帽 CloudForms 管理引擎 4.6 容器管理**：这是一种易于使用和配置的集成方式，通过 Ansible playbook 安装与红帽 CloudForms 集成，其中包括以下新特性、更新和旧版本的增强：

    +   OpenShift 模板配置

    +   警报管理

    +   用户体验（UX）的增强

    +   计费回收（chargeback）的增强

    +   提供商更新

+   **端到端在线扩展和容器化 GlusterFS PV 调整大小**：此功能允许 OpenShift 用户在线扩展**持久卷**（**PV**）声明。最初，这只能通过 CLI 完成。

+   **自动化容器原生存储部署与 OpenShift 容器平台进阶安装**：这允许与由最流行的云提供商（包括亚马逊 AWS、谷歌 GCE 和微软 Azure）提供的文件和块存储设备进行集成。

+   **设备插件**：一种特殊的插件，允许你在 OCP 中使用特殊设备，无需编写任何自定义代码。设备插件是一个便捷的解决方案，用于跨 OpenShift 集群使用硬件资源。

+   **支持我们自己的 HAProxy RPM 供路由器使用**： 在重负载下升级 HAProxy 路由器而不导致任何中断的能力。OpenShift 3.9 允许您进行无缝更新和升级。

+   **快速安装**： 该方法现已被弃用。您将能够使用此方法安装新的集群，但无法执行任何更新或升级。此方法将在未来版本中移除。应使用高级安装方法。

+   **自动化 3.7 到 3.9 的控制平面升级**： 通过 Ansible 使用高级 OpenShift 安装程序，可以从 3.7 升级到 3.8，再到 3.9。这包括以下内容：

    +   控制平面上的 API、控制器和节点，支持无缝的一跳升级

    +   路由器、注册表、服务目录和代理直接升级

    +   节点、Docker、**Open vSwitch**（**OVS**）直接升级

    +   日志和度量直接升级

+   **Prometheus**： 这是一个新的产品套件，未来将替代 OpenShift 中的标准日志记录和度量功能。

+   **CLI 插件**： 一个新功能，允许您通过新功能扩展 `oc` 命令的能力。

# 期待以下 OpenShift 版本的内容

尽管很难预测未来 OpenShift 版本的具体内容，但我们可以从技术预览功能中推测出一些信息，您可以在 OCP 3.9 版本说明中找到这些功能，也可以在最新的红帽活动中找到，例如 2018 年 5 月 7 日至 5 月 11 日举行的红帽峰会。好消息是，OCP 的软件发布周期为 3 个月，这意味着当您阅读本书时，可能会有一个新的 OpenShift 版本发布。下表显示了 OCP 版本之间的差异，主要体现在 **技术预览**（**TP**）和 **一般可用性**（**GA**）方面：

| **功能** | **OCP 3.7** | **OCP 3.9** | **OCP 3.10, OCP 3.11** |
| --- | --- | --- | --- |
| Prometheus 集群监控 | 技术预览 | 技术预览 | 一般可用性* |
| CRI-O |  | 技术预览 | 一般可用性* |
| CLI 插件 | 技术预览 | 技术预览 | 一般可用性* |
| 设备插件 |  | 技术预览 | 一般可用性 |
| CPU 管理器 |  | 技术预览 | 技术预览* |
| 大页内存 |  | 技术预览 | 一般可用性* |
| PV 扩容 |  | 技术预览 | 技术预览* |
| 本地存储 PVs | 技术预览 | 技术预览 | 一般可用性* |

*数据基于我们的预测提供。

除了以上所列的所有数据外，我们还将看到其他 OpenShift 增强功能，例如以下内容：

+   与 Admin Web Console 和操作员 **生命周期管理器**（**LCM**）功能结合使用的 Prometheus 集群监控，将使 *懒惰* 的 OpenShift 管理员的工作变得更加轻松，提供一个易于使用和配置的网页控制台，功能足够完成大多数从网页界面执行的任务。这只是这些项目将一起添加的功能之一，但未来还会有更多功能。

+   Istio 和 OpenShift 服务网格产品将通过使用按需服务连接，将 OpenShift 混合网格提升到新的水平。因此，将不再需要手动配置这些服务。

+   我们将在未来版本中看到的一个最棒的特性是无缝且容易执行的集群升级和集群扩展。这意味着，目前我们只能在不重启或重新启动主节点的情况下，从集群中移除 OpenShift 节点，但添加新节点的过程并不那么快速，也不总是容易的。所以，在即将发布的版本中，我们将看到使用 *黄金* 镜像的功能，并能够动态地将其添加到集群中。

+   与 OpenStack **基础设施即服务**（**IaaS**）平台的集成将更接近现实。我们将看到 OpenShift 在 OpenStack 上的部署如何利用此类部署，通过利用底层 OpenStack 平台服务，如 **负载均衡服务**（**LBaaS**）、**防火墙服务**（**FWaaS**）、**DNS 服务**（**DNSaaS**）等，同时进一步与经过测试和认证的 Neutron 插件集成，以及通过 Ironic 实现裸金属服务器的配置和管理。

+   另一个我们在未来将看到的巨大增强功能是 OpenShift 与 CoreOS 产品（如 CoreOS、Quay 和 Tectonic）的集成。在思考如何与 OCP 配合使用时，这些产品都是非常独特且有用的：

    +   **CoreOS**: 这是一个专为大规模运行容器而设计和构建的操作系统。CoreOS 占用的资源非常小，轻量级且功能最小，足以运行容器和类似 Kubernetes 这样的容器编排平台。

    +   **Quay**: 这是一个高度分布式且可靠的容器注册中心，适用于容器和 Kubernetes，它允许你运行多个 Quay 实例来确保开箱即用的冗余。Quay 还具备地理复制功能，能够在不同的数据中心之间无缝同步容器镜像。Quay 的另一个重要特点是自动化容器扫描，以检测安全漏洞。这是容器行业中需求量最大的安全功能之一。Quay 还具备持续集成功能，能够在开发者提交代码时自动构建并推送镜像。

    +   **Tectonic**: 这是 CoreOS 提供的一个容器编排平台，它的工作方式类似于 OCP，但与 OpenShift 相比，功能要少得多。Tectonic 的独特之处在于，它的控制平面服务运行在 Tectonic 管理的 Kubernetes 服务内部。这是一个经典的“先有鸡还是先有蛋”的问题，CoreOS 成功地解决了这个问题。

我们将看到这些功能中的大多数，或者是用户请求最多的功能，最终会迁移到或与 OCP 合并。由于最近收购了 CoreOS，2018 年整年对于 OCP 开发团队来说可能会有些忙碌。这些团队将共同决定哪些功能继续推进，哪些功能永远放弃。但无论如何，这一切都将使 OpenShift 受益，并使其成为史上最成功的容器管理平台。

# 总结

在本章中，我们简要概述了本书中涉及和未涉及的 OpenShift 3.9 新特性。我们还简要讨论了 2018 年稍后的 OpenShift 版本中可以期待的内容。

这是本书的最后一章，因此感谢您阅读本书，并希望您获得了有关 OpenShift 背后概念的有用知识，并获得了一些安装 OpenShift 和管理其资源的实践技能。

# 问题

1.  以下哪一项不是设计用来通过 CRI-O 向 Kubernetes 添加额外功能的？请选择一项：

+   1.  Docker 替代

    1.  增强的安全性

    1.  更好的可扩展性和性能

    1.  兼容任何符合 OCI 规范的容器

1.  最近收购的 CoreOS 带来了哪些主要产品，并且未来需要与 OpenShift 集成？请选择两个：

+   1.  Quay

    1.  Mesos

    1.  Tectonik

    1.  Kubernetes

1.  CoreOS 是一个设计和构建用于大规模运行容器的操作系统：

+   1.  正确

    1.  错误

1.  以下哪一项 OpenShift 功能可以扩展 OpenShift `oc` 命令的功能？请选择一项：

+   1.  CLI 插件

    1.  OCI 插件

    1.  设备插件

    1.  CLI 增强

# 进一步阅读

下面是与本章相关的主题列表，您可能希望深入研究：

+   **OpenShift 容器平台 3.9 版本发布说明** [`docs.openshift.com/container-platform/3.9/release_notes/ocp_3_9_release_notes.html`](https://docs.openshift.com/container-platform/3.9/release_notes/ocp_3_9_release_notes.html)。

+   **OpenShift 2018 年红帽峰会的路线图** [`www.youtube.com/watch?v=1AelNjx6BB4`](https://www.youtube.com/watch?v=1AelNjx6BB4)。

+   **OpenShift 容器平台已测试的集成** [`access.redhat.com/articles/2176281`](https://access.redhat.com/articles/2176281)。
