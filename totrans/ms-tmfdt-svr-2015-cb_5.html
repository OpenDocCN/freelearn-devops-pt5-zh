<html><head></head><body><div class="chapter" title="Chapter&#xA0;5.&#xA0;Testing Your Application" id="aid-1R42S1"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter 5. Testing Your Application</h1></div></div></div><div class="blockquote"><table border="0" cellspacing="0" cellpadding="0" class="blockquote" summary="Block quote"><tr><td valign="top"> </td><td valign="top"><p><span class="emphasis"><em>"Walking on water and developing software from a specification are easy…If both are frozen!"</em></span></p></td><td valign="top"> </td></tr><tr><td valign="top"> </td><td colspan="2" align="right" valign="top" style="text-align: center">--<span class="attribution"><span class="emphasis"><em>Edward Berard</em></span></span></td></tr></table></div><p>In this chapter, we will cover the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Running NUnit tests in the CI Pipeline using TFBuild</li><li class="listitem">Creating and setting up a Machine Group</li><li class="listitem">Deploying a test agent through the TFBuild task</li><li class="listitem">Distributing test execution on a Lab Machine Group</li><li class="listitem">Triggering Selenium Web Tests on a Selenium Test Grid using TFBuild</li><li class="listitem">Integrating the Cloud Load Testing Service in TFBuild</li><li class="listitem">Analyzing test execution results from the Runs view</li><li class="listitem">Exporting and importing test cases in Excel from TFS</li><li class="listitem">Copying and cloning test suites and test cases</li><li class="listitem">Exporting test artifacts and test results from the test hub</li><li class="listitem">Charting testing status on Dashboards in Team Portal</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec55"/>Introduction</h1></div></div></div><p>Software teams are constantly under pressure to deliver more… faster. End users expect software to simply work. Low quality software just isn't acceptable. But, you may ask what the right level of quality is? Quality is a very subjective term; it is therefore important for Teams to agree to a definition of quality for their software. Teams that are unable to define quality usually end up testing for coverage rather than testing for quality.</p><p>The toolkit<a id="id552" class="indexterm"/> in Team Foundation Server provides tooling for both manual and automation testing. <span class="strong"><strong>Microsoft Test Manager</strong></span> (<span class="strong"><strong>MTM</strong></span>), first introduced with TFS 2010, enables testers to plan, track, and run manual, exploratory, and automated tests. While Test Manager fully integrates with TFS, it does not offer any integration with other testing platforms. The Test Manager architecture does not lend itself to extensibility. Microsoft has ambitions to support every developer and every app; however, it isn't possible with tooling that can't be run on non-window platforms. The test tooling is gradually moving out from the Test Manager client into the web-based Team Web Portal to enable extensibility, cross-platform availability, and integration with other testing platforms. The following screenshot provides a comparison of testing features already in test hub, those that will gradually move, and those that will remain in MTM. For a full comparison of all the features, download <code class="literal">Microsoft Test Manager Vs Test Hub Feature Comparison.png</code> from the course material:</p><div class="mediaobject"><img src="../Images/image00651.jpeg" alt="Introduction"/></div><p style="clear:both; height: 1em;"> </p><p>To speed up the software delivery loop, software testing needs to be incorporated into the <span class="strong"><strong>Continuous Integration</strong></span> (<span class="strong"><strong>CI</strong></span>) <a id="id553" class="indexterm"/>Pipeline. In order to do this, software testing needs to shift left in the development processes. <span class="strong"><strong>Test-driven development</strong></span> (<span class="strong"><strong>TDD</strong></span>)<a id="id554" class="indexterm"/> enables developers to write code that's maintainable, flexible, and easily extensible. Code backed by unit tests helps identify change impact and empowers developers to make changes confidently. In addition to this, functional testing needs to be automated. This enables software testers to focus on high-value exploratory testing rather than just coverage of test matrix.</p><p>The DevOps movement at large supports bringing testing into the CI Pipeline. The tooling in TFS has evolved to enable this. The pre 2015 version of TFS shipped with a separate test controller and test agent, with the introduction of the new build framework in TFS 2015 test runner has been distilled down to a task in the build definition. TFS now provides a task based open and extensible build framework that allows you to pick not only a build framework of your choice, but also provides you full autonomy to pick and assemble the test frameworks of your choice too. The new build system enables the agent to be a generic task orchestrator. The agent is capable of executing the entire CI Pipeline. This new approach removes the need for managing multiple single purpose agents. This takes away the friction from the setup process and enables a scale up option without the need for tedious configuration. This also enables integrating other testing frameworks and platforms into the same pipeline:</p><div class="mediaobject"><img src="../Images/image00652.jpeg" alt="Introduction"/></div><p style="clear:both; height: 1em;"> </p><p>Through the recipes in this chapter, you'll learn how to leverage tasks in the build definition to provision test agents on demand, perform a distributed test execution that includes a large number of diverse automated tests such as unit, functional UI, Selenium and, coded UI on remote Machine Groups. We'll also look at integrating with Visual Studio Team Systems to run cloud load tests. Last but not least, we will look at the rich test reports and test result analysis from the test executions.</p><p>Look at the richness of testing features within the bigger DevOps capabilities available in TFS; should you decide to move from your existing Test Case Management Solutions to the Microsoft Test Manager, you may wonder what the possibilities for migration are. We'll briefly cover a few tools that are available today to help you with the migration. In the end, we'll look at how to export and visualize test execution results with the help of light weight charts.</p><p>Along with providing world-class tooling for manual and automation testers, TFS also provides rich, integrated test tooling to stakeholders. The web-based testing extension allows you to perform exploratory testing of your web or mobile application right from the browser on any platform (Windows, Mac, or Linux). Your stakeholders now do not need to follow predefined test cases or test steps. Stakeholders can capture and annotate screenshots, log bugs, and share notes. The testing session records and logs every step providing developers rich action logs for diagnosing application and user experience issues. Read more on this at <a class="ulink" href="http://bit.ly/1I82pfK">http://bit.ly/1I82pfK</a>.</p><p>These investments are taking the testing tooling from good to great. It is a very exciting time to be in the testing space!</p></div></div>
<div class="section" title="Running NUnit tests in the CI Pipeline using TFBuild" id="aid-1S2JE1"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec56"/>Running NUnit tests in the CI Pipeline using TFBuild</h1></div></div></div><p>Traditionally, developers<a id="id555" class="indexterm"/> using the NUnit framework had to<a id="id556" class="indexterm"/> install the NUnit Test Adapter on the build <a id="id557" class="indexterm"/>machines. While this approach worked if you were dealing with a small number of build servers, it quickly became tedious when dealing with large number of build servers. An alternative to installing the NUnit adapter was to inject the NUnit adapter DLLs to the build machines using the custom assembly field available in the build controller properties. While this worked with TFVC-based repositories, there were challenges using this approach for Git-based repositories. This is a classic example of configuration hell when using non-Microsoft testing frameworks.</p><p>The new build framework makes running non-Microsoft unit test frameworks completely configuration free. In this recipe, you'll learn how to use the Visual Studio Test task in the build definition to run NUnit tests or generally any non-Microsoft unit testing frameworks.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec154"/>Getting ready</h2></div></div></div><p>In order to create a build definition, you'll need to be a member of the Project Build Administrator Group.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec155"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Launch Team Explorer and connect to the FarbikamTFVC Team Project. From the Source Control Explorer, open the <code class="literal">FabrikamFiber.CallCenter.sln</code> in Visual Studio:<div class="mediaobject"><img src="../Images/image00653.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Follow the instructions at <a class="ulink" href="http://bit.ly/1XgG0UG">http://bit.ly/1XgG0UG</a> to create a <a id="id558" class="indexterm"/>new NUnit test project. Call the project <code class="literal">FabrikamFiber.Web.NUnit.Tests.csproj</code>.</li><li class="listitem">Right-click on the <code class="literal">FabrikamFiber.Web.NUnit.Tests.csproj</code> project and select <span class="strong"><strong>Manage NuGet Packages...</strong></span> from the context menu:<div class="mediaobject"><img src="../Images/image00654.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">From the <a id="id559" class="indexterm"/>NuGet package <a id="id560" class="indexterm"/>manager, search and install the <a id="id561" class="indexterm"/>NUnit test adapter.<div class="mediaobject"><img src="../Images/image00655.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Open the folder location of the solution and you'll notice that the <code class="literal">NUnitTestAdapter NuGet</code> package has been added under the packages folder:<div class="mediaobject"><img src="../Images/image00656.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Check in the code changes from the <span class="strong"><strong>Pending Changes</strong></span> view in Team Explorer:<div class="mediaobject"><img src="../Images/image00657.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">In the<a id="id562" class="indexterm"/> FabrikamTFVC Team <a id="id563" class="indexterm"/>Web Portal, navigate to the <span class="strong"><strong>BUILD</strong></span><a id="id564" class="indexterm"/> hub and click on the <span class="strong"><strong>+</strong></span> icon to add a new build definition. Create it using Visual Studio Build Template:<div class="mediaobject"><img src="../Images/image00658.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">In the Visual Studio Build Task, ensure that the <span class="strong"><strong>Restore NuGet Packages</strong></span> flag is checked. You don't need to make any other changes in the build or test task. Ensure that the code repository is mapped as FabrikamTFVC in the repository tab. Save the build definition as <code class="literal">FabrikamTFVC NUnit CI</code>. You can learn more about setting up a build definition in the <span class="emphasis"><em>Creating a continuous integration build definition in TFBuild</em></span> recipe in <a class="link" title="Chapter 4. Building Your Application" href="part0050.xhtml#aid-1FLS42">Chapter 4</a>, <span class="emphasis"><em>Building Your Application</em></span>.</li><li class="listitem">Queue a build. Once the build completes, you will see a summary of the test results in the build summary section. The build successfully executes all NUnit tests without any manual configuration specific to NUnit:<div class="mediaobject"><img src="../Images/image00659.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec156"/>How it works</h2></div></div></div><p>Let's now <a id="id565" class="indexterm"/>understand how TFBuild manages to<a id="id566" class="indexterm"/> identify the test runner for NUnit tests. Open the <a id="id567" class="indexterm"/>FabrikamTFVC NUnit CI build definition. In the <span class="strong"><strong>Advanced</strong></span> section of the Visual Studio Test task, you'll see a field for specifying the path to custom adapters:</p><div class="mediaobject"><img src="../Images/image00660.jpeg" alt="How it works"/></div><p style="clear:both; height: 1em;"> </p><p>With the restore NuGet packages flag checked in the Visual Studio Build task, all NuGet packages that the solution has dependency on are downloaded into the agent's working directory. The Visual Studio Test task scans the agent working directory for all test adapter packages. In this instance, the NUnit Test Adapter NuGet package was checked into source control. The package would have been restored into the agent working directory during the package restore process; as a result the Visual Studio Test task loaded up the NUnit Test Adapter during the scan.</p><div class="note" title="Note"><h3 class="title"><a id="note36"/>Note</h3><p>TFBuild publishes the test and coverage results into TFS independent of the testing framework used. This is automatically handled by the TFBuild framework.</p></div><p>This approach scales really well, as you add more machines to carry out testing, you do not need to worry about manually adding the NUnit Test Adapter on the test machines. This also simplifies upgrading test adapters. The test task can load multiple versions of one test adapter and use the adapter referenced by the unit tests.</p><p>The<a id="id568" class="indexterm"/> <span class="strong"><strong>Path to Custom Test Adapters</strong></span> <a id="id569" class="indexterm"/>field wasn't really put to use in this case. However, this<a id="id570" class="indexterm"/> field is useful for specifying the test adapter path if your solution uses a unit test framework that does not have a NuGet package associated with it. The path to the test adapter needs to be constructed using the build agent's source directory variable. The <code class="literal">Build.SourceDirectory</code> variable points to the directory in the build agent where the source code has been synced. If your custom test adapter was in the <code class="literal">$\FabrikamTFVC\myAdapters</code> folder, you would need to specify the path: <code class="literal">$(Build.SourcesDirectory)\src\myAdapters\TestAdapter.1.2</code>.</p></div></div>
<div class="section" title="Creating and setting up a Machine Group"><div class="titlepage" id="aid-1T1402"><div><div><h1 class="title"><a id="ch05lvl1sec57"/>Creating and setting up a Machine Group</h1></div></div></div><p>Simply put, Machine Group <a id="id571" class="indexterm"/>is a logical grouping of machines. The Machine Group holds metadata, connectivity, and login details of the machines in the group. Machine Group can directly be referenced from build and release definitions. In this recipe, you'll learn how to create and set up a Machine Group.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec157"/>Getting ready</h2></div></div></div><p>Scenario: The FabrikamTFVC <a id="id572" class="indexterm"/>Team has a lab environment in the <code class="literal">Fabrikam.lab</code> <a id="id573" class="indexterm"/>domain. <code class="literal">Fabrikam.lab</code> comprises of five servers that serve different roles. The FabrikamTFVC Team wants the ability to directly reference these machines from the build definition and release definition to deploy test agents on all the machines and trigger a distributed test run. <code class="literal">Fabrikam.Lab</code> is managed by the Fabrikam Environments Team who cannot share environment credentials with the FabrikamTFVC Team. In this recipe, we'll walk through the process followed by the Fabrikam Environments Team to set up and configure the Machine Group <code class="literal">Fabrikam-QA</code> for the FabrikamTFVC Team:</p><div class="mediaobject"><img src="../Images/image00661.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><p>The <a id="id574" class="indexterm"/>Machine <a id="id575" class="indexterm"/>Group will be accessed by a remote host; the remote host will likely be playing the role of a build agent or release agent. As illustrated in the following figure, the remote host is in the same network as the Machine Group and has a trust relationship with the Machine Group:</p><div class="mediaobject"><img src="../Images/image00662.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><p>The build agent uses Windows PowerShell remoting that requires the <span class="strong"><strong>Windows Remote Management</strong></span> (<span class="strong"><strong>WinRM</strong></span>)<a id="id576" class="indexterm"/> protocol to connect to the machines in the Machine Groups. WinRM needs to be enabled on a machine as a prerequisite before it can be added into the Machine Group. In this case, Kerberos will be used as the mode of authentication since the agent and Machine Group are in the same corp network.</p><div class="informaltable"><table border="1"><colgroup><col/><col/><col/><col/><col/><col/><col/></colgroup><tbody><tr><td valign="top">
<p><span class="strong"><strong>Target Machine state</strong></span></p>
</td><td valign="top">
<p>Target Machine trust with automation agent</p>
</td><td valign="top">
<p>Machine Identity</p>
</td><td valign="top">
<p>Auth Account</p>
</td><td valign="top">
<p>Auth Mode</p>
</td><td valign="top">
<p>Auth Account permission on target machine</p>
</td><td valign="top">
<p>Conn Type</p>
</td></tr><tr><td valign="top">
<p><span class="strong"><strong>Domain-joined machine in the corp network</strong></span></p>
</td><td valign="top">
<p>Trusted</p>
</td><td valign="top">
<p>DNS name</p>
</td><td valign="top">
<p>Domain account</p>
</td><td valign="top">
<p>Kerberos</p>
</td><td valign="top">
<p>Machine admin</p>
</td><td valign="top">
<p>WinRM</p>
<p>HTTP</p>
</td></tr></tbody></table></div><p>In the next<a id="id577" class="indexterm"/> few<a id="id578" class="indexterm"/> steps, we'll walk through how to configure WinRM on a machine, and you'll learn how to test connectivity through WinRM:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">PowerShell 2.0 and <a id="id579" class="indexterm"/>Windows Management Framework 4.0 (<a class="ulink" href="http://bit.ly/1kNlxuW">http://bit.ly/1kNlxuW</a>) are required to be installed on both the agent and machines in the Machine Group.</li><li class="listitem">Log into the <code class="literal">QA-Web1.Farbikam.lab</code> machine, start Windows PowerShell as an administrator by right-clicking on the Windows PowerShell shortcut and selecting <span class="strong"><strong>Run as Administrator</strong></span>.</li><li class="listitem">By default, the WinRM service is configured for manual startup and stopped. Executing the <code class="literal">winrmquickconfig -q</code> command performs a series of actions:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Starts the WinRM service.</li><li class="listitem">Sets the startup type on the WinRM service to <span class="strong"><strong>Automatic</strong></span>.</li><li class="listitem">Creates a listener to accept requests on any IP address.</li><li class="listitem">Enables a firewall exception for WS-Management communications.</li><li class="listitem">Registers the <code class="literal">Microsoft.PowerShell</code> and <code class="literal">Microsoft.PowerShell.Workflow</code> session configurations, if they are not already registered.</li><li class="listitem">Registers the <code class="literal">Microsoft.PowerShell32</code> session configuration on 64-bit computers, if it is not already registered.</li><li class="listitem">Enables all session configurations.</li><li class="listitem">Changes the security descriptor of all session configurations to allow remote access.</li><li class="listitem">Restarts the WinRM service to make the preceding changes effective.</li></ol><div style="height:10px; width: 1px"/></div></li><li class="listitem">The next few commands will prepare WinRM for Kerberos authentication.</li><li class="listitem">Increase the maximum memory allocation per session:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm set winrm/config/winrs '@{MaxMemoryPerShellMB="300"}'</strong></span>
</pre></div></li><li class="listitem">Next, increase the session timeout period:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm set winrm/config '@{MaxTimeoutms="1800000"}'</strong></span>
</pre></div></li><li class="listitem">Allow the<a id="id580" class="indexterm"/> traffic between agent and Machine Group to be <a id="id581" class="indexterm"/>unencrypted:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm set winrm/config/service '@{AllowUnencrypted="true"}'</strong></span>
</pre></div></li><li class="listitem">Disable basic authentication:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm set winrm/config/service/auth '@{Basic="false"}'</strong></span>
</pre></div></li><li class="listitem">Setup a firewall exception to allow inbound traffic on port <code class="literal">5985</code>; this is the default port used by WinRM when using HTTP:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>netshadvfirewall firewall set rule name="Windows Remote Management (HTTP-In)" profile=public protocol=tcplocalport=5985 remoteip=localsubnet new remoteip=any</strong></span>
</pre></div></li><li class="listitem">Disable digest for client authentication:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm set winrm/config/client/auth '@{Digest="false"}'</strong></span>
</pre></div></li><li class="listitem">Set service authentication to use Kerberos:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm set winrm/config/service/auth '@{Kerberos="true"}'</strong></span>
</pre></div></li><li class="listitem">Trust all connections between agent and Machine Group:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm set winrm/config/client '@{TrustedHosts="*"}'</strong></span>
<span class="strong"><strong>Set-Item WSMan:\localhost\Client\TrustedHosts *</strong></span>
</pre></div></li><li class="listitem">Restart the <code class="literal">win-rm</code> service:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Restart-Service winrm–Force</strong></span>
</pre></div></li><li class="listitem">To ensure Kerberos authentication is enabled on WinRM, run the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm get winrm/config/service/auth </strong></span>
</pre></div><div class="mediaobject"><img src="../Images/image00663.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Now, let's validate whether WinRM has correctly been set up on <code class="literal">QA-Web1.Fabrikam.lab</code>. Log into another VM in the lab, in this case <code class="literal">QA-Web2.Fabrikam.lab</code>. Launch PowerShell as an administrator by right-clicking on the Windows PowerShell shortcut and selecting <span class="strong"><strong>Run as administrator</strong></span>. Execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Test-Wsman –computerName QA-Web1.Fabrikam.lab</strong></span>
</pre></div><div class="mediaobject"><img src="../Images/image00664.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Execute the <a id="id582" class="indexterm"/>following command to check the port WinRM is<a id="id583" class="indexterm"/> listing on:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>winrm e winrm/config/listener</strong></span>
</pre></div><div class="mediaobject"><img src="../Images/image00665.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><div class="note" title="Note"><h3 class="title"><a id="note37"/>Note</h3><p>Execute the following command should you want to change the port WinRM is currently configured to listen on:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Set-Item WSMan:\localhost\listener\*\Port 8888</strong></span>
</pre></div></div></li><li class="listitem">Most importantly, validate that you are able to invoke the Pssession on <code class="literal">QA-Web1.Fabrikam.lab</code> by manually running the following command from <code class="literal">QA-Web2.Fabrikam.lab</code>. Once you execute the first statement, you'll receive a prompt to enter your credentials. Enter your domain account that has admin permissions:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$cred = get-credential</strong></span>
</pre></div></li><li class="listitem">Executing the next command will use your domain account to connect to the destination server; DNS will be used to resolve the destination name:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Enter-Pssession -ComputerNameQA-Web1.Fabrikam.lab–Credential $cred</strong></span>
</pre></div><div class="mediaobject"><img src="../Images/image00666.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Follow steps<a id="id584" class="indexterm"/> 1 to 5 to configure WinRM on other machines in the<a id="id585" class="indexterm"/> lab. Follow step 6 to validate WinRM connectivity before moving forward.</li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec158"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigating to the test hub in the FabrikamTFVC Team Web Portal, on the <span class="strong"><strong>Machines</strong></span> page, click on the <span class="strong"><strong>+</strong></span> icon to create a new Machine Group:<div class="mediaobject"><img src="../Images/image00667.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Enter the details as illustrated in the following screenshot:<div class="mediaobject"><img src="../Images/image00668.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The WinRM protocol in <code class="literal">Fabrikam.lab</code> will use HTTP since the remote machine has a trust relationship with <code class="literal">Fabrikam.lab.Add</code> and the details for all the machines. Now, click on <span class="strong"><strong>Done</strong></span> to complete the setup:<div class="mediaobject"><img src="../Images/image00669.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec159"/>How it works...</h2></div></div></div><p>The Fabrikam-QA<a id="id586" class="indexterm"/> Machine Group setup uses a common administrator<a id="id587" class="indexterm"/> credentials for all machines in the Machine Group. It is alternatively possible to specify different credentials for the individual machines added in the Machine Group:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To enter credentials per machine, check the option <span class="strong"><strong>Use custom credentials for each machine along with global credentials</strong></span>.<div class="mediaobject"><img src="../Images/image00670.jpeg" alt="How it works..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The password field is masked in the user interface. In addition to this, the value of this field is not printed in any of the log files either.</li><li class="listitem">The tags provide a great way to query for machines with in the Machine Group. For example, when using the test agent deployment task in build definition, you can specify a Machine Group and use Tags to filter the execution of the action on machines that include the Tag.</li><li class="listitem">Machine Groups, at the<a id="id588" class="indexterm"/> moment, support limited scenarios mainly domain joined on premise machine and standalone machines in Azure. Refer to  <a class="ulink" href="http://bit.ly/1NFqYma">http://bit.ly/1NFqYma</a> for a full list of supported scenarios.</li></ol><div style="height:10px; width: 1px"/></div></div></div>
<div class="section" title="Deploying a test agent through the TFBuild task" id="aid-1TVKI1"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec58"/>Deploying a test agent through the TFBuild task</h1></div></div></div><p>In previous versions of <a id="id589" class="indexterm"/>TFS, the test controller and agent used to<a id="id590" class="indexterm"/> ship as separate installers. While the installers supported unattended installation, the configuration needed manual intervention. This limited the ability to scale out the test agents on demand. In TFS 2015, the test controller and agent do not ship as separate installers; instead, the capability offered by the test agent has been distilled into one build task. In this recipe, you'll learn how to deploy a test agent on multiple machines in a Machine Group.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec160"/>Getting ready</h2></div></div></div><p>Scenario: The <a id="id591" class="indexterm"/>FabrikamTFVC Team has a dependency<a id="id592" class="indexterm"/> on the cucumber framework, since cucumber conflicts with the existing framework on the build agent, it cannot be installed on the build agent. The FabrikamTFVC Team instead wants the test agent to be deployed on the <code class="literal">QA-App1.Fabrikam.lab</code> server. This server is already part of the Fabrikam-QA Machine Group:</p><div class="mediaobject"><img src="../Images/image00671.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><p>In this recipe, we'll be using the Fabrikam-QA Machine Group. If you don't already have Machine Group set up, follow the instructions in the recipe <span class="emphasis"><em>Creating and setting up a Machine Group</em></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec161"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigating to the test hub in the FabrikamTFVC Team Web Portal, in the <span class="strong"><strong>Machine</strong></span> page, edit the Fabrikam-QA Machine Group. Append the Tag <code class="literal">Framework: Cucumber</code> for the machine <code class="literal">QA-App1.Fabrikam.lab</code> and save.<div class="mediaobject"><img src="../Images/image00672.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Navigate to the build hub and create a new build definition using the empty build template. Ensure that the code repository is mapped as FabrikamTFVC in the repository tab. Add the <span class="strong"><strong>Visual Studio Test Agent Deployment</strong></span> task from the test section. The task comprises of three sections; configure the Fabrikam-QA Machine Group, select the machine by machine names or tags, and filter the machine using the Tag <code class="literal">Framework:Cucumber</code>:<div class="mediaobject"><img src="../Images/image00673.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The <a id="id593" class="indexterm"/><span class="strong"><strong>Agent Configuration</strong></span> <a id="id594" class="indexterm"/>section accepts the credentials and the test agent service will run under it once installed. Create a variable for the test agent username and the test agent password from the <span class="strong"><strong>Variables</strong></span> tab. Add the variables to the <span class="strong"><strong>Agent Configuration</strong></span> section. Check the <span class="strong"><strong>Interactive Process</strong></span> option to run the agent as an interactive process. The agent is installed as a Windows service if it's not requested to be run as an interactive process:<div class="mediaobject"><img src="../Images/image00674.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The <span class="strong"><strong>Advanced</strong></span> section allows you to specify the location for the installer of the test agent. This is useful if you want to control the version of the agent getting installer. In the absence of a location, the latest version of the test agent is downloaded from the Internet. Check the option to enable data collection:<div class="mediaobject"><img src="../Images/image00675.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Save the build definition as <code class="literal">FabrikamTFVC Agent Deployment</code>. Queue a new build from this build definition. Once the build is complete, navigate to the <code class="literal">QA-App1.Fabrikam.lab</code> server. The test agent has successfully been installed as a Windows service.</li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec162"/>How it works...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The build <a id="id595" class="indexterm"/>agent downloads the <a id="id596" class="indexterm"/>test agent installer from the Internet into a <code class="literal">temp</code> location. The installer is then pushed for installation into the remote <code class="literal">QA-App1.Fabrikam.lab</code> machine:<div class="mediaobject"><img src="../Images/image00676.jpeg" alt="How it works..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The agent is installed as a Windows service on the machines in the Machine Group:<div class="mediaobject"><img src="../Images/image00677.jpeg" alt="How it works..."/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div></div>
<div class="section" title="Distributing test execution on a Lab Machine Group"><div class="titlepage" id="aid-1UU542"><div><div><h1 class="title"><a id="ch05lvl1sec59"/>Distributing test execution on a Lab Machine Group</h1></div></div></div><p>Earlier in this chapter, you<a id="id597" class="indexterm"/> learned how to create a <a id="id598" class="indexterm"/>Machine Group and deploy the test agent on selected machines in the Machine Group. The TFBuild framework ships a task to distribute the test execution across multiple test agents. In this recipe, you'll learn how to trigger a distributed test run across a farm of test runners deployed in a Machine Group.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec163"/>Getting ready</h2></div></div></div><p>Scenario: The <a id="id599" class="indexterm"/>FabrikamTFVC Team has over <a id="id600" class="indexterm"/>2,000 automated coded UI tests that need to be executed as part of the functional testing workflow. FabrikamTFVC Team would like the ability to parallelize the test execution. In order to do this, the Team wants to deploy the Visual Studio test agent to all machines in the Fabrikam-QA Machine Group and then parallelize by distributing the test execution at the test assembly level:</p><div class="mediaobject"><img src="../Images/image00678.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><p>In this recipe, you'll be using the Fabrikam-QA Machine Group. If you don't already have Machine Group set up, follow the instructions in the <span class="emphasis"><em>Creating and setting up a Machine Group</em></span> recipe. Since test agents need to be deployed as a prerequisite to the distribution of the tests, follow the steps in the <span class="emphasis"><em>Deploying a test agent through the TFBuild task </em></span>recipe to learn how TFBuild can be used to deploy the test agent in a Machine Group.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec164"/>How to do it…</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigating to the build hub in the FabrikamTFVC Team Web Portal, click on <span class="strong"><strong>Edit</strong></span> to open <code class="literal">FabrikamTFVC Agent Deployment</code> in edit mode.</li><li class="listitem">Click on <span class="strong"><strong>+</strong></span> to add a build step and from the <span class="strong"><strong>Add Task</strong></span> window, select the <span class="strong"><strong>Build</strong></span> tab and add the Visual Studio Build task. This task will be used to compile the test projects:<div class="mediaobject"><img src="../Images/image00679.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">From the<a id="id601" class="indexterm"/> <span class="strong"><strong>Deploy</strong></span> tab, add the <a id="id602" class="indexterm"/><span class="strong"><strong>Windows Machine File Copy</strong></span> task. This task will copy the test assemblies across to the machines the test need to be executed:<div class="mediaobject"><img src="../Images/image00680.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">From the <span class="strong"><strong>Test</strong></span> tab, add the <span class="strong"><strong>Visual Studio Test using Test Agent</strong></span> task. This task will be used to manage the test distribution across the farm of test agents:<div class="mediaobject"><img src="../Images/image00681.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Click on close icon to close the <span class="strong"><strong>Add Task</strong></span> window. The tasks in the build definition need to be ordered as:<div class="mediaobject"><img src="../Images/image00682.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Configure the Visual Studio Build task to build the solution the functional tests are part of:<div class="mediaobject"><img src="../Images/image00683.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Configure<a id="id603" class="indexterm"/> the Windows <a id="id604" class="indexterm"/>Machine File Copy task to copy the test assemblies into a directory on the machines in the Machine Group. It is always recommended to parameterize the test locations with configuration variables. The preconfigured build variables can be used to construct the path to the assemblies on the build agent working folder that need to be copied across. If the <span class="strong"><strong>Clean Target</strong></span> flag is checked, the build engine will delete the contents of the destination folder before copying the new files. The advanced section in this task also includes a flag to enable copying files in parallel and use this flag to allow the build system to copy the binaries across the machines on the Machine Group in parallel:<div class="mediaobject"><img src="../Images/image00684.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">No changes need to be made to the Visual Studio test agent deployment task. The configuration set up in the <span class="emphasis"><em>Deploying a test agent through the TFBuild task</em></span> recipe will carry out the test agent deployment across all machines in the Machine Group. The Visual Studio Tests using test agent task should immediately follow this task. Select the Fabrikam-QA Machine Group as the destination Machine Group, where the tests need to be executed. In addition to this, specify the test binaries location, the pattern of the test assemblies, the configuration, and the platform the tests need to be executed in. Check the code coverage flag in the <span class="strong"><strong>Advanced</strong></span> section. You can inject the test settings file to optionally override the configuration in the test settings file through the <span class="strong"><strong>Override Test Run Parameters</strong></span> field:<div class="mediaobject"><img src="../Images/image00685.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Save the <a id="id605" class="indexterm"/>changes to the build<a id="id606" class="indexterm"/> definition and queue a new build. Once the build completes, navigate to the build summary page; the logs for the Visual Studio Tests using test agent step shows the details of the test distribution:<div class="mediaobject"><img src="../Images/image00686.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec165"/>How it works…</h2></div></div></div><p>Let's look at the log files of the Visual Studio Test using a test agent task through the build summary. As illustrated in the preceding screenshot, the test DLLs have been distributed to multiple test agents in the group. The distribution is done at a DLL level rather than a test level. The test distribution significantly reduces the execution time if your tests are in multiple projects since each DLL is distributed to a test agent to execute.</p><p>It is also worth noting that the Windows Machine File Copy task successfully moves the files from the agent working directory across to the <code class="literal">C:\Fabrikam\FunctionalTests\$(Build.BuildNumber)</code> folder in the Machine Group:</p><div class="mediaobject"><img src="../Images/image00687.jpeg" alt="How it works…"/></div><p style="clear:both; height: 1em;"> </p><p>You'll learn <a id="id607" class="indexterm"/>more about the Windows Machine<a id="id608" class="indexterm"/> File Copy task in <a class="link" title="Chapter 6. Releasing Your Application" href="part0074.xhtml#aid-26I9K1">Chapter 6</a>, <span class="emphasis"><em>Releasing Your Application</em></span>, as it'll be used extensively for deployments in release management.</p></div></div>
<div class="section" title="Triggering Selenium Web Tests on a Selenium Test Grid using TFBuild" id="aid-1VSLM1"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec60"/>Triggering Selenium Web Tests on a Selenium Test Grid using TFBuild</h1></div></div></div><p>The cost of <a id="id609" class="indexterm"/>testing can significantly<a id="id610" class="indexterm"/> increase if your software <a id="id611" class="indexterm"/>needs to support multiple devices and browsers. The rise in client-side scripting frameworks and responsive design technologies enable each browser to offer a unique immersive user experience. With the matrix of devices and browsers rapidly increasing, it is virtually impossible to cover the matrix with manual testing. There are a number of commercial and open source tools available for assisting with the development of test automation. Selenium is possibly the most widely used open source solution. TFS works better together with open source tools. In this recipe, you'll learn how to execute Selenium Tests from TFBuild.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec166"/>Getting ready</h2></div></div></div><p>Scenario: The FabrikamGit Team has automated functional tests using Selenium. The Team now wants to validate the functionality by running the tests in Chrome, Firefox, and Internet Explorer. The FabrikamGit Team would like to trigger the execution of these tests on a Selenium grid via TFBuild.</p><div class="mediaobject"><img src="../Images/image00688.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><p>Follow the instructions in the blog post at <a class="ulink" href="http://bit.ly/1PSjfWy">http://bit.ly/1PSjfWy</a> to set up a <a id="id612" class="indexterm"/>Selenium grid on a Windows machine. For the purposes of this recipe, we'll follow a simple setup that comprises of both the Selenium hub and node on the same machine:</p><div class="mediaobject"><img src="../Images/image00689.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><p>The course <a id="id613" class="indexterm"/>material provided<a id="id614" class="indexterm"/> with this book includes a <a id="id615" class="indexterm"/>Selenium Test Project. Download the <code class="literal">SeleniumHelloWorld.zip</code> folder; alternatively, you can use your own Selenium Test Project. Commit and publish <code class="literal">Selenium.Web.Test.sln</code> into the master branch in the FabrikamGit repository:</p><div class="mediaobject"><img src="../Images/image00690.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p><p>More information on how to commit and publish changes to a Git repository is available in the introduction section of <a class="link" title="Chapter 2. Setting Up and Managing Code Repositories" href="part0027.xhtml#aid-PNV62">Chapter 2</a>, <span class="emphasis"><em>Setting Up and Managing Code Repositories</em></span>. The SeleniumHQ<a id="id616" class="indexterm"/> website (<a class="ulink" href="http://bit.ly/1YmqRDJ">http://bit.ly/1YmqRDJ</a>) includes great C# tutorials for authoring Selenium Tests.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec167"/>How to do it…</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the<a id="id617" class="indexterm"/> FarbikamGit <a id="id618" class="indexterm"/>Team Web<a id="id619" class="indexterm"/> Portal, navigate to <span class="strong"><strong>Build</strong></span> hub. Click on the <span class="strong"><strong>+</strong></span> icon to add a new build definition. Select the Visual Studio Build Template and click on <span class="strong"><strong>Create</strong></span>. Navigate to the <span class="strong"><strong>Repository</strong></span> tab in the build definition and map the repository to the master branch of the FabrikamGit repository:<div class="mediaobject"><img src="../Images/image00691.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">In the build definition navigate to the <span class="strong"><strong>Build</strong></span> tab, select the <span class="strong"><strong>Visual Studio Build</strong></span> task. Set the name of the solution containing the Selenium Test Project. Ensure that the <span class="strong"><strong>Restore NuGet Packages</strong></span> flag is checked:<div class="mediaobject"><img src="../Images/image00692.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Select the Visual Studio Test task, enter the path to the test settings file, and inject the URL of the Selenium grid via the <span class="strong"><strong>Override TestRun Parameters</strong></span> field:<div class="mediaobject"><img src="../Images/image00693.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Save the <a id="id620" class="indexterm"/>build<a id="id621" class="indexterm"/> definition <a id="id622" class="indexterm"/>as <code class="literal">FabrikamGitSelenium</code>. Queue a new build for this definition. Once the build execution completes, you can see the test results from the build summary view:<div class="mediaobject"><img src="../Images/image00694.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec168"/>How it works…</h2></div></div></div><p>Let's start by understanding why the Selenium grid URL was injected in the Visual Studio Test task via the <span class="strong"><strong>Override TestRun Parameters</strong></span> field. The solution contains Selenium Test Project and a <code class="literal">Run</code> settings file. This is the configuration file holding test settings used by the Test Project. The new build system provides the ability to overwrite the values in the <code class="literal">Test</code> settings file by directly passing the values through the <span class="strong"><strong>Override TestRun Parameters</strong></span> field, in this specific case, the value of <code class="literal">SeleniumTestGridURL</code>. This value is used by the Selenium Test to execute the test:</p><div class="mediaobject"><img src="../Images/image00695.jpeg" alt="How it works…"/></div><p style="clear:both; height: 1em;"> </p><p>Next, let's look at the build execution log file for this task; this provides a clear summary of the test executed, duration, and update on the result publishing:</p><div class="mediaobject"><img src="../Images/image00696.jpeg" alt="How it works…"/></div><p style="clear:both; height: 1em;"> </p><p>Last but not<a id="id623" class="indexterm"/> least, the TFBuild system <a id="id624" class="indexterm"/>automatically<a id="id625" class="indexterm"/> handles the publishing of test results back to the TFS, independent of the testing framework used:</p><div class="mediaobject"><img src="../Images/image00697.jpeg" alt="How it works…"/></div><p style="clear:both; height: 1em;"> </p><p>As you can see in the preceding screenshot, the Selenium Test Project execution results can directly be viewed in the build summary section.</p></div></div>
<div class="section" title="Integrating the Cloud Load Testing Service in TFBuild" id="aid-20R681"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec61"/>Integrating the Cloud Load Testing Service in TFBuild</h1></div></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Tests at Amazon revealed: every 100 ms increase in load time of Amazon.com decreased sales by 1% (Kohavi and Longbotham 2007)."</em></span></p></blockquote></div><p><a id="id626" class="indexterm"/>Performance Testing can't be an afterthought! Mature software teams test for performance early in the development life cycle. The biggest entry barrier to performance testing is the high cost and low utilization of infrastructure required to generate sufficient load on the application. Today, a wide range of pay-as-you-go Cloud Load Test Services are available. Microsoft also offers a Load Test Service with Visual Studio Team Services. Each VSTS account receives 20,000 virtual user minutes of Load Test Quota free every month. In this recipe, you'll learn how to integrate the VSTS Cloud Load Test Service into your CI Pipeline in TFS.<a id="id627" class="indexterm"/></p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec169"/>Getting ready</h2></div></div></div><p>Visual Studio Team Services<a id="id628" class="indexterm"/> is free for Teams of up to five people. You can <a id="id629" class="indexterm"/>create a free account at <a class="ulink" href="http://bit.ly/1lANwhA">http://bit.ly/1lANwhA</a>. In this recipe, we'll be using the account <a class="ulink" href="https://tfs2015cookbook.visualstudio.com">https://tfs2015cookbook.visualstudio.com</a>.</p><p>For TFS to <a id="id630" class="indexterm"/>authenticate with the VSTS account <a id="id631" class="indexterm"/>using your identity, you will need to generate a personal access token in the VSTS account. Follow the instructions at <a class="ulink" href="http://bit.ly/1I3kzVk">http://bit.ly/1I3kzVk</a> to generate a personal access token.</p><p>Now that we have the Cloud Load Test service in VSTS and personal access token, the Cloud Load Test service needs to be added as an endpoint in TFS. Adding an endpoint in TFS requires that you have <span class="strong"><strong>Edit project level information</strong></span> permissions. You can acquire this permission by being added to the Team Project Administrator Group. Follow the instructions here to add the Cloud Load Test Service endpoint to TFS.</p><p>Navigate to FabrikamTFVC Team Administration Console. In the <span class="strong"><strong>Services</strong></span> tab, click on the <span class="strong"><strong>+</strong></span> icon to add a new endpoint. Select the <span class="strong"><strong>Generic</strong></span> endpoint option and fill out the details as illustrated in the following screenshot. Name the endpoint <code class="literal">CLD-VSTS</code>.</p><div class="mediaobject"><img src="../Images/image00698.jpeg" alt="Getting ready"/></div><p style="clear:both; height: 1em;"> </p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec170"/>How to do it…</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to the <span class="strong"><strong>Build</strong></span> hub in the FabrikamTFVC Team Web Portal. Edit the FabrikamTFVC CI build definition.</li><li class="listitem">Click on the <span class="strong"><strong>+</strong></span> icon to launch the <span class="strong"><strong>Add New Task</strong></span> window. From the <span class="strong"><strong>Test</strong></span> tab, select and add the <span class="strong"><strong>Cloud-based Web Performance Test</strong></span> task:<div class="mediaobject"><img src="../Images/image00699.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The <a id="id632" class="indexterm"/>Cloud Load Test Service<a id="id633" class="indexterm"/> was added as a generic endpoint in the Fabrikam Team Administration Console. Select the <code class="literal">CLD-VSTS</code> endpoint from the registered connection dropdown. Enter the endpoint you would like to run the test against. Specify the location to generate the load from:<div class="mediaobject"><img src="../Images/image00700.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Click on <span class="strong"><strong>Save</strong></span> and trigger queue a new build. Once the build execution completes, the results of the load test execution is available as part of the build result:<div class="mediaobject"><img src="../Images/image00701.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec171"/>How it works…</h2></div></div></div><p>You can start to load test your application with simple configuration. It is easy to get started and utilize the free Cloud Load Test Virtual User Minutes available in your VSTS account. TFBuild also includes a Cloud-based Load Test task that allows you to run multistep performance tests.</p></div></div>
<div class="section" title="Analyzing test execution results from the Runs view" id="aid-21PMQ1"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec62"/>Analyzing test execution results from the Runs view</h1></div></div></div><p>In Team<a id="id634" class="indexterm"/> Foundation Server 2015, the<a id="id635" class="indexterm"/> test execution results of both manual and automated testing are surfaced in the <span class="strong"><strong>Runs</strong></span> page. This page is a new addition to the <span class="strong"><strong>Test</strong></span> hub in Team Web Portal. The <span class="strong"><strong>Runs</strong></span> page offers a unified experience for analyzing the results of test executed using any framework. In this recipe, you'll learn how to analyze and action the test execution results in the <span class="strong"><strong>Runs</strong></span> view in Team Web Portal.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec172"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to the <span class="strong"><strong>Test</strong></span> hub and click on <span class="strong"><strong>Runs</strong></span> to load the <span class="strong"><strong>Runs</strong></span> page. The <span class="strong"><strong>Runs</strong></span> page displays the recent test runs. At first glance, you can see the test execution status, test configuration, build number, number of failed tests, and the pass rate:<div class="mediaobject"><img src="../Images/image00702.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Navigate to the <span class="strong"><strong>Filters</strong></span> view by clicking on the <span class="strong"><strong>Filters</strong></span> tab. The query is defaulted to display the test runs from the last 7 days. Amend and add new clauses to show only the automated test runs for today:<div class="mediaobject"><img src="../Images/image00703.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The query narrows down the test execution results to just one run:<div class="mediaobject"><img src="../Images/image00704.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Double-click <a id="id636" class="indexterm"/>on test run ID to<a id="id637" class="indexterm"/> open the test run for analysis. This view shows the run summary along with charts to visualize the test results by properties, traits, configuration, failures types, and resolution. Any attachments associated to the test run are also available in this view:<div class="mediaobject"><img src="../Images/image00705.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Navigate to the <span class="strong"><strong>Test results</strong></span> tab to see the list of all tests executed as part of this test run. Prior to TFS 2015, you would have had to download the TRX file and open it in Visual Studio to get to this information. This view provides the next level of detail among other things. You can see the test execution duration and failure error messages:<div class="mediaobject"><img src="../Images/image00706.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Select multiple<a id="id638" class="indexterm"/> tests and click<a id="id639" class="indexterm"/> on <span class="strong"><strong>Create Bug</strong></span> to create a bug-type Work Item. Clicking on <span class="strong"><strong>Update Analysis</strong></span> lets you add comments to the test results. You can also double-click on a test to go the next level of detail on its test execution:<div class="mediaobject"><img src="../Images/image00707.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec173"/>How it works...</h2></div></div></div><p>This functionality gives you a unified test analysis experience irrespective of the framework you choose to execute your tests in. In summary, you can query all test runs available in your Team Project, drill down into a specific test run to get a summary view of that run, visualize test runs using charts, query/filter the test results within a run, drill down to a specific test result, download attachments, and last but not least, analyze test failures and file bugs.</p></div></div>
<div class="section" title="Exporting and importing test cases in Excel from TFS"><div class="titlepage" id="aid-22O7C2"><div><div><h1 class="title"><a id="ch05lvl1sec63"/>Exporting and importing test cases in Excel from TFS</h1></div></div></div><p>While test cases <a id="id640" class="indexterm"/>in TFS can be accessed from Microsoft Test<a id="id641" class="indexterm"/> Manager as well as Team Web Access, you may<a id="id642" class="indexterm"/> still find stakeholders wanting to access the test cases <a id="id643" class="indexterm"/>from Excel. As a matter of preference, a few of <a id="id644" class="indexterm"/>your stakeholders may find it easier to <a id="id645" class="indexterm"/>document test cases in excel. While TFS does not offer an out-of-the-box feature to export and import test cases in Excel, it offers a good <a id="id646" class="indexterm"/>
<span class="strong"><strong>Software Development Kit</strong></span> (<span class="strong"><strong>SDK</strong></span>) that can be used to create tools that enable such functionality. In this recipe, you'll learn how to use "test case export to excel" and "Test Case Migrator Plus (open source community tools)" to export test cases into Excel and import test cases from Excel into TFS.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec174"/>Getting ready</h2></div></div></div><p>Download and install the following utilities on your machine:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Test case</strong></span><a id="id647" class="indexterm"/><span class="strong"><strong> export utility</strong></span>: <a class="ulink" href="https://tfstestcaseexporttoexcel.codeplex.com">https://tfstestcaseexporttoexcel.codeplex.com</a></li><li class="listitem"><span class="strong"><strong>Test case</strong></span><a id="id648" class="indexterm"/><span class="strong"><strong> import utility</strong></span>: <a class="ulink" href="http://tcmimport.codeplex.com">http://tcmimport.codeplex.com</a></li></ul></div><div class="note" title="Note"><h3 class="title"><a id="note38"/>Note</h3><p>You'll need elevated permissions to install these utilities. The machine where these utilities are installed needs a version of Excel installed. These utilities do not need to be installed on the TFS application tier.</p></div></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec175"/>How to do it…</h2></div></div></div><div class="section" title="Exporting test cases from TFS"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec08"/>Exporting test cases from TFS</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">On <a id="id649" class="indexterm"/>starting the <span class="strong"><strong>Test Cases Export</strong></span> utility, you'll<a id="id650" class="indexterm"/> be prompted to connect to TFS. Once connected, you'll see a list of test plans and test suits associated to that plan. Select the test suite and the file location for export and fill out the export output location and filename as illustrated in the following screenshot:<div class="mediaobject"><img src="../Images/image00708.jpeg" alt="Exporting test cases from TFS"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The<a id="id651" class="indexterm"/> export process gives you the following<a id="id652" class="indexterm"/> options:<div class="mediaobject"><img src="../Images/image00709.jpeg" alt="Exporting test cases from TFS"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Select the <span class="strong"><strong>Export Each Test Suite into Separate Sheets</strong></span> option to export each test suite into a separate sheet. In the preceding example, regression pack, payments, and website will be exported in three separate sheets in the workbook.</li><li class="listitem">Once the export completes, open the spreadsheet from the export location to view the results of the export.</li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="Importing test cases from TFS"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec09"/>Importing test cases from TFS</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Start the <a id="id653" class="indexterm"/><span class="strong"><strong>Test Case Migrator Plus</strong></span> utility to<a id="id654" class="indexterm"/> launch the test case import wizard.</li><li class="listitem">Select the data source from the <span class="strong"><strong>Source</strong></span> tab. The input format can either be <span class="strong"><strong>Excel Workbook</strong></span> or <span class="strong"><strong>MHT/Word</strong></span>. In this recipe, we'll be using the input source format as <span class="strong"><strong>Excel Workbook</strong></span>. Key in the output folder location. Once the workbook has been parsed, you'll see the list of columns in the selected worksheet. Click on <span class="strong"><strong>Next</strong></span> to configure the <span class="strong"><strong>Destination</strong></span> settings:<div class="mediaobject"><img src="../Images/image00710.jpeg" alt="Importing test cases from TFS"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">From the <a id="id655" class="indexterm"/><span class="strong"><strong>Destination</strong></span> tab, enter the destination details such<a id="id656" class="indexterm"/> as Team Project and Work Item type to import the test cases to. From the <span class="strong"><strong>Settings</strong></span> tab, choose to create a new settings file and click on the <span class="strong"><strong>Next</strong></span> button (the settings file will persist your selections for future imports). From the <span class="strong"><strong>Field</strong></span> mapping tab, map the columns in the spreadsheet to the Work Item. For example, the <span class="strong"><strong>Title</strong></span> field in the spreadsheet maps to the title field of the Work Item.</li><li class="listitem">From the <span class="strong"><strong>Links mapping</strong></span> tab, you can optionally enable linking between Work Items using the <span class="strong"><strong>Miscellaneous</strong></span> tab to specify how the data is read from the source Excel file. Click on <span class="strong"><strong>Save and Migrate</strong></span> to start the migration process based on the settings configured through the wizard. This will trigger the import process; progress on the update is shown on the user interface:<div class="mediaobject"><img src="../Images/image00711.jpeg" alt="Importing test cases from TFS"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Once the<a id="id657" class="indexterm"/> import has been completed, exit the wizard by <a id="id658" class="indexterm"/>clicking on the <span class="strong"><strong>Close</strong></span> icon button. The import utility processes the worksheet and generates a report in the same location as the source worksheet. The import settings file is also generated in the same location. The import settings file stores the settings specified during the import process. The settings file can be used for future imports:<div class="mediaobject"><img src="../Images/image00712.jpeg" alt="Importing test cases from TFS"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Open the <code class="literal">Report.xls</code> file and all successfully imported test cases will be listed in the <span class="strong"><strong>Passed</strong></span> sheet. Any test cases that have issues during import will be listed in the warning sheet, and any test cases that couldn't be imported will be listed in the failed sheet.</li><li class="listitem">To view the imported test results, navigate to the FabrikamTest hub in Team Web Portal. You'll see the new plans appear in the test plan dropdown. The following screenshot illustrates a test suite and a linked test case in Team Web Portal:<div class="mediaobject"><img src="../Images/image00713.jpeg" alt="Importing test cases from TFS"/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec176"/>How it works…</h2></div></div></div><p>This, by no means, is<a id="id659" class="indexterm"/> a Test Case Migration solution, but it is worth<a id="id660" class="indexterm"/> pointing out that if you are using other Test Case Management tools that support extracting test cases into Excel, you could use these tools to import the artifacts into TFS.</p></div><div class="section" title="There is more"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec177"/>There is more</h2></div></div></div><p>While we are on the subject of test suites, it is worth highlighting that TFS 2015 now supports assigning multiple people to a test suite. This capability can be invoked by right-clicking on a test suite in test hub and choosing <span class="strong"><strong>Assign Individuals</strong></span> from the context menu. As illustrated in the following screenshot, the new form allows assigning multiple testers to the test suite:</p><div class="mediaobject"><img src="../Images/image00714.jpeg" alt="There is more"/></div><p style="clear:both; height: 1em;"> </p><p>This will iterate through the test suite and create test cases for each individual. An e-mail with the link to the test cases is e-mailed out to the individuals. This is a great way to enable multiple individuals to test using the same test suite, giving you the ability to track the test activity of each individual in isolation.</p></div></div>
<div class="section" title="Copying and cloning test suites and test cases" id="aid-23MNU1"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec64"/>Copying and cloning test suites and test cases</h1></div></div></div><p>TFS offers two <a id="id661" class="indexterm"/>types of copy operations for test suites and test cases, namely, <span class="strong"><strong>copy</strong></span> and <span class="strong"><strong>clone</strong></span>. Copy uses a mechanism called shallow copy that simply creates a<a id="id662" class="indexterm"/> reference to the artifact. If any amendment is made to the artifact, it <a id="id663" class="indexterm"/>reflects into all its references. Clone uses a mechanism called <a id="id664" class="indexterm"/>deep copy; the <a id="id665" class="indexterm"/>new artifacts have no reference back to its origin and is not impacted by any updates made to the original artifact. A common scenario for using shallow copy is when testing using the same scripts across multiple iterations. On the other hand, a common scenario for deep copy is creating a regression test script by copying several existing test suites and test cases. In this recipe, you'll learn how to use the copy and clone functionality.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec178"/>Getting ready</h2></div></div></div><p>In this recipe, we'll be using Microsoft Test Manager. Microsoft Test Manager is installed with Visual Studio Enterprise or Visual Studio Test Professional. Launch Microsoft Test Manager and connect to the FabrikamTFVC Team Project.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec179"/>How to do it...</h2></div></div></div><div class="section" title="Copying (shallow copy)"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec10"/>Copying (shallow copy)</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In Microsoft <a id="id666" class="indexterm"/>Test Manager, from the <span class="strong"><strong>Plan</strong></span> tab, select a static test suite that will hold the new copy.</li><li class="listitem">From the toolbar, click on the <span class="strong"><strong>Create test suites by referencing existing test cases</strong></span> button.</li><li class="listitem">From the dialog, select the test plan and test suites that you want to copy and click on <span class="strong"><strong>Create Suite</strong></span>.</li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="Clone (deep copy)"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec11"/>Clone (deep copy)</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the Microsoft Test Manager, from the <span class="strong"><strong>Organize</strong></span> tab, select a test plan.</li><li class="listitem">From the toolbar, click on the <span class="strong"><strong>Clone</strong></span> button.</li><li class="listitem">From the dialog, select one or more test suites that you want to clone. You can optionally choose to clone requirements that are associated with the selected test suite.</li><li class="listitem">Enter the name of the destination test plan and set the associated Area Path and Iteration Path.</li><li class="listitem">Next, click on the <span class="strong"><strong>Clone</strong></span> button to trigger the clone operation. The clone log appears showing updates of the clone process.<div class="note" title="Note"><h3 class="title"><a id="note39"/>Note</h3><p>Cloning test cases is supported between Team Projects, but only in the same Team Project Collection.</p></div></li></ol><div style="height:10px; width: 1px"/></div><p>You can also <a id="id667" class="indexterm"/>use the <code class="literal">/clone</code> switch with <code class="literal">tcm.exe</code> from command line to <a id="id668" class="indexterm"/>clone test cases and test suites. In the following sample, you'll<a id="id669" class="indexterm"/> notice that the <code class="literal">/clone</code> requirements is being used to clone the<a id="id670" class="indexterm"/> requirements. The value of the field Area Path and Iteration Path in the destination will be overridden with the specified value:</p><div class="informalexample"><pre class="programlisting">tcm suites /clone /collection:http://tfs2015:8080/tfs/DefaultCollection
   /teamproject:FabrikamTFVC /destinationteamproject:FabrikamGit
   /clonerequirements
   /suiteid:234 /destinationsuiteid:567 
   /overridefield:"Iteration Path"=" FabrikamGit\sprint3"
   /overridefield:"Area Path"=" FabrikamGit\catalog"</pre></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec180"/>How it works...</h2></div></div></div><p>When you clone a test suite, the following objects get copied from the source test plan to the destination test plan:</p><div class="informaltable"><table border="1"><colgroup><col/><col/></colgroup><thead><tr><th valign="bottom">
<p>Test plan object</p>
</th><th valign="bottom">
<p>Notes</p>
</th></tr></thead><tbody><tr><td valign="top">
<p>Test case</p>
</td><td valign="top">
<p>Each new test case retains its shared steps. A link is made between the source and new test cases. The new test cases do not have test runs, bugs, test results, and build information.</p>
</td></tr><tr><td valign="top">
<p>Shared steps referenced by cloned test cases</p>
</td><td valign="top">
<p>Any shared steps referenced by the source test cases are maintained in the cloned test cases at destination.</p>
</td></tr><tr><td valign="top">
<p>Test suite</p>
</td><td valign="top">
<p>The following data is retained:</p>
<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Names and hierarchical structure of the test suites</li><li class="listitem">Order of the test cases</li><li class="listitem">Assigned testers</li><li class="listitem">Configurations</li></ul></div>
</td></tr><tr><td valign="top">
<p>Action recordings linked from a cloned test case</p>
</td><td valign="top">
<p>Any action recording links are maintained in the clone test case.</p>
</td></tr><tr><td valign="top">
<p>Links and attachments</p>
</td><td valign="top">
<p>Any links and attachments in the source are also available in the cloned test case.</p>
</td></tr><tr><td valign="top">
<p>Test configuration</p>
</td><td valign="top">
<p>The test configuration is reapplied in the destination test plan.</p>
</td></tr></tbody></table></div></div></div>
<div class="section" title="Exporting test artifacts and test results from the test hub" id="aid-24L8G1"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec65"/>Exporting test artifacts and test results from the test hub</h1></div></div></div><p>TFS test artifacts<a id="id671" class="indexterm"/> comprise of test plans, test suites, and test cases, <a id="id672" class="indexterm"/>and of course, test results. It is common to <a id="id673" class="indexterm"/>have to export the test artifacts for purposes <a id="id674" class="indexterm"/>of sharing and reporting. Back in the days of TFS 2013 Test Scribe delivered as a Visual Studio Extension, it was the only way to export these artifacts from TFS. Test hub now boasts the e-mail or print test artifacts functionality that allows you to easily share test artifacts with stakeholders. The feature is simple to use and can be triggered from several places within the test hub in Team Web Portal. In this recipe, you'll learn how to export the test artifacts from the test hub.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec181"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Browse to the FabrikamTFVC Team web access and navigate into <span class="strong"><strong>Test</strong></span> hub. To export at the test plan level, select the test plan, and then click on the <span class="strong"><strong>Email or print test artifacts</strong></span> button from the toolbar:<div class="mediaobject"><img src="../Images/image00715.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">To export at the test suite level, select the test suite open the context menu and chose the <span class="strong"><strong>Export</strong></span> option:<div class="mediaobject"><img src="../Images/image00716.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Whether you <a id="id675" class="indexterm"/>choose to export from test plan <a id="id676" class="indexterm"/>or test suite, in both cases, you<a id="id677" class="indexterm"/> will get a new form to select "what" and "how". The "what" in this case being the artifacts. The "how" in <a id="id678" class="indexterm"/>this case being e-mail or print. A few items are worth highlighting in the following screenshot. The <span class="strong"><strong>Latest test outcome</strong></span> option has been added in Update 1, selecting this option also exports the test results. Choosing <span class="strong"><strong>Selected suite + children</strong></span> recursively exports all children of the selected suite:<div class="mediaobject"><img src="../Images/image00717.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec182"/>How it works...</h2></div></div></div><p>Clicking on <a id="id679" class="indexterm"/>print or e-mail starts the process of<a id="id680" class="indexterm"/> generating the extract; this may take up to a few<a id="id681" class="indexterm"/> seconds to complete depending on the <a id="id682" class="indexterm"/>quantity and size of the artifacts being exported. Once the export has been completed, a form will pop up to show you the preview of the export. You can also edit and format the values from the preview form. Since we have chosen the e-mail option, the form has a field that allows us to choose the e-mail address of the person we would like the export to be sent out to:</p><div class="mediaobject"><img src="../Images/image00718.jpeg" alt="How it works..."/></div><p style="clear:both; height: 1em;"> </p><p>As illustrated in the following screenshot, the export also includes the test steps:</p><div class="mediaobject"><img src="../Images/image00719.jpeg" alt="How it works..."/></div><p style="clear:both; height: 1em;"> </p></div><div class="section" title="There is more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec183"/>There is more…</h2></div></div></div><p>It is possible to<a id="id683" class="indexterm"/> customize the format of the export by modifying <a id="id684" class="indexterm"/>the underlying template used by TFS during the <a id="id685" class="indexterm"/>export/print process. The following <a id="id686" class="indexterm"/>points are to be kept in mind before customizing the template:</p><p>You should create a backup of the original template, for example, copy and rename it to <code class="literal">TestSuite-Original.xsl</code>. If not, when you upgrade TFS, the changes you made in the <code class="literal">TestSuite.xsl</code> file may get overwritten. The export does not support customization per project; the style changes will affect all projects in your TFS instance.</p><p>Follow the steps listed here to add your company logo to the export:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log on to the TFS application tier and navigate to the following path. Add your company logo (<code class="literal">companylogo.png</code>) in the <code class="literal">C:\Program Files\Microsoft Team Foundation Server 14.0\Application Tier\Web Services\_static\tfs\12\_content</code> folder path.</li><li class="listitem">Modify the <code class="literal">TestSuite.xsl</code> file in the <code class="literal">C:\Program Files\Microsoft Team Foundation Server 14.0\Application Tier\Web Services\_tfs_resources\TestManagement\v1.0\Transforms\1033</code> folder.</li><li class="listitem">Open the <code class="literal">TestSuite.xsl</code> file in the notepad and add the following lines of code to include your company logo into the export template:<div class="informalexample"><pre class="programlisting">&lt;div style="align:center;"&gt;
&lt;img src="../../_static/tfs/12/_content/companylogo.png" /&gt;
&lt;/div&gt;</pre></div></li><li class="listitem">The results of the <a id="id687" class="indexterm"/>customization can be tested by<a id="id688" class="indexterm"/> generating an export through the <a id="id689" class="indexterm"/>test hub in Team Web <a id="id690" class="indexterm"/>Portal.</li></ol><div style="height:10px; width: 1px"/></div></div></div>
<div class="section" title="Charting testing status on Dashboards in Team Portal" id="aid-25JP21"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec66"/>Charting testing status on Dashboards in Team Portal</h1></div></div></div><p>The charting tools in<a id="id691" class="indexterm"/> Team Web Portal provide a great way to <a id="id692" class="indexterm"/>analyze and visualize test case execution. The <a id="id693" class="indexterm"/>charts created through the charting tools can be pinned to custom Dashboards. Both charts and Dashboards are fantastic information radiators to share the test execution results with Team members and stakeholders. In this recipe, you'll learn how to pin the test execution results on a custom Dashboard in Team Portal.</p><div class="section" title="Getting Started"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec184"/>Getting Started</h2></div></div></div><p>Follow the steps in the Configuring Dashboards in Team Project recipe in <a class="link" title="Chapter 1. Team Project Setup" href="part0016.xhtml#aid-F8901">Chapter 1</a>, <span class="emphasis"><em>Team Project Setup</em></span>, to create a custom Dashboard for testing.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec185"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to the <span class="strong"><strong>Test</strong></span> hub in FabrikamTFVC Team Web Portal. The <span class="strong"><strong>Test Plan</strong></span> page gives you a list of test suites and a list of test cases for the selected suite. The <span class="strong"><strong>Charts</strong></span> tab gives you a great way to visualize this information. Click on the <span class="strong"><strong>+</strong></span> icon and select <span class="strong"><strong>New test result</strong></span> charts. Select a bar chart and group by <span class="strong"><strong>Outcome</strong></span>; this renders the test case outcome in the bar chart. Click on <span class="strong"><strong>OK</strong></span> to save the chart. Right-click on the newly created chart and pin the chart to the testing Dashboard:<div class="mediaobject"><img src="../Images/image00720.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Now, click<a id="id694" class="indexterm"/> on the <span class="strong"><strong>+</strong></span> icon and select the <a id="id695" class="indexterm"/><span class="strong"><strong>New test case</strong></span> chart. Test case chart<a id="id696" class="indexterm"/> types support trend charts and the supported trend period is from 7 days to up to 12 months. Select the stacked area chart type and chose to stack by <span class="strong"><strong>State</strong></span>. This will allow you to visualize the state of the test cases over time. Click on OK to save the chart, right-click on the chart and pin it to the Dashboard:<div class="mediaobject"><img src="../Images/image00721.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec186"/>How it works...</h2></div></div></div><p>The charts are calculated using the Work Item data in the transactional database. When Work Items are updated, the charts reflect the updates immediately. To learn more about the charting functionality <a id="id697" class="indexterm"/>in Team Web Portal refer to the walkthrough at <a class="ulink" href="http://bit.ly/1PGP8CU">http://bit.ly/1PGP8CU</a>.</p></div></div></body></html>