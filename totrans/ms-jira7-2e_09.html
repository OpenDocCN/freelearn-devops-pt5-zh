<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch09"/>Chapter 9. JIRA Add-On Development and Leveraging the REST API</h1></div></div></div><p>JIRA comes with tons of useful features that help you not only get started on your project, but also let you customize the workflows that match your software model and processes. However, there are times when certain functionalities or customizations are required, but these are not supported by JIRA. Then again, many new features can be added in JIRA by installing add-ons from the Atlassian marketplace. JIRA has a marketplace where one can search for these add-ons. Some add-ons are free and some are paid add-ons. If you are looking for additional features, you can search on the marketplace for existing add-ons, but it's also possible to create your own add-ons, which requires a decent knowledge of Java. This chapter will give you enough information to get you started with JIRA's add-on development, along with some simple examples.</p><p>The following topics will be covered:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Setting up the Atlassian plugin <strong>software development kit</strong> (<strong>SDK</strong>)</li><li class="listitem" style="list-style-type: disc">Installing the Atlassian SDK on Windows</li><li class="listitem" style="list-style-type: disc">Creating the <strong>helloworld</strong> plugin</li><li class="listitem" style="list-style-type: disc">Setting up the Eclipse IDE</li><li class="listitem" style="list-style-type: disc">Leveraging the JIRA <strong>representational state transfer</strong> (<strong>REST</strong>) API</li></ul></div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec59"/>Setting up the Atlassian plugin SDK</h1></div></div></div><p>Atlassian provides an SDK to develop add-ons. The SDK needs to be installed on your machine before starting the development. It can be installed on Windows, Linux, and Mac. Any of these operating systems can be used to develop add-ons, however, in this chapter, the instructions will focus only on the Windows platform. There are no specific recommended hardware requirements to install the Atlassian SDK; however, to get a decent performance, install it on a machine that has a core i5 processor and 8 GB of RAM.</p><div><div><h3 class="title"><a id="note21"/>Note</h3><p>Download the Atlassian SDK for Windows at <a class="ulink" href="https://marketplace.atlassian.com/download/plugins/atlassian-plugin-sdk-windows">https://marketplace.atlassian.com/download/plugins/atlassian-plugin-sdk-windows</a>.</p></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec74"/>Setting up the SDK prerequisites on a Windows system</h2></div></div></div><p>The SDK requires the Java environment to be configured on your machine. In <a class="link" href="ch01.html" title="Chapter 1. Planning Your JIRA Installation">Chapter 1</a>, <em>Planning Your JIRA Installation</em>, we discussed how to install the JDK. The JDK could have been installed at <code class="literal">C:\java</code> or <code class="literal">C:\java\jdk1.8.0_92</code>.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec75"/>Verifying the JDK installation and the JAVA_HOME system variable</h2></div></div></div><p>The Atlassian JDK needs Oracle's Java SE Development Kit installed on the system. Follow the steps mentioned in <a class="link" href="ch01.html" title="Chapter 1. Planning Your JIRA Installation">Chapter 1</a>, <em>Planning your JIRA Installation</em> to install it and verify that the <code class="literal">JAVA_HOME</code> system variable is set up by following the steps mentioned here:</p><div><ol class="orderedlist arabic"><li class="listitem">Open <strong>Command Prompt</strong> (<strong>cmd</strong>) and enter the following command:<pre class="programlisting">
<strong>      echo %JAVA_HOME%</strong>
</pre></li><li class="listitem">It should return the path where the JDK is installed. In our case, it's given as follows:<pre class="programlisting">
<strong>      c:\java</strong>
</pre></li></ol></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec21"/>Verifying that JAVA_HOME\bin is present in the environment variable PATH</h3></div></div></div><p>The JDK <code class="literal">bin</code> directory has executable files, such as <code class="literal">javac</code>, and it should be available to the Atlassian SDK.</p><p>All you need to do is append the following line to your existing <code class="literal">Path</code> system variable <code class="literal">%JAVA_HOME%\bin</code> and perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Open cmd and enter the following command:<pre class="programlisting">
<strong>javac -version</strong>
</pre></li><li class="listitem">It should return the version of the JDK:<pre class="programlisting">
<strong>javac 1.8.0_92</strong>
</pre></li></ol></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec60"/>Installing the Atlassian SDK on Windows</h1></div></div></div><p>The Atlassian SDK can be downloaded from <a class="ulink" href="https://marketplace.atlassian.com/download/plugins/atlassian-plugin-sdk-windows">https://marketplace.atlassian.com/download/plugins/atlassian-plugin-sdk-windows</a>. This link will always give you the latest stable version of the SDK. Here, you will get an executable file called <code class="literal">sdk-installer-6.2.6.exe</code>. Perform the following steps to install the SDK on your Windows system:</p><div><ol class="orderedlist arabic"><li class="listitem">After downloading the SDK installer, double-click on it and complete the installation.</li><li class="listitem">Once the installation is complete, the installer will prompt you to restart the computer. If the installer doesn't ask you to restart, just check whether you are able to use <code class="literal">atlas-</code>commands; if not, then restarting the system is the safest way to make sure that the SDK is installed properly.</li><li class="listitem">Open cmd and enter the following command:<pre class="programlisting">
<strong>atlas-version</strong>
</pre></li><li class="listitem">It should return the following information:<p>
</p><div><img src="img/image_09_001.jpg" alt="Installing the Atlassian SDK on Windows"/></div><p>
</p></li></ol></div><p>You can see that it will tell you which version of the Atlassian SDK is installed on the system and give you the details of the JDK that is installed as well.</p><p>At this point, everything is set up and you are now ready to start developing add-ons.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec76"/>Getting familiar with the Atlassian SDK</h2></div></div></div><p>When you ran the <code class="literal">atlas-version</code> command, it showed various details of the installed SDK. You might have noticed that <code class="literal">ATLAS Home</code> is the location where the Atlassian SDK is installed. Let's open this directory and check its content:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">apache-maven-3.2.1</code>: This Atlassian SDK uses <strong>Maven</strong>, which is a popular tool used to build automation for Java projects.</li><li class="listitem" style="list-style-type: disc"><code class="literal">bin</code>: This directory contains all the command-line tools that are used to develop add-ons. All the commands here are prefixed with <code class="literal">atlas-</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">repository</code>: This directory contains the actual code that the SDK relies on to develop add-ons.</li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec77"/>The atlas command</h2></div></div></div><p>We just discussed that all the commands are prefixed with <code class="literal">atlas-</code>. Before you start creating add-ons, a working JIRA instance is required. This will be used to test your add-ons. The <code class="literal">atlas-run-standalone</code> command is used to set up and start the JIRA instance for you.</p><p>Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Create a folder called <code class="literal">atlastutorial</code> in your <code class="literal">C:\</code> directory.</li><li class="listitem">In cmd, change directory using:<pre class="programlisting">
<strong>cd c:\atlastutorial</strong>
</pre></li><li class="listitem">Start JIRA using the following command:<pre class="programlisting">
<strong>atlas-run-standalone --product jira</strong>
</pre></li><li class="listitem">Depending on your internet connection, this command will take a few minutes to complete. It downloads the JIRA files and starts the instance on port <code class="literal">2990</code>:<pre class="programlisting">
<strong>[INFO] Starting jira on the tomcat7x container on ports 2990 (http),&#13;
     54668  &#13;
     (rmi) and 8009 (ajp)</strong>
<strong>[INFO] using codehaus cargo v1.4.7</strong>
<strong>[INFO] [2.ContainerStartMojo] Resolved container artifact &#13;
     org.codehaus.cargo:cargo-core-container-tomcat:jar:1.4.7 for container &#13;
     tomcat7x</strong>
<strong>[INFO] [talledLocalContainer] Tomcat 7.x starting...</strong>
<strong>[INFO] [stalledLocalDeployer] Deploying [c:\atlastutorial\amps-&#13;
     standalone\target\jira\jira.war] to [c:\atlastutorial\amps-&#13;
     standalone/target\container\tomcat7x\cargo-jira-home/webapps]...</strong>
<strong>[INFO] [talledLocalContainer] Tomcat 7.x started on port [2990]</strong>
<strong>[INFO] jira started successfully in 703s at http://localhost:2990/jira</strong>
<strong>[INFO] Type Ctrl-D to shutdown gracefully</strong>
<strong>[INFO] Type Ctrl-C to exit     </strong>
</pre></li><li class="listitem">Enter <code class="literal">http://localhost:2990/jira</code> in your browser; the exact URL will also be displayed by the command.</li><li class="listitem">Enter <code class="literal">admin</code> as the username and password.</li></ol></div><p>This is your JIRA instance, created after you set up the Atlassian SDK with the test license for plugin developers; we will use this to develop the JIRA add-ons.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec61"/>Creating the helloworld plugin</h1></div></div></div><p>Now, we are ready to create our first add-on in JIRA, which will introduce new features to our instance. Any JIRA add-on contains a lot of files, and it has to follow a directory structure; the Atlassian SDK provides a command-line tool called <code class="literal">atlas-create-jira-plugin</code> to create a plugin.</p><p>If your existing JIRA is already running in cmd, then stop it by pressing on <em>Ctrl + C</em> and perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">In cmd, make sure that you are in the <code class="literal">C:\atlastutorial</code> directory.</li><li class="listitem">Enter the following command and press <em>Enter</em>:<pre class="programlisting">
<strong>atlas-create-jira-plugin</strong>
</pre></li><li class="listitem">This command will respond and ask you to provide certain inputs. Use the values mentioned in the following table:<div><table border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td>
<p><strong>Define value for</strong> <code class="literal">groupId</code>
</p>
</td><td>
<p>
<code class="literal">com.atlassian.tutorial</code>
</p>
</td><td>
<p><strong>Used to identify project uniquely</strong></p>
</td></tr><tr><td>
<p>Define value for <code class="literal">artifactId</code>
</p>
</td><td>
<p>
<code class="literal">helloworld</code>
</p>
</td><td>
<p>An artifact is a file, usually a JAR, that gets deployed</p>
</td></tr><tr><td>
<p>Define value for <code class="literal">version</code>
</p>
</td><td>
<p>
<code class="literal">1.0-Version</code>
</p>
</td><td>
<p>Used for distributing the plugin</p>
</td></tr><tr><td>
<p>Define value for <code class="literal">package</code>
</p>
</td><td>
<p>
<code class="literal">com.atlassian.tutorial.helloworld</code>
</p>
</td><td>
<p>Used to organize the related classes</p>
</td></tr></tbody></table></div></li><li class="listitem">The <code class="literal">atlas-create-jira-plugin</code> command will prompt you to confirm the values you just entered. Press <em>
<strong>Y</strong>
</em> to continue. A new <code class="literal">helloworld</code> folder will be created at <code class="literal">c:\atlastutorial\helloworld</code>.</li></ol></div><p>If you take a look in the <code class="literal">c:\atlastutorial\helloworld</code> directory, you will find a skeleton of the plugin project with the following files and folders created by the <code class="literal">atlas-create-jira-plugin</code> command:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">src</code>: This folder contains the source code of the plugin</li><li class="listitem" style="list-style-type: disc"><code class="literal">LICENSE</code>: This file stores the plugin license information</li><li class="listitem" style="list-style-type: disc"><code class="literal">pom</code>: This is the Maven configuration file</li><li class="listitem" style="list-style-type: disc"><code class="literal">README</code>: This file contains brief instructions on how to run the plugin</li></ul></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec78"/>Adding organization details in pom.xml</h2></div></div></div><p>Open the <code class="literal">pom.xml</code> file, search the <code class="literal">&lt;organization&gt;</code> tag, and update the company name and the company URL. This information will be visible to the user who will install the plugin from the <strong>Universal Plugin Manager</strong> (<strong>UPM</strong>):</p><pre class="programlisting">&lt;organization&gt; &#13;
  &lt;name&gt;Sparxsys Solutions Pvt. Ltd.&lt;/name&gt; &#13;
  &lt;url&gt;http://www.sparxsys.com/&lt;/url&gt; &#13;
&lt;/organization&gt; &#13;
</pre><p>Enter the company name within an enclosed <code class="literal">&lt;name&gt;</code> tag and the company URL within an enclosed <code class="literal">&lt;url&gt;</code> tag and save the file.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec79"/>Loading the plugin in JIRA</h2></div></div></div><p>We now have a plugin created with just a single command, and you can actually load this plugin in JIRA. Although it has no functionality right now, we will still make the attempt to understand how to load this plugin in JIRA. Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">In cmd, navigate to the <code class="literal">c:\atlastutorial\helloworld</code> directory.</li><li class="listitem">Enter the following command and press <em>Enter</em>:<pre class="programlisting">
<strong>atlas-run</strong>
</pre><p>                       This is a shell script that installs and runs the plugin.</p></li><li class="listitem">This command will create a folder called the <code class="literal">target</code> subdirectory in the <code class="literal">helloworld</code> directory. After some time, a JIRA instance will start.</li><li class="listitem">Enter <code class="literal">http://localhost:2990/jira</code> in your browser; the exact URL will also be displayed by the command.</li><li class="listitem">Enter <code class="literal">admin</code> for both username and password.</li><li class="listitem">Go to JIRA <strong>Administration</strong> | <strong>Add-ons</strong> | <strong>Manage add-ons</strong> (under <strong>ATLASSIAN MARKETPLACE</strong>).</li><li class="listitem">Under <strong>User-installed add-ons</strong>, you will find the new add-on called <strong>helloworld</strong>:<p>
</p><div><img src="img/image_09_002.jpg" alt="Loading the plugin in JIRA"/></div><p>
</p></li></ol></div><p>As you can see in the preceding screenshot, the <strong>helloworld</strong> add-on is now loaded in your JIRA instance. Also, the version information that we filled in while creating the plugin is visible here. The hyperlinked company name is also displayed.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec62"/>Setting up the Eclipse IDE</h1></div></div></div><p>We have set up the development environment and installed the Atlassian SDK. You also learned how to create a skeleton plugin; apart from just showing up in the UPM, this plugin did not perform any other function. We will add a few functionalities to our plugin, but before that, let's configure the popular Eclipse IDE, which really assists in developing JIRA add-ons.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec80"/>Downloading the Eclipse IDE</h2></div></div></div><p>The Eclipse IDE is used for development purposes in various programming languages, however, we will install the Eclipse IDE for Java EE Developers (Indigo). Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Download the Eclipse IDE for Java EE developers from <a class="ulink" href="http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/indigosr2">http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/indigosr2</a>.</li><li class="listitem">Extract the content of the downloaded file in the <code class="literal">C:\eclipse</code> directory.</li></ol></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec22"/>Configuring Eclipse to start under the JDK</h3></div></div></div><p>We need to tell our Eclipse IDE to start and use the JDK that we have already installed on our machine:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the <code class="literal">C:\eclipse\eclipse.ini</code> file.</li><li class="listitem">Add a <code class="literal">-vm</code> entry before the <code class="literal">-vmargs</code> entry. We should define the JDK path here; the final <code class="literal">eclipse.ini</code> file should look similar to the following code:<pre class="programlisting">        -startup &#13;
        plugins/org.eclipse.equinox.launcher_1.3.0.v20140415-2008.jar &#13;
        --launcher.library &#13;
        plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.&#13;
        v20140603-1326 &#13;
        -product &#13;
        org.eclipse.epp.package.jee.product &#13;
        --launcher.defaultAction &#13;
        openFile &#13;
        --launcher.XXMaxPermSize &#13;
        256M &#13;
        -showsplash &#13;
        org.eclipse.platform &#13;
        --launcher.XXMaxPermSize &#13;
        256m &#13;
        --launcher.defaultAction &#13;
        openFile &#13;
        --launcher.appendVmargs &#13;
        -vm &#13;
        c:\java &#13;
        -vmargs &#13;
        -Dosgi.requiredJavaVersion=1.8 &#13;
        -Xms40m &#13;
        -Xmx512m &#13;
</pre></li><li class="listitem">Save and close the file.</li></ol></div></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec23"/>Updating the installed JREs in Eclipse</h3></div></div></div><p>The Eclipse JREs need to be updated with the ones that are currently installed in our JDK version. Perform the following steps if you are not sure whether you have the updated JREs or not:</p><div><ol class="orderedlist arabic"><li class="listitem">In the menu bar, click on <strong>Windows</strong> | <strong>Preferences</strong>.</li><li class="listitem">Double-click on the <code class="literal">C:\eclipse\eclipse.exe</code> application and it will start the Eclipse IDE.</li><li class="listitem">On the left-hand side, enter <code class="literal">Installed JREs</code>; this will filter down the list; after that, double-click on <strong>Installed JREs</strong>.</li><li class="listitem">On the right-hand side, click on the <strong>Add</strong> button and select <strong>Standard VM</strong>.</li><li class="listitem">In <strong>JRE home</strong>, enter <code class="literal">c:\java</code> as the location of the directory and click on the <strong>Finish</strong> button:<p>
</p><div><img src="img/image_09_003.jpg" alt="Updating the installed JREs in Eclipse"/></div><p>
</p></li><li class="listitem">Finally, the JREs will be updated, and it should look similar to the following screenshot:<p>
</p><div><img src="img/image_09_004.jpg" alt="Updating the installed JREs in Eclipse"/></div><p>
</p></li></ol></div></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec24"/>Installing the Maven plugin</h3></div></div></div><p>The development of the JIRA add-ons is based on Maven, and there is an Eclipse plugin for Maven that needs to be installed. Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">In the menu bar, click on <strong>Help</strong> | <strong>Install New Software…</strong></li><li class="listitem">In the <strong>Available Software</strong> window, click on the <strong>Add</strong> button.</li><li class="listitem">Enter the <strong>Name</strong> as <code class="literal">Sonatype M2Eclipse</code>. Enter <code class="literal">http://download.eclipse.org/technology/m2e/releases</code> as the <strong>Location</strong> and click on the <strong>OK</strong> button.<p>
</p><div><img src="img/image_09_005.jpg" alt="Installing the Maven plugin"/></div><p>
</p></li><li class="listitem">Select <strong>Maven Integration for Eclipse</strong> and click on the <strong>Finish</strong> button.</li><li class="listitem">Finally, restart Eclipse for these changes to take effect.</li></ol></div></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec25"/>Configuring the Maven plugin</h3></div></div></div><p>Finally, we need to tell the Maven Eclipse plugin the location of Maven on our machine. The Maven directory is placed in the <code class="literal">ATLAS Home</code> directory. You can run the <code class="literal">atlas-version</code> command on your machine to find out the exact location of <code class="literal">ATLAS Maven Home</code>. Just copy this location and perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">In the menu bar, click on <strong>Windows</strong> | <strong>Preferences</strong>.</li><li class="listitem">On the left-hand side, enter <code class="literal">Maven</code>; it will filter down the options available for <strong>Maven</strong>.</li><li class="listitem">Click on <strong>Installations</strong> and then click on the <strong>Add</strong> button.</li><li class="listitem">The <strong>Installation type</strong> should be <strong>External</strong>. Copy the <code class="literal">ATLAS Maven Home</code> directory and click on the <strong>Finish</strong> button.</li></ol></div><p>Now we are all set to start developing our JIRA add-ons using Eclipse.</p></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec81"/>Adding functionality to the skeleton plugin</h2></div></div></div><p>The helloworld plugin (which we created earlier) lacks any functionality; we loaded the plugin in JIRA, but it didn't do anything apart from just showing up in the UPM. Now that we have also configured the Eclipse IDE, let's add a few functionalities to our helloworld plugin.</p><p>As an example, we will add a custom link in the JIRA main navigation bar using this plugin.</p><div><div><div><div><h3 class="title"><a id="ch09lvl3sec26"/>Importing the helloworld plugin in Eclipse</h3></div></div></div><p>We can use the Eclipse IDE and import our plugin, but before we do that, there are Eclipse configuration files that need to be generated in the <code class="literal">helloworld</code> plugin project. Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">In cmd, navigate to the <code class="literal">C:\atlastutorial\helloworld</code> directory.</li><li class="listitem">Enter the following command and press <em>Enter</em>:<pre class="programlisting">
<strong>atlas-mvn eclipse:eclipse</strong>
</pre></li><li class="listitem">This command will return the following message:<pre class="programlisting">
<strong>[INFO] -------------------------------------------------------[INFO] &#13;
      BUILD SUCCESS</strong>
<strong>[INFO] -------------------------------------------------------[INFO] &#13;
      Total time: 56.519 s</strong>
<strong>[INFO] Finished at: 2014-11-28T11:15:35+05:30</strong>
<strong>[INFO] Final Memory: 21M/102M</strong>
<strong>[INFO] ---------------------------------------------------</strong>
</pre></li><li class="listitem">Now, we are ready to import the plugin in Eclipse. In the menu bar, click on <strong>File</strong> | <strong>Import…</strong></li><li class="listitem">Select <strong>Existing Projects into Workspace</strong> under <strong>General</strong> and click on the <strong>Next</strong> button.</li><li class="listitem">Enter <code class="literal">C:\atlastutorial\helloworld</code> in the <strong>Select root</strong> directory and click on the <strong>Finish</strong> button.</li></ol></div><p>Now you should see the <code class="literal">helloworld</code> plugin project loaded on the left-hand side under <strong>Project Explorer</strong>, as shown in the following screenshot. If you notice the welcome screen in your SDK, then close it.</p><p>
</p><div><img src="img/image_09_006.jpg" alt="Importing the helloworld plugin in Eclipse"/></div><p>
</p></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec27"/>Creating a menu in JIRA's top navigation bar</h3></div></div></div><p>We will use a very simple example to help us understand how to add new functionalities in JIRA. You are already familiar with JIRA's top navigation bar. From the JIRA frontend, it's not possible to add a new menu item to it; however, we will modify our <code class="literal">helloworld</code> plugin to add this menu item.</p><p>The JIRA functionality and the behavior of its various sections are controlled by various modules. If we want to make any modifications to JIRA's top navigation bar, then we need to add two modules called <code class="literal">Web Section</code> and <code class="literal">Web Item</code>. Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">In the cmd, navigate to the <code class="literal">c:\atlastutorial\helloworld</code> directory.</li><li class="listitem">Enter the following command and press <em>Enter</em>:<pre class="programlisting">
<strong>atlas-create-jira-plugin-module</strong>
</pre></li><li class="listitem">To learn more about plugin modules, refer to theURL: <a class="ulink" href="https://developer.atlassian.com/docs/getting-started/plugin-modules">https://developer.atlassian.com/docs/getting-started/plugin-modules</a>.</li><li class="listitem">The command will respond and prompt you to enter a specific number for various modules. Type <code class="literal">30</code> for <code class="literal">Web Section</code>.</li><li class="listitem">The command will again respond and ask you to provide certain inputs. Use the values as mentioned in the following table:<div><table border="1"><colgroup><col/><col/></colgroup><tbody><tr><td>
<p>
<code class="literal">Enter Plugin Module Name</code>
</p>
</td><td>
<p>
<code class="literal">mySection</code>
</p>
</td></tr><tr><td>
<p>
<code class="literal">Enter Location</code>
</p>
</td><td>
<p>
<code class="literal">contact-us-links</code>
</p>
</td></tr><tr><td>
<p>
<code class="literal">Show Advanced Setup?</code>
</p>
</td><td>
<p>
<em>N</em>
</p>
</td></tr></tbody></table></div></li><li class="listitem">The command will ask you, <strong>Add Another Plugin Module?</strong> Press <em>
<strong>Y</strong>
</em>.</li><li class="listitem">The command will respond and prompt you to enter a specific number for various modules. Type <code class="literal">25</code> for <code class="literal">Web Item</code>.</li><li class="listitem">The command will again respond and ask you to provide certain inputs. Use the values as mentioned in the following table:<div><table border="1"><colgroup><col/><col/></colgroup><tbody><tr><td>
<p>
<code class="literal">Enter Plugin Module Name</code>
</p>
</td><td>
<p>
<code class="literal">Contact Us</code>
</p>
</td></tr><tr><td>
<p>
<code class="literal">Enter Section</code>
</p>
</td><td>
<p>
<code class="literal">system.top.navigation.bar</code>
</p>
</td></tr><tr><td>
<p>
<code class="literal">Enter Link URL</code>
</p>
</td><td>
<p>
<code class="literal">http://www.sparxsys.com/contact</code>
</p>
</td></tr><tr><td>
<p>
<code class="literal">Show Advanced Setup?</code>
</p>
</td><td>
<p>
<em>N</em>
</p>
</td></tr></tbody></table></div></li><li class="listitem">The command will ask you to <strong>Add Another Plugin Module?</strong> Press <em>
<strong>N</strong>
</em>.</li><li class="listitem">Run the <code class="literal">atlas-run</code> command from within your plugin project directory. Once JIRA starts running, open it in the browser:<p>
</p><div><img src="img/image_09_007.jpg" alt="Creating a menu in JIRA's top navigation bar"/></div><p>
</p></li></ol></div><p>You should now see a new menu item called <strong>Contact Us</strong>, which we have added from our <code class="literal">helloworld</code> plugin.</p><p>We have just started to add the functionality in the skeleton plugin project. Although all we did was add a link to the JIRA navigation bar, there is a lot more that can be done.</p><p>If you are starting JIRA add-on development, then start by going through the tutorials mentioned on the Atlassian website at <a class="ulink" href="https://developer.atlassian.com/docs/getting-started/tutorials">https://developer.atlassian.com/docs/getting-started/tutorials</a>.</p><p>So far in this chapter, we have discussed creating add-ons that extend JIRA's functionalities, but it's also possible to interact with JIRA from other applications as well. JIRA comes with the <strong>REST API</strong>, which allows you to manipulate JIRA's data and configurations from external applications. The JIRA API that adheres to the principles of REST does not require the client to know anything about the structure of the API. Rather, the server needs to provide whatever information the client needs to interact with the service.</p><p>Various programming languages are capable of making REST calls. In the following section, we will discuss how to interact with JIRA REST APIs, along with some examples in detail.</p></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec82"/>JIRA Cloud add-ons with an Atlassian Connect framework</h2></div></div></div><p>We have just seen how to develop an add-on for a JIRA Server instance that you host on your own server. However, a lot of organizations also use an Atlassian Cloud instance, which is a hosted environment; it doesn't require any installation. You just sign up online and pay for the usage. The Atlassian Cloud instance comes with most of the features that JIRA Server offers. Many organizations prefer to use a cloud instance as there is no hassle to manage the server yourself. The procedure to develop an add-on for cloud is different. If you want to learn that, please follow the documentation at <a class="ulink" href="https://developer.atlassian.com/static/connect/docs/latest/guides/introduction.html">https://developer.atlassian.com/static/connect/docs/latest/guides/introduction.html</a>.</p><p>If you plan to sell your add-on on the Atlassian marketplace then it is a good idea to develop the add-on for both JIRA Server and JIRA Cloud.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec63"/>Leveraging the JIRA REST API</h1></div></div></div><p>We have discussed how to start building add-ons that extend JIRA's functionalities. The add-ons are integrated very closely with JIRA's existing features; however, there are times when you need to add a few functionalities on top of JIRA so that other tools can interact with JIRA. JIRA provides access to various operations via REST.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec83"/>Examples of a few operations that can be performed via REST</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Issue operations such as create/modify/delete issues</li><li class="listitem" style="list-style-type: disc">Search issues</li><li class="listitem" style="list-style-type: disc">Create users</li><li class="listitem" style="list-style-type: disc">Group management operations like adding/removing users from a group</li></ul></div><p>There are a lot of resources that are available through REST API. You can get the detailed list of all the resources at <a class="ulink" href="https://docs.atlassian.com/jira/REST/latest/">https://docs.atlassian.com/jira/REST/latest/</a>.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec84"/>Use cases of JIRA REST API</h2></div></div></div><p>Having the ability to interact with JIRA through external applications opens up a lot of possibilities. Let's take a look at some of the use cases of functionality that can be built on top of JIRA:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Generating business intelligence reports</li><li class="listitem" style="list-style-type: disc">Generating bulk operations in JIRA</li><li class="listitem" style="list-style-type: disc">Building a custom interface for clients</li></ul></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec28"/>Generating business intelligence reports</h3></div></div></div><p>JIRA comes with a lot of readymade reports, which we discussed in detail in <a class="link" href="ch03.html" title="Chapter 3. Reporting – Using Charts to Visualize the Data">Chapter 3</a>, <em>Reporting - Charts to visualize the data</em>, but companies use the business intelligence tools to generate reports that are customized to their needs; in JIRA, all the data is stored in issues, which can be fetched from REST API.</p></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec29"/>Bulk operations in JIRA</h3></div></div></div><p>System administrators in JIRA are often faced with situations where they need to perform various operations in bulk. For instance, if a new team in the company wants to start using JIRA, then several user accounts need to be created. JIRA's REST API provides the resources to create a user account. After the accounts are created, they also need to be added to the correct group. Although the JIRA group management interface already provides the mechanism to modify user groups by entering their usernames as a comma-separated list, modifying groups can also be done via the REST API.</p><p>The scripts can be created to perform such bulk operations, and they can be run whenever it is needed.</p></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec30"/>Building a custom interface for clients</h3></div></div></div><p>We have already seen that it's very easy to customize permissions in JIRA and give limited access of your JIRA instance to your clients. However, it's also possible to create a simple web interface that has a login box for authentication, a form to raise tickets, and a simple list of issues for a particular project or client. This web application can internally interact with JIRA, and it acts like the backend to store and retrieve client tickets.</p></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec85"/>JIRA's REST API Browser</h2></div></div></div><p>REST calls are made by calling the <code class="literal">http://jira.sparxsys.com/rest/api/2/RESOURCE URL</code>, and most programming languages (such as Java and PHP) support them; however, before you can develop the functionalities to interact with JIRA using REST, you need to test it.</p><p>The Atlassian SDK that you have installed comes with a nifty tool called <strong>REST API Browser</strong>. It helps you explore the APIs and also test them. Perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Run the <code class="literal">atlas-run</code> command, as we did earlier in this chapter. It will start the JIRA instance.</li><li class="listitem">Enter <code class="literal">http://localhost:2990/jira</code> in your browser; the exact URL will also be displayed by the command.</li><li class="listitem">Enter <code class="literal">admin</code> for both the username and password.</li><li class="listitem">Go to JIRA <strong>Administrator</strong> | <strong>System</strong> | <strong>REST API Browser</strong> (under <strong>ADVANCED</strong>).</li><li class="listitem">On the left-hand side, you will find the list of all the resources that REST API has to offer:<p>
</p><div><img src="img/image_09_008.jpg" alt="JIRA's REST API Browser"/></div><p>
</p></li><li class="listitem">Click on any one of the resources, and on the right-hand side of the main window; this particular resource can be tested by passing optional parameters.</li></ol></div><p>Let's take a look at some examples to test REST API.</p><div><div><div><div><h3 class="title"><a id="ch09lvl3sec31"/>Fetching user details</h3></div></div></div><p>On the left-hand side, either scroll or navigate to find <strong>api/2/user</strong> and click on it:</p><p>
</p><div><img src="img/image_09_009.jpg" alt="Fetching user details"/></div><p>
</p><p>Enter <code class="literal">admin</code> as the value in the <strong>username</strong> parameter and click on the <strong>Send</strong> button. You will see the following response:</p><p>
</p><div><img src="img/image_09_010.jpg" alt="Fetching user details"/></div><p>
</p><p>The response is actually in a JSON format, and you can see that it has returned the details of the <code class="literal">admin</code> user. However, the groups that this user is a part of are not returned in this response, but it's possible to fetch this information as well. Perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on the <strong>+<strong>Parameter</strong>
</strong> button on the right-hand side.</li><li class="listitem">Enter <code class="literal">expand</code> in the <strong>Parameter</strong> column.</li><li class="listitem">Enter <code class="literal">groups</code> in the <strong>Value</strong> column.</li><li class="listitem">Click on the <strong>Send</strong> button again.<p>
</p><div><img src="img/image_09_011.jpg" alt="Fetching user details"/></div><p>
</p></li></ol></div><p>The following response is generated:</p><p>
</p><div><img src="img/image_09_012.jpg" alt="Fetching user details"/></div><p>
</p><p>You can see that in the new response the groups that this user belongs to are also fetched by specifying the additional parameter.</p><p>JIRA REST API Browser is a great tool to help you get familiar with all the available resources, and it really assists in development.</p></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec32"/>Sample code to interact with the REST API</h3></div></div></div><p>The REST API is supported by a variety of languages (such as Java, PHP, Python, and so on). In this chapter, we will discuss a couple of code examples in the PHP language. PHP is a popular language used in web applications. The following examples are written in PHP, but even if you are familiar with other languages, such as Java, then you should be able to understand the concept explained here.</p><p>To install PHP quickly, along with Apache, the <code class="literal">XAMPSERVER</code> package can be installed from <a class="ulink" href="https://www.apachefriends.org/">https://www.apachefriends.org/</a>.</p><div><div><div><div><h4 class="title"><a id="ch09lvl4sec18"/>Creating an issue using PHP</h4></div></div></div><p>The sample code <code class="literal">create_issue.php</code> is used to create an issue using PHP as follows:</p><pre class="programlisting">&lt;?php &#13;
 &#13;
define('JIRA_URL', 'http://localhost:2990/jira'); &#13;
define('USERNAME', 'admin'); &#13;
define('PASSWORD', 'admin'); &#13;
 &#13;
//The function that is making the REST call using Curl Protocol &#13;
 &#13;
function post_to($resource, $data) { &#13;
  $curlname=CURLOPT_POST; &#13;
  $curlvalue=1; &#13;
  $jdata = json_encode($data); &#13;
  $ch = curl_init(); &#13;
  curl_setopt_array($ch, array( &#13;
  $curlname =&gt; $curlvalue, &#13;
  CURLOPT_URL =&gt; JIRA_URL . '/rest/api/latest/' . $resource, &#13;
  CURLOPT_USERPWD =&gt; USERNAME . ':' . PASSWORD, &#13;
  CURLOPT_POSTFIELDS =&gt; $jdata, &#13;
  CURLOPT_HTTPHEADER =&gt; array('Content-type: application/json'), &#13;
  CURLOPT_RETURNTRANSFER =&gt; true &#13;
  )); &#13;
  $result = curl_exec($ch); &#13;
  curl_close($ch); &#13;
  return json_decode($result); &#13;
} &#13;
 &#13;
function create_issue($issue) { &#13;
  return post_to('issue', $issue); &#13;
} &#13;
 &#13;
//The issue details &#13;
$new_issue = array( &#13;
'fields' =&gt; array( &#13;
'project' =&gt; array('key' =&gt; 'GEN'), &#13;
'summary' =&gt; 'Test via REST', &#13;
'description' =&gt; 'Description of issue goes here.', &#13;
'issuetype' =&gt; array('name' =&gt; 'Task') &#13;
) &#13;
); &#13;
 &#13;
//Call the function to create the issue &#13;
$result = create_issue($new_issue); &#13;
 &#13;
//Print the output &#13;
if (property_exists($result, 'errors')) { &#13;
  echo "Error(s) creating issue:\n"; &#13;
  var_dump($result); &#13;
} else {print_r($result); &#13;
  echo "New issue created at " . JIRA_URL ."/browse/{$result-&gt;key}\n"; &#13;
} &#13;
 &#13;
?&gt; &#13;
</pre><p>The preceding code creates an issue in a JIRA project with the <code class="literal">GEN</code> project key and the <code class="literal">Task</code> issue type. Let's understand what this code does.</p><div><div><div><div><h5 class="title"><a id="ch09lvl4sec188854"/>Authenticating with JIRA</h5></div></div></div><p>First, we need to define our JIRA URL, username, and password for authentication. Note that this user should have the permission to create the issue in the project:</p><pre class="programlisting">define('JIRA_URL', 'http://localhost:2990/jira'); &#13;
define('USERNAME', 'admin'); &#13;
define('PASSWORD', 'admin'); &#13;
</pre><p>Making the REST call to create the issue</p><p>The <code class="literal">curl_exec()</code> PHP function is used to make the REST call using the <code class="literal">curl</code> protocol. This function accepts the parameters to make the REST call. The username, password, and the issue data are passed in the following code:</p><pre class="programlisting">function post_to($resource, $data) { &#13;
  $curlname=CURLOPT_POST; &#13;
  $curlvalue=1; &#13;
  $jdata = json_encode($data); &#13;
  $ch = curl_init(); &#13;
  curl_setopt_array($ch, array( &#13;
  $curlname =&gt; $curlvalue, &#13;
  CURLOPT_URL =&gt; JIRA_URL . '/rest/api/latest/' . $resource, &#13;
  CURLOPT_USERPWD =&gt; USERNAME . ':' . PASSWORD, &#13;
  CURLOPT_POSTFIELDS =&gt; $jdata, &#13;
  CURLOPT_HTTPHEADER =&gt; array('Content-type: application/json'), &#13;
  CURLOPT_RETURNTRANSFER =&gt; true &#13;
  )); &#13;
  $result = curl_exec($ch); &#13;
  curl_close($ch); &#13;
  return json_decode($result); &#13;
} &#13;
 &#13;
function create_issue($issue) { &#13;
  return post_to('issue', $issue); &#13;
} &#13;
</pre></div><div><div><div><div><h5 class="title"><a id="ch09lvl4sec188854854"/>Issuing data and printing the output</h5></div></div></div><p>The issue that needs to be created has a lot of information, such as the project key, summary, description, and issue type. This information is stored in the array. Finally, the output is printed when the code is run:</p><pre class="programlisting">$new_issue = array( &#13;
'fields' =&gt; array( &#13;
'project' =&gt; array('key' =&gt; 'GEN'), &#13;
'summary' =&gt; 'Test via REST', &#13;
'description' =&gt; 'Description of issue goes here.', &#13;
'issuetype' =&gt; array('name' =&gt; 'Task') &#13;
) &#13;
); &#13;
 &#13;
//Call the function to create the issue &#13;
$result = create_issue($new_issue); &#13;
 &#13;
//Print the output &#13;
if (property_exists($result, 'errors')) { &#13;
  echo "Error(s) creating issue:\n"; &#13;
  var_dump($result); &#13;
} else {print_r($result); &#13;
  echo "New issue created at " . JIRA_URL ."/browse/{$result-&gt;key}\n"; &#13;
} &#13;
</pre><p>After you run the PHP code, you will get an output, as shown in the following command:</p><pre class="programlisting">
<strong>New issue created at http://hp:2990/jira/browse/GEN-2&#13;
</strong>
</pre></div></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec19"/>Fetching issue details using PHP</h4></div></div></div><p>The previous example was quite simple, where we created the issue using the REST API. Now, let's look at how to fetch the issue details that we just created:</p><pre class="programlisting">&lt;?php &#13;
 &#13;
$username = 'admin'; &#13;
$password = 'admin'; &#13;
 &#13;
$url = 'http://localhost:2990/jira/rest/api/latest/issue/GEN-2'; &#13;
 &#13;
$curl = curl_init(); &#13;
curl_setopt($curl, CURLOPT_USERPWD, "$username:$password"); &#13;
curl_setopt($curl, CURLOPT_URL, $url); &#13;
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); &#13;
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1); &#13;
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0); &#13;
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0); &#13;
 &#13;
$issue_list = (curl_exec($curl)); &#13;
echo '&lt;pre&gt;'; &#13;
print_r(json_decode($issue_list)); &#13;
echo '&lt;/pre&gt;'; &#13;
?&gt; &#13;
</pre><p>This is a simple code that is just fetching the details of the <code class="literal">GEN-1</code> issue, which we created in the previous example. The output returned by the REST API is a JSON file. We have converted the JSON data to an array using the <code class="literal">json_decode()</code> PHP function and printed it using the <code class="literal">print_r()</code> function.</p><p>The previous code can be used to fetch user and group details; just change the <code class="literal">$url</code> variable.</p></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec64"/>Summary</h1></div></div></div><p>In this chapter, you learned how to develop add-ons for JIRA. If you already have a working knowledge of Java, and have worked on Maven, then you have a good opportunity to learn add-on development for JIRA and other Atlassian tools. Whenever the existing functionality is not sufficient to serve your needs, you can always develop add-ons for JIRA. These add-ons are developed in the Java language and also utilize Apache Maven for build automation. In this chapter, we discussed how to set up the development environment and the Eclipse IDE. We also created a skeleton plugin project.</p><p>In the next chapter, you will learn how to migrate data to JIRA using the CSV file. JIRA provides migration tools for Bugzilla, Mantis, and a few other issue trackers, but if your existing issue tracker has a lot of customizations, then it's always preferable to migrate the data using CSV import, which is quite powerful. With careful planning, it can import complex data into JIRA. We will also take a look at the major aspects of JIRA's CSV import.</p></div></body></html>