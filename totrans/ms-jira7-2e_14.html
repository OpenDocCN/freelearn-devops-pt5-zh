<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch14"/>Chapter 14. Customizing Look, Feel, and Behavior</h1></div></div></div><p>JIRA offers a simple functionality in its UI to change the colors of various sections and elements, such as the header, footer, and links; you can also upload your custom logo. However, if you want to change the width of a certain section or the whole body element, you can't do it from the UI. It's possible to include your own custom CSS to make changes to the look and feel. It's also possible to load custom JavaScript in a JIRA instance; this enables changes in the behavior of various HTML elements. For example, you can selectively show or hide a field on another field's values and insert text-based templates in JIRA fields. In this chapter, we will take a look at such customizations.</p><p>We will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Adding your own CSS</li><li class="listitem" style="list-style-type: disc">Adding JavaScript to show/hide field</li><li class="listitem" style="list-style-type: disc"><strong>Velocity</strong> templates</li></ul></div><div><div><div><div><h1 class="title"><a id="ch14lvl1sec88"/>Adding your own CSS</h1></div></div></div><p>The JIRA administration interface allows you to change the look and feel of various elements in JIRA and to change the default logo. Perform these steps to customize your JIRA interface:</p><div><ol class="orderedlist arabic"><li class="listitem">Navigate to <strong>Administration</strong> | <strong>System</strong> | <strong>Look and feel</strong> (under <strong>USER INTERFACE</strong>).</li><li class="listitem">The first option on this page is to change <strong>Logo</strong>. Click on the <strong>Browse…</strong> button and then click on the <strong>Upload Logo</strong> button to upload your own custom logo:<p>
</p><div><img src="img/image_14_001.jpg" alt="Adding your own CSS"/></div><p>
</p></li><li class="listitem">The second option is to display <strong>Site Title</strong>, located next to logo. Check the <strong>Show Site Title</strong> checkbox and click on the <strong>Update</strong> button:<p>
</p><div><img src="img/image_14_002.jpg" alt="Adding your own CSS"/></div><p>
</p><p>You will notice that the name of your instance, which you entered while installing JIRA, will now appear right next to the JIRA logo. In our example, it's <strong>Sparxsys JIRA Demo</strong>, which now appears next to the JIRA logo:</p><p>
</p><div><img src="img/image_14_003.jpg" alt="Adding your own CSS"/></div><p>
</p></li><li class="listitem">The third option is to update <strong>Favicon</strong>, which appears in the browser tab when JIRA is opened. Click on the <strong>Browse…</strong> button to select the new <strong>Favicon</strong> image and then click on the <strong>Upload Favicon</strong> button:<p>
</p><div><img src="img/image_14_004.jpg" alt="Adding your own CSS"/></div><p>
</p></li><li class="listitem">The fourth option is to change the color of various sections of JIRA's web interface. For instance, click on any color in the box for <strong>Header Background Color</strong>. In the popup window, select the new color, or enter the color's hexadecimal value directly. Let's change this color to red, with a hexadecimal value of <code class="literal">#ff0000</code>. Click on the <strong>Update</strong> button to continue:<p>
</p><div><img src="img/image_14_005.jpg" alt="Adding your own CSS"/></div><p>
</p></li></ol></div><p>The color of the main navigation bar is now red.</p><p>You can change the color of various sections available from this interface and match it with your company's color scheme, but JIRA's interface is limited to changing colors. If you want to change the width of the <code class="literal">&lt;body&gt;</code> element or give extra padding and margins to certain sections, it's not possible to do it through this interface.</p><p>However, it's possible to insert your own custom CSS in JIRA, which can override the default look and feel. Perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to <strong>Administration</strong> | <strong>System</strong> | <strong>Announcement banner</strong> (under <strong>USER INTERFACE</strong>).</li><li class="listitem">In the <strong>Announcement</strong> text area, copy <code class="literal">&lt;LINK href="http://localhost:8080/includes/custom_css/custom_style.css" rel="stylesheet" type="text/css"&gt;</code> and click on the <strong>Set Banner</strong> button:</li></ol></div><p>
</p><div><img src="img/image_14_006.jpg" alt="Adding your own CSS"/></div><p>
</p><p>The <strong>Announcement banner</strong> is used to display text common to all the users in JIRA on all the pages in JIRA; the good thing is that it supports HTML tags as well. In our case, we want to load a custom CSS code to all the pages. The <code class="literal">LINK</code> tag mentioned previously specifies the path where our custom CSS will be found. Perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Create a <code class="literal">custom_css</code> folder in the following directory in your JIRA installation directory:<pre class="programlisting">        JIRA_INSTALL/atlassian-jira/includes/. &#13;
</pre></li><li class="listitem">Navigate to the <code class="literal">custom_css</code> folder and create a <code class="literal">custom_style.css</code> file; the location of the file should be <code class="literal">JIRA_INSTALL/atlassian-jira/includes/custom_css/custom_style.css</code>.</li></ol></div><p>This file contains the CSS to make changes to the UI of JIRA which are otherwise not possible through configurations. When you save the <strong>Announcement banner</strong>, nothing will be displayed to the user, but this CSS file will be loaded on all the pages. You can also verify this by viewing the source code of any page in JIRA and searching for the filename:</p><p>
</p><div><img src="img/image_14_007.jpg" alt="Adding your own CSS"/></div><p>
</p><p>In the preceding screenshot, you can see that our custom CSS file is loaded.</p><p>Now it's time to add some CSS code to this file and change the look and feel of our JIRA instance. Open the <code class="literal">custom_style.css</code> code in your favorite editor and enter the following code snippet:</p><pre class="programlisting">body { &#13;
  background-color: #e0e0e0; &#13;
  padding: 0 70px; &#13;
} &#13;
#content { &#13;
  box-shadow: 0px 0px 5px #232323; &#13;
} &#13;
#footer { &#13;
  background-color: #232323; &#13;
  box-shadow: 0px 0px 5px #232323; &#13;
} &#13;
</pre><p>Then, refresh your JIRA instance in your browser. You should now see that the preceding CSS code is applied and the changes have appeared, as shown in the following screenshot:</p><p>
</p><div><img src="img/image_14_008.jpg" alt="Adding your own CSS"/></div><p>
</p><p>You can further customize the look and feel of the web page by adding your own CSS code. This will be loaded to every page; just make sure that the code in the <strong>Announcement banner</strong> is not removed.</p><p>We have added an additional file to the JIRA filesystem. It's very important to keep a note of this file and save it separately too. When you upgrade your JIRA instance to a new version or migrate to a new server, the JIRA administrator should make sure that this file is not removed; otherwise, the customizations to the look and feel of the web page will not appear.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch14lvl1sec89"/>Adding JavaScript to show/hide field</h1></div></div></div><p>JIRA comes with tons of functionalities and customizations; however, there are times when you want more control over the behavior of HTML fields. For instance, if you want to show or hide a particular custom field on the basis of a value of another custom field, you can use custom JavaScript to do this.</p><p>Let's take a scenario where users who create a ticket in JIRA need to enter their analysis in one of the text areas based on the custom field, but they only need to fill it in when the priority of the issue is highest. Now, in order to achieve this, we want to completely hide the <strong>Analysis</strong> field first, and display it only when users set <strong>Priority</strong> as <strong>Highest</strong>.</p><p>Unlike the preceding example for inserting custom CSS, the custom JavaScript can be added directly from the JIRA interface. Perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to JIRA <strong>Administration</strong> | <strong>Issues</strong> | <strong>Custom fields</strong> (under <strong>FIELDS</strong>).</li><li class="listitem">Click on the <strong>Add custom field</strong> button in the top-right corner and select <strong>Field Type</strong> as <strong>Text Field (multi-line)</strong>.</li><li class="listitem">On the next screen, enter <code class="literal">Analysis</code> as <strong>Name</strong> and enter the JavaScript code (<code class="literal">analysis_js.css</code>) in the <strong>Description</strong> field of the custom field, as shown in the following screenshot:<p>
</p><div><img src="img/image_14_009.jpg" alt="Adding JavaScript to show/hide field"/></div><p>
</p></li><li class="listitem">Click on the <strong>Create</strong> button to continue.</li><li class="listitem">Add this field in the screen associated with the <strong>Create Issue</strong> operation just after the <strong>Priority</strong> system field.</li></ol></div><p>Note that the field description of custom fields can also be controlled by <strong>Field Configurations</strong> option. In <a class="link" href="ch04.html" title="Chapter 4. Customizing JIRA for Test Management">Chapter 4</a>, <em>Customizing JIRA for Test Management</em>, we discussed the purpose of field configurations. In the previous example, we added the JavaScript code in the field description while creating the custom field; it will be overwritten if field configurations are used in the project.</p><p>Let's understand the important section of this JavaScript code.</p><p>The <strong>Analysis</strong> custom field ID is equal to <code class="literal">10100</code> and we assigned a target variable to this field:</p><pre class="programlisting"> target = document.getElementById('customfield_10100'); &#13;
</pre><p>Then, for the <strong>Priority</strong> field, we check whether its value is <strong>Highest</strong>, which is selectable from a list with different numerical values for <strong>Highest</strong>, <strong>High</strong>, <strong>Medium</strong>, <strong>Low</strong>, and <strong>Lowest</strong> (<strong>Highest</strong> having the numerical value <code class="literal">1</code>). For every other value, the <strong>Analysis</strong> field is hidden:</p><pre class="programlisting">if (priority.value != 1) &#13;
  target.style.display='none'; &#13;
priority.onchange=function() { &#13;
  if (this.value == 1) { &#13;
    target.style.display = ''; &#13;
    target.value="enter message here"; &#13;
  } else { &#13;
    target.style.display='none'; &#13;
  } &#13;
} &#13;
</pre><p>When users select the <strong>Priority</strong> as <strong>Highest</strong>, the <strong>Analysis</strong> field is displayed again.</p><div><div><div><div><h2 class="title"><a id="ch14lvl2sec123"/>Creating the issue</h2></div></div></div><p>After creating the <strong>Analysis</strong> field, just add one more issue in JIRA to test it. By default, the <strong>Analysis</strong> field is not displayed to the user:</p><p>
</p><div><img src="img/image_14_010.jpg" alt="Creating the issue"/></div><p>
</p><p>The moment you select <strong>Priority</strong> as <strong>Highest</strong>, the <strong>Analysis</strong> text area will be visible to the user:</p><p>
</p><div><img src="img/image_14_011.jpg" alt="Creating the issue"/></div><p>
</p><p>This example is just to give you an idea of how to use JavaScript to control the behavior of HTML elements.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch14lvl1sec90"/>Velocity templates</h1></div></div></div><p>Velocity is a Java-based, server-side template engine used to render page content that allows Java objects to be used alongside HTML elements. As JIRA has been written in Java, it utilizes Velocity templates to display the content. These template files can be modified by the user. However, Atlassian will not provide any support for such changes to the template files; therefore, I recommend taking a backup of the original files before making any changes to them.</p><p>In this section, let's discuss a few examples where we will make changes to these templates.</p><div><div><div><div><h2 class="title"><a id="ch14lvl2sec124"/>Modifying the description system field with predefined text</h2></div></div></div><p>JIRA allows you to add a description for every custom field, where some instructions on how to enter the data can be given to the end user. However, it's sometimes useful to present the user with a predefined text, which is like a text-based template. In this example, we will add some default text in the JIRA <strong>Description</strong> system field. Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Edit the following file in your JIRA installation directory:<pre class="programlisting">        JIRA_INSTALL/atlassian-jira/WEB-INF/    &#13;
        classes/templates/jira/issue/field/description-edit.vm. &#13;
</pre></li><li class="listitem">Enter the following code just before the <code class="literal">$rendererDescriptor.getEditVM()</code> function:<pre class="programlisting">        #set ($description = "Please enter the details in steps.\ &#13;
        \ &#13;
        Step 1:\ &#13;
        \ &#13;
        Step 2:\ &#13;
        \ &#13;
        Step 3:\ &#13;
        \ &#13;
        Issue Occurrence: Once or Always\ &#13;
        Current Status: Working or Not Working &#13;
        \ &#13;
        ") &#13;
        #set ($description = $description.replace('','')) &#13;
</pre></li><li class="listitem">The code is shown in the following screenshot:<p>
</p><div><img src="img/image_14_012.jpg" alt="Modifying the description system field with predefined text"/></div><p>
</p></li><li class="listitem">Restart your JIRA instance.</li><li class="listitem">Once the JIRA instance is restarted, click on the <strong>Create</strong> button to create an issue.</li><li class="listitem">You will notice that the default text now appears in the <strong>Description</strong> field:<p>
</p><div><img src="img/image_14_013.jpg" alt="Modifying the description system field with predefined text"/></div><p>
</p></li></ol></div><p>You can use the same method to add custom predefined text to other fields as well.</p><p>After modifying the <strong>Description</strong> field template using the previous code, this predefined text will be added to the <strong>Description</strong> field for all the projects and issue types in your JIRA instance, but it's possible to restrict it to a specific project and issue type. Instead, use the following code:</p><pre class="programlisting">#if ($issue.getProject().getString("key") == 'SSP') &#13;
  #if(($description == "") &amp;&amp; ($issue.getIssueTypeObject().getName() == "Story")) &#13;
    #set ($description = "Please enter the details in steps.\ &#13;
       \ &#13;
    Step 1:\ &#13;
        \ &#13;
    Step 2:\ &#13;
        \ &#13;
    Step 3:\ &#13;
        \ &#13;
    Issue Recurrance: Once or Always\ &#13;
    Current Status: Working or Not Working &#13;
        \ &#13;
        ") &#13;
    #set ($description = $description.replace('','')) &#13;
  #end &#13;
#end &#13;
</pre><p>To define the default value of a custom field, the context can also be used, which is discussed in <a class="link" href="ch17.html" title="Chapter 17. JIRA Best Practices">Chapter 17</a>, <em>JIRA Best Practices</em>.</p><p>In the preceding code, we just added two lines at the top to restrict <strong>Project Key</strong> to <code class="literal">SSP</code> and <strong>Issue Type</strong> to <code class="literal">Story</code>. Make sure that you restart your JIRA instance before making any changes in the template file. If you don't want to restart your instance, it's also possible to disable the caching of Velocity templates by following these steps in your JIRA installation directory:</p><div><ol class="orderedlist arabic"><li class="listitem">Uncomment (remove the <code class="literal">#</code> sign from <code class="literal">#velocimacro.library.autoreload=true)</code>.</li><li class="listitem">Change <code class="literal">class.resource.loader.cache</code> from <code class="literal">true</code> to <code class="literal">false</code>.</li><li class="listitem">Open <code class="literal">JIRA_INSTALL/atlassian-jira/WEB-INF/classes/velocity.properties</code>.</li><li class="listitem">Now, any change in Velocity templates will be reflected in your instance without restarting JIRA. Do this only in your development environment.</li></ol></div><p>As mentioned previously, for custom CSS, keep track of any changes you make in the template file and always keep a backup of the original template file. It's important to note that Atlassian will not provide any support for customizations made on the template files.</p></div><div><div><div><div><h2 class="title"><a id="ch14lvl2sec125"/>Modifying the footer</h2></div></div></div><p>There are various template files you can customize in JIRA, and for various sections of the web page. Let's take a look at another example, where we will add some custom text to the footer section. Perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Edit the following file in your JIRA installation directory:<pre class="programlisting">        JIRA_INSTALL/atlassian-jira/WEB-  &#13;
        INF/classes/templates/plugins/footer/footer.vm. &#13;
</pre></li><li class="listitem">This file has a lot of content; just navigate to the bottom of the file and add the following lines before <code class="literal">#end</code>:<pre class="programlisting">        &lt;ul&gt; &#13;
          &lt;li&gt;This is a Test JIRA Instance and we are adding text in the footer.  &#13;
          &lt;/li&gt; &#13;
        &lt;/ul&gt; &#13;
</pre><p>The file looks as follows:</p><p>
</p><div><img src="img/image_14_014.jpg" alt="Modifying the footer"/></div><p>
</p></li><li class="listitem">Restart your JIRA instance.</li><li class="listitem">Once the JIRA instance is restarted, you will notice some additional text before the Atlassian logo:<p>
</p><div><img src="img/image_14_015.jpg" alt="Modifying the footer"/></div><p>
</p></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch14lvl2sec126"/>Displaying a custom field in e-mails</h2></div></div></div><p>It's also possible to customize e-mails sent to the users. The e-mail content is also generated using Velocity templates. Let's now customize the template for e-mails that are sent when an issue is created. The custom fields that are created in the system are not included in the e-mail content, but we will modify the Velocity template of the issue creation e-mail and include the <strong>Analysis</strong> field (which we added earlier). Perform these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Edit the following file in your JIRA installation directory:<pre class="programlisting">        JIRA_INSTALL/atlassian-jira/WEB-&#13;
        INF/classes/templates/email/html/issuecreated.vm &#13;
</pre></li><li class="listitem">Add the following code before the final <code class="literal">#parse</code> at the end of the file:<pre class="programlisting">        #if ($issue.getCustomFieldValue("customfield_10100")) &#13;
        &lt;tr valign="top"&gt; &#13;
          &lt;td &gt; &#13;
            #text("Analysis"): &#13;
          &lt;/td&gt; &#13;
          &lt;td&gt; &#13;
            $issue.getCustomFieldValue("customfield_10100") &#13;
          &lt;/td&gt; &#13;
        &lt;/tr&gt; &#13;
        #end &#13;
</pre></li><li class="listitem">Save the file and restart JIRA.</li><li class="listitem">Once the JIRA instance is restarted, create one issue in JIRA and fill the <strong>Analysis</strong> field.</li><li class="listitem">Check the e-mail you receive; it should have the <strong>Analysis</strong> field value now. The e-mail content should look similar to the following screenshot:<p>
</p><div><img src="img/image_14_016.jpg" alt="Displaying a custom field in e-mails"/></div><p>
</p></li></ol></div><p>There are templates for similar events and system fields. You can explore them and make changes to them once you get comfortable with Velocity templates.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch14lvl1sec91"/>Summary</h1></div></div></div><p>In this chapter, you learned how to customize the look and feel of JIRA by inserting custom CSS codes. We also modified the behavior of HTML elements of the JIRA interface using JavaScript to show/hide JIRA fields based on the selection made by the user, of a specific value from a selectable list. Finally, we explored Velocity templates and how to modify the displayed content. We also discussed how to insert custom field values in e-mails.</p><p>In the next chapter, we will discuss JIRA Service Desk, which has become the most popular way to cater to your customer support requests. Service Desk is now a separate application, which can either be installed as a standalone application or as an application along with JIRA Core. Service Desk comes with inbuilt configurations that are standard to any support project.</p></div></body></html>