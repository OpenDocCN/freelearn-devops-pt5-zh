<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-265"><a id="_idTextAnchor265"/>14</h1>
<h1 id="_idParaDest-266"><a id="_idTextAnchor266"/>Keeping Automation Simple and Efficient</h1>
<p>Ansible is a simple and powerful automation tool. We can automate any kind of workflow using Ansible but if we increase complexity in automation, we decrease efficiency, which kills productivity. When you design an automated solution or use case, you must consider multiple factors, such as the capability of the tool and flexibility in adjusting the automation’s flow or scalability. </p>
<p>For example, it is possible to write simple playbooks to monitor the service status in a system or to check the health of an application. But this is not efficient as you need other arrangements such as job schedulers to execute the job at regular intervals and monitor the execution. Instead of using Ansible natively for complex automation tasks, we can utilize the integration capabilities of the Ansible automation controller and other systems. We can use the existing tools for monitoring, logging, and security control, and use Ansible for remediation actions such as starting services and blocking ports and IP addresses.</p>
<p>In this chapter, we will cover the following topics:  </p>
<ul>
<li>Utilizing surveys and automated inputs</li>
<li>Integrating Ansible with monitoring tools</li>
<li>Ansible for security automation</li>
<li>Ansible workflow templates</li>
</ul>
<p>We will start by looking at various survey features in the automation controller and continue with Ansible integration topics.</p>
<h1 id="_idParaDest-267"><a id="_idTextAnchor267"/>Technical requirements</h1>
<p>The following are the technical requirements for this chapter:</p>
<ul>
<li>Basic knowledge of monitoring and logging platforms</li>
<li>General knowledge about security platforms</li>
<li>Basic knowledge about <strong class="bold">IT Service Management</strong> (<strong class="bold">ITSM</strong>) tools (Jira and ServiceNow)</li>
<li>Access to the <strong class="bold">Ansible Automation Platform</strong> (<strong class="bold">AAP</strong>) environment</li>
</ul>
<p>All the Ansible artifacts, commands, and snippets for this chapter can be found in this book’s GitHub repository at <a href="https://github.com/PacktPublishing/Ansible-for-Real-life-Automation/tree/main/Chapter-14">https://github.com/PacktPublishing/Ansible-for-Real-life-Automation/tree/main/Chapter-14</a>.</p>
<h1 id="_idParaDest-268"><a id="_idTextAnchor268"/>Utilizing surveys and automated inputs</h1>
<p>In <a href="B18383_08.xhtml#_idTextAnchor144"><em class="italic">Chapter 8</em></a>, <em class="italic">Helping the Database Team with Automation</em>, you learned the advantages<a id="_idIndexMarker901"/> of integrating Jira service<a id="_idIndexMarker902"/> management with Ansible to automate database operations. Instead of copying the input details from the Jira ticket to the Ansible automation controller, you learned how to integrate with Jira and pass the variables automatically. This enables zero-touch integration without needing to input the details for the automation job, such as the database name, server name, database username, or database tables.</p>
<p>You learned about similar samples in <em class="italic">Chapter 12</em>, <em class="italic">Integrating Jenkins with Ansible Automation Platform</em>, where Jenkins calls the Ansible automation controller API to execute the job template. From the Ansible automation controller, you used survey fields and elegant forms to pass such information:</p>
<div><div><img alt="Figure 14.1 – Survey form for the PostgreSQL – Create Database and User Access job template " height="627" src="img/B18383_14_01.jpg" width="1043"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.1 – Survey form for the PostgreSQL – Create Database and User Access job template</p>
<p>When we integrate<a id="_idIndexMarker903"/> this job template with external tools<a id="_idIndexMarker904"/> such as Jenkins, we need to provide the input (database user, database, or table) in a non-interactive way. This is where we used Jenkins (or Jira in the previous example) to call the Job template with all the required information, including the database user, database name, table, and user details as extra variables.</p>
<p>Also, by integrating with the existing ITSM and request management tools, it is possible<a id="_idIndexMarker905"/> to enhance the automation system and offload the input form creation (survey form) overhead from the Ansible automation controller.</p>
<p>The following diagram shows the high-level communication that happens between the tools, AAP, and managed nodes or platforms. The external tools can pass all the required information to the AAP API as extra variables and implement the non-interactive workflow:</p>
<div><div><img alt="Figure 14.2 – Triggering AAP job templates with extra variables from other platforms " height="639" src="img/B18383_14_02.jpg" width="914"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.2 – Triggering AAP job templates with extra variables from other platforms</p>
<p>With that, you have learned<a id="_idIndexMarker906"/> about one of the best practices<a id="_idIndexMarker907"/> in Ansible, called <em class="italic">softcoding</em> (the opposite of hardcoding). This means<a id="_idIndexMarker908"/> accepting the parameters while executing the automation job. </p>
<p>In the following sections, you will learn about the advantages of integrating Ansible with other security and monitoring tools rather than using Ansible natively for such purposes.</p>
<h1 id="_idParaDest-269"><a id="_idTextAnchor269"/>Integrating Ansible with monitoring tools</h1>
<p>Because Ansible is flexible<a id="_idIndexMarker909"/> and can automate most<a id="_idIndexMarker910"/> of your day-to-day jobs, it is a common practice to automate every possible use case, even if it is not efficient. One of the so-called non-standard use cases we have learned from the community is using Ansible for monitoring purposes, as follows:</p>
<ul>
<li>Monitoring the service or application status in a system</li>
<li>Running health checks on endpoints (applications, web services, or clusters)</li>
<li>Monitoring network and security device rules or status</li>
</ul>
<p>The following diagram<a id="_idIndexMarker911"/> shows a typical scenario where Ansible automation<a id="_idIndexMarker912"/> jobs are scheduled to run health checks on managed nodes or applications. These jobs<a id="_idIndexMarker913"/> can be either running as <strong class="bold">cron</strong> jobs from an Ansible control node or as a scheduled job in an Ansible automation controller:</p>
<div><div><img alt="Figure 14.3 – Using scheduled automation jobs for monitoring " height="510" src="img/B18383_14_03.jpg" width="889"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.3 – Using scheduled automation jobs for monitoring</p>
<p>This method is possible and easy to implement but is not efficient. It has many disadvantages, as follows:</p>
<ul>
<li>You have less control over the frequency of monitoring.</li>
<li>There’s computing overhead on the Ansible control node or the automation controller. The number of monitoring targets will increase this overhead. </li>
<li>You have less control over the execution time as some jobs may take more time and the next jobs in the queue may be delayed as well.</li>
<li>You need to create a lot of Ansible playbooks, depending on the target items to be monitored. </li>
</ul>
<p>Instead of using Ansible playbooks <a id="_idIndexMarker914"/>to execute the frequent monitoring<a id="_idIndexMarker915"/> job, we can use the standard monitoring tools that are already in place and do their jobs efficiently. The following diagram shows the high-level integration between monitoring and logging tools, ITSM software, and Ansible:</p>
<div><div><img alt="Figure 14.4 – Ansible integration with logging and monitoring tools " height="642" src="img/B18383_14_04.jpg" width="885"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.4 – Ansible integration with logging and monitoring tools</p>
<p>The monitoring and logging agents can effectively do their job and report the alerts, incidents, and issues<a id="_idIndexMarker916"/> to a central database system. Based<a id="_idIndexMarker917"/> on the organization’s requirements and infrastructure landscape, the monitoring stack may contain different components and multiple moving parts. The monitoring and logging tools can integrate with your ITSM tools to log the incidents and alerts in the ITSM incident management system. Also, the ITSM tools can be integrated with Red Hat AAP for automated remediations. You will learn more about this in the next section.</p>
<h2 id="_idParaDest-270"><a id="_idTextAnchor270"/>The role of Ansible in monitoring</h2>
<p>There are several use cases in the monitoring<a id="_idIndexMarker918"/> and alerting area for which we can use Ansible to automate the operations:</p>
<ul>
<li>Implement automatic job triggers on the automation controller via an API call.</li>
<li>Automated remediation and deployment based on the API calls from the monitoring tools or ITSM tools.</li>
<li>Deploy monitoring agents and configurations on the managed nodes.</li>
<li>Implement configuration hardening based on alerts and API calls.</li>
</ul>
<p>The following diagram shows the typical integration and workflow based on AAP and automated job executions:</p>
<div><div><img alt="Figure 14.5 – Monitoring and alert workflow in Ansible " height="422" src="img/B18383_14_05.jpg" width="716"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.5 – Monitoring and alert workflow in Ansible</p>
<p>In the preceding diagram, the following<a id="_idIndexMarker919"/> actions occur: </p>
<ul>
<li>By monitoring the agents on the hosts or services, it is possible detect incidents and alerts such as system issues, security incidents, or application health issues.</li>
<li>Monitoring and logging tools create incidents in ITSM and security monitoring tools.</li>
<li>Monitoring and logging tools can also trigger alerts (or API calls) directly on the automation controller API to trigger the job.</li>
<li>ITSM tools trigger API calls based on rules, workflows, and scripts.</li>
<li>Based on the API call, the automation controller executes the configured job template and remediates the incident.</li>
<li>The automation controller also updates the incident ticket automatically with the remediation job status<a id="_idIndexMarker920"/> and ticket status (for example, close the ticket or update the review status).</li>
</ul>
<p class="callout-heading">Ansible and ServiceNow Integration</p>
<p class="callout">To learn more about <a id="_idIndexMarker921"/>the integration between Ansible and ServiceNow, read <em class="italic">Ansible + ServiceNow Part 3: Making outbound RESTful API calls to Red Hat Ansible Tower</em> (<a href="https://www.ansible.com/blog/ansible-servicenow-howto-part-3-making-outbound-restful-api-calls-to-ansible-tower">https://www.ansible.com/blog/ansible-servicenow-howto-part-3-making-outbound-restful-api-calls-to-ansible-tower</a>). Also check <a href="https://www.ansible.com/integrations/it-service-management/servicenow">https://www.ansible.com/integrations/it-service-management/servicenow</a> for additional references<a id="_idIndexMarker922"/> on this topic.</p>
<p>You will explore this integration with a use case in the next section.</p>
<h2 id="_idParaDest-271"><a id="_idTextAnchor271"/>ServiceNow, Ansible, and zero-touch incident fixes</h2>
<p>In this section, you will learn<a id="_idIndexMarker923"/> about the important integration<a id="_idIndexMarker924"/> and connection<a id="_idIndexMarker925"/> points for<a id="_idIndexMarker926"/> a zero-touch incident fix with <strong class="bold">ServiceNow</strong> (also known as <strong class="bold">SNOW</strong>) and Ansible. A typical workflow can be seen in the following diagram:</p>
<div><div><img alt="Figure 14.6 – Typical incident automation workflow " height="711" src="img/B18383_14_06.jpg" width="1142"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.6 – Typical incident automation workflow</p>
<p>Configuring the monitoring <a id="_idIndexMarker927"/>agent and ServiceNow instances<a id="_idIndexMarker928"/> is outside the scope<a id="_idIndexMarker929"/> of this book, so we will<a id="_idIndexMarker930"/> only focus on the Ansible portion. It is possible to replace ServiceNow with other ITSM tools such as Jira service management or BMC Remedy, so long as the tool can trigger API calls to AAP for automation jobs.</p>
<p class="callout-heading">ServiceNow Workflow</p>
<p class="callout">Refer to the ServiceNow documentation<a id="_idIndexMarker931"/> at <a href="https://www.servicenow.com/products/workflow.xhtml">https://www.servicenow.com/products/workflow.xhtml</a> to learn more about its workflow automation.</p>
<p>Once an incident has been created in the service <a id="_idIndexMarker932"/>management system, the Ansible automation controller<a id="_idIndexMarker933"/> will receive the API<a id="_idIndexMarker934"/> call based on the<a id="_idIndexMarker935"/><a id="_idIndexMarker936"/> workflow’s configuration. For example, we have configured a job template called <strong class="bold">PostgreSQL - Service Start</strong> in the automation controller, as shown here:</p>
<div><div><img alt="Figure 14.7 – The PostgreSQL – Service Start job template " height="412" src="img/B18383_14_07.jpg" width="1207"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.7 – The PostgreSQL – Service Start job template</p>
<p>The Ansible playbook contains a few tasks for updating the incident ticket and also for restarting the PostgreSQL service. The first step is to update the incident ticket with the <code>In progress</code> status, as shown here:</p>
<div><div><img alt="Figure 14.8 – Task to update the ServiceNow ticket " height="536" src="img/B18383_14_08.jpg" width="1191"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.8 – Task to update the ServiceNow ticket</p>
<p>Now, add a task that will start the PostgreSQL service:</p>
<div><div><img alt="Figure 14.9 – Task for starting the PostgreSQL service " height="219" src="img/B18383_14_09.jpg" width="1191"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.9 – Task for starting the PostgreSQL service</p>
<p>Now, add<a id="_idIndexMarker937"/> a task that will update<a id="_idIndexMarker938"/> the ticket <a id="_idIndexMarker939"/>to show that<a id="_idIndexMarker940"/> it’s been resolved:</p>
<div><div><img alt="Figure 14.10 – Updating the ticket’s status to resolved " height="405" src="img/B18383_14_10.jpg" width="1191"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.10 – Updating the ticket’s status to resolved</p>
<p>Expand the playbook with more validations and ticket status updates to meet the ITSM processes in your organization and requirements. If required, you can even add the task of updating the ticket as closed.</p>
<p class="callout-heading">The Life Cycle of an Incident in ServiceNow</p>
<p class="callout">Refer to the ServiceNow<a id="_idIndexMarker941"/> documentation (<a href="https://docs.servicenow.com/en-US/bundle/sandiego-it-service-management/page/product/incident-management/concept/c_IncidentManagementStateModel.xhtml">https://docs.servicenow.com/en-US/bundle/sandiego-it-service-management/page/product/incident-management/concept/c_IncidentManagementStateModel.xhtml</a>) to learn more about the incident life cycle. Also, refer to the Ansible blog post at <a href="https://www.ansible.com/blog/ansible-servicenow-opening-and-closing-tickets">https://www.ansible.com/blog/ansible-servicenow-opening-and-closing-tickets</a> to learn more about<a id="_idIndexMarker942"/> ServiceNow integration with Ansible.</p>
<p>There will be cases<a id="_idIndexMarker943"/> where someone has stopped<a id="_idIndexMarker944"/> the PostgreSQL service for some<a id="_idIndexMarker945"/> activities; Ansible<a id="_idIndexMarker946"/> should be aware of this. It is possible to create a maintenance tracking system using your ITSM tool or third-party solutions, where system maintenance details can be updated with time slots to efficiently handle the incident ticket, as follows:</p>
<ol>
<li>The ITSM tool detects the system maintenance window and updates the ticket as a false alarm.</li>
<li>Add tasks to the Ansible playbook to check against this maintenance window and update the alert as a false alarm if the system is in that maintenance window. </li>
</ol>
<p>With that, you’ve explored<a id="_idIndexMarker947"/> some of the possibilities<a id="_idIndexMarker948"/> of integrating Ansible<a id="_idIndexMarker949"/> with various monitoring<a id="_idIndexMarker950"/> and logging systems. In the next section, you will learn how to use Ansible with security automation solutions.</p>
<h1 id="_idParaDest-272"><a id="_idTextAnchor272"/>Ansible for security automation</h1>
<p>Security hardening<a id="_idIndexMarker951"/> is the practice of securing the hosts, networking devices, and applications<a id="_idIndexMarker952"/> by reducing the attack surface. There are multiple ways to implement security hardening, such as configuring the system appropriately, installing the latest version of the software (or firmware), or disabling unwanted configurations. Organizations<a id="_idIndexMarker953"/> use different security benchmarking methods and standards based on the requirements. <strong class="bold">Center for Internet Security</strong> (<strong class="bold">CIS</strong>) is one of the well-known organizations that provides the necessary enterprise standard<a id="_idIndexMarker954"/> benchmarks and CIS controls (<a href="https://www.cisecurity.org/about-us">https://www.cisecurity.org/about-us</a>). </p>
<p>Log in and download the benchmark documents for operating systems or platforms for free, as shown in the following screenshot:</p>
<div><div><img alt="Figure 14.11 – CIS Benchmark download page for Kubernetes  " height="599" src="img/B18383_14_11.jpg" width="1197"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.11 – CIS Benchmark download page for Kubernetes </p>
<p>It is not easy to configure<a id="_idIndexMarker955"/> the systems based on these benchmarks as hundreds<a id="_idIndexMarker956"/> of rules and configuration items must be executed to secure the system. Organizations use different methods to achieve these configurations, such as shell scripts, PowerShell scripts, and Ansible automation. Due to their flexibility and modularity, Ansible playbooks are much more efficient and maintainable. </p>
<p>It is possible to execute the CIS hardening playbooks frequently using Ansible or an automation controller (scheduled jobs) to ensure the system has a good security posture. However, this method will not be effective for detecting and remediating the threats and incidents on time. </p>
<p>As you learned<a id="_idIndexMarker957"/> in the previous section, it is also<a id="_idIndexMarker958"/> possible to utilize<a id="_idIndexMarker959"/> the power of security tools and solutions and integrate<a id="_idIndexMarker960"/> them with Ansible to automate various security operations, as follows:</p>
<ul>
<li><strong class="bold">Security information and event management</strong> (<strong class="bold">SIEM</strong>)</li>
<li><strong class="bold">Intrusion detection &amp; prevention system</strong> (<strong class="bold">IDPS</strong>) tasks</li>
<li><strong class="bold">Privileged access management</strong> (<strong class="bold">PAM</strong>) operations</li>
<li><strong class="bold">Endpoint protection platform</strong> (<strong class="bold">EPP</strong>) tasks</li>
<li>Firewall operations</li>
</ul>
<p>The following diagram<a id="_idIndexMarker961"/> shows a typical threat detection and automation<a id="_idIndexMarker962"/> workflow:</p>
<div><div><img alt="Figure 14.12 – Threat detection and automated remediation " height="730" src="img/B18383_14_12.jpg" width="1151"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.12 – Threat detection and automated remediation</p>
<p>By using the existing security solutions, it is possible to offload the detection and response overhead from Ansible but still use the power of Ansible to remediate the security issue. </p>
<p>Ansible has a large collection of community modules and collections available to support the automation of security devices and solutions, as follows:</p>
<ul>
<li>Cisco ASA</li>
<li>FortiGate</li>
<li>Palo Alto</li>
<li>F5</li>
<li>CheckPoint</li>
<li>CyberArk</li>
<li>Trend Micro</li>
</ul>
<p class="callout-heading">Ansible Collection for Security Automation</p>
<p class="callout">Refer<a id="_idIndexMarker963"/> to the Ansible collection index (<a href="https://docs.ansible.com/ansible/latest/collections/index.xhtml">https://docs.ansible.com/ansible/latest/collections/index.xhtml</a>) to find the security-related<a id="_idIndexMarker964"/> collections. Also, check out <em class="italic">Security Automation with Red Hat Ansible Automation Platform</em> (<a href="https://access.redhat.com/articles/4001711">https://access.redhat.com/articles/4001711</a>) to learn more about the platform’s compatibility<a id="_idIndexMarker965"/> matrix. Finally, please read the blog post <em class="italic">Getting started with Ansible security automation: investigation enrichment</em> (<a href="https://www.ansible.com/blog/getting-started-with-ansible-security-automation-investigation-enrichment">https://www.ansible.com/blog/getting-started-with-ansible-security-automation-investigation-enrichment</a>) to understand the security automation and integration with AAP.</p>
<p>The process<a id="_idIndexMarker966"/> of automatic IP address<a id="_idIndexMarker967"/> blocking can be seen in the following diagram:</p>
<div><div><img alt="Figure 14.13 – Automated IP address blocking " height="735" src="img/B18383_14_13.jpg" width="1151"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.13 – Automated IP address blocking</p>
<p>With the help of Ansible<a id="_idIndexMarker968"/> modules, most of your security-related operations<a id="_idIndexMarker969"/> can be automated efficiently.</p>
<p>For example, adding an <code>cisco.asa.asa_acls</code> module, as shown in the following screenshot:</p>
<div><div><img alt="Figure 14.14 – Adding an access control rule to the Cisco ASA device " height="591" src="img/B18383_14_14.jpg" width="1191"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.14 – Adding an access control rule to the Cisco ASA device</p>
<p>The following screenshot<a id="_idIndexMarker971"/> shows a simple<a id="_idIndexMarker972"/> Ansible task using the <code>fortinet.fortios.fortios_firewall_address</code> module to block the IP address in the FortiGate device:</p>
<div><div><img alt="Figure 14.15 – Blocking the IP address in the FortiGate device " height="591" src="img/B18383_14_15.jpg" width="1191"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.15 – Blocking the IP address in the FortiGate device</p>
<p>Similarly, the following screenshot shows adding a security rule to the Palo Alto device using the <code>paloaltonetworks.panos.panos_security_rule</code> module:</p>
<div><div><img alt="Figure 14.16 – Adding a security rule to the Palo Alto device " height="484" src="img/B18383_14_16.jpg" width="1191"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.16 – Adding a security rule to the Palo Alto device</p>
<p>Please refer to the <em class="italic">Further reading</em> section for more<a id="_idIndexMarker973"/> resources about security automation<a id="_idIndexMarker974"/> modules in Ansible. </p>
<p>In the next section, you will learn about the workflow templates in the automation controller.</p>
<h1 id="_idParaDest-273"><a id="_idTextAnchor273"/>Ansible workflow templates</h1>
<p>It is possible to create any number<a id="_idIndexMarker975"/> of tasks in a single playbook and make it a long workflow. For example, a Linux operating system job template can include the following tasks:</p>
<ol>
<li value="1">Create a VM snapshot before you start patching. </li>
<li>Save the configuration file backups.</li>
<li>Stop the services inside the system.</li>
<li>Perform various Linux operating system patching tasks.</li>
<li>Reboot the system.</li>
<li>Wait for the system to boot up and start the necessary services.</li>
<li>Handle the VM snapshot restore operation in the same job if the VM reboot is not successful.</li>
</ol>
<p>Note that most of the tasks<a id="_idIndexMarker976"/> can be reused as individual jobs for creating snapshots, stopping services, or configuration backup. </p>
<p>Instead of developing long, complex job templates, utilize the workflow templates in the automation controller to create modular job workflows and handle tasks based on success/failure status. Workflow templates are created by stitching multiple job templates together to achieve a bigger or more complex workflow. </p>
<p>The following diagram shows the high-level differences between a job template and a workflow template in an Ansible automation controller:</p>
<div><div><img alt="Figure 14.17 – Job templates versus workflow templates " height="800" src="img/B18383_14_17.jpg" width="1159"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.17 – Job templates versus workflow templates</p>
<p>The following screenshot shows a simple workflow template for Linux operating system patching. Here, we have<a id="_idIndexMarker977"/> multiple tasks, as follows:</p>
<ol>
<li value="1">Create a snapshot job before patching.</li>
<li>Create a job template to stop the important and dependency services inside the system.</li>
<li>Perform operating system patching tasks.</li>
<li>Reboot.</li>
<li>If the reboot succeeded, all the required services will be started.</li>
<li>If the reboot failed, the job template for restoring the snapshot will be executed:</li>
</ol>
<div><div><img alt="Figure 14.18 – Workflow template for operating system patching " height="151" src="img/B18383_14_18.jpg" width="1029"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.18 – Workflow template for operating system patching</p>
<p>This modular approach helps you implement complex automation workflows by reusing the job templates. The following screenshot shows a similar workflow where the operating system-specific job templates have been replaced and other job templates are being reused:</p>
<div><div><img alt="Figure 14.19 – Windows patching workflow " height="151" src="img/B18383_14_19.jpg" width="1045"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.19 – Windows patching workflow</p>
<p class="callout-heading">Ansible Workflow Job Templates</p>
<p class="callout">Please refer to <a href="https://docs.ansible.com/automation-controller/4.1.2/html/userguide/workflow_templates.xhtml">https://docs.ansible.com/automation-controller/4.1.2/html/userguide/workflow_templates.xhtml</a> to learn more about<a id="_idIndexMarker978"/> the features of workflow templates, such as webhooks and integration options.</p>
<h1 id="_idParaDest-274"><a id="_idTextAnchor274"/>Summary</h1>
<p>In this chapter, you learned about the importance of simplifying Ansible automation. You explored the advantages of survey features in the automation controller and soft coding opportunities to accept parameters dynamically. This method helps you reuse the same playbook and job templates for different devices and scenarios.</p>
<p>Then, you learned about the integration options between Ansible and other monitoring and alerting tools to implement zero-touch incident fixes. It is possible to utilize the existing ITSM tools and workflows to trigger Ansible automation controller jobs based on the rules and conditions. By utilizing the power of monitoring tools and the automation capabilities of Ansible, an efficient monitoring and remediation system can be implemented.</p>
<p>After that, you explored similar integration opportunities within the security domain for automating threat detection and automated remediation using an automation controller. The security modules and collections for Ansible automation help you implement complex and enhanced security automation solutions. </p>
<p>Finally, you learned about the workflow templates in an automation controller, the modular way of creating workflows, and the advantages of reusing job templates.</p>
<p>In the next chapter, you will learn how to automate non-standard and non-supported platforms using Ansible. You will explore some of the useful modules and Ansible custom module creation basics as well.</p>
<p>Further reading</p>
<p>To learn more about the topics that were covered in this chapter, take a look at the following resources:</p>
<ul>
<li><em class="italic">Ansible for Security Automation</em>: <a href="https://www.ansible.com/use-cases/security-automation">https://www.ansible.com/use-cases/security-automation</a></li>
<li><em class="italic">Ansible blog on security automation</em>: <a href="https://www.ansible.com/blog/topic/security-automation">https://www.ansible.com/blog/topic/security-automation</a></li>
<li><em class="italic">Security &amp; Compliance Using Ansible</em>: <a href="https://www.ansible.com/use-cases/security-and-compliance">https://www.ansible.com/use-cases/security-and-compliance</a></li>
<li><em class="italic">Ansible Collections</em>: <a href="https://docs.ansible.com/ansible/latest/collections/index.xhtml#list-of-collections">https://docs.ansible.com/ansible/latest/collections/index.xhtml#list-of-collections</a></li>
<li><em class="italic">Applications in Ansible automation controller</em>: <a href="https://docs.ansible.com/automation-controller/latest/html/userguide/applications_auth.xhtml">https://docs.ansible.com/automation-controller/latest/html/userguide/applications_auth.xhtml</a></li>
<li><em class="italic">Ansible for Network Automation</em>: <a href="https://docs.ansible.com/ansible/latest/network/index.xhtml">https://docs.ansible.com/ansible/latest/network/index.xhtml</a></li>
</ul>
</div>
<div><div></div>
</div>
</div></body></html>