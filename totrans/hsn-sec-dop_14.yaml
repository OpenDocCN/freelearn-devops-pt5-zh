- en: Incident Response
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Security testing plans, whitebox testing tips, security toolsets, and automation
    were illustrated in previous chapters. Starting with this chapter, we will now
    discuss incident responses for a security operation team. We will mainly discuss
    the key activities in the key phases of the incident response process: preparation,
    containment, detection, and post-incident analysis. The field of incident response
    includes how to handle public CVE vulnerability, how to respond to whitehat or
    security attacks, how we evaluate each security issue, the feedback loop to the
    development team, and the tools or practices we may apply in incident response.
    The topics that will be covered in this chapter are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Security incident response process
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security operation team structure
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Incident forensics techniques
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security incident response process
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Establishing a security incident response process is a must for not only very
    large enterprises but also small businesses. Cybersecurity laws or GDPR require
    not only a security incident process, but they also require a security incident
    notification to be sent to the supervisory authority and key stakeholders. A complete
    security incident process involves the security incident handling team, human
    resources, the legal department, and also external supervisory groups. Although
    there are many security technologies and tools that can help to identify, protect,
    detect, respond, and recover from threats, PR and public communication play critical
    roles in non-technical parts. We will mainly focus on the security activities during
    the preparation, detection, containment, and post-incident handling stages based
    on NIST SP 800-62.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some of the recommended industry references related to security incident
    response:'
  prefs: []
  type: TYPE_NORMAL
- en: NIST SP 800-62 Computer Security Incident Handling Guide ([https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SANS Incident Handler Handbook ([https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901](https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ENISA Cloud Computing Benefits, risks, and recommendations for information security ([https://resilience.enisa.europa.eu/cloud-security-and-resilience/publications/cloud-computing-benefits-risks-and-recommendations-for-information-security](https://resilience.enisa.europa.eu/cloud-security-and-resilience/publications/cloud-computing-benefits-risks-and-recommendations-for-information-security))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MITRE Ten Strategies of a World-Class Cyber Security Operations Center ([https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf](https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: FIRST ([https://www.first.org/education/FIRST_PSIRT_Service_Framework_v1.0](https://www.first.org/education/FIRST_PSIRT_Service_Framework_v1.0))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'NIST SP 800-62 defines the incident response life cycle as consisting of four
    phases: preparation, detection and analysis, containment eradication and recovery,
    and post-incident activity. We will introduce some practical tools for each phase
    in the upcoming sections:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00047.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Preparation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The preparation is the most critical part of the incident process. We cannot
    completely predict or avoid any security incident, but we can plan to have full
    preparation for a security incident. The preparation covers all the required processes,
    analysis tools, security technologies, and team resources to prevent and handle
    a security incident. Preparation not only helps in preventing security incidents
    but also minimizing the damage caused during a security incident.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some suggested security practices to be performed in the incident
    response preparation phase:'
  prefs: []
  type: TYPE_NORMAL
- en: Incident handler communication plan
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Incident analysis hardware and software tools (refer to the section on incident
    forensics)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Existing networking diagram and baselines
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Prevention controls, such as risk assessments, host security, network security,
    malware protection, user awareness, and training (refer to the CIS security controls)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The blue and red team security exercise (refer to the following table)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bounty program for whitehat hackers or security researchers to submit security
    issues
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It's suggested that you perform internal attack simulations regularly to test
    the effectiveness and weakness of existing endpoint and network detection security
    solutions, such as antivirus software, IPS, IDS, and firewalls. The security team
    can also analyze the existing logging and alerting capabilities and the response
    time. These kinds of simulated attacks give the security team a chance to review
    and optimize the existing security framework.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following open source tools can help to generate an internal attack simulation
    without compromising business operations. These tools don''t generate real attack
    samples, but simulate the behaviors of hacking or **advanced persistent threat** (**APT**)
    behaviors:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Tools** | **Simulation of APT** |'
  prefs: []
  type: TYPE_TB
- en: '| DumpsterFire   | The DumpsterFire tool includes various kinds of simulated
    attack scenarios, such as an account attack, file download, drop files, command
    execution, and web access in Python. It provides a user-friendly menu to customize
    the security incidents, even for those who don''t understand Python. |'
  prefs: []
  type: TYPE_TB
- en: '| METTA  | The METTA tool allows the security team to customize the simulation
    of APT attacks based on MITRE ATT&CK. The simulated APT behaviors defined by YAML
    include credential access, evasion, discovery, execution, exfiltration, lateral
    movement, persistence, and privilege escalation. |'
  prefs: []
  type: TYPE_TB
- en: '| Red Team Automation (RTA) | The Red Team Automation tool is a collection
    of Python and PowerShell scripts that can simulate over 50 malicious behaviors
    based on ATT&CK.  |'
  prefs: []
  type: TYPE_TB
- en: '| Atomic Red Team (ART) | The Atomic Red Team tool provides Windows, macOS,
    and Linux shell scripts to simulate the MITRE ATT&CK.  |'
  prefs: []
  type: TYPE_TB
- en: '| APT Simulator | The APT Simulator tool is a collection of Windows BAT scripts
    that simulate APT behaviors.  |'
  prefs: []
  type: TYPE_TB
- en: '| Network Flight Simulator | The Network Flight Simulator tool can be used
    to generate malicious network traffic, such as DNS tunneling, C2 communication,
    DGA traffic, and port scans.  |'
  prefs: []
  type: TYPE_TB
- en: During the security incident handling, the team may be occupied by the case,
    but forget to record the information. An incident case-tracking tool will help
    to keep records of the relevant information. The open source tool FIR (Fast Incident
    Response) is a security incident case-management tool that can help to record,
    track, and archive all the findings for each security incident case. This information
    will help to build an in-house security incident handling knowledge base and generate
    an incident report for post-mortem analysis (you can find the tool at [https://github.com/certsocietegenerale/FIR/](https://github.com/certsocietegenerale/FIR/)).
  prefs: []
  type: TYPE_NORMAL
- en: Detection and analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Identifying the signs of a security incident requires the deployment of various
    security solutions and log sensors. The sources of infections include IDS/IPS,
    SIEM, antivirus, file-integrity monitoring, OS/network logs, and public and known
    vulnerabilities. The deployment of the whole enterprise's security controls may
    refer to the CIS Critical Security Controls for Effective Cyber Defense (you can
    find the information at [https://www.cisecurity.org/controls/](https://www.cisecurity.org/controls/boundary-defense/)).
  prefs: []
  type: TYPE_NORMAL
- en: 'These consist of 20 security controls, as summarized in the following table.
    There are many commercial solutions in each security control, but only open source
    solutions are listed in the table:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Cybersecurity controls** | **Examples of security techniques and open source
    tools** |'
  prefs: []
  type: TYPE_TB
- en: '| CSC1: Inventory of Authorized and Unauthorized Devices | Endpoint security,
    Asset Management |'
  prefs: []
  type: TYPE_TB
- en: '| CSC2: Inventory of Authorized and Unauthorized Software | Endpoint security,
    Asset Management |'
  prefs: []
  type: TYPE_TB
- en: '| CS3: Secure Configurations for Hardware and Software on Mobile Devices, Laptops,
    Workstations, and Servers | CIS Security Benchmark, OpenSCAP. |'
  prefs: []
  type: TYPE_TB
- en: '| CSC4: Continuous Vulnerability Assessment and Remediation | OpenVASNmap OWASP
    Dependency CheckOWASP Dependency-Trackvulscan  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 5: Controlled Use of Administrative Privileges | Strong password complexityAuditing
    logs for root and administrator activities |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 6: Maintenance, Monitoring, and Analysis of Audit Logs | Syslog, Event
    Logs, SIEMELKGrayLogSecurity Onion Malicious Traffic Detection  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 7: Email and Web Browser Protections | Email Protection, Anti-Spam, Web
    Application FirewallModSecurity Email Encryption Scramble Linux Malware Detection
    |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 8: Malware Defenses | Endpoint Protection, Antivirus, HIDS/HIPSOSSECClamAV
    |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 9: Limitation and Control of Network Ports, Protocols, and Services |
    Nmap OpenSCAP |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 10: Data Recovery Capability | Bacula  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 11: Secure Configurations for Network Devices, such as Firewalls, Routers,
    and Switches | CIS Security Benchmark  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 12: Boundary Defense | Firewall, IPS, HoneyPotSecurity Onion  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 13: Data Protection | OSQuery Data Vault   |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 14: Controlled Access Based on the Need to Know | Data Classification,
    Firewall, VLAN, Logging |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 15: Wireless Access Control | VPN, SSL Certificate, WAP2 |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 16: Account Monitoring and Control | Log Analysis ToolsFail2ban  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 17: Security Skills Assessment and Appropriate Training to Fill Gaps
    | Security Training and Labs ResourceCybraryIT  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 18: Application Software Security | OWASP  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 19: Incident Response and Management | NIST SP800-61 Computer Security
    Incident Handling Guide FIR (Fast Incident Response)  |'
  prefs: []
  type: TYPE_TB
- en: '| CSC 20: Penetration Tests and Red Team Exercises | Refer to some of the open
    source tools we suggested in the *Preparation* section |'
  prefs: []
  type: TYPE_TB
- en: 'When a security incident case is received, the security team should perform
    a prioritization of the security incident based on the impact that it has. The
    NIST SP800-61 Computer Security Incident Handling Guide suggests quantifying the
    impact level by the functional impact, the PII information impact, and the recoverability
    effort:'
  prefs: []
  type: TYPE_NORMAL
- en: The functional impact means the impact on business functions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The PII information impact is the **confidentiality, integrity, and availability**
    (**CIA**) of the sensitive information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The recoverability effort refers to the amount of time and resources needed
    to recover from the incident
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following table shows some sample definitions of each security incident
    alert level:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Priority** | **Impact** | **Response** |'
  prefs: []
  type: TYPE_TB
- en: '| High | The functional impact, information leakage, or recoverability effort
    is classed as high. | Requires immediate human response. |'
  prefs: []
  type: TYPE_TB
- en: '| Medium | The functional impact, information leakage, or recoverability effort
    is classed as medium. | Requires response within 24 hours. |'
  prefs: []
  type: TYPE_TB
- en: '| Low | The functional impact, information leakage, and recoverability effort
    are all defined as low. | Requires response during routine tasks. |'
  prefs: []
  type: TYPE_TB
- en: '| Notification | No major signs are directly related to the functional impact
    or information leakage, but it can be a potential security issue. | Just a notice.
    This can be part of a quarterly threat-trending analysis. |'
  prefs: []
  type: TYPE_TB
- en: Containment and recovery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The short-term objective of containment is to isolate the infected hosts before
    a complete solution is ready. On the other hand, the long-term objective of recovery
    is to look for a security control that can avoid a similar security incident in
    the future, or that can perform automatic recovery when the security incident
    is detected.
  prefs: []
  type: TYPE_NORMAL
- en: For the containment, there are typical network- or host-containment criteria
    established by network policy enforcement. Whenever one of the criteria is met,
    the containment actions can include blocking that specific host, redirecting the
    traffic to apply the latest security patches, and rejecting specific communication
    traffic or ports.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are common security policy enforcement criteria that will trigger
    the network or host containment:'
  prefs: []
  type: TYPE_NORMAL
- en: The host hasn't installed any antivirus products.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The antivirus pattern/engine versions are not updated.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There are known vulnerable components on the host.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There is suspicious communication traffic on the specified ports.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A known virus is detected on the hosts.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'There is outgoing communication to an external known malicious IP or domain.
    Refer to the following resources:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[http://iplists.firehol.org/](http://iplists.firehol.org/)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://www.spamhaus.org/drop/](https://www.spamhaus.org/drop/)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://rules.emergingthreats.net/fwrules/emerging-Block-IPs.txt](https://rules.emergingthreats.net/fwrules/emerging-Block-IPs.txt)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://check.torproject.org/exit-addresses](https://check.torproject.org/exit-addresses)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: In terms of recovery, the objective is to restore the infected applications
    or hosts back to normal operation. The activities of recovery not only include
    restoring the system but also removing compromised files, applying the latest
    patches, securing communication ports, increasing the complexity of passwords,
    and improving security controls, such as permission configurations, HIDS, SELinux,
    and firewalls.
  prefs: []
  type: TYPE_NORMAL
- en: Post-incident activity
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Hosting a *lessons learned* meeting or post-mortem analysis report can help
    the team to learn from the incident. The primary objective of the lessons learned
    meeting is to look for the improvement of each phase during the security incident
    response process. This kind of meeting is often neglected once the security issue
    is solved. It's suggested that you at least document the process of the security
    incident and incorporate it into the knowledge base.
  prefs: []
  type: TYPE_NORMAL
- en: For a lessons learned meeting, the meeting should focus on how the team can
    improve together and prevent a similar issue in the future instead of blaming
    someone for the error. The inputs of the post-mortem meeting typically include
    the proposed security control changes, the case-handling information, and the
    root cause analysis report. It's expected that the team will think on what specific
    actions can be done to prevent similar issues. For example, specific email phishing
    awareness training can be increased. The security scanning rules in IDS can be
    optimized to reduce false positives. Security incident forensics can be done by
    automation. The period of the known vulnerabilities installation cycle can be
    shortened. These are the potential outputs of the meeting with the consensus among
    the stakeholders, such as the security, IT, development, business, and legal teams.
  prefs: []
  type: TYPE_NORMAL
- en: 'The expected post-mortem output report typically includes certain key sections
    answering key questions, such as what happened, the impact, root cause analysis,
    short-term and long-term mitigations, the activities that occurred during the
    incident timeline, what should be improved, and what should be kept. Here is an
    example of a post-mortem meeting output report:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Overview of the issue**'
  prefs: []
  type: TYPE_NORMAL
- en: One of the services was identified as having abnormal unavailability. The WebLogic
    process had a CPU usage of 100%, and the log showed an abnormal and suspicious
    outbound IP connection.
  prefs: []
  type: TYPE_NORMAL
- en: '**What happened and the impact**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Business Functional Impact: Some of the services slowed down, and were unable
    to respond to the requests. The running process occupied 100% of the CPU resources.
    No data-leakage risks were identified.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Root Cause Analysis**'
  prefs: []
  type: TYPE_NORMAL
- en: IT identified that it was the WebLogic process that frequently had a CPU usage
    of over 80%.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: After the security team checked the Linux connection logs, it was confirmed
    that the WebLogic process had an outbound connection to external hosts that were
    related to cryptojacking (cryptojacking refers to the use of compromised hosts
    to mine cryptocurrency).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: After searching the CVE database by the security team, the issue was likely
    related to CVE 2017-3248.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Mitigation and Solutions**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Short-term before the security patch is ready: Apply firewall rules to block
    outbound communication traffic to the cryptojacking servers, and inbound connections
    to the victim host.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Long-term:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Apply WebLogic security patch.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Update the antivirus security patterns.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Optimize the host-based intrusion detection rules for high-CPU usage processes
    and abnormal outbound connections behaviors.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Activities during the timeline**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Day 1 1000: IT service monitoring identified service unavailability.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Day 1 1020: IT identified that a WebLogic process occupied 100% CPU usage,
    and collected related logs for further analysis. As the issue happened frequently
    and impacted the service''s availability, the case was also escalated to the security
    team to identify whether it was a security incident.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Day 1 1040: Security team completed the log analysis and identified abnormal
    connections.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Day 1 1145: The IT team was informed, and decided to disconnect the outbound
    connection to the malicious IP.'
  prefs: []
  type: TYPE_NORMAL
- en: '**What should be improved or kept**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Keep: Good collaboration between IT and security team.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Improvement: Automated log collection and analysis tools.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Improvement: Virtual patch by firewall before a security patch is ready.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Improvement: Networking log correlation with threat knowledge from [http://iplists.firehol.org/](http://iplists.firehol.org/).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security incident response platforms (SIRP)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When handling a security incident, there will be lots of information that needs
    to be processed and analyzed. An ideal security incident response platform should
    be able to do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Receive alerts and security events from different sources (SIEM, IDS, email)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The security incident case management should allow a security analyst to add
    related logs, IOCs, or findings during the incident case handling life cycle
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Compare its analysis with external threat information, such as VirusTotal, to
    identify the malicious behaviors of a file, hash, domain, or IP address
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The open source tool TheHive can help you to provide a security incident response
    management platform. TheHive can also work with MISP, which is a threat intelligence
    platform for sharing and correlating indicators of compromise (which indicate
    that a targeted attack has taken place) and vulnerability information. Refer to
    the following  documentation for more information:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://thehive-project.org/](https://thehive-project.org/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[http://www.misp-project.org/index.html](http://www.misp-project.org/index.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For more information on how TheHive, CorTex, and MISP can integrate together
    for a threat incident response, go to [https://blog.thehive-project.org/2017/06/19/thehive-cortex-and-misp-how-they-all-fit-together/](https://blog.thehive-project.org/2017/06/19/thehive-cortex-and-misp-how-they-all-fit-together/).
  prefs: []
  type: TYPE_NORMAL
- en: SOC team
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The **security operations center** (**SOC**), also known as the **computer
    incident response team** (**CIRT**), is the security team that handles and monitors
    daily security events. The organizational structure of SOC can include parts of
    the existing IT team, an outsourced team, or a dedicated security team. No matter
    what kind of structure it has, there are several key functions that the team will
    have:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Key functions** | **Description** |'
  prefs: []
  type: TYPE_TB
- en: '| Security incident analysis and forensics (call center) | This function team
    may include the Tier 1 case handling in the 24/7 security monitoring center. The
    Tier 1 team typically handles the case by following the predefined checklist or
    SOP to perform initial root-cause analysis or mitigation based on the incidents.
    |'
  prefs: []
  type: TYPE_TB
- en: '| Security operations and administration | This functional team involves the
    following routine security activities. These are regular security checking activities
    for the production environments:'
  prefs: []
  type: TYPE_NORMAL
- en: Network scanning (weekly)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerability scanning (weekly)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Penetration testing (monthly)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security awareness training (bi-monthly)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security log trending analysis (monthly)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security administration and monitoring (daily)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Patch or security signature update (daily/weekly)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '|'
  prefs: []
  type: TYPE_NORMAL
- en: '| Security tools engineering | The security engineering team implement security
    tools for the security call center or security operations team. The security tools
    can be security automation, suspicious behaviors detectors, forensic analysis
    tools, security configurations checker, threat intelligence integration, threat
    signatures creation, and so on. |'
  prefs: []
  type: TYPE_TB
- en: 'The SOC team can consist of parts of an IT call center or a dedicated security
    team depending on the size of the whole organization. A typical dedicated SOC
    team structure is shown in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00048.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Incident forensics techniques
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The primary objective of incident forensics for an organization is to answer
    the following questions:'
  prefs: []
  type: TYPE_NORMAL
- en: Is the host infected with a malicious program?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How did the host get infected?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What can be improved to avoid the infection?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The NIST SP 800-86 Guide to Integrating Forensic Techniques into Incident Response
    defines four major phases to perform digital forensics on a compromised computer:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Collection**: Collect all the relevant logs of the compromised computer or
    networking activities logs'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Examination**: Extract and correlate the information that may highly relate
    to suspicious behaviors'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Analysis**: Analyze all the information for root causes of the malicious
    infection'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Reporting**: Conclude the summary results'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The forensics techniques require the capability of the incident response team
    to perform the analysis. In the following table, we have listed some quick-win
    solutions that can perform semi-automated forensics, including collection, examination,
    and analysis:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Category** | **Tools** | **Purpose and usage scenario** |'
  prefs: []
  type: TYPE_TB
- en: '| Log Collection | OSX Collector | Mac OS X Log Collector is an automated forensic
    evidence collection for macOS. The Python script, osxcollector.py, is the script
    that performs all the collection jobs. The tool will generate a JSON file as a
    summary of the collected information.  |'
  prefs: []
  type: TYPE_TB
- en: '| Log Collection | IR Rescue | IR Rescue is a Windows and Linux script for
    collecting host forensic data. For the Windows version, it integrates several
    utilities from the from Sysinternals and NirSoft. |'
  prefs: []
  type: TYPE_TB
- en: '| Log Collection | FastIR Collector | FastIR Collector (for Linux) only requires
    one Python script to collect all related logs in Linux. For Windows systems, it
    will require additional modules and tools. Refer to [https://github.com/SekoiaLab/Fastir_Collector ](https://github.com/SekoiaLab/Fastir_Collector)for
    more information. |'
  prefs: []
  type: TYPE_TB
- en: '| Malware Detector | Linux Malware Scanner | Free malware scanners for Linux
    are available from the following links:CalmAV: It''s an open source antivirus
    software for Windows.Linux Malware Detect (LMD): It''s an open source antivirus software
    for Linux. |'
  prefs: []
  type: TYPE_TB
- en: '| Suspicious Files Analysis | Cuckoo | Cuckoo is an automated malware analysis
    system. It can analyze the dynamic runtime and static behaviors of the unknown
    and suspicious files under Windows, Linux, macOS, and Android. |'
  prefs: []
  type: TYPE_TB
- en: '| Client/Server log collector and analysis | GRR Rapid Response | You can use
    Google Remote Live forensics for incident response. It will require the installation
    of a Python agent on the target hosts to collect the logs and on the Python server
    to do the analysis.  |'
  prefs: []
  type: TYPE_TB
- en: '| Client/Server log collector and analysis | OSQuery | The OSQuery tool works
    in a similar way to GRR. The key difference is that OSQuery provides an SQL query
    to perform endpoint analysis.For more information, you can read the documentation
    at the following links:[https://osquery.io/](https://osquery.io/)[https://osquery.readthedocs.io/en/stable/deployment/anomaly-detection/](https://osquery.readthedocs.io/en/stable/deployment/anomaly-detection/)
    |'
  prefs: []
  type: TYPE_TB
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we discussed the security incident response process and shared
    some of the industry practices, such as the NIST SP800-62, SANS Incident Handler
    Handbook, and MITRE's Ten Strategies of a World-Class Cyber Security Operations
    Center. We explored the incident response activities based on the phases defined
    by the NIST SP800-62, which are the preparation, detection and analysis, containment
    eradication, and post-incident activity phases.
  prefs: []
  type: TYPE_NORMAL
- en: In the preparation phase, we introduced some of the simulated attack tools for
    the red/blue team exercise. In the detection phase, we suggested applying CIS
    Critical Security Controls for Effective Cyber Defense to assess the detection
    and analysis capabilities. We introduced some containment security policies when
    looking at the containment phase. In the post-incident phase, we learned how to
    do a post-mortem review and looked at one incident post-mortem sample report.
    To link all the information from the different phases and teams, it's suggested
    that you have a **security incident response platform** (**SIRP**).
  prefs: []
  type: TYPE_NORMAL
- en: Last but not least, we discussed the SOC organization and the key functions
    that it should have. We also looked at some incident forensics techniques and
    tools.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will discuss security monitoring. Security incident
    response may be a one-time event for security case handling, but security monitoring
    will be a constant security-monitoring activity.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: What's the right order of the security incident response phases?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Detection -> Preparation -> Containment -> Post-Incident Analysis
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Containment -> Detection -> Preparation -> Post-Incident Analysis
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Preparation -> Detection -> Containment -> Post-Incident Analysis
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Preparation -> Containment -> Detection -> Post-Incident Analysis
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: What best describes a bounty program?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It's an incentive program for security researchers to submit security issues
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: It's a security awareness training program
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: It's an in-house security penetration exercise
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: It's a security design camp
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: What's the purpose of attack simulations?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To test the weakness of endpoint detection
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: To test the detection capability of network security
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: To test the logging and alerting capability of the security system
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: All of the above
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: What does the CIS Critical Security Controls for Effective Cyber Defense define?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It defines the 20 security controls for the whole enterprise security
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: It defines incident response processes
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: It defines the secure coding practices
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: It defines security automation practices
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: The ELK, Graylog, and Syslogs are mainly used in which of the following security
    controls?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Monitoring and Analysis of Audit Logs
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Email and Web Browser Protections
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Malware Defenses
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Data Recovery Capability
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Which should not be used to quantify the impact level?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The functional impact
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: The malware detection capability
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: The PII information impact
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: The recoverability efforts
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Which one of the following is the incorrect role/responsibility for the SOC
    team?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The primary objective of the Tier 1 call center is to perform malware analysis
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: The security operations team should perform network scanning on a regular basis
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: The security tools engineering team is in charge of security tools implementation
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: The security log analysis should be regularly summarized and analyzed
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: What is the correct description of "cryptojacking "?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Unauthorized use of a compromised host to mine cryptocurrency
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Encryption of the compromised host without permission
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Unauthorized access to the encrypted information
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Unauthorized encryption of the compromised host
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**NIST SP 800-62 Computer Security Incident Handling Guide**: [https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf](https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ENISA Cloud Computing Benefits, risks, and recommendations for information
    security**: [https://www.enisa.europa.eu/publications/cloud-computing-risk-assessment](https://www.enisa.europa.eu/publications/cloud-computing-risk-assessment)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Handbook for Computer Security Incident Response Teams (CSIRTs)**: [https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=6305](https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=6305)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SANS Security Checklists & Step by Step Guides**: [https://www.sans.org/score/checklists](https://www.sans.org/score/checklists)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Awesome Incident Response**: [https://github.com/meirwah/awesome-incident-response/](https://github.com/meirwah/awesome-incident-response/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**InfoSec Tools**: [https://secure.dshield.org/tools/](https://secure.dshield.org/tools/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Forming an Incident Response Team**:  [https://www.auscert.org.au/publications/forming-incident-response-team](https://www.auscert.org.au/publications/forming-incident-response-team)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Awesome Forensics**: [https://github.com/cugu/awesome-forensics/](https://github.com/cugu/awesome-forensics/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Awesome Incident Response**:  [https://github.com/meirwah/awesome-incident-response/](https://github.com/meirwah/awesome-incident-response/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Awesome List of Digital Forensic Tools**: [https://github.com/ivbeg/awesome-forensicstools/](https://github.com/ivbeg/awesome-forensicstools/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Awesome Malware Analysis Tools**: [https://github.com/rshipp/awesome-malware-analysis/](https://github.com/rshipp/awesome-malware-analysis/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Incident Response Playbooks**: [www.incidentresponse.com/playbooks/](http://www.incidentresponse.com/playbooks/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SANS Incident Handler''s Handbook**: [https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901](https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Incident Response Process**: [https://response.pagerduty.com](https://response.pagerduty.com)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**NIST Framework for Improving Critical Infrastructure Cybersecurity**: [https://www.nist.gov/publications/framework-improving-critical-infrastructure-cybersecurity-version-11](https://www.nist.gov/publications/framework-improving-critical-infrastructure-cybersecurity-version-11)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Microsoft TechNet Responding to IT Security Incidents**: [https://technet.microsoft.com/en-us/library/cc700825.aspx](https://technet.microsoft.com/en-us/library/cc700825.aspx)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**MITRE''s Ten Strategies of a World-Class Cybersecurity Operations Center**: [https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf](https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Security 101 for SaaS Startup**: [https://github.com/forter/security-101-for-saas-startups/blob/english/security.md](https://github.com/forter/security-101-for-saas-startups/blob/english/security.md)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**InfoSec Security Training and Labs Resource**: [https://github.com/onlurking/awesome-infosec](https://github.com/onlurking/awesome-infosec)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**vFeed - The Correlated Vulnerability and Threat Intelligence Database Wrapper**: [https://github.com/toolswatch/vFeedhttps://vfeed.io/](https://vfeed.io/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**MITRE ATT&CK**: [https://attack.mitre.org/wiki/Main_Page](https://attack.mitre.org/wiki/Main_Page)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Red Team Automation**: [https://github.com/endgameinc/RAT](https://github.com/endgameinc/RAT)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Atomic Red Team**: [https://github.com/redcanaryco/atomic-red-team](https://github.com/redcanaryco/atomic-red-team)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**APT Simulator**: [https://github.com/NextronSystems/APTSimulator](https://github.com/NextronSystems/APTSimulator)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Network Flight Simulator**: [https://github.com/alphasoc/flightsim](https://github.com/alphasoc/flightsim)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Awesome Information Security:** [https://github.com/onlurking/awesome-infosec](https://github.com/onlurking/awesome-infosec)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**NIST SP800-61 Computer Security Incident Handling Guide:** [https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
