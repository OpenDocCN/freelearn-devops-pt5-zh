<html><head></head><body>
        

                            
                    <h1 class="header-title">Emails and Notifications</h1>
                
            
            
                
<p>Email is one of the most important communication tools in the world. It is a technology that people are familiar with and had the least amount of resistance in regard to its adoption. Therefore, these days email integration has become one of the key features of any system. Help-desk systems, CRMs, and even document-management systems all need to be able to both send and receive emails. So it is not surprising that Jira comes with a full list of email integration features out of the box.</p>
<p>In this chapter, we will learn how to configure Jira to send out email notifications every time someone makes a change to issues, set up notification rules to manage email recipients, and create mail templates to customize email content. We will also look at how Jira can process emails and create issues automatically, saving us the effort of manual data entry.</p>
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Setting up an outgoing mail server</li>
<li>Sending emails to users from Jira</li>
<li>Sending notifications for issue updates</li>
<li>Sending notifications with custom templates</li>
<li>Disabling outgoing notifications</li>
<li>Creating mail handlers to process incoming emails</li>
<li>Using emails to update Jira issues</li>
<li>Setting up a project-specific From email address</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up an outgoing mail server</h1>
                
            
            
                
<p>In this recipe, we will look at how to set up an outgoing mail server in Jira that can be used to send direct emails to users or automated notifications when updates are made to issues.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Jira requires a working mail server to send emails, and it uses the <strong>SMTP</strong> (short for <strong>Simple Mail Transfer Protocol</strong>) to communicate with the mail server. Because of this, you will need the following:</p>
<ul>
<li>A working mail server that is either on the same server as Jira or accessible over the network</li>
<li>Connectivity details, including the mail server's host, port, protocol (SMTP or secured SMTP), and SSL certificate if it is using a self-signed certificate</li>
<li>Authentication details for Jira to log in to the mail server</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to set up an outgoing mail server:</p>
<ol>
<li>Log in to Jira as a Jira administrator.</li>
<li>Navigate to Administration &gt; System &gt; Outgoing Mail.</li>
<li>Click on the Configure new SMTP mail server<strong> </strong>button.</li>
<li>Set a name for the mail server. For example, you can use the mail server's hostname.</li>
<li>Set the From address<strong> </strong>field that will be used when users receive an email from Jira.</li>
<li>Provide an Email prefix<strong> </strong>value, which will be added to every email's subject. For example, you can use <kbd>[Jira]</kbd> to let users know it is coming from Jira.</li>
<li>Select whether you will be using a custom SMTP server or one from either Gmail or Yahoo! mail. If you are using Gmail or Yahoo!, make sure you select the corresponding option and provide the access credentials. If you are using a custom SMTP server, you will need to provide its hostname, port number, and credentials, if necessary.</li>
</ol>
<p> </p>
<ol start="8">
<li>Click on the Test Connection button, with the credentials provided, to make sure Jira is able to connect to the mail server. If the test is successful, click on the Add button, as shown in the following screenshot:</li>
</ol>
<div><img src="img/27f85913-6cce-4767-81f7-7e982fc67a6e.png" style="width:43.75em;height:42.58em;"/></div>
<p>You can only have one outgoing mail server.</p>
<p>Once we have configured the outgoing mail server in Jira, we can send a test email to make sure everything is working properly:</p>
<ol>
<li>Click on the Send a Test Email link.</li>
<li>Verify whether the email address in the <strong>To </strong>field is the one that you have access to. Jira will automatically populate it with the email address of the currently logged-in user.</li>
<li>Click on the <strong>Send </strong>button to send the test email.</li>
</ol>
<p>Jira will immediately send out the test email (normal notification emails are placed in a queue before they are sent) to the address in the <strong>To</strong> field, with the Subject and Body content specified, as shown in the following screenshot. If there is an error, you can check the SMTP logging checkbox to get more details on the error:</p>
<div><img src="img/2c21791a-2a09-4847-9e0e-07a9d5d4a4ee.png" style="width:41.25em;height:30.92em;"/></div>
<p>We have now successfully set up an outgoing email server.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Sending emails to users from Jira</h1>
                
            
            
                
<p>With the outgoing mail server set up, we will now be able to send emails directly from Jira. One common use case is sending out reminders, such as system maintenance notices, to everyone in Jira, or sending important updates to members of a project. In this recipe, we will look at how to perform these types of tasks with Jira.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>You must first configure an outgoing mail server for Jira. Refer to the previous recipe, <em>Setting up an outgoing mail server</em>, for more details.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to send out direct emails to users in Jira:</p>
<ol>
<li>Navigate to Administration &gt; <strong>System</strong> &gt; <strong>Send email</strong>.</li>
<li>Select the recipients of the email. You can choose to send an email via <strong>Project Roles </strong>or <strong>Groups</strong>. For example, to send an email to everyone who uses Jira, you can select the <strong>jira-software-users</strong> group (if it is the group that all of the users are in).</li>
<li>Type in your email <strong>Subject </strong>and <strong>Body</strong>.</li>
<li>Check the <strong>Bcc </strong>checkbox if you do not want people to see other recipients' email addresses.</li>
</ol>
<p> </p>
<ol start="5">
<li>Click on the <strong>Send </strong>button to send the email, as shown in the following screenshot:</li>
</ol>
<div><img src="img/482bd1ec-4180-4b12-a4a9-d5a3b4e4dfe1.png" style="width:42.00em;height:39.75em;"/></div>
<p>This completes the steps to send emails to users.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Sending notifications for issue updates</h1>
                
            
            
                
<p>The other major use of outgoing mails is for Jira to automatically send out notifications about changes to issues. For example, if an issue has been updated, you would want the issue's reporter and assignee to be notified of the change.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>In this recipe, we will look at how to set up notification rules so that interested parties are notified of any changes to their issues.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>You must first configure an outgoing mail server for Jira. Refer to the <em>Setting up an outgoing mail server</em> recipe for more details.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Jira uses notification schemes to control who should receive notifications when there are any changes in issues. Jira comes with a default notification scheme that is applied to all projects by default. You can update this default scheme's notification settings by clicking on its <strong>Notifications</strong> link. In this recipe, however, we will be creating a new notification scheme and applying it to projects. If you want to use the default notification scheme, you can skip the new scheme creation steps and go straight to step 2:</p>
<ol>
<li>Go through the following steps to create a new notification scheme:
<ol>
<li>Navigate to <strong>Administration</strong> &gt; <strong>Issues</strong> &gt; <strong>Notification schemes</strong>.</li>
<li>Click on the <strong>Add notification scheme </strong>link.</li>
<li>Enter a name for the new scheme and click on <strong>Add </strong>to create it.</li>
</ol>
</li>
</ol>
<p style="padding-left: 60px">After you have created a new notification scheme, you will be taken to the notification settings page for the scheme. By default, there will be no notifications set for any event.</p>
<ol start="2">
<li>To add a notification recipient to an event, go through the following steps:
<ol>
<li>Click on the Add link for the event.</li>
<li>Select the type of notification recipient (for example, the <kbd>Group</kbd> option, as shown in the following screenshot), and click on <strong>Add</strong>.</li>
</ol>
</li>
</ol>
<p class="mce-root"/>
<p style="padding-left: 60px">You can add a notification recipient to multiple events at the same time by using the multi-select events field. The following screenshot of the <strong>Add Notification</strong> page shows this:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/6b23d0c1-2c2a-4753-bf9c-06ece0eda95e.png" style="width:45.00em;height:42.25em;"/></p>
<p class="mce-root"/>
<p style="padding-left: 60px">You can add as many notification recipients as you need for an event, and Jira will not send duplicate emails to the same user. For example, if you have set both the reporter and assignee to receive notifications for a single event, and they happen to be the same user, Jira will only send out one email instead of two. Also, note that Jira will take permissions into consideration when sending out notifications. If a user does not have access to the issue, Jira will not send notifications to that user.</p>
<ol start="3">
<li>The last step is to apply our new notification scheme to a project:
<ol>
<li>Browse to the project you want to apply the notification scheme to.</li>
<li>Click on the <strong>Project settings </strong>option.</li>
<li>Select the <strong>Notifications </strong>option from the panel on the left-hand side.</li>
<li>Select <strong>Use a different scheme </strong>from the <strong>Actions</strong> menu.</li>
<li>Select the new notification scheme and click on <strong>Associate</strong>.</li>
</ol>
</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Jira uses an event system where every issue operation, such as creating a new issue or workflow transition, will trigger a corresponding event to be fired. As we have seen, notification schemes map events to notification recipients. This way, we are able to set up flexible notification rules to notify different people for different events.</p>
<p>Jira provides many different notification recipient types. Some, such as Current Assignee and Reporter, are very simple—they will simply take the value of the current issue's assignee and reporter field respectively. Other options, such as User Custom Field Value, can be very flexible. For example, you can create a multi-user picker custom field, and for each issue, you can have a different list of users as recipients, without having to modify the actual scheme itself.</p>
<p>Events are also mapped to email templates so that Jira knows what to use for the subject and body. You cannot change the mapping for system events, but as we will see in the next recipe, we can create custom events and select which templates to use.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>Being automatically notified of any changes that happen in Jira is convenient, but if you have a busy Jira, you might find yourself buried in emails as a result of too many updates. To help with that, you can enable the new email batching feature. By enabling batching, instead of receiving an email for each update that happens to an issue, Jira will group all updates for a given issue and send you a summary email instead. To enable email batching, go through the following steps:</p>
<ol>
<li>Navigate to Administration &gt; System &gt; Batching email notification.</li>
<li>Check the Batching email notification option to enable the feature.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Sending notifications with custom templates</h1>
                
            
            
                
<p>In the previous recipe, <em>Sending notifications for issue updates</em>, we looked at how to set up notification schemes by mapping events to notification recipients.</p>
<p>In this recipe, we will expand on that and look at how to create custom events and templates to use for notifications. This has two advantages:</p>
<ul>
<li>We can customize the content and the look and feel of the notification email</li>
<li>We can specify exactly which event will be fired for each workflow transition and set up notification rules accordingly</li>
</ul>
<p>We will create a new event that will represent a request that has been approved by the management to proceed. This event will be triggered in an approve workflow transition and will have a custom template applied to it.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>The first step is to create our custom email templates. All mail templates are stored in the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes/templates/email</kbd> directory, and generally, for each event in Jira, there are three template files:</p>
<ul>
<li><strong>The subject template</strong>: This is the template file for the email's subject line, which is stored in the <kbd>subject</kbd> subdirectory.</li>
<li><strong>The text template</strong>: This is the template file for emails sent in text format, which is stored in the <kbd>text</kbd> subdirectory.</li>
<li><strong>The HTML template</strong>: This is the template file for emails sent in HTML format, which is stored in the <kbd>html</kbd> subdirectory.</li>
</ul>
<p>To start creating our own email templates, we first need to create the three files mentioned in the previous list of template files and place them in their respective directories. Take special note that all three files need to have the same filename with a <kbd>.vm</kbd> extension.</p>
<p>We will start with the subject template, as follows:</p>
<ol>
<li>Create a new file called <kbd>issueapproved.vm</kbd> in the <kbd>subject</kbd> subdirectory with the following code snippet:</li>
</ol>
<pre style="padding-left: 60px">#disable_html_escaping()

$eventTypeName - ($issue.key) $issue.summary</pre>
<ol start="2">
<li>We now need to create the body of the email, keeping in mind that we have to create two versions—one for text and one for HTML. The following snippet shows the HTML version; for the text version, simply remove the HTML markups. Note that both HTML and text template files need to be the same—that is, <kbd>issueapproved.vm</kbd>:</li>
</ol>
<pre style="padding-left: 60px">#disable_html_escaping()

Hello $issue.reporterUser.displayName,

&lt;p&gt;
 Your request &lt;a href=""&gt;$issue.key&lt;/a&gt; has been approved, with the comment below:
&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;<br/>   #if($comment.body)<br/>      $comment.body<br/>    #else<br/>   &lt;i&gt;No comment&lt;/i&gt;<br/>    #end<br/>  &lt;/p&gt;
 &lt;/blockquote&gt;

 &lt;br/&gt;

 Internal IT team</pre>
<ol start="3">
<li>After we have created all three template files, we need to register them in Jira so that they can be selected while creating custom events. To register new email templates, open the <kbd>email-template-id-mappings.xml</kbd> file in a text editor; you can find the file inside the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes</kbd> directory.</li>
<li>The <kbd>email-template-id-mappings.xml</kbd> file lists all the email templates in Jira, so we need to add a new entry at the end, as follows:</li>
</ol>
<pre style="padding-left: 60px">&lt;templatemapping id="10002"&gt;

 &lt;name&gt;Issue Approved&lt;/name&gt;

 &lt;template&gt;issueapproved.vm&lt;/template&gt;

 &lt;templatetype&gt;issueevent&lt;/templatetype&gt;

&lt;/templatemapping&gt;</pre>
<p>There are a few points to note here:</p>
<ul>
<li>The <kbd>id</kbd> value of <kbd>&lt;templatemapping&gt;</kbd> needs to be unique.</li>
<li>You can give any value to the <kbd>&lt;name&gt;</kbd> element and it will be displayed in Jira. It is good practice to keep it consistent with standard Jira event convention.</li>
<li>The <kbd>&lt;template&gt;</kbd> element should be the name of the custom template files we have created. All three files need to have the same filename since we can only have one <kbd>&lt;template&gt;</kbd> element.</li>
<li>The <kbd>&lt;templatetype&gt;</kbd> element needs to have the value set to <kbd>issueevent</kbd>.</li>
</ul>
<p>Once you have added the entry and saved the file, you will need to restart Jira for the changes to be applied.</p>
<p>Now that we have our custom email templates in place, we can create the custom event that will use our new templates. Go through the following steps to create a custom event in Jira:</p>
<ol>
<li>Navigate to Administration &gt; System &gt; Events.</li>
<li>Enter <kbd>Issue Approved</kbd> for the new event's name.</li>
</ol>
<ol start="3">
<li>Select the <strong>Issue Approved </strong>template we just created.</li>
<li>Click on the <strong>Add</strong> button to create the new event:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/82b5b36f-ef53-4ac3-a920-70d8ab9ff941.png" style="width:31.50em;height:14.25em;"/></p>
<p>Once you have created the event, it will be available in the notification schemes, and we will be able to select who will receive email notifications by configuring our notification schemes—as shown in the following screenshot. Whenever an issue is approved, both the reporter and the user Christine will be notified:</p>
<div><img src="img/494b7342-9459-4985-834d-31422541588d.png" style="width:32.25em;height:12.83em;"/></div>
<p>The last step is to make sure that our custom events are fired when users trigger the action:</p>
<ol>
<li>Navigate to Administration &gt; Issues &gt; Workflows.</li>
</ol>
<ol start="2">
<li>Click on the <strong>Edit </strong>link for the workflow, which contains the transitions that will fire the custom event. In this case, we will be using a simple approval workflow that contains a transition called <strong>Approve</strong>:</li>
</ol>
<div><img src="img/89991ec3-f024-464e-84bd-74159af35b11.png" style="width:47.33em;height:31.17em;"/></div>
<ol start="3">
<li>Click on the workflow transition, and select the <strong>Post Functions </strong>tab. Normally, you will see the last post function in the list firing <strong>Generic Event</strong>.</li>
<li>Hover your mouse over the post function and click on the edit icon (it looks like a pencil).</li>
<li>Select the new <kbd>Issue Approved</kbd> event and click on <strong>Update</strong>, as shown in the following screenshot. This will make the transition fire our event instead of the default Generic Event:</li>
</ol>
<div><img src="img/0953245b-c72b-4e16-994b-77e35d8f28f2.png" style="width:29.67em;height:10.50em;"/></div>
<p>Let's see how the steps work.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Jira's email templates use the Apache Velocity (<a href="http://velocity.apache.org/" target="_blank">http://velocity.apache.org</a>) template language to display dynamic data. Each template is a mix of static text (with or without HTML markups) and some Velocity code. If you do not need to have dynamic contents, then you can only have static text in your templates.</p>
<p>In our previous examples, every time you see the dollar sign (<kbd>$</kbd>), such as in the phrase <kbd>$issue.key</kbd>, it is a piece of Velocity code. The <kbd>$</kbd> sign is an instruction to get a variable from the Velocity context, and the variable name is the word that comes directly after the <kbd>$</kbd> sign so, in this case, it is <kbd>issue</kbd>. The period character (<kbd>.</kbd>) is an instruction to get the specified value from the variable. So, <kbd>$issue.key</kbd> can be read as <em>get the value of key from the variable issue</em>, or in other words, <em>get me the issue's key</em>.</p>
<p>Jira exposes a number of variables in its Velocity context for email templates; you can find the full list at <a href="https://confluence.atlassian.com/display/JIRA041/Velocity+Context+for+Email+Templates" target="_blank">https://confluence.atlassian.com/display/JIRA041/Velocity+Context+for+Email+Templates</a>.</p>
<p>So, if we take a look at our templates, for the subject template, the <kbd>($issue.key) $issue.summary</kbd> Velocity code will be turned into something like <kbd>IT-10 Request for Jira administrator access</kbd>, where <kbd>IT-10</kbd> replaces <kbd>$issue.key</kbd> and <kbd>Request for Jira administrator access</kbd> replaces <kbd>$issue.summary</kbd>.</p>
<p>You can also have conditional logic in your Velocity templates. In our example, we have an <kbd>if/else</kbd> condition. We check to see if there is a comment accompanying the approve transition, and if there is, we will display the comment. If there is no comment, then we simply display No Comment in italic font.</p>
<p class="mce-root"/>
<p>The following screenshot shows a sample email generated from the custom template that we have created, displayed in Gmail:</p>
<div><img src="img/1bfe5151-cb11-429b-9d49-3caff5b455db.png" style="width:46.33em;height:20.42em;"/></div>
<p>Now, onto the custom Issue Approved event. Unlike system events, custom events can only be fired from workflow transitions (or custom script code), so we have to update our workflows. Every workflow transition fires an event, and by default, the Generic Event is fired. This means that most workflow transitions will have the same notification recipient using the email template.</p>
<p>By configuring the workflow to fire our own custom event, we have finer control over who receives notifications and which templates to use.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Disabling outgoing notifications</h1>
                
            
            
                
<p>This recipe shows you how to completely prevent Jira from sending out emails. You may need to do this if you are performing testing, performing data migration, or cloning a new development instance, and do not want to flood users with hundreds of test notifications.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to disable outgoing notifications in Jira:</p>
<ol>
<li>Navigate to <strong>Administration </strong>&gt; <strong>System</strong> &gt; <strong>Outgoing Mail</strong>.</li>
<li>Click on the <strong>Disable Outgoing Mail </strong>button.</li>
</ol>
<p class="mce-root"/>
<p>Once you have disabled outgoing mail, Jira will no longer send out notifications. If you want to re-enable outgoing mail, simply click on the Enable Outgoing Mail button, and Jira will start sending out emails again.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating mail handlers to process incoming emails</h1>
                
            
            
                
<p>Jira is not only able to send emails to users, but also to poll and process emails. It can also create issues or add comments to existing issues. When set up correctly, this can be a powerful way to let your users interact with Jira.</p>
<p>In this recipe, we will set up Jira to poll incoming emails so that it can create new issues and add comments to the existing issues. This is useful in a help-desk scenario where customers can write an email to the support email address of the company and let Jira automatically create issues from them.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Since Jira will be polling email from an inbox, you need to have its connection details, including the following:</p>
<ul>
<li>The protocol it supports (for example, <strong>POP </strong>or <strong>IMAP</strong>)</li>
<li>Authentication details</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>The first step to configure Jira for processing incoming email is to set up the inboxes that Jira will use to poll the email from:</p>
<ol>
<li>Navigate to Administration &gt; System &gt; Incoming Mail.</li>
<li>Click on the Add POP / IMAP mail server button.</li>
<li>Enter a name for the new mail server. We will be using this when adding the mail handler later.</li>
</ol>
<p> </p>
<ol start="4">
<li>Provide the credentials and click on the Test Connection<strong> </strong>button to make sure that Jira is able to connect to the mail server. If the test is successful, click on the Add button. After we have set up the mail inbox, we can set up what are known as mail handlers in Jira to poll and process email. In this recipe, we will use the most common handler to create and/or comment on issues from email contents.</li>
<li>Click on the Add incoming mail handler<strong> </strong>button.</li>
<li>Enter a name for the mail handler.</li>
<li>Select the mail server you just added from the Server drop-down list.</li>
</ol>
<p>You can use the Local Files option to test your configuration. This allows you to place a test email on the filesystem so that you do not have to send test emails all the time.</p>
<ol start="8">
<li>Set the Delay<strong> </strong>timer in minutes for how often the handler should poll for new emails. Generally, you should not set the time too short: <kbd>5</kbd> minutes is usually a good delay.</li>
<li>Select the <kbd>Create a new issue or add a comment to an existing issue</kbd> handler.</li>
<li>Click on the Next button to configure the mail handler, as shown in the following screenshot:</li>
</ol>
<div><img src="img/93e8b645-4d2e-4d35-8af5-aa2272442363.png" style="width:25.92em;height:17.17em;"/></div>
<ol start="11">
<li>Enter the mail handler configuration details. The most important configurations are as follows:
<ul>
<li><strong>Project</strong>: You can only select one project. All emails from the inbox will go into the selected project.</li>
<li><strong>Issue Type</strong>: This is the issue type from which new issues will be created.</li>
<li><strong>Create Users</strong>: Check this if you want to automatically create a new account based on the email addresses. Note that this will count toward your license seat.</li>
<li><strong>Default Reporter</strong>: If you do not want to create new accounts, you can select an existing user who will be the reporter for all new issues created from emails.</li>
</ul>
</li>
</ol>
<ol start="12">
<li>Click on the Add button to create the mail handler.</li>
</ol>
<p>The following table explains the various parameters that you need to set:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td style="width: 13.4435%"><strong>Parameter</strong></td>
<td class="CDPAlignCenter CDPAlign" style="width: 85.5565%"><strong>Description</strong></td>
</tr>
<tr>
<td style="width: 13.4435%">Project</td>
<td style="width: 85.5565%">This is where the project's new issues will be created. Note that this is only used for creating new issues. While adding comments, this is ignored, as comments will be added to the issue key specified in the subject.</td>
</tr>
<tr>
<td style="width: 13.4435%">Issue Type</td>
<td style="width: 85.5565%">This is the issue type for all newly created issues.</td>
</tr>
<tr>
<td style="width: 13.4435%">Strip Quotes</td>
<td style="width: 85.5565%">If this option is checked, the text wrapped in quotes will not be used as an issue description or comment.</td>
</tr>
<tr>
<td style="width: 13.4435%">Catch Email Address</td>
<td style="width: 85.5565%">An email with the specified address will be processed if this option is selected.</td>
</tr>
<tr>
<td style="width: 13.4435%">Bulk</td>
<td style="width: 85.5565%">This option dictates how to process autogenerated emails, such as an email from Jira. This is to prevent the creation of a loop where Jira sends email to the same inbox that it is polling the email from.</td>
</tr>
<tr>
<td style="width: 13.4435%">Forward Email</td>
<td style="width: 85.5565%">This option sets an address to which Jira can forward all the emails that it cannot process.</td>
</tr>
<tr>
<td style="width: 13.4435%">Create Users</td>
<td style="width: 85.5565%">This option creates a new user if the sender's email address cannot be found.</td>
</tr>
<tr>
<td style="width: 13.4435%">Default Reporter</td>
<td style="width: 85.5565%">This option sets the user who will be used as the reporter if the sender's email address cannot be found.</td>
</tr>
<tr>
<td style="width: 13.4435%">Notify Users</td>
<td style="width: 85.5565%">Uncheck this option if you do not want Jira to send an account-related email.</td>
</tr>
<tr>
<td style="width: 13.4435%">CC Assignee</td>
<td style="width: 85.5565%">Check this option if you want the first user in the CC list to be the issue's assignee if a matching account can be found.</td>
</tr>
<tr>
<td style="width: 13.4435%">CC Watchers</td>
<td style="width: 85.5565%">Check this option if you want to add the CC list as watchers to the issue if matching accounts can be found.</td>
</tr>
</tbody>
</table>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p>The following screenshot shows these parameters:</p>
<div><img src="img/eb768386-bb51-4dca-b4a3-065654a6dc37.png"/></div>
<p>It's time to see the working information.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Mail handlers periodically poll for new emails from the selected incoming mail server and process them based on the handler used. The Create a new issue or add a comment to an existing issue handlers will create a new issue in Jira, where the email subject becomes the issue summary and the email body becomes the issue description. If the email subject contains an issue key to an existing issue, the email body will be added as a comment to the issue.</p>
<ul>
<li><strong>Add a comment from the non-quoted email body</strong>: This adds the email body that is not quoted with the <kbd>&gt;</kbd> or <kbd>|</kbd> symbols as a comment to an existing issue.</li>
<li><strong>Add a comment with the entire email body</strong>: This adds the entire email body as a comment to an existing issue.</li>
<li><strong>Create a new issue from each email message</strong>: This always creates a new issue from an email.</li>
<li><strong>Add a comment before a specified marker or a separator in the email body</strong>: This adds the email body <em>before </em>a marker line is specified as a regular expression. Contents <em>after </em>the marker will be ignored. This is useful when you do not want to include old contents from a forwarded email. Depending on the email client being used, you will need to use regular expressions (regex) to work out the text to be excluded. For most cases, the following regex will work:</li>
</ul>
<pre style="padding-left: 60px">/From: *|___.*|On .*wrote:|----Orig.*|On
.*(JIRA).*/</pre>


            

            
        
    

        

                            
                    <h1 class="header-title">Using email to update Jira issues</h1>
                
            
            
                
<p>Jira's out-of-the-box mail handlers mostly focus on creating new issues from emails or adding comments to existing issues, based on certain matching criteria. In this recipe, we will look at how to update an existing issue via email.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, we need to have the <strong>Enterprise Mail Handler for Jira</strong> (<strong>JEMH</strong>) app installed. You can download the app from <a href="https://marketplace.atlassian.com/plugins/com.javahollic.jira.jemh-ui" target="_blank">https://marketplace.atlassian.com/plugins/com.javahollic.jira.jemh-ui</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Once you have the app installed, the first step is to create a profile. You can think of a profile as a configuration scheme in Jira, such as a workflow scheme. The profile contains all aspects of the configuration settings that are needed for processing incoming emails. To create a new profile, go through the following steps:</p>
<ol>
<li>Navigate to Administration &gt; Manage apps &gt; Configure JEMH.</li>
<li>Select the Profiles option from the left-hand navigation panel.</li>
<li>Click the Create Profile button.</li>
<li>Enter a name for the profile, select <kbd>DEVELOPMENT</kbd> in the Readiness field, and click Create Profile:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/bfc95b45-cdf9-45cc-bd4a-53aa7d7737a6.png" style="width:31.75em;height:13.58em;"/></p>
<p>With the profile created, we now need to configure it so that the JEMH app will know how to process incoming emails. The first step is to create an incoming mail handler by going through the following steps:</p>
<ol>
<li>Navigate to Administration &gt; System &gt; Incoming Mail.</li>
<li>Click on the Add incoming mail handler button.</li>
<li>Enter a name for the new mail handler.</li>
<li>Select the Enterprise Mail Handler (JEMH) for Jira as the <strong>Handler</strong> option and click <strong>Next</strong>.</li>
<li>Select the JEMH profile we have just created and click Submit:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/6cbadd48-2115-49cd-8df3-018bc270f115.png" style="width:40.67em;height:24.58em;"/></p>
<p>So now that we have an incoming mail handler that is associated with our JEMH profile, the next step is to configure it to process our email content:</p>
<ol>
<li>Click on the <strong>Configure</strong> link for our JEMH profile.</li>
<li>Select the <strong>Field Processors</strong> option.</li>
<li>Enable the <strong>Colon Suffix (Mailform)</strong> option.</li>
<li>Click the <strong>Save</strong> button.</li>
</ol>
<p>You may choose any format or combination of formats for field processors, and it is usually a good idea to enable multiple processors so that Jira can understand and process more than one. The important point here is that, whichever option you choose, you need to communicate this with your end users so they will understand how to craft their emails so that they can be successfully processed by Jira.</p>
<p class="mce-root"/>
<p>Look at the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/7930addf-9fa7-47cf-bd2c-67ed67d0c4e1.png" style="width:39.75em;height:13.17em;"/></p>
<p>This is the minimum required configuration to set up an incoming mail handler so that you can update your issues with emails. With all the configurations in place, the easiest way to test things out is to use the test case feature provided by the app, which avoids the need to send a real email around to all interested users. We can set this up by going through the following steps:</p>
<ol>
<li>Select the Test Cases option from the left-hand navigation panel.</li>
<li>Click on the Create button.</li>
<li>Replace the Subject with the key of an existing issue in the Content textbox.</li>
<li>Add the following content under the <strong>Content</strong> textbox:</li>
</ol>
<pre style="padding-left: 60px">summary: This is a new updated summary       <br/>description: This issue is updated via an email.</pre>
<ol start="5">
<li>Click the Update and run button.</li>
</ol>
<p>You should now see the result of running the test case:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/0f4a19bf-d44c-4b71-b04e-b40921a49d6c.png" style="width:43.50em;height:12.50em;"/></p>
<p>As shown in the previous screenshot, and the issue you have referenced in the test case would have its summary and description values changed to the preceding content.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>The JEMH profile contains all the configurations needed for the app to process emails. By creating an incoming mail handler and selecting Enterprise Mail Handler for Jira (JEMH) as the handler, Jira will be able to pass on the processing to the JEMH app.</p>
<p>The one key configuration in our recipe is the field processors. The field processor determines how email content should be processed, which directly determines the format for our emails if we want them to be processed correctly. JEMH comes with several processors, and we have chosen to use the Colon Suffix processor, which has the format of <kbd>key:value</kbd>. So in our test-case email, we have the name of the field we want to update as the key and the new value we want to assign to the field as the value—for example, <kbd>summary: this is a new summary</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up a project-specific From email address</h1>
                
            
            
                
<p>By default, all notifications sent from Jira will have the same From address, configured as a part of the outgoing mail server; however, it is possible to override this at the project level so that each project can have its own From address. This can be very useful if you want to let users reply directly to notifications and have the reply added as a comment.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to set up a project-specific From address:</p>
<ol>
<li>Browse to the project from which you want to set up a specific From address.</li>
<li>Click on the Project settings<strong> </strong>option.</li>
</ol>
<ol start="3">
<li>Click on the pencil (edit) icon for the Email in Notifications<strong> </strong>section, as shown in the following screenshot:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/152dcb16-21c8-4803-a7ae-3bd100b141d3.png" style="width:28.00em;height:9.83em;"/></p>
<ol start="4">
<li>Enter the email address dedicated to the project.</li>
<li>Click on Update to apply the changes.</li>
</ol>
<p>You can revert to the default values by leaving the field blank.</p>


            

            
        
    </body></html>