<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Customize Application Navigation</h1>
                </header>
            
            <article>
                
<p class="chapter-content">A site map can be defined as a set of links through which a user can navigate and find their way around the website. In Dynamics 365 and in its earlier version, a site map is an XML file that is used for defining the navigation of the application or specific app module for the users. Until CRM 2016, there had been only one site map file for an organization. With the advent of apps in Dynamics 365, now we have one site map file for each of the app modules. As far as customizing the site map was concerned, until now we had to either update it using XML Editor, a text editor or some third-party tools. However, with Microsoft Dynamics 365 we have the built-in Site Map Designer in the product itself. This designer allows the administrator, customizers, or users with appropriate privileges to easily define navigation for an app by simply adding, dragging, and dropping the components within the Site Map Designer canvas. In this chapter, we will be covering the following points:</p>
<ul>
<li>Overview of the site map in Dynamics 365</li>
<li>Understanding the designer interface and its components—areas, group, and sub areas</li>
<li>Common operations that can be performed on the site map</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Overview of the site map</h1>
                </header>
            
            <article>
                
<p class="chapter-content">For every app that is configured, we will have a separate site map defined for it. By default, we will have a Dynamics 365 custom app configured during the set up of the Dynamics 365. We can also have other apps configured while provisioning the Dynamics 365 instance such as <span class="packt_screen">Sales</span>, <span class="packt_screen">Field service</span>, <span class="packt_screen">Project service automation</span>, or <span class="packt_screen">Customer service</span>, if we have opted for them while provisioning Dynamics 365. For now, let's try to understand the basics of using the Site Map Designer using Dynamics 365 for a Sales app. Suppose we have selected <span class="packt_screen">Sales</span> while provisioning Microsoft Dynamics 365, shown as follows:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="374" src="assets/d3621005-599e-4dff-944a-735ef5d886b7.png" width="383"/></div>
<div class="packt_infobox">The link for the <em>Dynamics 365 Trial with Enterprise Plan 1</em> can be found here: <a href="https://signup.microsoft.com/Signup?OfferId=bd569279-37f5-4f5c-99d0-425873bb9a4b&amp;dl=DYN365_ENTERPRISE_PLAN1">https://signup.microsoft.com/Signup?OfferId=bd569279-37f5-4f5c-99d0-425873bb9a4b&amp;dl=DYN365_ENTERPRISE_PLAN1</a>.</div>
<p class="mce-root">This will provision Dynamics 365 with a Sales app. This is how the navigation will look for the Sales app:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/55245fa1-85af-4dc3-8a9b-ecbc6297f856.png"/></div>
<p class="mce-root">Now, as we have covered the basics of site map, let us look at the Site Map Designer interface and what components it has and how we can use it to update our site map for sales.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Overview of Site Map Designer</h1>
                </header>
            
            <article>
                
<p class="mce-root">To access the Site Map Designer for our Sales app, perform the following steps:</p>
<ol>
<li>Log in to the Dynamics 365 Sales app with a user having System Customizer, System Administrator, or any appropriate security role to customize the site map.</li>
<li>Go to <span class="packt_screen">Settings</span> | <span class="packt_screen">Solutions.</span></li>
<li>Create a new solution with the appropriate details. For example, we have created a solution with the name of Site Map Solution, the publisher as default publisher, and the version as 1.0.0.0.</li>
</ol>
<div class="packt_infobox">We can also log in to the default <em>Dynamics 365 - custom</em> app and create a new solution and add the Sales App Site Map in it.</div>
<ol start="4">
<li>Click on <span class="packt_screen">Client Extensions</span> and add <span class="packt_screen">Sales App Site Map </span>in it, shown as follows:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="422" src="assets/32b54edb-b203-48c2-8eaf-d1e71ef609d5.png" width="670"/></div>
<div class="packt_tip">We can go to <span class="packt_screen">Settings</span> | <span class="packt_screen">Customizations</span> and update the site map in the default solution as well. However, as a best practice, we should create a separate solution and add the required components that need to be customized in it.</div>
<p class="mce-root">Double-clicking on it will open the <span class="packt_screen">Sales App Site Map</span> on the Site Map Designer for us to edit. The Site Map Designer canvas allows us to work with <span class="packt_screen">Area</span>, <span class="packt_screen">Group</span>, and <span class="packt_screen">Subarea</span> components:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="309" src="assets/f6f19284-84bb-4218-b904-dce1147959a3.png" width="260"/></div>
<p class="mce-root">Within the designer canvas, we can <span class="packt_screen">Add, Cut, Copy, Paste, Clone</span>, and <span class="packt_screen">Delete.</span></p>
<p class="mce-root">Let us look at these components in detail.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Understanding components in the site map</h1>
                </header>
            
            <article>
                
<p class="mce-root">Site map consists of three main components:</p>
<ul>
<li><span class="packt_screen">Area</span>: Area can be defined as the main node or area inside the navigation pane that consists of groups and their corresponding subarea. A new area can be added or the existing area can be updated or deleted. If an area doesn't consist of any visible subarea, the area will be hidden.</li>
<li><span class="packt_screen">Group</span>: Groups can be defined as a collection or group of subareas. Just like an area, a new group can be added or an existing group can be updated or deleted.</li>
<li><span class="packt_screen">Subarea</span>: A subarea can be defined as a navigation link within the area that defines what should load inside CRM's main pane when clicked. The subarea can point to a dashboard, an entity, a URL, or a web resource. Just like area and group, a new subarea can be added and an existing subarea can be updated or deleted.</li>
</ul>
<p class="mce-root">Referring to our Sales app interface:</p>
<ul>
<li><span class="packt_screen">Sales</span>, <span class="packt_screen">Marketing</span>, <span class="packt_screen">Settings</span>, and <span class="packt_screen">Training</span> are termed as areas</li>
<li><span class="packt_screen">My Work</span>, <span class="packt_screen">Customers</span>, <span class="packt_screen">Sales</span>, <span class="packt_screen">Collateral</span>, <span class="packt_screen">Marketing</span>, <span class="packt_screen">Goals</span>, and <span class="packt_screen">Tools</span> are groups within the Sales area</li>
<li><span class="packt_screen">Dashboards</span>, <span class="packt_screen">What's New</span>, and <span class="packt_screen">Activities</span> are subareas inside the <span class="packt_screen">My Work group</span>.</li>
</ul>
<p>The Sales area would have subareas specific to Sales, arranged inside what are termed as groups. Similarly, the Marketing, Settings and Training Area will have corresponding subareas inside the corresponding group. As shown in the following screenshot, the <span class="packt_screen">Marketing</span> Area has <span class="packt_screen">Dashboards</span>, <span class="packt_screen">Activities</span>, <span class="packt_screen">Accounts</span>, <span class="packt_screen">Contacts</span>, <span class="packt_screen">Leads</span>, <span class="packt_screen">Marketing </span><span class="packt_screen">Lists</span>, <span class="packt_screen">Campaigns</span>, <span class="packt_screen">Quick </span><span class="packt_screen">Campaigns</span>, and so on. It also has subareas specific to the marketing module. These subareas are arranged inside the <span class="packt_screen">My Work</span>, <span class="packt_screen">Customers</span>, <span class="packt_screen">Marketing</span>, <span class="packt_screen">Collateral, </span>and <span class="packt_screen">Tools</span> groups:</p>
<div class="mce-root CDPAlignCenter CDPAlign CDPAlignLeft"><img src="assets/ff089d67-a6ad-4816-87bd-238e00dcb4f4.png"/></div>
<p>Now, as we have got the overview of the site map components, let us look at the different properties of each of these components in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting to know the area, group, and subarea properties</h1>
                </header>
            
            <article>
                
<p class="mce-root">Let us look at the different properties of these components before we start customizing our Sales app navigation.</p>
<ul>
<li>The area component comprises of following properties:</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img height="376" src="assets/6b325c1b-258e-4f4d-8709-3d93b7b61790.png" width="510"/></div>
<ul>
<li>Group component shares most of the same properties as Area:</li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="360" src="assets/99bf8e74-a27f-4e99-92b3-abe466e0a107.png" width="511"/></div>
<div class="packt_tip"><span class="packt_screen">Set as Profile</span> property of Group might not be relevant for Dynamics 365, as the Workplace area has been discontinued starting CRM 2013.</div>
<p class="mce-root CDPAlignCenter CDPAlign">Subarea has few more properties compared to Area and Group:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><br/>
<img height="516" src="assets/85cdc0cf-1d55-44b9-ae45-cef6ab4fd5e5.png" width="513"/></div>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="515" src="assets/c6d7c015-be6a-4617-a9a7-6e77042c9e12.png" width="514"/></div>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="140" src="assets/9318859b-036b-4773-a8cd-c54714a2928d.png" width="509"/></div>
<ul>
<li>As we know that the site map is basically an XML file, any changes that we are doing through Site Map Designer are basically updating the site map's XML behind the scenes:</li>
<li>To get the Sales App Site Map definition, export the solution containing the Sales App Site Map client extension and unzip it. Then, open the <kbd>customizations.xml</kbd> file and search for the <kbd>SiteMap</kbd> tag.</li>
<li>The following is the sample XML for the My Work group of the Sales area inside the Sales App Site Map. We can see the <kbd>Area</kbd>, <kbd>Group</kbd>, and <kbd>SubArea</kbd> tags along with their corresponding attributes:</li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="assets/4fa3d7b7-532a-4a75-adf3-27aa7d4afd99.png"/></div>
<ul>
<li>As mentioned earlier, instead of using the Site Map Designer, we can manually update the site map's XML using any text editor, and can import back the solution (and publish it) to see the changes.</li>
</ul>
<div class="packt_infobox">Site map XML reference : <a href="https://msdn.microsoft.com/en-us/library/gg334430.aspx">https://msdn.microsoft.com/en-us/library/gg334430.aspx.</a></div>
<p class="mce-root">In this section, we looked at the properties of the area, group, and subarea components of Site Map Designer. In the next section, we will learn how to perform some basic operations such as updating, adding, deleting, and so on, on these components through Site Map Designer.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Common operations using Site Map Designer</h1>
                </header>
            
            <article>
                
<p class="mce-root">Now, as we have gone through all the properties of the components of site map in detail, let us see how we can perform some common operations using Site Map Designer.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Editing an existing component in the site map</h1>
                </header>
            
            <article>
                
<p>To edit an existing area, group, and subarea in the site map, we need to select that component in the designer and go to the <span class="packt_screen">properties</span> tab of that component. Let us take a simple example to understand this. Suppose we want to rename the existing <span class="packt_screen">Training</span> area to Help, we need to select the <span class="packt_screen">Training</span> area on the site map, go to its <span class="packt_screen">Properties</span> tab, and update its <span class="packt_screen">Title</span> property.</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f4d71b80-18f3-447b-ab39-cf596d87b350.png"/></div>
<p>Let us specify <span class="packt_screen">Help</span> as the value for the <span class="packt_screen">Title</span> property. This updates the area's title from Training to <kbd>Help</kbd>, as shown as follows:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="410" src="assets/e7b87e8b-2d6a-4ba3-9fb7-6e893db0e7bf.png" width="449"/></div>
<p>We can also update the title property of the site map components through inline editing. For this, hover over the component to reveal the pencil. We can click on the pencil icon to edit the <span class="packt_screen">Title</span>. <span>Similarly, we can edit or update the corresponding properties of the group and subarea components, and as we mentioned earlier, any changes made in the designer will reflect back in the XML for the site map.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding a component to the site map</h1>
                </header>
            
            <article>
                
<p class="mce-root">To add an area, group, or subarea to the site map, we need to click on the <span class="packt_screen">Add</span> button on the Action Bar in the <span class="packt_screen">Sitemap Designer</span>. Let's add an area here to understand this. Click on the <span class="packt_screen">Add</span> button and select <span class="packt_screen">Area</span>:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="360" src="assets/b0b24185-89f5-449b-9f76-6f5ae90c6f2f.png" width="371"/></div>
<p class="mce-root">Or, drag-and-drop the Area from the <span class="packt_screen">Components</span> tab.</p>
<p class="mce-root">Once added, we need to select the component (Area here), and then edit its properties in the <span class="packt_screen">Properties</span> tab. For example, the <span class="packt_screen">Properties</span> tab for the new Area component added is shown in the following image:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="483" src="assets/8cab78a0-db81-49c3-a717-48d459d3f789.png" width="260"/></div>
<p class="mce-root">This will add a new Area named <span class="packt_screen">New Area</span> in the site map.</p>
<p class="mce-root">Similarly, we can add or drag and drop new groups and subarea components in the Navigation and specify their properties.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Cutting, copying, and pasting a component to the site map</h1>
                </header>
            
            <article>
                
<p>Through Site Map Designer, we can also cut, copy, and paste site map components. Let's select our <span class="packt_screen">New Area</span> and click on the <span class="packt_screen">Cut</span> button on the Action Bar to cut the component. The component will be grayed out.</p>
<p>Similarly, we can select the component and click on the <span class="packt_screen">Copy</span> button to copy the component. The <span class="packt_screen">Paste</span> button gives us the option of pasting the component to the right or left in case of Area and Group components, shown as follows:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="244" src="assets/0f3ce459-e058-4500-a2f7-7a89715709ed.png" width="362"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Cloning a component to the site map</h1>
                </header>
            
            <article>
                
<p>To clone or make a copy of an existing Area, Group, and Subarea to the site map, we can select the component and click the <span class="packt_screen">Clone</span> button on the Action Bar in the <span class="packt_screen">Sitemap Designer</span>. The clone will add the respective component to the next component being cloned with the -Copy suffix added to its Title. For example, cloning the <span class="packt_screen">Sales</span> Area, as shown in the following image, will add a new area named <span class="packt_screen">Sales-Copy</span> next to the <span class="packt_screen">Sales</span> Area that is cloned:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="198" src="assets/b39fd9f7-0d07-4646-9ed6-a7d09f85a075.png" width="465"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Deleting a component from the site map</h1>
                </header>
            
            <article>
                
<p>To delete an Area, Group, or Subarea from the site map, select the component and either click <span class="packt_screen">Delete</span> from the Action bar or press the <span class="packt_screen">Delete</span> key:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="204" src="assets/d1dac548-440a-4a66-b0d1-317a03250b01.png" width="498"/></div>
<p>Deleting an Area will also delete the Group and Subarea in it. Similarly, deleting the Group will delete the Subarea in it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Organizing a component within the site map</h1>
                </header>
            
            <article>
                
<p>Using Drag and Drop, we can move the components around the site map before we rearrange it:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="217" src="assets/e4964b3c-cee7-4fdf-9fd8-46ac40d79617.png" width="441"/></div>
<p>For example, we can move the <span class="packt_screen">Sales</span> Area to be the last Area in the site map, <span class="packt_screen">My Work</span> to be the second group within the <span class="packt_screen">Sales</span> Area, <span class="packt_screen">Dashboard</span> as the last Subarea inside the <span class="packt_screen">My</span><span class="packt_screen">Work</span> Group, and so on, shown as follows:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="229" src="assets/826c7823-0e77-472f-ba68-535d3b0a01af.png" width="449"/></div>
<p>We can also move a Subarea to a different Group. For example, the <span class="packt_screen">Dashboards</span> Subarea can be moved to any of the other Groups such as <span class="packt_screen">Customer</span>, <span class="packt_screen">Sales</span>, <span class="packt_screen">Collateral</span>, and so on, and a Group to be part of a different Area. That is, we can move the <span class="packt_screen">My Work</span> Group to be part of the <span class="packt_screen">Settings</span>, <span class="packt_screen">Training</span>, and <span class="packt_screen">Sales</span> area.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Saving, validating, and publishing changes in the site map</h1>
                </header>
            
            <article>
                
<p>To reflect any of the preceding changes for the users, such as add, clone, delete, and so on, we need to click <span class="packt_screen">Save</span> and then <span class="packt_screen">Publish</span> it in the Site Map Designer canvas. Here, <span class="packt_screen">*Draft</span> indicates that there are unsaved changes:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="176" src="assets/788a64df-618b-4973-9dd8-4af3a05f84c5.png" width="264"/></div>
<p class="mce-root">On saving the changes and clicking on <span class="packt_screen">Publish</span>, it changes to <span class="packt_screen">Published</span> to indicate that changes have been applied and are available for the users to see:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="120" src="assets/379d16b6-1fae-4393-8a36-f5afb092d4e0.png" width="267"/></div>
<p class="mce-root">Clicking on the <span class="packt_screen">Save</span> button will also validate and show up if there are any errors in the site map. For example, if we have not provided values for any of the required fields or specified unallowed characters for any of the properties. In the following screenshot, we have not provided a value for the entity property in the Subarea and clicked on <span class="packt_screen">Save</span>, which is a mandatory field:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/ee174d40-58b8-421c-b86b-2a0a8c91c78c.png"/></div>
<p class="mce-root">This shows the <span class="packt_screen">ERROR MESSAGE</span> notification in the designer with all the details. We will only be able to save and then publish the changes after fixing the error.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding a Subarea component in the site map</h1>
                </header>
            
            <article>
                
<p class="mce-root">Let's take a simple scenario here to understand how we can add a new Subarea component. We realize that our Sales app users would be frequently accessing the Open Leads View inside CRM, so it would be helpful for them if we could add a Subarea for Open Leads View in the My Work Group in the Sales Area for them. To implement it, we will need to add a new Subarea inside the My Work Group of type URL. To do so, we need to click on <span class="packt_screen">Add</span> in the Action bar in <span class="packt_screen">Sitemap Designer</span> and add a new Subarea and drag and place it below the Activities SubArea in the My Work Group:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="361" src="assets/e8fa0bd2-26c6-490c-9220-8fd0354fa1c2.png" width="279"/></div>
<p class="mce-root">Here, the URL pattern for the view needs to be the following:</p>
<pre>=/_root/homepage.aspx?etc=&lt;entity code &gt;&amp;viewid=%7b&lt;GUID value of view id&gt;%7d"</pre>
<p class="mce-root">For the <kbd>etc</kbd> and <kbd>viewid</kbd> query parameters, we need to go to the <span class="packt_screen">Open Leads</span> view in CRM and click on the <span class="packt_screen">EMAIL A LINK| </span><span class="packt_screen">Of Current View</span> ribbon button to get the link:</p>
<div class="CDPAlignCenter CDPAlign"><img height="89" src="assets/77ae0149-95f6-4b06-921d-d16fb0cf956c.png" width="384"/></div>
<p class="mce-root">The link will have the value of <kbd>etc</kbd> and <kbd>viewid</kbd>. We will then copy the value of the <kbd>etc</kbd> and <kbd>viewid</kbd> query string parameters from the link. We can then set the properties for our new <span class="packt_screen">SUB AREA</span>, shown as follows:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="542" src="assets/e20b976b-4983-4845-a914-fe09a03fcb70.png" width="324"/></div>
<p class="mce-root">We will save and then publish it. After publishing, inside the Sales app the user will be able to see the new Subarea named <span class="packt_screen">Open Leads</span>:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="292" src="assets/8e9b2064-1182-42f7-b429-0f8eb9f8d26d.png" width="260"/></div>
<p class="mce-root">Clicking on the <span class="packt_screen">Open Leads</span> Subarea will open the <span class="packt_screen">Open Leads</span> view, shown as follows:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="205" src="assets/e2ce4e07-dfe6-4bd7-bc1a-dd057ea482cf.png" width="381"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Hiding a Subarea component in the site map</h1>
                </header>
            
            <article>
                
<p class="mce-root">As we saw earlier, the Subarea component has a privilege property. It defines whether to show or hide the Subarea based on privileges the user has through the security roles assigned. Let us try to understand this with an example as well. Suppose we want to show the Open Leads Subarea we just added to only those users who have a Create privilege on the Lead entity. To define this, let us go back to the <span class="packt_screen">Properties</span> tab of the Open Leads Subarea in Site Map Designer. There, we need to go to <span class="packt_screen">Privileges</span> inside the <span class="packt_screen">Advanced</span> section. Inside the Entity drop-down, we can select the Lead entity and click on the <span class="packt_screen">+</span> (plus) button to add the record. We will leave all the checkboxes unchecked, except <span class="packt_screen">Create</span>:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="284" src="assets/9726b6e3-0a4f-4f80-905f-b061d04452c6.png" width="308"/></div>
<p class="mce-root">Save and publish the changes. Now, let us log in with the user that has only the Salesperson security role assigned. Here, we have updated the security role and have set <span class="packt_screen">None</span> for <span class="packt_screen">Create</span> Privilege on <span class="packt_screen">Lead</span> Entity; that is, the first option that we see in the following screenshot:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="261" src="assets/51841768-0243-4a37-ac09-a5e31c903cc3.png" width="404"/></div>
<p class="mce-root">The users who do not have the Create privilege on the Lead record, will not be able to see the Open Leads Subarea in their site map. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Passing parameters to a URL from the site map</h1>
                </header>
            
            <article>
                
<p class="mce-root">As we saw earlier, the Subarea component has a Parameter Passing checkbox property. It specifies whether to pass information about the organization and language context to the URL. The property is only available for Subareas of type web resource or URL. Suppose we have the following URL defined in our URL property of Subarea:<span class="URLPACKT"><br/>
<kbd>http://mydomain/mypage.aspx</kbd>.<br/></span>Checking the Parameter Passing checkbox will pass the following parameters to it:<span class="URLPACKT"><br/>
<kbd>http://mydomain/mypage.aspx/?orglcid=1033&amp;orgname=org29d341dd&amp;userlcid=1033</kbd>.<br/></span></p>
<ul>
<li><kbd>orglcid</kbd>: language code identifier of the base language of the organization</li>
<li><kbd>orgname </kbd><span>:</span> unique name of the organization</li>
<li><kbd>userlcid</kbd><span>: </span>language code identifier used by the current user</li>
</ul>
<p class="mce-root">This information could be used to create solutions that support multiple languages.</p>
<div class="packt_infobox">Creating solutions that support multiple languages is detailed at <a href="https://msdn.microsoft.com/en-us/library/hh670609.aspx#Anchor_0">https://msdn.microsoft.com/en-us/library/hh670609.aspx#Anchor_0</a>.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Editing the site map and support for clients</h1>
                </header>
            
            <article>
                
<p class="mce-root">Let us look briefly at separate ways of editing the site map apart from Site Map designer and the ways in which clients are supported for the different type of site map that we now have in Dynamics 365.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Site map editors</h1>
                </header>
            
            <article>
                
<p class="mce-root">A site map, as we essentially know, is an XML file. Any XML text editor is good enough to edit site map XML files. For this, we can export the unmanaged solution that contains the site map XML, edit it either in NotePad, Visual Studio, or any other XML editor, and import it back. The important thing to remember here is, if we are importing the site map as a managed solution, it will create a new site map record with all the latest changes, and in the case of unmanaged, the existing site map XML is overwritten.</p>
<div class="packt_infobox">Editing the site map XML with schema validation is detailed at <span class="URLPACKT"><a href="https://msdn.microsoft.com/en-us/library/gg334493(v=crm.8).aspx">https://msdn.microsoft.com/en-us/library/gg334493(v=crm.8).aspx</a>.</span></div>
<p class="mce-root">Apart from Site Map Designer, we can use one of the third-party site map editors to edit the site map. One of the most popular tools is site map editor that is included as part of the XRM Tool Box. This is how our Sales App Site Map loads up inside site map editor:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="450" src="assets/1635c806-3831-488b-b9a8-ac23fde32972.png" width="336"/></div>
<p class="mce-root">The tool makes it easy to edit the site map compared to editing the XML manually. The tool has been one of the most popular tools for editing site maps and has been available since CRM 2011. The tool has been recently updated to support multiple site maps available in Dynamics 365. The other option is programmatically updating the site map. For this, we can make use of the site map entity and update its <kbd>sitemapxml</kbd> property, shown as follows:</p>
<ul>
<li>Create an object of the site map entity:</li>
</ul>
<pre style="padding-left: 90px">Entity siteMap = new Entity["sitemap"]; </pre>
<ul>
<li>Update its <kbd><span>sitemapxml</span></kbd> property with valid XML:</li>
</ul>
<pre style="padding-left: 90px">siteMap["sitemapxml"] = "valid site map xml"; </pre>
<ul>
<li>Update the entity using Organization Service's instance:</li>
</ul>
<pre style="padding-left: 90px">service.Update(siteMap); </pre>
<ul>
<li>Publish the changes using the <kbd>PublishXmlRequest</kbd> class:</li>
</ul>
<pre style="padding-left: 90px">PublishXmlRequest request = new PublishXmlRequest();<br/> request.ParameterXml = "&lt;importexportxml&gt;&lt;sitemaps&gt;&lt;sitemap&gt;&lt;/sitemap&gt;&lt;/sitemaps&gt;&lt;/importexportxml&gt;";<br/> service.Execute(request);</pre>
<p class="mce-root">We can also create and delete app-specific site map records programmatically. However, it is recommended you use Site Map Designer instead of doing it programmatically. Another point to note is that the default site map record cannot be created or deleted.</p>
<div class="packt_tip">It is strongly recommended that we export the existing site map XML file and save a copy of it before we start editing, which can help us to restore it back in case of any errors while editing.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Supported clients</h1>
                </header>
            
            <article>
                
<p class="mce-root">The default site map, which is the site map for Dynamics 365 – custom app is supported for both Dynamics 365 web applications and Dynamics 365 for Outlook. The site maps for any new custom apps, or the business apps such as Sales, Customer Service, Field Service, and Project Service Automation, are only supported by Dynamics 365 web applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p class="mce-root">In this chapter, we saw how the site map has evolved in Dynamics 365. Now, we can have multiple site maps per app and the built-in Site Map Designer tool in the product itself. We also had a detailed look at the new Site Map Designer and some common operations that can be performed through it. In the next chapter, we will cover the new Visual Process Designer and how it can be used to create business process flows with intuitive drag and drop capabilities.</p>
<p> </p>
<p class="mce-root"/>


            </article>

            
        </section>
    </body></html>