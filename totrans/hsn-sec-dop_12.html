<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Security Testing Toolkits</h1>
                
            
            <article>
                
<p class="calibre2"><span class="calibre6">In the previous chapter, we looked at</span> <span class="calibre6">w</span><span class="calibre6">hite box</span> <span class="calibre6">testing tips. In this chapter, we will learn about a common (but not a comprehensive) set of security testing tools. The major elements of a network that involve security testing include web and mobile connections, configuration, communication, third-party components, and sensitive information. We will look at the testing tips and tools for each element. Furthermore, we will also learn how these tools can be executed both automatically and as tools that are built into continuous integration.</span><br class="calibre5"/></p>
<p class="calibre2">We will cover the following topics in this chapter:</p>
<ul class="calibre10">
<li class="calibre11">General security testing toolkits</li>
<li class="calibre11">Automation testing criteria</li>
<li class="calibre11">Behavior-driven security testing frameworks</li>
<li class="calibre11">Android security testing</li>
<li class="calibre11">Secure infrastructure configuration</li>
<li class="calibre11">Docker security scanning</li>
<li class="calibre11">Integrated security tools</li>
</ul>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">General security testing toolkits</h1>
                
            
            <article>
                
<p class="calibre2">The objective of providing security testing toolkits is for project teams to understand what tools are available and apply the tools that they judge to be appropriate based on the business application scenario. There are many kinds of security testing tools. An organization may define one general testing toolkit for all projects, and also suggest other security testing tools based on those specific domains, such as automation, infrastructure, Docker, and BDD:</p>
<p class="cdpaligncenter1"><img src="../images/00038.jpeg" class="calibre106"/></p>
<p class="calibre2">There are many kinds of Linux security distributions that have been installed and preconfigured with security tools. Kali, BlackArch, and PentestBox are the common Linux security distributions. PenetestBox is recommended because it doesn't need a Linux virtual machine environment to execute Linux utilities, and it can be executed natively on Windows. PenetestBox also includes many security tools, as does Kali Linux. For more information on each tool, go to the following links:</p>
<ul class="calibre10">
<li class="calibre11">Kali Linux: <a href="https://www.kali.org/" class="calibre9">https://www.kali.org/</a></li>
<li class="calibre11">BlackArch: <a href="https://blackarch.org/" class="calibre9">https://blackarch.org/</a></li>
<li class="calibre11">PentestBox: <a href="https://pentestbox.org/" class="calibre9">https://pentestbox.org/</a></li>
</ul>
<p class="calibre2"><span class="calibre6">As there can be hundreds of security tools in Kali or BlackArch Linux, it may not be feasible to require the security testing team to execute the security testing with all of the tools. It's suggested that you familiarize yourself with some of the key and common security tools.</span></p>
<p class="calibre2"/>
<p class="calibre2"><span class="calibre6">The following table shows the recommended minimum security testing toolset (only open source or free tools are listed here):</span></p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Area that is being security checked</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Common open source security tools</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">WhiteBox review</p>
</td>
<td class="calibre28">
<p class="calibre2">GraudIT or GREP-IT</p>
<p class="calibre2">These tools are recommended because they don't require a whole buildable source code to identify the security issue for different programming languages:</p>
<ul class="calibre10">
<li class="calibre11">GraudIT: <a href="https://github.com/wireghoul/graudit" class="calibre9">https://github.com/wireghoul/graudit</a></li>
<li class="calibre11"><span>GREP-IT:</span><a href="https://github.com/floyd-fuh/crass/blob/master/grep-it.sh" class="calibre9"><span> </span></a><a href="https://github.com/floyd-fuh/crass/blob/master/grep-it.sh" class="calibre9">https://github.com/floyd-fuh/crass/blob/master/grep-it.sh</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Web</p>
</td>
<td class="calibre28">
<p class="calibre2">BurpSuite, OWASP ZAP, Vega, SQLmap, Arachni</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Vulnerability</p>
</td>
<td class="calibre28">
<p class="calibre2">Nessus, OpenVAS, OpenSCAP, NMAP</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Networking</p>
</td>
<td class="calibre28">
<p class="calibre2">NMAP, WireShark, TCPDump, Hping, SSLScan, SSLyze, masscan</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Automation testing criteria</h1>
                
            
            <article>
                
<p class="calibre2">We would like most basic and obvious web security testing cases to be done automatically while human testing is focused on deeper security issue reviews. The objective of <span class="calibre6">automated</span><span class="calibre6"> web security testing is to integrate the security testing tools with a continuous integration framework, such as Jenkins. The web security testing can be automatically triggered every time the build is submitted. To be able to integrate web security testing tools with Jenkins, there are several key criteria that we need to consider:</span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">Command console</strong>: Most security testing tools provide a command console or GUI interface to operate the security testing procedures. It would be ideal for the tool to provide both interfaces. The command console can be used for Jenkins to trigger the execution of the security testing, and the GUI can help the human testing. From the automated testing point of view, the <strong class="calibre1">command-line interface</strong> (<strong class="calibre1">CLI</strong>) is a minimum requirement to integrate with Jenkins. The CLI interface also helps us to integrate with the unit test framework or BDD framework.</li>
<li class="calibre11"><strong class="calibre1">API interface</strong>: The web security testing can be executed in a standalone attacker mode or a proxy mode. The API interface will allow us to interact with the testing tool programmatically during runtime. For example, the OWASP ZAP provides a REST API to automate all the operations using Python and also the ZAP CLI to interact with ZAP from the command line. </li>
<li class="calibre11"><strong class="calibre1"><span>Output formats</span></strong><span>: </span><span>Most web security testing tools provide different kinds of reporting formats, such as HTML, PDF, XML, CSV, JSON, or console output. CSV, JSON, and XML are considered the basics if we would like to import the testing results together. </span><span>Because of the various security</span> tools<span> and large quantities of results in the daily report, it's suggested that you apply integrated security testing tools, such as OWASP DefectDojo, </span><span>to consolidate all the testing results in one dashboard (this option will be discussed later). </span>In <span>addition, some tools may provide the Jenkins plugin, which can help you to output the results in the Jenkins management console. </span></li>
</ul>
<p class="calibre2">Based on these criteria, the suggested web security testing tools for automation are summarized in the following table. OWASP ZAP, Arachni, and W3af are three open source web security testing tools that provide CLI, API, and web GUI interfaces. Nikto and Wapiti are also good choices if you are looking for lightweight command-line tools. For web security testing, we also suggest using one additional tool to do the scanning because of the false positive rate of each tool.</p>
<p class="calibre2">Just be aware that the web security automated test can't complete all web security tasks. Some testing scenarios still require a human security tester to guide the tool and perform further verification, such as authentication, web page authorization, business logic-related tests, and multiple order submissions. The following table displays the tools and their features:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Web GUI</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">CLI</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">REST API</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">OWASP ZAP</strong></p>
<p class="calibre2"/>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">ZAP CLI</p>
</td>
<td class="calibre28">
<p class="calibre2">ZAP API </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Arachni</strong></p>
<p class="calibre2"/>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
<p class="calibre2">(It also provides Ruby libraries.)</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">W3af</strong></p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Nikto</strong></p>
</td>
<td class="calibre28">
<p class="calibre2">n/a</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">n/a</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Wapiti</strong></p>
</td>
<td class="calibre28">
<p class="calibre2">n/a</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">n/a</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Behavior-driven security testing framework</h1>
                
            
            <article>
                
<p class="calibre2"><span class="calibre6">BDD security testing is very suitable when your security testing reports will be shared with external vendors, or even internal, cross-team communication to understand what security testing cases are being executed. In addition, BDD security tests can help you to integrate all of the various kinds of security testing tools and consolidate testing reports based on the framework. </span></p>
<p class="calibre2"/>
<p class="calibre2">Let's look at a simple example to understand what behavior-driven security testing is. Under the behavior-driven security testing framework, the security testing scripts are the testing cases that are written in a human-readable language. It makes the security testing cases, and testing results, easily understood by non-security professionals. Here is an example of this human-readable script:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Scenario: The attack may execute a system command to gain valuable information.</strong></p>
<p class="calibre2"><strong class="calibre4">Precondition: Given the "ping" command line binary is available on the OS.</strong></p>
<p class="calibre2"><strong class="calibre4">When I launch a "ping" attack with:</strong></p>
<p class="calibre2">    "Ping 127.0.0.1"</p>
<p class="calibre2"><strong class="calibre4">Then it should pass with regexp:</strong></p>
<p class="calibre2">    "&lt;1ms TTL=128"   </p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2"><span class="calibre6">The preceding example is a re-edited version based on </span>GauntIT<span class="calibre6"> testing scripts. You may also refer to </span><a href="https://github.com/gauntIT/gauntIt/tree/master/examples/" class="calibre9">https://github.com/gauntIT/gauntIt/tree/master/examples/</a><span class="calibre6"> for more examples of defining security testing cases. </span></p>
<p class="calibre2">There are three open source tools in the BDD security testing framework. If you are familiar with Java BDD cucumber, then BDD security will be your best choice. If you would like to use Python with a BDD framework, refer to MITTN. GauntIT is programming-language independent, and can be easily extended to execute any tools and verify the results by defining a regular expression. <span class="calibre6">GauntIT </span>allows security testers to focus on the definition of the testing script, and is suitable for testers who have little knowledge of Java or Python. The BDD security frameworks and their featured tools are listed in the following table:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">BDD security frameworks</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Default security tools included</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">BDD security</p>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2">OWASP ZAP, SSLyze, Nessus</p>
<p class="calibre2">BDD Security is based on Java and Cucumber. </p>
<ul class="calibre10">
<li class="calibre11">BDD Security: <a href="https://www.continuumsecurity.net/bdd-security/" class="calibre9">https://www.continuumsecurity.net/bdd-security/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">MITTN</p>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2">BurpSuite, SSlyze, and Radamsa API fuzzing</p>
<p class="calibre2">MITTN is based on Python and Behave. </p>
<ul class="calibre10">
<li class="calibre11"><span>MITTN: </span><a href="https://github.com/F-Secure/mittn" class="calibre9">https://github.com/F-Secure/mittn</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">GauntIT</p>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2">CURL, NMAP, SSLyze, SQLmap, Garmr, heartbleed, dirb, Arachni </p>
<ul class="calibre10">
<li class="calibre11"><span>GauntIT: </span><a href="http://gauntlt.org/" class="calibre9">http://gauntlt.org/</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Android security testing</h1>
                
            
            <article>
                
<p class="calibre2">Android security testing requires the reverse engineering analysis using APK files, permission analysis using Manifest, and internal components analysis using intents, services, broadcast, and content providers. Generally, the following are considered common testing tools when it comes to Android security testing:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Tools</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Description</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">ApkTool</p>
</td>
<td class="calibre28">
<p class="calibre2">ApkTool is used to perform reverse engineering for Android APK files.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">ByteCode View</p>
</td>
<td class="calibre28">
<p class="calibre2">ByteCode View is a Java Bytecode viewer and GUI Java decompiler.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Dex2JAR</p>
</td>
<td class="calibre28">
<p class="calibre2">Dex2JAR converts the DEX to a CLASS file.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">JADX</p>
</td>
<td class="calibre28">
<p class="calibre2">JADX converts the DEX to a Java decompiler.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">JD-GUI</p>
</td>
<td class="calibre28">
<p class="calibre2">JD-GUI is a GUI viewer that is used to read the source code of CLASS files.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Drozer</p>
</td>
<td class="calibre28">
<p class="calibre2">Drozer is an interactive security and attacks framework for the Android app.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Baksmali</p>
</td>
<td class="calibre28">
<p class="calibre2">Baksmali is an assembler/disassembler for the DEX format.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">AndroBugs</p>
</td>
<td class="calibre28">
<p class="calibre2">AndroBugs takes an APK file as input and performs an APK security vulnerabilities scan.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">AndroGuard</p>
</td>
<td class="calibre28">
<p class="calibre2">AndroGuard is a Python framework that can perform reverse engineering and malware analysis of the APK.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">QARK</p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Quick Android Review Kit</strong> (<span class="calibre6"><strong class="calibre4">QARK</strong>)</span> works similarly to AndroBugs. It detects security vulnerabilities for APK files.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">AppMon</p>
</td>
<td class="calibre28">
<p class="calibre2">AppMon can monitor API calls for both iOS and Android apps.</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">To install and configure the tools separately can be very time-consuming, so it is suggested that you use the following toolkits, which have <span class="calibre6">most of the Android security testing tools </span><span class="calibre6">preinstalled:</span><span class="calibre6"> </span></p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Toolkit</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Description</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">AndroL4b</p>
</td>
<td class="calibre28">
<p class="calibre2">AndroL4b is an Unbuntu-based virtual machine that includes not only security testing tools, but also vulnerable APK labs for practice.</p>
<ul class="calibre10">
<li class="calibre11">AndroL4b: <a href="https://github.com/sh4hin/Androl4b/" class="calibre9">https://github.com/sh4hin/Androl4b/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Appie</p>
</td>
<td class="calibre28">
<p class="calibre2">Appie is a portal for Android testing toolkits that can be executed in Windows without any installation and virtual machines. </p>
<ul class="calibre10">
<li class="calibre11"><span>Appie: </span><a href="https://manifestsecurity.com/appie/" class="calibre9">https://manifestsecurity.com/appie/</a> </li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">PentestBox</p>
</td>
<td class="calibre28">
<p class="calibre2">PentestBox is similar to Appie, but also includes lots of other non Android-related security testing tools. </p>
<ul class="calibre10">
<li class="calibre11"><span>PentestBox: </span><a href="https://tools.pentestbox.org/" class="calibre9">https://tools.pentestbox.org/</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">Last but not least, if you would like a fully automated APK and iOS security analysis that you can use by dragging and dropping an APK file to the Android security analysis platform, the MobSF (Mobile Security Framework) is what you will need, as shown in the following screenshots:  Source: <a href="http://github.com/MobSF/Mobile-Security-Framework-MobSF/" class="calibre9">http://github.com/MobSF/Mobile-Security-Framework-MobSF/</a> </p>
<p class="calibre2">MobSF/Mobile-Security-Framework-MobSF is licensed under the GNU General Public License v3.0.</p>
<p class="calibre2">The following screenshot shows the basic uses of MobSF.</p>
<p class="cdpaligncenter1"><img src="../images/00039.jpeg" class="calibre107"/></p>
<p class="calibre2"/>
<p class="calibre2">The following screenshot shows the MobSF security assessment results for the Manifest Analysis and the Code Analysis.</p>
<p class="cdpaligncenter1"><img src="../images/00040.jpeg" class="calibre107"/></p>
<div class="cdpaligncenter3">Source : https://github.com/MobSF/Mobile-Security-Framework-MobSF</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Securing infrastructure configuration</h1>
                
            
            <article>
                
<p class="calibre2">Securing the infrastructure configuration is vital in ensuring that the infrastructure configurations and system hardening are compliant with industry security best practices, such as CIS benchmarks, PCI-DSS, and the <strong class="calibre4">National Checklist Program</strong> (<span class="calibre6"><strong class="calibre4">NCP</strong>)</span>. If the DevOps team have applied infrastructure tools, such as Chef or Puppet, it's highly recommended that you define the security configuration on top of these tools to achieve the goal of <strong class="calibre4">infrastructure security as code</strong>. This helps to move the infrastructure security from the operation stage to the development stage. The Inspec, Hardening Framework, and ServerSpec tools are tools that are used for checking infrastructure security configurations. You can learn more about them at the following links:</p>
<ul class="calibre10">
<li class="calibre11">Inspec: <a href="https://www.inspec.io/" class="calibre9">https://www.inspec.io/</a></li>
<li class="calibre11">Hardening Framework: <a href="https://Dev-Sec.io" class="calibre9">https://Dev-Sec.io</a></li>
<li class="calibre11">Serverspec: <a href="https://serverSpec.org/" class="calibre9">https://serverSpec.org/</a></li>
</ul>
<p class="calibre2"/>
<p class="calibre2">For an infrastructure environment that is not deployed with configuration management tools (Puppet, Chef, Ansible, or SaltStack), the following scanning tools are suggested: </p>
<ul class="calibre10">
<li class="calibre11">Lynis Security Auditing: <a href="https://github.com/CISOfy/lynis" class="calibre9">https://github.com/CISOfy/lynis</a></li>
<li class="calibre11">OpenSCAP: <a href="https://www.open-scap.org/" class="calibre9">https://www.open-scap.org/</a></li>
<li class="calibre11">CIS Benchmarks: <a href="https://www.cisecurity.org/cis-benchmarks/" class="calibre9">https://www.cisecurity.org/cis-benchmarks/</a></li>
</ul>
<p class="calibre2">These infrastructure security configuration review tools will reduce the operation team's and security team's efforts. The operation team may apply these tools before services deployment, and they may also do a regular check on the production environment. The development and testing team may use these tools to know whether any secure configurations are missing or incorrectly configured.</p>
<p class="mce-root">For a sample of the scanning result of OpenSCAP, go to <a href="https://www.open-scap.org/wp-content/uploads/2015/09/ssg-rhel7-ds-xccdf.report.html" class="calibre9">https://www.open-scap.org/wp-content/uploads/2015/09/ssg-rhel7-ds-xccdf.report.html</a><span class="calibre6">.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Docker security scanning</h1>
                
            
            <article>
                
<p class="calibre2">Docker technology is widely used for software deployment and cloud infrastructure. For Docker-specific security testing, the Docker Bench defines several security best practices and configurations for Docker containers deployment. The "CIS Docker Community Edition Benchmark" defines a security recommendation on the Docker host, daemon, container images, and container runtime. Generally speaking, there are three kinds of Docker security tools that do one of three different things:</p>
<ul class="calibre10">
<li class="calibre11">Scan for Docker security best practices based on CIS (Docker Bench, Actuary)</li>
<li class="calibre11">Scan for known common vulnerabilities and exposures (CVEs) (Claire, Anchor Engine)</li>
<li class="calibre11">Runtime threat analysis (Falco, Dagda)</li>
</ul>
<p class="calibre2"/>
<p class="calibre2">Here are the open source security testing tools for Docker security:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Docker security tools</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Purpose and reference</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Docker Bench</p>
</td>
<td class="calibre28">
<p class="calibre2">Docker Bench is an automated script that checks the Docker security best practices compliance. </p>
<p class="calibre2">The scanning rules are based on the CIS Docker Security Benchmark. </p>
<ul class="calibre10">
<li class="calibre11"><span>Docker Bench Security: </span><a href="https://github.com/docker/docker-bench-security/" class="calibre9">https://github.com/docker/docker-bench-security/</a></li>
<li class="calibre11"><span>Docker Benchmark: </span><a href="https://benchmarks.cisecurity.org/" class="calibre9">https://benchmarks.cisecurity.org/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Actuary</p>
</td>
<td class="calibre28">
<p class="calibre2">Actuary works similarly to Docker Bench. Additionally, Actuary can scan based on user-defined security profiles from the Docker security community. </p>
<ul class="calibre10">
<li class="calibre11"><span>Actuary: </span><a href="https://github.com/diogomonica/actuary/" class="calibre9">https://github.com/diogomonica/actuary/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Clair</p>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2">Clair is a container image security static analyzer for CVEs. </p>
<p class="calibre2"><span class="calibre6">Clair: </span><a href="https://github.com/coreos/clair" class="calibre9">https://github.com/coreos/clair</a></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Anchor Engine</p>
<p class="calibre2">Anchor Cloud</p>
</td>
<td class="calibre28">
<p class="calibre2">Anchor Cloud and Anchor Engine scan the Docker images for CVEs. <span class="calibre6">Anchor Engine is a hosted tool and Anchor Cloud is a cloud-based tool</span>.</p>
<ul class="calibre10">
<li class="calibre11"><span>Anchor Engine: </span><a href="https://github.com/anchore/anchore-engine" class="calibre9">https://github.com/anchore/anchore-engine</a></li>
<li class="calibre11"><span>Anchor Cloud: </span><a href="https://Anchore.com/cloud/" class="calibre9">https://Anchore.com/cloud/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Falco</p>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2">Falco is a Docker container runtime security tool that can detect anomalous activities. </p>
<ul class="calibre10">
<li class="calibre11"><span>Falco: </span><a href="https://sysdig.com/opensource/falco/" class="calibre9">https://sysdig.com/opensource/falco/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Dagda</p>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2">Dagda is an integrated Docker security tool that provides runtime anomalous activities detection (Sysdig Falco), vulnerabilities (CVEs) analysis (OWASP dependency check, Retire.JS), and malware scanning (CalmAV). </p>
<ul class="calibre10">
<li class="calibre11"><span>Dagda:</span><a href="https://github.com/eliasgranderubio/dagda/" class="calibre9"> https://github.com/eliasgranderubio/dagda/</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Integrated security tools</h1>
                
            
            <article>
                
<p class="calibre2">As there are many security testing tools, we may like the testing results to be integrated into one dashboard, or to execute the tool through a unified interface. If you are looking for such an integrated security testing management tool, here are some of the open source and free tools to consider: </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Tools</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Tools included by default</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">JackHammer</p>
</td>
<td class="calibre28">
<p class="calibre2">JackHammer, provided by <span class="calibre6">Ola, </span>is an integrated security testing tool. It provides you with a dashboard to consolidate all the testing results. The key difference is that JackHammer includes mobile app security scanning and source code static analysis tools. The supported open source security scanners include Brakeman, Bundler-Audit, Dawnscanner, FindSecurityBugs, PMD, RetireJS, Arachni, Trufflehog, Androbugs, Androguard, and NMAP. The following screenshots show a typical example of its integrated interface.</p>
<ul class="calibre10">
<li class="calibre11"><span>JackHammer: </span><a href="https://github.com/olacabs/jackhammer" class="calibre9">https://github.com/olacabs/jackhammer</a></li>
<li class="calibre11"><span>Additional information: </span><a href="https://jch.olacabs.com/userguide/" class="calibre9">https://jch.olacabs.com/userguide/</a></li>
</ul>
<p class="calibre2"> </p>
<p class="cdpaligncenter1"><img src="../images/00041.jpeg" class="calibre108"/></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Faraday</p>
</td>
<td class="calibre28">
<p class="calibre2">Faraday is an integrated penetration testing environment, and provides a dashboard for all the testing results. It integrates with over 50 security tools.  </p>
<ul class="calibre10">
<li class="calibre11"><span>Faraday: </span><a href="https://www.faradaysec.com/#why-faraday" class="calibre9">https://www.faradaysec.com/#why-faraday</a></li>
<li class="calibre11"><span>Additional information:</span> <a href="https://github.com/infobyte/faraday/wiki/Plugin-List" class="calibre9">https://github.com/infobyte/faraday/wiki/Plugin-List</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Mozilla Minion</p>
</td>
<td class="calibre28">
<p class="calibre2">Mozilla Minion is also an integrated security testing tool that includes the following plugins by default: </p>
<ul class="calibre10">
<li class="calibre11">ZAP</li>
<li class="calibre11">Nmap</li>
<li class="calibre11">Skipfish</li>
<li class="calibre11">SSLScan</li>
</ul>
<p class="calibre2"><span class="calibre6">You can find Mozilla Minion at </span><a href="https://github.com/mozilla/minion/" class="calibre9">https://github.com/mozilla/minion/</a><span class="calibre6">.</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Penetration testing toolkit</p>
</td>
<td class="calibre28">
<p class="calibre2">Penetration testing toolkit provides a unified web interface for many Linux scanning tools, such as nmap, nikto, WhatWeb, SSLyze, fping, URLCrazy, lynx, mtr, nbtscan, automater, and shellinabox. </p>
<ul class="calibre10">
<li class="calibre11"><span>Penetration testing toolkit: </span><a href="https://github.com/veerupandey/Penetration-Testing-Toolkit" class="calibre9">https://github.com/veerupandey/Penetration-Testing-Toolkit</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Seccubus</p>
</td>
<td class="calibre28">
<p class="calibre2">The key advantage of using Seccubus is that it integrates with various kinds of vulnerability scanner testing results, and also compares the differences between each scan. It includes the following scanners: </p>
<ul class="calibre10">
<li class="calibre11">Nessus</li>
<li class="calibre11">OpenVAS</li>
<li class="calibre11">NMAP</li>
<li class="calibre11">Nikto</li>
<li class="calibre11">Medusa</li>
<li class="calibre11">SSLyze</li>
<li class="calibre11">SSL Labs</li>
<li class="calibre11">TestSSL.sh</li>
<li class="calibre11">SkipFish</li>
<li class="calibre11">ZAP</li>
</ul>
<p class="calibre2"><span class="calibre6">You can find Seccubus at</span> <a href="https://github.com/schubergphilis/Seccubus" class="calibre9">https://github.com/schubergphilis/Seccubus</a><span class="calibre6">. </span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">OWTF</p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Offensive Web Testing Framework</strong> (<span class="calibre6"><strong class="calibre4">OWTF</strong>)</span> is an integrated security testing standards OWASP testing guide and includes PTES and NIST tools. </p>
<ul class="calibre10">
<li class="calibre11"><span>OWTF: </span><a href="https://owtf.github.io/" class="calibre9">https://owtf.github.io/</a></li>
<li class="calibre11"><span>Additional information: </span><a href="https://owtf.github.io/online-passive-scanner/" class="calibre9">https://owtf.github.io/online-passive-scanner/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">RapidScan</p>
</td>
<td class="calibre28">
<p class="calibre2">RapidScan is a mult-itool that includes a web-vulnerability scanner. The security scanning tools that it contains include nmap, dnsrecon, uniscan, sslyze, fierce, theharvester, and golismero.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">DefectDojo</p>
</td>
<td class="calibre28">
<p class="calibre2">The OWASP DefectDojo is a security tool that can import and consolidate various security testing tool outputs into one management dashboard. </p>
<p class="calibre2"><span class="calibre6">DefectDojo: </span><a href="https://github.com/DefectDojo/django-DefectDojo" class="calibre9">https://github.com/DefectDojo/django-DefectDojo</a></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we learned about security testing toolkits. Based on the elements that are to be tested, there are Kali Linux, BlackArch, and PentestBox, which are the Linux security distributions that provide general security testing toolkits. As there are many tools, we suggested a minimum set of security tools to cover the white box review, web connection, vulnerability, and network security.</p>
<p class="calibre2">We also showed the key factors of security automation tools and compared the capabilities of some web security tools for supporting the CLI and REST API interfaces. The BDD Security framework was also introduced for the support of an automated framework. We looked at BDD Security, MITTN, and GauntIT.</p>
<p class="calibre2"/>
<p class="calibre2">Some other security testing tools were also discussed. For Android security testing, MobSF (Mobile Security Framework) was recommended for a quick-win, fully automated analysis platform. For infrastructure security, we looked at the Lynis Security Auditing, OpenSCAP, or CIS Benchmarks security scanning tools to detect insecure configurations. For Docker security, there are three kinds of security tools—namely, the CIS security configuration best practices, the scan for known vulnerabilities, and the runtime threat analysis. Finally, we introduced the integrated security tools, which can help you to integrate and consolidate all the testing results.</p>
<p class="calibre2">In the next chapter, we will discuss security automation with continuous integration. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Questions</h1>
                
            
            <article>
                
<ol class="calibre13">
<li value="1" class="calibre11">Which one of the following is not a Linux distribution for security testing? Ans: d
<ol class="calibre14">
<li value="1" class="calibre11">Kali Linux</li>
<li value="2" class="calibre11">BlackArch</li>
<li value="3" class="calibre11">PentestBox</li>
<li value="4" class="calibre11">OSSEC</li>
</ol>
</li>
<li class="calibre11" value="2">The OWASP ZAP, Vega, and Arachni tools are used for which of the following security tests?
<ol class="calibre14">
<li class="calibre11" value="1">Web security</li>
<li class="calibre11" value="2">Network security</li>
<li class="calibre11" value="3">Intrusion detection</li>
<li class="calibre11" value="4">Integrity monitoring</li>
</ol>
</li>
<li class="calibre11" value="3">Which one of the following tools is used for vulnerability scanning?
<ol class="calibre14">
<li class="calibre11" value="1">WireShark</li>
<li class="calibre11" value="2">OpenVAS</li>
<li class="calibre11" value="3">TCPDump</li>
<li class="calibre11" value="4">Hping</li>
</ol>
</li>
<li class="calibre11" value="4">Which one of the following is not a minimum criterion for automated testing?
<ol class="calibre14">
<li class="calibre11" value="1">GUI interface</li>
<li class="calibre11" value="2">CLI interface</li>
<li class="calibre11" value="3">API interface</li>
<li class="calibre11" value="4">Output formats</li>
</ol>
</li>
</ol>
<ol start="5" class="calibre13">
<li class="calibre11" value="5">What're the benefits of using BDD security?
<ol class="calibre14">
<li class="calibre11" value="1">Integration with all tools</li>
<li class="calibre11" value="2">Consolidated testing results</li>
<li class="calibre11" value="3">Easy to communicate across the team</li>
<li class="calibre11" value="4">All of the above</li>
</ol>
</li>
<li value="6" class="calibre11">Which one of the following is not used for Docker security?
<ol class="calibre14">
<li value="1" class="calibre11">Scanning for Docker security best practices based on CIS (Docker Bench, Actuary)</li>
<li value="2" class="calibre11">Appie</li>
<li value="3" class="calibre11">Scanning for known CVEs. (Claire, Anchor Engine)</li>
<li value="4" class="calibre11">Runtime threats analysis. (Falco, Dagda) </li>
</ol>
</li>
<li value="7" class="calibre11">Which of the following is not mainly focused on infrastructure security?
<ol class="calibre14">
<li value="1" class="calibre11">Inspec </li>
<li value="2" class="calibre11">Hardening Framework </li>
<li value="3" class="calibre11">Serverspec </li>
<li value="4" class="calibre11">PentestBox </li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Further reading</h1>
                
            
            <article>
                
<p class="calibre2">For more information visit the following URLs:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">GauntIT examples</strong>: <a href="https://github.com/gauntIT/gauntIt/tree/master/examples/" class="calibre9">https://github.com/gauntIT/gauntIt/tree/master/examples/</a></li>
<li class="calibre11"><strong class="calibre1">United States Government Configuration Baseline (USGCB)</strong>: <a href="https://csrc.nist.gov/projects/united-states-government-configuration-baseline/" class="calibre9">https://csrc.nist.gov/projects/united-states-government-configuration-baseline/</a></li>
<li class="calibre11"><strong class="calibre1">National Checklist Program Repository</strong>: <a href="https://nvd.nist.gov/ncp/repository" class="calibre9">https://nvd.nist.gov/ncp/repository</a></li>
<li class="calibre11"><strong class="calibre1">Docker Secure Deployment Guidelines</strong>: <a href="https://github.com/GDSSecurity/Docker-Secure-Deployment-Guidelines" class="calibre9">https://github.com/GDSSecurity/Docker-Secure-Deployment-Guidelines</a></li>
<li class="calibre11"><strong class="calibre1">Vulscan</strong>: <a href="https://github.com/scipag/vulscan" class="calibre9">https://github.com/scipag/vulscan</a></li>
<li class="calibre11"><strong class="calibre1">AttifyOS distribution for IoT security testing</strong>: <a href="https://github.com/adi0x90/attifyos" class="calibre9">https://github.com/adi0x90/attifyos</a> </li>
<li class="calibre11"><strong class="calibre1">Attify Firmware Analysis Toolkit</strong>: <a href="https://github.com/attify/firmware-analysis-toolkit" class="calibre9">https://github.com/attify/firmware-analysis-toolkit</a></li>
<li class="calibre11"><strong class="calibre1">CHIPSEC Platform Security Assessment Framework</strong>: <a href="https://github.com/chipsec/chipsec" class="calibre9">https://github.com/chipsec/chipsec</a></li>
<li class="calibre11"><strong class="calibre1">List of penetration testing resources</strong>: <a href="https://github.com/enaqx/awesome-pentest" class="calibre9">https://github.com/enaqx/awesome-pentest</a></li>
<li class="calibre11"><strong class="calibre1">List of penetration testing resources</strong>: <a href="https://github.com/wtsxDev/Penetration-Testing" class="calibre9">https://github.com/wtsxDev/Penetration-Testing</a></li>
<li class="calibre11"/>
</ul>


            </article>

            
        </section>
    </body></html>