["```\nEnable-PSRemoting -Force\nNew-NetFirewallRule -Name \"Allow WinRM HTTPS\" -DisplayName \"WinRM HTTPS\" -Enabled True -Profile Any -Action Allow -Direction Inbound -LocalPort 5986 -Protocol TCP\n$thumbprint = (New-SelfSignedCertificate -DnsName $env:COMPUTERNAME -CertStoreLocation Cert:\\LocalMachine\\My).Thumbprint\n$command = \"winrm create winrm/config/Listener?Address=*+Transport=HTTPS @{Hostname=\"\"$env:computername\"\"; CertificateThumbprint=\"\"$thumbprint\"\"}\"\ncmd.exe /C $command\n```", "```\n{\n\"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n\"contentVersion\": \"1.0.0.0\",\n\"parameters\": {\n\"name\": {\n\"type\": \"string\"\n},\n\"location\": {\n\"type\": \"string\"\n},\n\"sku\": {\n\"type\": \"string\"\n},\n\"publicIPAddressName\": {\n\"type\": \"string\"\n}\n},\n\"resources\": [\n{\n\"apiVersion\": \"2017-08-01\",\n\"name\": \"[parameters('name')]\",\n\"type\": \"Microsoft.Network/loadBalancers\",\n\"location\": \"[parameters('location')]\",\n\"sku\": {\n\"name\": \"[parameters('sku')]\"\n},\n\"dependsOn\": [\n\"[concat('Microsoft.Network/publicIPAddresses/', parameters('publicIPAddressName'))]\"\n],\n\"properties\": {\n\"frontendIPConfigurations\": [\n{\n\"name\": \"LoadBalancerFrontEnd\",\n\"properties\": {\n\"publicIPAddress\": {\n\"id\": \"[resourceId('test', 'Microsoft.Network/publicIPAddresses', parameters('publicIPAddressName'))]\"\n}\n}\n}\n]\n}\n},\n{\n\"apiVersion\": \"2017-08-01\",\n\"type\": \"Microsoft.Network/publicIPAddresses\",\n\"name\": \"[parameters('publicIPAddressName')]\",\n\"location\": \"[parameters('location')]\",\n\"sku\": {\n\"name\": \"[parameters('sku')]\"\n},\n\"properties\": {\n\"publicIPAllocationMethod\": \"Dynamic\",\n\"publicIPAddressVersion\": \"IPv4\"\n}\n}\n]\n}\n```", "```\n{\n \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\n \"contentVersion\": \"1.0.0.0\",\n \"parameters\": {\n \"vmSku\": {\n \"type\": \"string\",\n \"defaultValue\": \"Standard_D1\",\n \"metadata\": {\n \"description\": \"Size of VMs in the VM Scale Set.\"\n }\n },\n \"vmssName\": {\n \"type\": \"string\",\n \"metadata\": {\n \"description\": \"String used as a base for naming resources. Must be 3-61 characters in length and globally unique across Azure. A hash is prepended to this string for some resources, and resource-specific information is appended.\"\n },\n \"maxLength\": 61\n },\n \"instanceCount\": {\n \"type\": \"int\",\n \"metadata\": {\n \"description\": \"Number of VM instances (100 or less).\"\n },\n \"defaultValue\": 2,\n \"maxValue\": 100\n },\n \"adminUsername\": {\n \"type\": \"string\",\n \"metadata\": {\n \"description\": \"Admin username on all VMs.\"\n }\n },\n \"adminPassword\": {\n \"type\": \"securestring\",\n \"metadata\": {\n \"description\": \"Admin password on all VMs.\"\n }\n }\n },\n \"variables\": {\n \"vnetName\": \"vnet\",\n \"subnetName\": \"subnet\",\n \"subnetRef\": \"[resourceId('Microsoft.Network/virtualNetworks/subnets', variables('vnetName'), variables('subnetName'))]\",\n \"publicIPAddressName\": \"pip\",\n \"loadBalancerName\": \"loadBalancer\",\n \"loadBalancerFrontEndName\": \"loadBalancerFrontEnd\",\n \"loadBalancerBackEndName\": \"loadBalancerBackEnd\",\n \"loadBalancerProbeName\": \"loadBalancerHttpProbe\",\n \"loadBalancerNatPoolName\": \"loadBalancerNatPool\"\n },\n \"resources\": [\n {\n \"type\": \"Microsoft.Compute/virtualMachineScaleSets\",\n \"name\": \"[parameters('vmssName')]\",\n \"location\": \"[resourceGroup().location]\",\n \"apiVersion\": \"2017-03-30\",\n \"dependsOn\": [\n \"[concat('Microsoft.Network/virtualNetworks/', variables('vnetName'))]\",\n \"[resourceId('Microsoft.Network/loadBalancers', variables('loadBalancerName'))]\"\n ],\n \"sku\": {\n \"name\": \"[parameters('vmSku')]\",\n \"capacity\": \"[parameters('instanceCount')]\"\n },\n \"properties\": {\n \"overprovision\": \"true\",\n \"upgradePolicy\": {\n \"mode\": \"Manual\"\n },\n \"virtualMachineProfile\": {\n \"storageProfile\": {\n \"osDisk\": {\n \"createOption\": \"FromImage\",\n \"caching\": \"ReadWrite\"\n },\n \"imageReference\": {\n \"publisher\": \"MicrosoftWindowsServer\",\n \"offer\": \"WindowsServer\",\n \"sku\": \"2016-Datacenter\",\n \"version\": \"latest\"\n }\n },\n \"osProfile\": {\n \"computerNamePrefix\": \"[parameters('vmssName')]\",\n \"adminUsername\": \"[parameters('adminUsername')]\",\n \"adminPassword\": \"[parameters('adminPassword')]\"\n },\n \"networkProfile\": {\n \"networkInterfaceConfigurations\": [\n {\n \"name\": \"nic\",\n \"properties\": {\n \"primary\": true,\n \"ipConfigurations\": [\n {\n \"name\": \"ipconfig\",\n \"properties\": {\n \"subnet\": {\n \"id\": \"[variables('subnetRef')]\"\n },\n \"loadBalancerBackendAddressPools\": [\n {\n \"id\": \"[concat('/subscriptions/', subscription().subscriptionId,'/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', variables('loadBalancerName'), '/backendAddressPools/', variables('loadBalancerBackEndName'))]\"\n }\n ],\n \"loadBalancerInboundNatPools\": [\n {\n \"id\": \"[concat('/subscriptions/', subscription().subscriptionId,'/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', variables('loadBalancerName'), '/inboundNatPools/', variables('loadBalancerNatPoolName'))]\"\n }\n ]\n }\n }\n ]\n }\n }\n ]\n }\n }\n }\n },\n {\n \"type\": \"Microsoft.Network/virtualNetworks\",\n \"name\": \"[variables('vnetName')]\",\n \"location\": \"[resourceGroup().location]\",\n \"apiVersion\": \"2017-04-01\",\n \"properties\": {\n \"addressSpace\": {\n \"addressPrefixes\": [\n \"10.0.0.0/16\"\n ]\n },\n \"subnets\": [\n {\n \"name\": \"[variables('subnetName')]\",\n \"properties\": {\n \"addressPrefix\": \"10.0.0.0/24\"\n }\n }\n ]\n }\n },\n {\n \"type\": \"Microsoft.Network/publicIPAddresses\",\n \"name\": \"[variables('publicIPAddressName')]\",\n \"location\": \"[resourceGroup().location]\",\n \"apiVersion\": \"2017-04-01\",\n \"properties\": {\n \"publicIPAllocationMethod\": \"Dynamic\",\n \"dnsSettings\": {\n \"domainNameLabel\": \"[toLower(parameters('vmssName'))]\"\n }\n }\n },\n {\n \"type\": \"Microsoft.Network/loadBalancers\",\n \"name\": \"[variables('loadBalancerName')]\",\n \"location\": \"[resourceGroup().location]\",\n \"apiVersion\": \"2017-04-01\",\n \"dependsOn\": [\n \"[concat('Microsoft.Network/publicIPAddresses/', variables('publicIPAddressName'))]\"\n ],\n \"properties\": {\n \"frontendIPConfigurations\": [\n {\n \"name\": \"[variables('loadBalancerFrontEndName')]\",\n \"properties\": {\n \"publicIPAddress\": {\n \"id\": \"[resourceId('Microsoft.Network/publicIPAddresses', variables('publicIPAddressName'))]\"\n }\n }\n }\n ],\n \"backendAddressPools\": [\n {\n \"name\": \"[variables('loadBalancerBackendName')]\"\n }\n ],\n \"loadBalancingRules\": [\n {\n \"name\": \"roundRobinLBRule\",\n \"properties\": {\n \"frontendIPConfiguration\": {\n \"id\": \"[concat(resourceId('Microsoft.Network/loadBalancers', variables('loadBalancerName')), '/frontendIPConfigurations/', variables('loadBalancerFrontEndName'))]\"\n },\n \"backendAddressPool\": {\n \"id\": \"[concat(resourceId('Microsoft.Network/loadBalancers', variables('loadBalancerName')), '/backendAddressPools/', variables('loadBalancerBackendName'))]\"\n },\n \"protocol\": \"Tcp\",\n \"frontendPort\": 80,\n \"backendPort\": 80,\n \"enableFloatingIP\": false,\n \"idleTimeoutInMinutes\": 5,\n \"probe\": {\n \"id\": \"[concat(resourceId('Microsoft.Network/loadBalancers', variables('loadBalancerName')), '/probes/', variables('loadBalancerProbeName'))]\"\n }\n }\n }\n ],\n \"probes\": [\n {\n \"name\": \"[variables('loadBalancerProbeName')]\",\n \"properties\": {\n \"protocol\": \"Tcp\",\n \"port\": 80,\n \"intervalInSeconds\": \"5\",\n \"numberOfProbes\": \"2\"\n }\n }\n ],\n \"inboundNatPools\": [\n {\n \"name\": \"[variables('loadBalancerNatPoolName')]\",\n \"properties\": {\n \"frontendIPConfiguration\": {\n \"id\": \"[concat(resourceId('Microsoft.Network/loadBalancers', variables('loadBalancerName')), '/frontendIPConfigurations/', variables('loadBalancerFrontEndName'))]\"\n },\n \"protocol\": \"Tcp\",\n \"frontendPortRangeStart\": 50000,\n \"frontendPortRangeEnd\": 50019,\n \"backendPort\": 3389\n }\n }\n ]\n }\n }\n ]\n}\n```"]