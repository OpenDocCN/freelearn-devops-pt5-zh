<html><head></head><body>
		<div><h1 id="_idParaDest-100"><em class="italic"><a id="_idTextAnchor080"/>Chapter 4</em>: Sending Automated Notifications</h1>
			<p>Sending the right notification at the right time, with relevant contextual information, is important. It ensures that the desired action is taken by the recipient of the notification.</p>
			<p>Jira has always had the ability to send email notifications to users when changes to issues are made. However, these are, by necessity, very generalized. They do not contain relevant contextual information and are exceedingly difficult to customize.</p>
			<p>Automation rules allow us to overcome some of this limitation by enabling us to send custom notifications based on any rule condition we require, and not only via email; we also have the ability to send notifications to mobile phones via SMS and to chat applications such as <strong class="bold">Slack</strong> and <strong class="bold">Microsoft Teams</strong>.</p>
			<p>This chapter will introduce you to the notification capabilities in automation rules and show you how to send custom email notifications to users, groups, or indeed any valid email address. We'll also learn how to send messages to Slack channels and to Microsoft Teams channels. Finally, we'll learn how to use <strong class="bold">Twilio</strong> to send text messages via SMS to mobile devices.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Sending email notifications using automation</li>
				<li>How to send notifications to Slack</li>
				<li>How to send notifications to Microsoft Teams</li>
				<li>Sending SMS notifications with Twilio</li>
			</ul>
			<h1 id="_idParaDest-101"><a id="_idTextAnchor081"/>Technical requirements</h1>
			<p>The requi<a id="_idTextAnchor082"/>rements for this chapter are as follows:</p>
			<ul>
				<li><strong class="bold">Jira Cloud environment</strong>: If you don't already have access to Jira, you can create a free Jira Cloud account at <a href="https://www.atlassian.com/software/jira/free">https://www.atlassian.com/software/jira/free</a> and ensure that you have both Jira Software and Jira Service Management selected; or</li>
				<li><strong class="bold">Jira Server environment</strong>: If you are using Jira Server (available from <a href="https://www.atlassian.com/software/jira/download">https://www.atlassian.com/software/jira/download</a>), ensure that you have licenses for both Jira Software and Jira Service Management. In addition, you will also need to ensure that you install the <em class="italic">Automation for Jira</em> app from the Atlassian Marketplace.</li>
			</ul>
			<p>In both instances, you will need to have at least Project Administrator access to a Jira project.</p>
			<p>You will also need access to any of the following tools:</p>
			<ul>
				<li><strong class="bold">Slack</strong>: If you don't already have access to Slack, you can sign up for an account at <a href="https://www.slack.com">https://www.slack.com</a>.</li>
				<li><strong class="bold">Microsoft Teams</strong>: You can sign up for a Teams account at <a href="https://teams.microsoft.com">https://teams.microsoft.com</a> if you don't already have one.</li>
				<li><strong class="bold">Twilio</strong>: Sign up at <a href="https://www.twilio.com">https://www.twilio.com</a> if you need an account.</li>
			</ul>
			<p>You can download the latest code samples for this chapter from this book's official GitHub repository at <a href="https://github.com/PacktPublishing/Automate-Everyday-Tasks-in-Jira">https://github.com/PacktPublishing/Automate-Everyday-Tasks-in-Jira</a>.</p>
			<p>The Code in Action videos for this chapter are available at: <a href="https://bit.ly/2Y9p0cR">https://bit.ly/2Y9p0cR</a></p>
			<h1 id="_idParaDest-102"><a id="_idTextAnchor083"/>Sending email notifications using automation</h1>
			<p>Jira has <a id="_idIndexMarker194"/>always had the ability to <a id="_idIndexMarker195"/>send notifications to users via email when certain events take place, for example, when an issue has been updated or a comment has been added. You can also send emails to various users containing the results of saved filters on a scheduled basis and with Jira Service Management, you can create custom templates for sending notifications to customers via email in place of the standard event notifications.</p>
			<p>With the <strong class="bold">Send email</strong> action available to automation rules, we are able to extend this capability and send customized email notifications to any email address, user field, or group of users whenever the rule is activated.</p>
			<p>In this section, we'll<a id="_idIndexMarker196"/> look at how to introduce <a id="_idIndexMarker197"/>custom email notifications in automation rules and how these notifications can provide more specific context to the user.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You should always take care when creating custom email notifications in an automation rule. Make sure that you do not end up spamming the user with multiple notifications for the same event.</p>
			<p>Before we look at how to use email notifications in a rule, let's take a quick look at the <strong class="bold">Send email</strong> action itself.</p>
			<p>The following screenshot shows the fields available in the <strong class="bold">Send email</strong> action:</p>
			<div><div><img src="img/Figure_4.1_B16551.jpg" alt="Figure 4.1 – The Send email action&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.1 – The Send email action</p>
			<p>Let's <a id="_idIndexMarker198"/>take a quick look at each of the<a id="_idIndexMarker199"/> fields available in the <strong class="bold">Send email</strong> action:</p>
			<ol>
				<li>The <strong class="bold">To</strong> field is where we configure the email recipients. This can be in the form of one or more email addresses, or you can use the drop-down menu to select one or more Jira users or user groups. You can also use smart values and smart value functions to extract email addresses from issue fields.<p>You can additionally set the email <strong class="bold">CC</strong> and <strong class="bold">BCC</strong> fields in the same manner by clicking on the corresponding links under the <strong class="bold">To</strong> field to reveal the relevant input field.</p></li>
				<li>The <strong class="bold">Subject</strong> field is where we configure the email notification subject. You can use smart values and smart value functions in this field to reference data from any issue field.</li>
				<li>The <strong class="bold">Content</strong> field is where you supply the email message itself. You can use HTML tags to format the message and you can also use smart values and smart value functions to reference and manipulate any data from the issue that triggered the automation rule.</li>
				<li>Under the <strong class="bold">More options</strong> disclosure, you will find the <strong class="bold">From</strong> field. This field is only applicable to Jira Server and Data Center. It is not editable in Jira Cloud.<p>If you are using Jira Server or Data Center, you should ensure that the email address you enter here uses a valid sender domain as many SMTP servers are configured to only accept outgoing mail from valid domains in order to prevent themselves from being used as spam relays.</p></li>
				<li>The <strong class="bold">From name</strong> field is the human-readable sender name that will appear in the email notification. In Jira Cloud, this will default to <em class="italic">Jira automation</em>, and in Jira Server and Data Center, it will not be present.</li>
				<li>Optionally, if you want users to be able to reply to the email and potentially capture the reply as a comment against the issue, you can use the <strong class="bold">Reply to</strong> field to enter the email address you have configured in the <strong class="bold">Incoming Email</strong> system configuration for Software and Core projects, or, for Service Management projects, in the project's <strong class="bold">Email requests</strong> setting.<p>You should<a id="_idIndexMarker200"/> also ensure that <a id="_idIndexMarker201"/>the issue key is present in the <strong class="bold">Subject</strong> line if you make use of the <strong class="bold">Reply to</strong> feature.</p></li>
				<li>The <strong class="bold">Send as</strong> field allows you to select whether this notification will be sent as plain text or HTML. If the email notification is being sent to another application, you will probably want to set this to plain text.</li>
				<li>Leaving the <code>&lt;br&gt;)</code> in the message body for each new line when the <strong class="bold">Send as</strong> field is set to <strong class="bold">HTML</strong>. While convenient, it has the ability to play havoc with your HTML formatting if you forget to take this into consideration.<p class="callout-heading">Important note</p><p class="callout">If you are using Jira Server or Jira Data Center, you (or a Jira administrator) need to have configured an outgoing SMTP mail server in the <strong class="bold">Jira Administration</strong> | <strong class="bold">System</strong> | <strong class="bold">Outgoing Mail</strong> settings. Without a configured outgoing mail server, rules with email notifications will still execute successfully, however, no emails will actually be sent.</p></li>
			</ol>
			<p>Let's take a look at a rule that makes use of email notifications.</p>
			<h2 id="_idParaDest-103"><a id="_idTextAnchor084"/>Creating a rule to notify customers when a new version is released</h2>
			<p>In this<a id="_idIndexMarker202"/> example, we want to be able to notify customers when a new software version is released and list the items that were fixed or added in the newly released version.</p>
			<p>All the customers for this example belong to a user group called <em class="italic">Customers</em>. This will allow us to add any new customers to the group and not have to modify the automation rule for each new customer.</p>
			<p>Due to the differences in the way automation rules handle multiple issues in Jira Cloud and Jira Server, we'll present this rule twice in order to highlight the differences between the two environments.</p>
			<h3 id="_idParaDest-104">Using Jira Cloud to notify customers when a new version is released</h3>
			<p>In Jira Cloud, we need to <a id="_idIndexMarker203"/>make use of the <strong class="bold">Lookup issues</strong> action, which will allow us to iterate up to 100 issues in a single operation.</p>
			<p>Let's see how to build this rule using Jira Cloud:</p>
			<ol>
				<li value="1">In your Jira Software project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the project settings menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Select the <strong class="bold">Version released</strong> trigger and click <strong class="bold">Save</strong>.</li>
				<li>Next, select <strong class="bold">New action</strong> and then select the <strong class="bold">Lookup issues</strong> action.<p>Add the following query to the <strong class="bold">JQL</strong> field and click <strong class="bold">Save</strong>:</p><pre>fixVersion = {{version.name}}</pre><p>As you can see, we are using a smart value to reference the version name in this JQL query and so we cannot validate the query.</p></li>
				<li>Then, select <code>Customers</code></p><p><code>{{version.project.key}} version {{version.name}} is released!</code></p><p><strong class="bold">Content</strong>:</p><pre>We have just released Version &lt;strong&gt;<strong class="bold">{{version.name}}</strong>&lt;/strong&gt; for <strong class="bold">{{version.project.key}}</strong>.&lt;br/&gt;This version includes the following fixes and features:
&lt;ul&gt;
<strong class="bold">{{#lookupIssues}}</strong>
  &lt;li&gt;
    &lt;a href="<strong class="bold">{{url}}</strong>"&gt;<strong class="bold">{{issuetype.name}}</strong>: <strong class="bold">{{key}}</strong> - <strong class="bold">{{summary}}</strong>&lt;a/&gt;
  &lt;/li&gt;
<strong class="bold">{{/}}</strong>
&lt;/ul&gt;
We hope you enjoy it!&lt;br/&gt;&lt;br/&gt;
Regards,&lt;br/&gt;
The <strong class="bold">{{version.project.key}}</strong> development team</pre></li>
				<li>Next, expand the <strong class="bold">More options</strong> disclosure and uncheck the <strong class="bold">Convert line breaks to HTML line breaks</strong> option, as <a id="_idIndexMarker204"/>we have included explicit HTML line breaks in the content field, and then click <strong class="bold">Save</strong>.<p>Your rule should look similar to the following screenshot:</p><div><img src="img/Figure_4.2_B16551.jpg" alt="Figure 4.2 – Sending an email notification in Jira Cloud&#13;&#10;"/></div><p class="figure-caption">Figure 4.2 – Sending an email notification in Jira Cloud</p></li>
				<li>Finally, name <a id="_idIndexMarker205"/>your rule <code>Version released customer notification</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>Now that we've learned how to send an email notification in Jira Cloud using the <strong class="bold">Lookup issues</strong> action, let's see how we need to adjust this rule to work in Jira Server.</p>
			<h3 id="_idParaDest-105">Using Jira Server to notify customers when a new version is released</h3>
			<p>Automation rules in Jira Server do not have the <strong class="bold">Lookup issues</strong> action. Instead, we can choose to process issues in certain triggers and branch rules in bulk.</p>
			<p>Let's see <a id="_idIndexMarker206"/>how to replicate the version-released rule in Jira Server:</p>
			<ol>
				<li value="1">In your Jira Software project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Project automation</strong> link in the project settings menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Select the <strong class="bold">Version released</strong> trigger and click <strong class="bold">Save</strong>.</li>
				<li>Next, select <strong class="bold">Branch rule/related issues</strong> and select <strong class="bold">Issues fixed in version</strong> in the <strong class="bold">Type of related issues</strong> field.</li>
				<li>Expand the <strong class="bold">More options</strong> disclosure and ensure the <strong class="bold">Process all issues produced by this trigger in bulk</strong> option is checked and click <strong class="bold">Save</strong>.</li>
				<li>Now, select <code>Customers</code></p><p><code>{{version.project.key}} version {{version.name}} is released!</code></p><p><strong class="bold">Content</strong>:</p><pre>We have just released Version &lt;strong&gt;<strong class="bold">{{version.name}}</strong>&lt;/strong&gt; for <strong class="bold">{{version.project.key}}</strong>.&lt;br/&gt;This version includes the following fixes and features:
&lt;ul&gt;
<strong class="bold">{{#lookupIssues}}</strong>
  &lt;li&gt;
    &lt;a href="<strong class="bold">{{url}}</strong>"&gt;<strong class="bold">{{issuetype.name}}</strong>: <strong class="bold">{{key}}</strong> - <strong class="bold">{{summary}}</strong>&lt;a/&gt;
  &lt;/li&gt;
<strong class="bold">{{/}}</strong>
&lt;/ul&gt;
We hope you enjoy it!&lt;br/&gt;&lt;br/&gt;
Regards,&lt;br/&gt;
The <strong class="bold">{{version.project.key}}</strong> development team</pre></li>
				<li>Next, expand <a id="_idIndexMarker207"/>the <strong class="bold">More options</strong> disclosure and uncheck the <strong class="bold">Convert line breaks to HTML line breaks</strong> option as we have included explicit HTML line breaks in the content field, and then click <strong class="bold">Save</strong>.<p>Your rule should look similar to the following screenshot:</p><div><img src="img/Figure_4.3_B16551.jpg" alt="Figure 4.3 – Sending an email notification in Jira Server&#13;&#10;"/></div><p class="figure-caption">Figure 4.3 – Sending an email notification in Jira Server</p></li>
				<li>Finally, name<a id="_idIndexMarker208"/> your rule <code>Version released customer notification</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this section, we have learned how to use the <strong class="bold">Send email</strong> action to send custom notifications to users from automation rules.</p>
			<p>In the next section, we'll look at how we can integrate Slack notifications within our automation rules.</p>
			<h1 id="_idParaDest-106"><a id="_idTextAnchor085"/>How to send notifications to Slack</h1>
			<p>Slack is a<a id="_idIndexMarker209"/> popular workspace communications tool that allows users to chat in so-called channels or via direct messages with one another.</p>
			<p>One of the actions we have<a id="_idIndexMarker210"/> available to our automation rules is the <strong class="bold">Send Slack message</strong> action, which gives us the ability to send messages<a id="_idIndexMarker211"/> to Slack channels or to an individual user.</p>
			<p>In this section, we'll learn how we can integrate with Slack to send notifications from automation rules.</p>
			<h2 id="_idParaDest-107"><a id="_idTextAnchor086"/>Integrating with Slack</h2>
			<p>Before we get to <a id="_idIndexMarker212"/>sending a Slack notification from an automation rule, we first need to set up an incoming webhook in Slack to be able to receive the messages from Jira.</p>
			<p>There are two ways we can achieve this. The first is by creating a custom app in Slack and configuring it with an incoming webhook and then selecting the channel that will receive the notifications.</p>
			<p>The second and simplest way to integrate Slack with automation rules is to create a legacy incoming webhook, which also allows the configured channel to be overridden.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If you use the custom app method of creating incoming webhooks in Slack, you will need to create a webhook for each channel you need to send a notification to as this method does not allow you to override the default channel that you selected when creating the webhook. It is better to use the <em class="italic">legacy webhook</em> method instead, which we'll cover in this section.</p>
			<p>Let's take a look at how to establish an incoming webhook in Slack using the legacy incoming webhook option, which we'll then use in an automation rule to post a message to the <strong class="bold">#general</strong> channel in Slack:</p>
			<ol>
				<li value="1">Navigate to the following URL in your browser: <a href="https://my.slack.com/services/new/incoming-webhook/">https://my.slack.com/services/new/incoming-webhook/</a>.<p>You should be<a id="_idIndexMarker213"/> presented with a screen similar to the following screenshot, after being asked to log in if required:</p><div><img src="img/Figure_4.4_B16551.jpg" alt="Figure 4.4 – Adding an incoming webhook to Slack&#13;&#10;"/></div><p class="figure-caption">Figure 4.4 – Adding an incoming webhook to Slack</p></li>
				<li>In the <strong class="bold">Post to Channel</strong> field, select the <strong class="bold">#general</strong> channel and click the <strong class="bold">Add Incoming WebHooks integration</strong> button.</li>
				<li>In the following screen, you will be presented with your new <strong class="bold">webhook URL</strong>. You can also use this page to customize the icon, label, and username that will be used for this integration. For now, make a note of the <strong class="bold">webhook URL</strong> that was generated as we'll need it to complete the setup of the<a id="_idIndexMarker214"/> automation rule later.</li>
			</ol>
			<p>Now that we've set up Slack to receive incoming messages via a webhook, let's set up an automation rule to make use of this integration.</p>
			<h2 id="_idParaDest-108"><a id="_idTextAnchor087"/>Creating a rule to notify open issues in a sprint</h2>
			<p>In this example, we want<a id="_idIndexMarker215"/> to send a notification to the development team's <strong class="bold">#sprint-update</strong> channel in Slack on a daily basis, listing the issues still outstanding for the current sprint:</p>
			<ol>
				<li value="1">In your Jira Software project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the project settings menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Select the <code>1 Days</code> in the <strong class="bold">Run this rule every</strong> field and click <strong class="bold">Save</strong>.</li>
				<li>Next, select <strong class="bold">New action</strong> and then select the <strong class="bold">Lookup issues</strong> action.<p>Enter the following query in the <strong class="bold">JQL</strong> field and click <strong class="bold">Save</strong>:</p><pre>Sprint in openSprints() AND status != Done</pre></li>
				<li>Then, select <code>#sprint-updates</code></p><p>The<a id="_idIndexMarker216"/> automation rule should look similar to the following screenshot:</p><div><img src="img/Figure_4.5_B16551.jpg" alt="Figure 4.5 – Sending a Slack message&#13;&#10;"/></div><p class="figure-caption">Figure 4.5 – Sending a Slack message</p></li>
				<li>Finally, name the rule <code>Open issues in sprint notification</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
				<li>Now that you've set up the automation rule, every day around the time you created the rule, you should receive a notification in the Slack channel you configured that should look similar to the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_4.6_B16551.jpg" alt="Figure 4.6 – Receiving a notification in a Slack channel&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.6 – Receiving a notification in a Slack channel</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To create this rule in Jira Server, instead of the <strong class="bold">Lookup issues</strong> action, you will need to enter the JQL query in the trigger configuration, expand the <strong class="bold">More options</strong> disclosure, and ensure that the <strong class="bold">Process all issues produced by this trigger in bulk</strong> option is selected.</p>
			<p>In this section, we have<a id="_idIndexMarker217"/> learned how to integrate Slack notifications in automation rules and how to send notifications to Slack channels. In the next section, we'll explore how to integrate with Microsoft Teams to send notifications to a Teams channel in a similar manner to Slack.</p>
			<h1 id="_idParaDest-109"><a id="_idTextAnchor088"/>How to send notifications to Microsoft Teams</h1>
			<p>Microsoft Teams is <a id="_idIndexMarker218"/>a collaboration platform from Microsoft and part of the Microsoft 365 offering. As with Slack, it allows teams to collaborate in channels or via direct messages with other individuals.</p>
			<p>As we saw in the previous section, automation provides a <strong class="bold">Send Microsoft Teams message</strong> action <a id="_idIndexMarker219"/>that allows us to send messages to<a id="_idIndexMarker220"/> a Microsoft Teams channel.</p>
			<p>In this section, we will learn how to integrate with Microsoft Teams to send notifications to channels using automation rules.</p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor089"/>Integrating with Microsoft Teams</h2>
			<p>The first thing we need to<a id="_idIndexMarker221"/> do before we can use Microsoft Teams in automation rules is to set up an incoming webhook so that our rule can send messages to a channel in Teams.</p>
			<p>In Microsoft Teams, we need to add the Incoming Webhook connector to our team before we can send messages to a channel from an automation rule.</p>
			<p>Let's look at how we can configure a team and channel in Microsoft Teams using the <em class="italic">Incoming Webhook connector</em>:</p>
			<ol>
				<li value="1">Open your Microsoft Teams app and open the Teams app store from the sidebar.</li>
				<li>Select <strong class="bold">Connectors</strong> from the menu and then find the <strong class="bold">Incoming Webhook</strong> connector.</li>
				<li>In the pop-up window, click on <strong class="bold">Add to a team</strong>, and then select the team and channel you want to add the connector to and click <strong class="bold">Set up a connector</strong>.</li>
				<li>In the following screen, provide a name for your incoming webhook such as <em class="italic">Jira Notifications</em>, upload a new image if you like, and click on <strong class="bold">Create</strong>.<p>The following <a id="_idIndexMarker222"/>screenshot shows the URL for your new Incoming Webhook connector that you will need to copy so that you can use it when configuring your automation rule:</p></li>
			</ol>
			<div><div><img src="img/Figure_4.7_B16551.jpg" alt="Figure 4.7 – Setting up a Microsoft Teams Incoming Webhook connector&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.7 – Setting up a Microsoft Teams Incoming Webhook connector</p>
			<p>Now that we've set up our Incoming Webhook connector in Microsoft Teams, we are ready to use it in an automation rule to send notifications to our configured channel.</p>
			<h2 id="_idParaDest-111"><a id="_idTextAnchor090"/>Creating a rule to notify a Microsoft Teams channel when a high-priority issue is raised</h2>
			<p>In this example, we'll use an<a id="_idIndexMarker223"/> automation rule to watch for issues raised with a high or highest priority alert and then send a notification to the team channel using <em class="italic">Microsoft Teams</em>:</p>
			<ol>
				<li value="1">In your Jira Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the project settings menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Next, select the <strong class="bold">Issue created</strong> trigger and click <strong class="bold">Save</strong>.</li>
				<li>Then, select <strong class="bold">New</strong> <strong class="bold">condition</strong> followed by the <strong class="bold">Issue</strong> fields condition.</li>
				<li>Complete the fields as follows and click <code>Priority</code></p><p><code>is one of</code></p><p><code>Highest, High</code></p></li>
				<li>Next, select <strong class="bold">New action</strong> followed by the <strong class="bold">Send Microsoft Teams message</strong> action.</li>
				<li>Complete the action fields as follows and click <code>High Priority Ticket</code>.</p><p><strong class="bold">Message</strong>:</p><pre><strong class="bold">{{issue.key}}</strong> - <strong class="bold">{{summary}}</strong> has just been created with *<strong class="bold">{{issue.priority.name}}</strong>* priority.
Your urgent attention is required.</pre><p class="callout-heading">Tip</p><p class="callout">If you leave the <strong class="bold">Include issue summary in message</strong> option checked, the notification in Microsoft Teams will include the issue status, issue type, and assignee in the message, as well as a <strong class="bold">View in Jira</strong> button that will open the Jira ticket in your web browser when clicked.</p><p>Your rule<a id="_idIndexMarker224"/> should look similar to the following screenshot:</p><div><img src="img/Figure_4.8_B16551.jpg" alt="Figure 4.8 – Sending a message with Microsoft Teams&#13;&#10;"/></div><p class="figure-caption">Figure 4.8 – Sending a message with Microsoft Teams</p></li>
				<li>Finally, name the rule <code>High priority issue notification</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
				<li>Creating a new high or highest priority issue in your Service Management project will cause a notification similar to the following screenshot to be sent to your configured<a id="_idIndexMarker225"/> Microsoft Teams channel:</li>
			</ol>
			<div><div><img src="img/Figure_4.9_B16551.jpg" alt="Figure 4.9 – Receiving a notification in a Microsoft Teams channel&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.9 – Receiving a notification in a Microsoft Teams channel</p>
			<p>In this section, we have learned how to set up an Incoming Webhook connector in Microsoft Teams and how to use it in an automation rule to send notifications to the team channel that was configured in the connector.</p>
			<p>In the next section, we'll look at how to send SMS notifications to mobile phones using <em class="italic">Twilio</em>.</p>
			<h1 id="_idParaDest-112"><a id="_idTextAnchor091"/>Sending SMS notifications with Twilio</h1>
			<p><strong class="bold">Twilio</strong> is a <a id="_idIndexMarker226"/>communications platform offered as a cloud-based service that allows developers to integrate voice, video, and text communications into their applications using a <strong class="bold">REST API</strong>.</p>
			<p>Using the <strong class="bold">Send Twilio notification</strong> action in our automation rules allows us to make use of the Twilio platform to send SMS messages to mobile phones.</p>
			<p>In practice, you <a id="_idIndexMarker227"/>would usually have a dedicated <a id="_idIndexMarker228"/>on-call tool integrated with Jira that has the capability to contact the correct team member using a customizable schedule via various methods, including via mobile phone text message (SMS). However, the <strong class="bold">Send Twilio notification</strong> action will allow you to build a simple on-call schedule using <em class="italic">automation rules</em>.</p>
			<p>In this section, we will learn how to integrate with Twilio to send notifications as SMS messages using automation rules.</p>
			<h2 id="_idParaDest-113"><a id="_idTextAnchor092"/>Integrating with Twilio</h2>
			<p>Integrating with Twilio is a <a id="_idIndexMarker229"/>relatively straightforward process. You will need a Twilio account and a telephone number from which your SMS messages will be sent.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Twilio accounts are free to set up and you can get a trial number free of charge. However, you will be charged for every SMS message you send through the platform and you will need to pay for a phone number in your country of choice.</p>
			<p>Let's take a look at how we can get set up with Twilio so that we can send SMS messages from our automation rules:</p>
			<ol>
				<li value="1">Navigate to <a href="https://www.twilio.com">https://www.twilio.com</a> and sign up for an account or log in to your existing account.</li>
				<li>If you don't already have a phone number, click on the <strong class="bold">Get a Trial Number</strong> button on your project dashboard.<p>Once you have a <a id="_idIndexMarker230"/>phone number, your Twilio dashboard should look similar to the following screenshot:</p><div><img src="img/Figure_4.10_B16551.jpg" alt="Figure 4.10 – Setting up a Twilio account&#13;&#10;"/></div><p class="figure-caption">Figure 4.10 – Setting up a Twilio account</p></li>
				<li>You will need to copy your <strong class="bold">TRIAL NUMBER, ACCOUNT SID, and AUTH TOKEN</strong> information from your Twilio dashboard when we come to configure the automation rule. To copy your <strong class="bold">ACCOUNT SID</strong> and <strong class="bold">AUTH TOKEN</strong> fields, you can click on the icon at the right of the respective field.</li>
			</ol>
			<p>Now that we have a Twilio account and phone number, we can create an automation rule to send SMS messages to a mobile phone.</p>
			<h2 id="_idParaDest-114"><a id="_idTextAnchor093"/>Creating a rule to send an after-hours notification via SMS message</h2>
			<p>In this example, for any <a id="_idIndexMarker231"/>incidents with a priority of highest or high and raised before 8 a.m. or after 6 p.m., we will send an SMS notification using <em class="italic">Twilio</em> to a mobile number.</p>
			<p>To keep things simple, we will assume that there is a single mobile device that is in the possession of the team member who is on-call after hours.</p>
			<p>Let's create the rule to send an SMS message:</p>
			<ol>
				<li value="1">In your Jira Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the <strong class="bold">Project Settings</strong> menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Next, select the <strong class="bold">Issue created</strong> trigger and click <strong class="bold">Save</strong>.</li>
				<li>Then, select <code>Issue Type</code></p><p><code>equals</code></p><p><code>Incident</code></p></li>
				<li>Now click <strong class="bold">Save</strong> so we can add our next condition.</li>
				<li>Select <code>Priority</code></p><p><code>is one of</code></p><p><code>Highest, High</code></p><p>Click <strong class="bold">Save</strong> so that we can move on to our final condition.</p></li>
				<li>Now select <strong class="bold">New Condition</strong> followed by <strong class="bold">JQL condition</strong> and enter the following <strong class="bold">JQL</strong> query and click <strong class="bold">Save</strong>:<pre>NOT(created &gt; startOfDay("+8h") AND created &lt; endOfDay("-6h"))</pre></li>
				<li>Next, select <strong class="bold">New action</strong> and then the <strong class="bold">Send Twilio notification</strong> action.<p>Complete the fields as follows and click <strong class="bold">Save</strong>:</p><p><strong class="bold">Account SID</strong>: Copy the account SID from your Twilio dashboard.</p><p><strong class="bold">Auth token</strong>: Copy the auth token from your Twilio dashboard.</p><p><strong class="bold">From</strong>: Copy the trial number or phone number from your Twilio dashboard.</p><p><strong class="bold">To</strong>: The mobile number <a id="_idIndexMarker232"/>to send the text message to in international format.</p><p><strong class="bold">Message body</strong>:</p><pre>A new incident, <strong class="bold">{{issue.key}}</strong> - <strong class="bold">{{issue.summary.abbreviate(100)}}</strong>, requires urgent attention!</pre><p>Your automation rule should look similar to the following screenshot:</p><div><img src="img/Figure_4.11_B16551.jpg" alt="Figure 4.11 – Sending an SMS message via Twilio&#13;&#10;"/></div><p class="figure-caption">Figure 4.11 – Sending an SMS message via Twilio</p></li>
				<li>Finally, name the rule <code>High priority after-hours notification</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
				<li>Creating an issue in the<a id="_idIndexMarker233"/> Service Management project with a high or highest priority should result in an SMS message being sent that looks similar to the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_4.12_B16551.jpg" alt="Figure 4.12 – Receiving an SMS message notification via Twilio&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.12 – Receiving an SMS message notification via Twilio</p>
			<p>In this section, we have learned how to use the Twilio platform to send text messages via SMS to a mobile phone number from an automation rule. The ability to send an SMS message notification gives you another channel to ensure that your notifications are delivered in a timely manner and express the desired level of urgency.</p>
			<h1 id="_idParaDest-115"><a id="_idTextAnchor094"/>Summary</h1>
			<p>In this chapter, you have learned how to use automation rules to send custom email notifications to users, groups of users, or indeed any valid email address.</p>
			<p>You have also learned how to send notifications to two of the most widely used chat systems, Slack and Microsoft Teams.</p>
			<p>Finally, we have learned how to integrate with Twilio to send text messages via SMS to mobile phones.</p>
			<p>With these skills, you will now be able to leverage automation rules to send customized notifications at exactly the right time and with the relevant contextual information, and this will encourage your users to take the desired actions.</p>
			<p>In the next chapter, we will explore how to use automation rules to integrate with external systems that can accept web requests and how to accept requests from external systems.</p>
		</div>
	</body></html>