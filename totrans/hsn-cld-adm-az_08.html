<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure Active Directory - Identity in the Cloud</h1>
                </header>
            
            <article>
                
<p>We already have applications and data in Azure, and the connection between our local network and Azure is up and running. But what about authentication and authorization? How can we manage permissions and access for our users? The answer to all these questions is an <strong>Azure Active Directory</strong> (<strong><span>AAD</span></strong>) that allows us to set up a cloud-based identity authentication which, along with <strong>Azure role-based access control</strong> (<strong>RBAC</strong>), allows us to authenticate users and allow them access to specific resources.</p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>The Azure Active Directory</li>
<li>Syncing local AD with AAD</li>
<li>Managing users and applications in <span>AAD</span></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>For this chapter, you'll need the following:</p>
<ul>
<li>An Azure subscription</li>
<li>A local server running a Windows Server 2012 R2 or later, with the domain controller role installed </li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">The Azure Active Directory</h1>
                </header>
            
            <article>
                
<p>AAD is a cloud-based directory and identity management service that provides <span>application access management and identity protection. It's often referred to as IaaS. </span></p>
<p class="mce-root"><span>We already mentioned this, but let's review it anyway.</span> <span>AAD</span> <span>is at the top level of the Azure management chain and it's directly tied to the tenant. Under the tenant, we can have multiple subscriptions, under subscriptions multiple resource groups, and under resource groups multiple resources.</span></p>
<p>A single account can have access to multiple tenants but each tenant is isolated. When a user signs in, the default directory and tenant is selected. Only resources that are under subscriptions under that tenant are available. In order to manage resources in another tenant, we must switch the directory.</p>
<p><span>AAD</span> comes in four tiers:</p>
<ul>
<li>Azure Active Directory Free</li>
<li>Azure Active Directory Basic</li>
<li>Azure Active Directory Premium P1</li>
<li>Azure Active Directory Premium P2</li>
</ul>
<p>Azure Active Directory Basic offers <span>cloud-centric application access and self-service identity management solutions with group-based access management, self-service password reset for cloud applications, and the AAD Application Proxy.</span></p>
<p>The premium tiers offer additional features and enterprise-grade management tools such as <span>dynamic groups, self-service group management, and Microsoft identity management (P1) or identity protection and privileged identity management (P2). Azure Active Directory Premium P2 contains all the features of P1 plus identity protection and privileged identity management.</span></p>
<p>Here, we are going to focus on features that are covered by the Azure Active Directory Free tier. The free tier is limited to 500.000 directory objects and supports a limited set of features but allows for user/group management, syncing on-premises directories to Azure, and basic security reports. It will be sufficient to provide general images and to introduce <span>AAD</span>. Including all features provided by all <span>AAD</span> tiers would probably result in a separate book and would be too much to cover when discussing Azure administration in general. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating a new directory</h1>
                </header>
            
            <article>
                
<p>Even though <span>AAD</span> will probably exist if an Azure subscription is in place, let's start by creating a new <span>AAD</span> (a new tenant).</p>
<p>To create a new directory, we need to provide an <span class="packt_screen">Organization name</span>, <span class="packt_screen">Initial domain name</span>, and <span class="packt_screen">Country or region</span>. Note that the initial domain name will be used to form an initial domain using <kbd>yourdomain.onmicrosoft.com</kbd>. The domain must be unique and can be customized for your custom domain later. An example of the settings is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-669 image-border" src="Images/eb2fc123-0277-467c-a0e1-0dc7827bc2ea.png" style="width:22.75em;height:31.08em;" width="374" height="511"/></p>
<p class="mce-root">Creating a new directory takes about 1 minute. After the new directory is created, you need to switch directories in order to manage it. Note that the directory name is located under your profile. To change the directory, click on the <span class="packt_screen">Directory</span> menu to the left of your profile and select directory from the list; it will open, as shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-670 image-border" src="Images/ceaefd0f-6b76-4778-9bd5-1cd01e8a842a.png" style="width:27.50em;height:30.08em;" width="548" height="599"/></p>
<p>After you switch the directory, you will be in a new tenant. If you created a new directory, the tenant will be empty and no subscriptions will be assigned. To start creating Azure resources, you must create a new subscription under this tenant. The only thing that you can manage in an empty tenant is <span>AAD</span>. The <span class="packt_screen">Overview</span> and <span class="packt_screen">Manage</span> options for Azure Active Directory Free are shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-671 image-border" src="Images/2c930d86-b398-409a-ae4b-9ac76df5b692.png" style="width:119.33em;height:68.08em;" width="1432" height="817"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Customizing your domain</h1>
                </header>
            
            <article>
                
<p>The first thing we need to customize is the domain name. In order to add a custom domain to your directory, you need to enter a <span class="packt_screen">Custom domain name</span>, which is actually a public domain that you own. For example, I'm going to use my domain, <kbd>azuresecurity.cloud</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-672 image-border" src="Images/5e2419bf-9195-4022-abc6-04c71bc738ec.png" style="width:21.92em;height:11.67em;" width="356" height="189"/></p>
<p>After the custom domain is added, the domain needs to be verified, or to be more precise, domain ownership needs to be verified. In order to verify domain ownership, you need to input a <span class="packt_screen">TXT</span> or <span class="packt_screen">MX</span> record into your domain name register. An example for the <span class="packt_screen">TXT</span> records is shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-673 image-border" src="Images/f576a379-de3e-4363-b5dc-099ecbbf43e8.png" style="width:37.42em;height:29.58em;" width="675" height="533"/></p>
<p>After you input records and press the <span class="packt_screen">Verify</span> button, you might receive an error. DNS records may need up to 72 hours to propagate changes. The time depends on the DNS you're using but usually, it doesn't take more than 30 minutes to propagate changes. If the changes aren't propagated yet, you'll receive error, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-674 image-border" src="Images/25b828e5-7d49-47dd-a074-68e93e76e802.png" style="width:35.00em;height:11.25em;" width="662" height="213"/></p>
<p>After changes are propagated and verification passes, you'll receive a message stating that verification has passed. You'll be offered two additional options—make this domain primary, and download Azure AD Connect. We'll ignore Azure AD Connect for now, but I recommend making the custom domain primary. This way, the custom domain will become the primary and the preferred domain suffix. Instead of the default username being <kbd>username@yourdomain.onmicrosoft.com</kbd>, it will become <kbd>username@yourdomain.com</kbd>. As in the preceding example, instead of <kbd>username@azuresecuritycloud.onmicrosoft.com</kbd>, the new username will be <kbd>username@azuresecurity.cloud</kbd>. A screenshot showing a verified custom domain is shown after you've done this:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-675 image-border" src="Images/007385c9-a3a1-41fb-9dd9-e05958936472.png" style="width:36.17em;height:25.67em;" width="687" height="487"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Syncing AAD with on-premises AD</h1>
                </header>
            
            <article>
                
<p>We have a new directory in place; we can start adding users and assigning them access rights. But there is a good chance that we already have an identity solution in an on-premises environment and that users already have one identity in place. Providing users with an additional identity can cause issues and confusion. Users will have problems detecting when to use which account, and if the same or a similar account is created, users will start typing in the password for the wrong account...</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Fortunately, with <span>AAD</span>, we can use Azure AD Connect, and that will allow us to sync accounts from on-premises AD to Azure and allow users to use the same account for everything. This will make things easier for everyone; users will not have to think about which account they will use (as it's the same account) and admins will have less issues to resolve (less accounts to manage and less users blocking their account with wrong password attempts). </p>
<p>Additionally, with Azure AD Connect, we can implement <strong>single sign-on</strong> (<strong>SSO</strong>), which will allow users to access Azure and on-premises resources with the single sign-in process. The user is asked to enter their credentials once, and the same credentials are used to access everything that the user has access to.</p>
<p>In order to start syncing with the local AD, we need to go to the Azure AD Connect blade in <span>AAD</span>. Here, we can see the current sync status. If sync isn't enabled yet, you will also have the download link for the Azure AD Connect client, as you can see here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-676 image-border" src="Images/09e028d2-7b52-4744-b5e3-5a38ca8a4ac7.png" style="width:48.00em;height:34.92em;" width="903" height="658"/></p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Installing Azure AD Connect</h1>
                </header>
            
            <article>
                
<p>Azure AD Connect must be installed on a server in your on-premises environment. It's recommended that you use a server without a domain controller role but with access to a domain controller. A server with Azure AD Connect must have access to the internet as it will need the internet to sync information between on-premises AD and <span>AAD</span>. All traffic going over Azure AD Connect is encrypted and secure.</p>
<p>The installation wizard is very intuitive and explains every step of the process; you just need to follow the guidelines (and understand the local AD structure). A screenshot of the first screen in the installation process, explaining what the tool will do, is shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-677 image-border" src="Images/835d9445-2a76-4736-9545-884fb566c7d6.png" style="width:109.58em;height:61.25em;" width="1315" height="735"/></p>
<p>The first choice you need to make is whether you want to use express or custom settings. If you select <span class="packt_screen">Use express settings</span>, all features are determined in advance. The installation will use the default installation path, install SQL Express, and use the default options for syncing, such as password hash sync, sync all attributes, or sync all identities across AD forest.</p>
<p>An example of the Azure AD Connect express settings is shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-678 image-border" src="Images/7ec86f2a-7591-4656-ab00-23d9f101ffea.png" style="width:42.17em;height:20.83em;" width="1316" height="650"/></p>
<p>If you decide on using <span class="packt_screen">Customize</span> options, some features such as the installation path, SQL Server instance, and sync groups can be set. For example, you can use an existing instance of SQL Server or you can choose to sync only specific user groups. Also, a new service account will be created for the sync process with express settings; in custom settings, you can choose an existing service account. An example of custom settings is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-679 image-border" src="Images/baea5ed7-68d3-4092-aee3-98abc3491667.png" style="width:40.67em;height:19.58em;" width="1316" height="632"/></p>
<p>After choosing the settings, you need to provide accounts that will enable sync. First, you need to provide <span>AAD</span> credentials that have global administration rights. I recommend creating a separate account for this and not tying it to your personal account. If an admin leaves the company, there is a good chance that the account will be deactivated and the sync will stop. A screenshot of entering an <span>AAD</span> account is shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-680 image-border" src="Images/2029180b-4085-44ed-932d-e0589ba19bba.png" style="width:109.50em;height:47.00em;" width="1314" height="564"/></p>
<p>The second account you need to provide is an AD DS enterprise administrator account. The same goes for the local account as for the Azure one: try using a service account dedicated to this service, and not a personal admin account. A screenshot of entering an AD DS account is shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-681 image-border" src="Images/dad67ea6-da4b-4bab-af67-368202117304.png" style="width:109.58em;height:47.08em;" width="1315" height="565"/></p>
<p>Finally, you'll get to a screen where you need to confirm the installation. It will again state all of the actions that will be taken and allow you to enable the sync process to start right after configuration is completed. You can see the confirmation screen in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1080 image-border" src="Images/e63181db-dd29-4a67-aa22-3d507b750adf.png" style="width:38.58em;height:18.33em;" width="1312" height="624"/></p>
<p>After the installation completes, you will be provided with a status report with recommendations as to what else should be done. For example, in my domain, Active Directory Recycle Bin is not enabled. The process will detect this setting and suggest that you enable it, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-683 image-border" src="Images/35e139af-958f-4527-afec-b2366ac188aa.png" style="width:42.42em;height:20.75em;" width="1320" height="647"/></p>
<p class="mce-root"/>
<p>In the Azure Portal, under the <span class="packt_screen">Azure AD Connect</span> blade, you will see the new status. The link for Azure AD Connect is gone and you can see that sync is enabled and that the <kbd>Last sync</kbd> was <kbd>Less than 1 hour ago</kbd>. Depending on the on-premises environment, you can also have a federation, SSO, and some other settings. An example of a synced directory is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-684 image-border" src="Images/5b80a15c-e239-4fcd-b66e-8c3f1cf3d818.png" style="width:52.33em;height:36.50em;" width="843" height="588"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing AAD</h1>
                </header>
            
            <article>
                
<p>After the sync is completed, all synced users will be present in <span>AAD</span>. In <span>AAD</span>, accounts can be from two different sources: <span>AAD</span> and Windows Service AD. Accounts with a Windows Server AD source are accounts that have been synced from the local Active Directory. <span>AAD</span> accounts exist only in <span>AAD</span> and these accounts are created in Azure. There is a third type of account, that is, a Microsoft Account. These accounts are actually Microsoft Live Accounts that can be added to your <span>AAD</span>.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>The <span class="packt_screen">USER TYPE</span> in <span>AAD</span> can be a <kbd>Member</kbd> or a <kbd>Guest</kbd>. Members are accounts in <span>AAD</span> (with your domain name) and guests are accounts that are coming from other <span>AAD</span> or Microsoft Live Accounts. The only exception is that a Microsoft Live Account can be a member of your <span>AAD</span> when that account was used to create <span>AAD</span>. The same thing applies to external <span>AAD</span> accounts (<span>AAD</span> accounts from outside your tenant); these can only have member status when that account is used to create a new tenant. An example of a member list is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-685 image-border" src="Images/6eb4b5bd-7c86-48ac-a006-0a1f8133ec94.png" style="width:95.00em;height:49.25em;" width="1140" height="591"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating a new user</h1>
                </header>
            
            <article>
                
<p>Accounts with an <span>AAD</span> source are accounts that have been created in Azure. I mentioned that, for Azure AD Connect, you should use a service account for syncing. Note that this account must have a global admin role. An example of how to create such an account is shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-686 image-border" src="Images/b08d7522-37cb-4404-ade8-5e37d6709539.png" style="width:21.67em;height:36.58em;" width="371" height="627"/></p>
<p>The default user role (when creating a new <span>AAD</span> user) is <span class="packt_screen">User</span>. This option can be changed to Admin during creation or after the user has been created.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Managing user options and permissions </h1>
                </header>
            
            <article>
                
<p>After the user has been created, you have the option to manage the user and assign different roles and permissions. Along with <span class="packt_screen">Manage</span> options, you have an activity section where you can monitor and audit a user's activity. An example of a user profile is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-687 image-border" src="Images/8eae6ec9-f1f0-4b72-bfc6-bccc5a5dac99.png" style="width:90.25em;height:61.08em;" width="1083" height="733"/></p>
<p class="mce-root"/>
<p>One of the most important management options is role assignment. Under <span class="packt_screen">Directory role</span>, you can select multiple predefined roles that can be assigned to a user. Each role comes with an explanation, as shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-688 image-border" src="Images/e6edce94-869a-43c6-a6e1-8946fdefd20a.png" style="width:85.33em;height:66.08em;" width="1024" height="793"/></p>
<p>Users can be added to groups to simplify management. For example, we can assign multiple roles to groups, and by assigning a user to a group, the user will automatically be assigned all roles assigned to the group the user is a member of. Groups can be assigned and synced, similar to accounts. Assigned groups originate in <span>AAD</span> and <span>are synced using Windows Server AD</span>. Examples of groups assigned to users in <span>AAD</span> are as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-689 image-border" src="Images/2c9852b6-dc73-43bc-86e6-72af93ffe32b.png" style="width:40.42em;height:12.67em;" width="727" height="229"/></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Registering an application in AAD</h1>
                </header>
            
            <article>
                
<p>In order to use <span>AAD</span> as an authentication method for an application, you need to register the application in <span>AAD</span>. This will create two objects in your <span>AAD</span>: an application object and a service principal.</p>
<p>To register a new application, we need to go to <span class="packt_screen">Application registration</span> in the <span>AAD</span> blade and select <span class="packt_screen">New Application Registration</span>. Information that we need to provide includes the application <span class="packt_screen">Name</span>, <span class="packt_screen">Application type</span> (<span class="packt_screen">Web app / API</span> or <span class="packt_screen">Native</span>), and <span class="packt_screen">Sign-on URL</span> (I'm using localhost as an example):</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-690 image-border" src="Images/7e4f82d5-dc42-4d23-ac28-03785cb52e9c.png" style="width:20.08em;height:20.33em;" width="371" height="376"/></p>
<p>Creating the application is only the first step as you need additional configuration to use this registration. In the first screen that will open after the application has been created, there are two very important sections: <span class="packt_screen">Application ID</span> and <span class="packt_screen">Object ID</span>. These will be used later in order to identify the application with <span>AAD</span>. In other words, the application uses the ID to contact <span>AAD</span> and gathers information on whether the user is authorized to access the application. Which ID, application, or object is used for authentication depends on the authentication method. An example of this is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-691 image-border" src="Images/9ff980df-f695-4443-9d33-77891ac0e138.png" style="width:43.08em;height:18.50em;" width="688" height="296"/></p>
<p>In order to provide access to a registered application, we need to configure permissions and keys. To provide permissions to the application, we must set the required permissions under <span class="packt_screen">Required permissions</span> in the <span class="packt_screen">Settings</span> blade. You need to be very careful here <span>as you may fall into a trap when using too many permissions.</span> </p>
<p>I have often seen people giving all possible permissions to applications that only required basic authentication. If too many permissions are assigned, this can be exploited and presents high security risks. An example permissions blade is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-692 image-border" src="Images/0122f893-f74d-4b8a-baed-e1d26422c307.png" style="width:80.67em;height:48.33em;" width="968" height="580"/></p>
<p>Once we have the ID and permissions in place, the last thing we are missing is the key. The application will use the ID and key to authorize access to <span>AAD</span>. To add a new key, we must provide a <span class="packt_screen">DESCRIPTION</span>, <span class="packt_screen">EXPIRES</span> (expiration time), and <span class="packt_screen">VALUE</span> for the key. The expiration time can be <span class="packt_screen">in 1 year</span>, <span class="packt_screen">in 2 years</span>, or <span class="packt_screen">Never expires</span>. I strongly recommend not using <span class="packt_screen">Never expires</span> as this is another possible security risk. The <span class="packt_screen">VALUE</span> for the key is not the actual key; this value will be encrypted and then a new value will be provided. After entering all values, click <span class="packt_screen">Save</span>. An example of adding a new key is shown as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-693 image-border" src="Images/70af1565-b4ef-47bf-ac36-483c3632f011.png" style="width:104.42em;height:48.33em;" width="1253" height="580"/></p>
<p>After saving, a new value for the key will be provided. Make sure to copy this value as this is the only time you will be able to collect it. Once you leave this blade, you will not be able to retrieve this value. An example generated key is shown in the following screenshot (note the warning at the top of the blade):</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-694 image-border" src="Images/8eac817f-5f37-4bc6-bb92-9bf70b41a2a5.png" style="width:102.58em;height:47.25em;" width="1231" height="567"/></p>
<p>Applications, using IDs and keys registered in <span>AAD</span>, will be able to communicate with <span>AAD</span>. These applications don't have to be hosted in Azure; this can be done for an on-premises application or in some other cloud.</p>
<p>Note that when using Azure Web apps, you can achieve a similar goal by using <span class="packt_screen">Authentication</span>/<span class="packt_screen">Authorization</span> in the Web app blade. This option will automatically create all of the necessary objects and provide the Web app with an ID and key. Minimum permissions will be created, which is a good thing, but if you need to provide an application with more permissions, you need to do this manually. </p>
<p>We already mentioned that in this process, two objects will be created: <span>an application object and a service principal.</span></p>
<p><span>Now would be good time to talk about the concept of multi-tenancy. Multi-tenant applications allow users from multiple tenants to use the same application and resources. For example, we can develop an application for customers and host it in our own subscription (and our tenant). Then, we can set access for the application for multiple customers and allow them to use their own AAD for authentication and authorization. In this concept, users coming from multiple tenants are using the same application and the same resources. If a multi-tenant approach is used, the application would have one application object in the home tenant and multiple service principles—one for each directory. Basically, an application object has a one-to-one relationship with the application and a one-to-many relationship with service principles.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Role-based access control</h1>
                </header>
            
            <article>
                
<p>We already mentioned <span>RBAC</span> and how it can help with the management and administration of cloud resources. <span>RBAC</span> allows you to use <span>AAD</span> accounts to set up different roles and permissions on different levels of the Azure tenant. In order to provide user administration rights in the tenant, we must use the <span>AAD</span> blade. These rights are not transferred further. Under the tenant, we can have multiple subscriptions, and subscription engagement is done separately for each subscription.</p>
<p>Assigning a user to admin (or some other role) will automatically provide them with the same role on all resource groups and resources under that subscription. If we assign a role to a user on the resource group level, the role will be automatically provided for all resources in that resource group. Providing a role access to a single resource, will give the user access only to that resource.</p>
<p>During the process of assigning permissions on any of these levels (subscription, resource group, resource), we use the same option: <span class="packt_screen">Access Control (IAM)</span>. Here, we select a <span class="packt_screen">Role</span>, assignment type, and user. Instead of users, you can also use groups or service principals. An example of how to add a new Contributor to your subscription/resource group/resource is shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-695 image-border" src="Images/a98dbdd2-dbc2-4760-be23-ddd897729aca.png" style="width:31.50em;height:21.33em;" width="501" height="340"/></p>
<p>You can select multiple predefined roles, create custom roles, or assign users to multiple roles. If a user is assigned multiple roles that are in conflict, the highest role will be applied.</p>
<p>For example, the <span class="packt_screen">Reader</span> role allows you to only see information about resources, and you can't make any changes. If the <span class="packt_screen">Reader</span> role is assigned along with the <span class="packt_screen">Contributor</span> role (which allows you to make changes), the <span class="packt_screen">Contributor</span> role will be applied.</p>
<p class="mce-root"/>
<p>A screenshot of the available roles is shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-696 image-border" src="Images/90e9fd2c-34f4-4f82-87d0-1c7b7b84b0ad.png" style="width:30.92em;height:49.42em;" width="509" height="814"/></p>
<p class="mce-root"/>
<p>As mentioned previously, groups can be assigned roles on any level. In this case, all users that are members of that group will be assigned that role automatically.</p>
<p>Service principles are often used to set up access for applications that need the ability to change or create something. For example, a service principle is often used to allow Azure DevOps to access your subscription during the release process and to create or edit resources that are needed for deployment.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p><span>AAD</span> provides authentication and authorization in Azure. Along with <span>RBAC</span>, it allows you to control who can do what and where. These tools are your first line of defense when managing and securing your cloud resources.</p>
<p>Now, we will concentrate on what else we need to secure in Azure and how can we protect our data and other resources. Securing Azure is different from securing our on-premises infrastructure and requires a different mindset. In <a href="0e16c405-a21c-4cfc-9dc6-e20fc05db041.xhtml" target="_blank">Chapter 9</a>, <span><em>Azure Security and Administration</em>, </span>we will discuss how to harden Azure security and what is available to protect us.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>An <span>AAD</span> is on top of a...
<ol>
<li>Tenant</li>
<li>Subscription</li>
<li>Resource group</li>
</ol>
</li>
<li>An account can be part of multiple tenants:
<ol>
<li>Yes</li>
<li>No</li>
</ol>
</li>
<li><span>AAD</span> can contain Microsoft Live Accounts:
<ol>
<li>Yes</li>
<li>No</li>
</ol>
</li>
<li><span>AAD</span> can be synced with Windows Server AD:
<ol>
<li>Yes</li>
<li>No</li>
</ol>
</li>
</ol>
<ol start="5">
<li><span><span>The Azure </span></span>Active Directory F<span>ree tier has a limit of...</span>
<ol>
<li>5,000 objects</li>
<li>500,000 objects</li>
<li>5,000,000 objects</li>
</ol>
</li>
</ol>
<ol start="6">
<li>To set up a custom domain...
<ol>
<li>You can choose any domain</li>
<li>You must own the domain</li>
<li>You must use <kbd>.onmicrosoft.com</kbd></li>
</ol>
</li>
<li><span>To verify your custom domain, you must use...</span>
<ol>
<li>MX records</li>
<li>TXT records</li>
<li><span>Either</span></li>
<li>Both</li>
</ol>
</li>
<li>Using RBAC, you can assign roles for...
<ol>
<li>A subscription</li>
<li>A resource group</li>
<li>A resource</li>
<li> All of the above</li>
</ol>
</li>
<li>Roles can be assigned to...
<ol>
<li>Users</li>
<li>Groups</li>
<li>Both</li>
</ol>
</li>
<li>To set up <span>AAD</span> sign-in from the application, you must...
<ol>
<li>Register the application in <span>AAD</span></li>
<li>Create an <span>AAD</span> group for the application</li>
<li>Both</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    </div>



  </body></html>