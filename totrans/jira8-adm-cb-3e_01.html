<html><head></head><body>
        

                            
                    <h1 class="header-title">Jira Server Administration</h1>
                
            
            
                
<p>Atlassian Jira is a popular issue tracking system used by many companies across the Globe. One of its strengths, unlike most other enterprise software, is that it does not take days or weeks to install and implement, and is very simple to upgrade and maintain.</p>
<p>We will assume that you already know how to install a brand-new Jira system. So, we will explore common administration tasks, such as upgrading and migrating your Jira, and we'll look at different options, ranging from using the new automated upgrade utility provided by Atlassian to doing everything from scratch. We will also look at some other neat tricks for you as an administrator, such as resetting the admin password to get you out of sticky situations.</p>
<p>Since Jira is now a family of products, including Jira Core (which is the old Jira Classic before Jira 7), Jira Software (which is Jira Core plus agile capabilities), and Jira Service Desk (which is Jira Core plus the old Jira Service Desk add-on), recipes in this book will use the term Jira to refer to the most popular of the three, Jira Software.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Installing Jira for production use</li>
<li>Upgrading Jira with an installer</li>
<li>Upgrading Jira manually</li>
<li>Migrating Jira to another environment</li>
<li>Setting up the context path for Jira</li>
<li>Setting up SSL</li>
<li>Installing SSL certificates from other applications</li>
<li>Resetting the Jira administrator password</li>
<li>Importing data from CSV</li>
<li>Copying configurations between Jira instances</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Installing Jira for production use</h1>
                
            
            
                
<p>In this recipe, we will look at how to install and set up Jira in a production environment. This includes setting up a dedicated user to run Jira under and using an external database.</p>
<p>We will use the archive distribution since the steps are consistent across both the Windows and Linux platforms. This will also provide you with an insight into the exact steps required to get a Jira instance deployed and running; these would otherwise be hidden by an automated installer. This will provide you with the information needed for subsequent maintenance and further configurations.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>The following things need to be checked before you begin with this recipe:</p>
<ul>
<li>Download the latest Jira archive distribution from <a href="https://www.atlassian.com/software/jira/download" target="_blank">https://www.atlassian.com/software/jira/download</a> and select a package based on your server, such as Linux or Windows. For this recipe, we will be using the TAR.GZ Archive.</li>
<li>Make sure your server environment meets Jira's requirements by visiting <a href="https://confluence.atlassian.com/adminjiraserver/supported-platforms-938846830.html">https://confluence.atlassian.com/adminjiraserver/supported-platforms-938846830.html</a>.</li>
<li>Install Java on the system. At the time of writing, Jira 8 requires Java 8 (either Oracle JDK or OpenJDK). You can download Java from <a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html">https://www.oracle.com/technetwork/java/javase/downloads/index.html</a>.</li>
<li>Make sure that the <kbd>JAVA_HOME</kbd> or <kbd>JRE_HOME</kbd> environment variable is configured.</li>
<li>Have a database system available, either on the server hosting Jira, or a different server accessible over the network. For this recipe, we will use <strong>MySQL</strong>. If you are using a different database, change the commands and queries accordingly.</li>
<li>Download the necessary database driver. For MySQL, you can download it from <a href="https://dev.mysql.com/downloads/connector/j" target="_blank">https://dev.mysql.com/downloads/connector/j</a>.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>We first need to create an empty MySQL database for Jira:</p>
<ol>
<li>Open up a new Command Prompt on the MySQL server.</li>
</ol>
<ol start="2">
<li>Run the following command (you can also use another user instead of <kbd>root</kbd> as long as the user has permission to create new users and databases):</li>
</ol>
<pre style="padding-left: 60px"><strong>mysql -u root -p</strong></pre>
<ol start="3">
<li>Enter the password for the user when prompted.</li>
<li>Create a new database for Jira by running the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>create database jiradb character set utf8;</strong></pre>
<ol start="5">
<li>Create a new user for Jira in the database and grant the user access to the <kbd>jiradb</kbd> database we just created using the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>grant all on jiradb.* to 'jirauser'@'localhost'
identified by  'jirapassword';</strong></pre>
<ol start="6">
<li>In the previous five steps, we created a new database named <kbd>jiradb</kbd> and a new database user named <kbd>jirauser</kbd>. We will use these details later to connect Jira with MySQL. The next step is to install Jira.</li>
<li>Create a dedicated user account to run Jira under. If you're using Linux, run the following command as root or with <kbd>sudo</kbd>:</li>
</ol>
<pre style="padding-left: 60px"><strong>useradd --create-home --comment "Dedicated
Jira account" -- shell /bin/bash jira</strong></pre>
<p>It is good practice to reduce security risks by locking down the user account so that it does not have login permissions.</p>
<ol start="8">
<li>Create a new directory on the filesystem where Jira will be installed. This directory will be referred to as <kbd>JIRA_INSTALL</kbd>.</li>
<li>Create another directory on the filesystem. This will be used for Jira to store its attachments, search indexes, application data, and other information. You can create this directory on a different drive with more hard disk capacity, such as a network drive (this could slow down performance). This directory will be referred to as <kbd>JIRA_HOME</kbd>.</li>
</ol>
<p>It is good practice to keep the <kbd>JIRA_INSTALL</kbd> and <kbd>JIRA_HOME</kbd> directories separate; that is, the <kbd>JIRA_HOME</kbd> directory should not be a subdirectory inside <kbd>JIRA_INSTALL</kbd>. This will make future upgrading and maintenance easier.</p>
<ol start="10">
<li>Unzip the Jira archive file in the <kbd>JIRA_INSTALL</kbd> directory.</li>
<li>Change both the <kbd>JIRA_INSTALL</kbd> and <kbd>JIRA_HOME</kbd> directories' owner to the new Jira user.</li>
<li>Open the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes/jira-application.properties</kbd> file in a text editor.</li>
<li>Locate the <kbd>jira.home=</kbd> line in this file.</li>
<li>Copy and paste this in the full path to the <kbd>JIRA_HOME</kbd> directory and remove the <kbd>#</kbd> symbol if present. Make sure you use the forward slash (<kbd>/</kbd>). The following line shows how it looks on a Linux system:</li>
</ol>
<pre style="padding-left: 60px"><strong>jira.home=/opt/data/jira_home</strong> </pre>
<p>Windows uses the backward slash (<kbd>\</kbd>) in the file path. You should still use the forward slash (<kbd>/</kbd>) while specifying the <kbd>jira.home</kbd> directory.</p>
<ol start="15">
<li>Copy the database driver JAR file (obtained from the <em>Getting ready </em>section) to the <kbd>JIRA_INSTALL/lib</kbd> directory.</li>
<li>Start up Jira by running the <kbd>start-jira.sh</kbd> (for Linux) or <kbd>start-jira.bat</kbd> (for Windows) script from the <kbd>JIRA_INSTALL/bin</kbd> directory as the Jira user. You should see the output, <kbd>Tomcat</kbd>, started in your console; this means that Jira is up and running.</li>
</ol>
<ol start="17">
<li>Jira comes with a setup wizard that will help guide us through the final phase of the installation.</li>
<li>Open up a browser and go to <kbd>http://localhost:8080</kbd> (replace localhost with the actual server name). By default, Jira runs on port <kbd>8080</kbd>. You can change this by changing the connector port value in the <kbd>JIRA_INSTALL/conf/server.xml</kbd> file.</li>
<li>The first step in setup is to select how you want Jira to be set up. Select the <strong>I'll set it up myself </strong>option and click on the <strong>Next</strong> button:</li>
</ol>
<div><img src="img/985bb420-3288-4004-aeee-320aa629a849.png" style="width:50.17em;height:31.25em;"/></div>
<ol start="20">
<li>The second step is to set up database information. Select the <strong>My Own Database</strong> <strong>(recommended for production environments)</strong> option.</li>
<li>Select a value for the <strong>Database Type </strong>option. For this recipe, select the MySQL 5.7+ option.</li>
</ol>
<ol start="22">
<li>Enter the details for our new <kbd>jiradb</kbd> database:</li>
</ol>
<div><img src="img/23e5dff7-5076-4a7e-90e2-4b06169eb3f8.png" style="width:36.92em;height:35.67em;"/></div>
<ol start="23">
<li>Click on Test Connection<strong> </strong>to check whether Jira is able to connect to the database.</li>
<li>Click on the Next button to proceed if the database connection test is successful and move to the next step of the wizard.</li>
<li>Enter the Application Title<strong> </strong>value for this Jira instance.</li>
<li>Select <strong>Public </strong>if you would like to let people sign up for accounts, or Private if you want only administrators to create accounts. Most organizations that use Jira to track internal projects will require <strong>Private</strong> mode.</li>
<li>Set the Base URL<strong> </strong>option. The base URL is the one that users will use to access Jira. Usually, this should be a fully qualified domain name or the hostname—that is, not localhost or an IP address.</li>
</ol>
<ol start="28">
<li>Click on <strong>Next </strong>to go to the third step of the wizard, as shown in the following screenshot:</li>
</ol>
<div><img src="img/169ce61b-5ebe-4a86-bd13-fd7dea52c814.png" style="width:38.33em;height:21.75em;"/></div>
<ol start="29">
<li>Enter your Jira license key if you have one. If you do not have a license key, you can generate a temporary trial license by clicking the G<strong>enerate a Jira trial license link </strong>and following the instructions.</li>
<li>Click on <strong>Next </strong>to go to the fourth step in the wizard, as shown in the following screenshot:</li>
</ol>
<div><img src="img/3e47921a-7863-4f6b-92c1-6f2a3e1c69f5.png" style="width:33.17em;height:20.17em;"/></div>
<ol start="31">
<li>Enter the details for the initial administrator account. The user account will have access to all the configuration options in Jira, so make sure you do not lose its login credentials.</li>
<li>Click on <strong>Next </strong>to go to the fifth and final step of the wizard, as shown in the following screenshot:</li>
</ol>
<div><img src="img/52788c09-482f-4654-b5e8-a9454cc2a3b6.png"/></div>
<ol start="33">
<li>Choose whether you want to set up an outgoing SMTP server Now or Later. If you do not have an SMTP server ready right now, you can always come back and configure it later.</li>
<li>Click on <strong>Finish </strong>to complete the setup process.</li>
</ol>
<p>You will see the following Welcome! screen:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/0a58f177-0060-4211-99eb-818dfa437fd3.png"/></p>
<p class="mce-root">This ends the general configuration part of the setup process. Your Jira system is up and running. Next, Jira will walk you through its onboarding process as a first-time user. You will be asked to select the default language to use, upload a user avatar, and create your very first project.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>By default, Jira is set to use a maximum of 768 MB of memory. For a production deployment, you might need to increase the amount of memory allocated to Jira. You can increase this by opening up the <kbd>setenv.sh</kbd> (on Linux) or <kbd>setenv.bat</kbd> (on Windows) files in the <kbd>JIRA_INSTALL/bin</kbd> directory and changing the value of the <kbd>JVM_MAXIMUM_MEMORY</kbd> parameter.</p>
<p>For example, if we want to set the maximum memory to 2 GB, we will change it to <kbd>JVM_MAXIMUM_MEMORY="2048m"</kbd>. You will need to restart Jira after performing this change. For production uses, it is recommended that you allocate at least 4 GB (4096 MB) of memory to the Jira JVM. Make sure you have sufficient physical memory available on your server first.</p>
<p>If you are using LDAP for user management in your organization, refer to the <em>Integrating with LDAP for authentication only</em> recipe in <a href="a872df29-8ee1-4a43-a1be-ba30c2904ec3.xhtml">Chapter 4</a>, <em>User Management</em>.</p>
<p>Detailed steps for downloading the code bundle are mentioned in the <em>Preface</em> of this book. Please have a look. The code bundle for the book is also hosted on GitHub at <a href="https://github.com/PacktPublishing/Jira-8-Administration-Cookbook-Third-Edition">https://github.com/PacktPublishing/Jira-8-Administration-Cookbook-Third-Edition</a>. We also have other code bundles from our rich catalog of books and videos available at <a href="https://github.com/PacktPublishing/" target="_blank">https://github.com/PacktPublishing/</a>. Check them out!</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Upgrading Jira with an installer</h1>
                
            
            
                
<p class="mce-root">For both Windows and Linux, Atlassian provides an installer package that can guide you through the upgrade process. The installer will detect your current Jira installation and perform all the necessary tasks to upgrade it to the target version.</p>
<p>In this recipe, we will show you how to upgrade your Jira instance with the standard Jira installer.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>As the Jira installer is only available for standalone installations on Windows and Linux, we will run you through the installer on Windows in this recipe:</p>
<ul>
<li>Check the upgrade notes for any special instructions as well as the target Jira version to make sure you can perform a direct upgrade.</li>
<li>Make sure you have a valid Jira license.</li>
<li>Verify whether your current host environment is compatible with the target Jira version. This includes the Java version, database, and OS.</li>
<li>Verify whether your operating environment is compatible with the target's Jira version, specifically, the browser requirements.</li>
<li>Make sure that the add-ons you are using are compatible with the new version of Jira.</li>
<li>Download the installer binary for your target Jira version.</li>
</ul>
<p>You can use the Universal Plugin Manager's Jira update check utility to check for add-on compatibility.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Upgrade your Jira system with the installer using the following steps:</p>
<ol>
<li>Take your current Jira offline, for example, by running the <kbd>stop-jira.bat</kbd> script.</li>
<li>Back up the Jira database with its native backup utility.</li>
<li>Launch the installer and select the <strong>Upgrade an existing JIRA installation </strong>option.</li>
<li>Now, select the directory where the current Jira is installed:</li>
</ol>
<div><img src="img/b58bd1f3-d5a4-4e6b-9a3a-b84a5c8e09f7.png" style="width:39.83em;height:20.42em;"/></div>
<ol start="5">
<li>Check the backup JIRA home directory option and click on the <strong>Next </strong>button.</li>
</ol>
<p>If your <kbd>JIRA_HOME</kbd> directory is big, you might want to manually back it up or remove some of the <kbd>cache</kbd> and <kbd>tmp</kbd> folders as it would take a long time for the installer to back these up.</p>
<ol start="6">
<li>Review the Upgrade checklist and click on the <strong>Upgrade </strong>button:</li>
</ol>
<div><img src="img/88b46af0-1c34-497e-8422-084e5fda10e4.png" style="width:40.92em;height:26.58em;"/></div>
<ol start="7">
<li>Wait for the installer to complete the upgrade process. Once the upgrade is complete, the installer will automatically launch Jira.</li>
<li>Update any add-ons once Jira starts successfully.</li>
</ol>
<p>The installer will detect and provide you with a list of customized files in the <kbd>JIRA_INSTALL</kbd> directory, which you will need to copy manually after the upgrade.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">See also</h1>
                
            
            
                
<p>If you cannot use the installer to upgrade Jira, refer to the <em>Upgrading Jira manually</em> recipe.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Upgrading Jira manually</h1>
                
            
            
                
<p>If you find yourself in a situation where you cannot use the installer to upgrade Jira—for example, if you are hosting Jira on an OS that does not have an installer binary or on a cloud platform, then you can use the manual upgrade method to upgrade your Jira instance.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>The tasks required to upgrade Jira manually will remain the same as those for the installer. Refer to the previous recipe for common tasks involved. As the installer automates many backup tasks while upgrading Jira manually, you will have to do the following:</p>
<ol>
<li>Back up the Jira database with its native backup utility.</li>
<li>Back up the <kbd>JIRA_INSTALL</kbd> directory.</li>
<li>Back up the <kbd>JIRA_HOME</kbd> directory.</li>
<li>Get a list of all the customized files in the <kbd>JIRA_INSTALL</kbd> directory from the <strong>System Info</strong> page in Jira.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>To manually upgrade your Jira instance, perform the following steps:</p>
<ol>
<li>Take your current Jira offline.</li>
<li>Install the new version of Jira in a different directory.</li>
<li>Edit the <kbd>jira-application.properties</kbd> file in the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes</kbd> directory to point to the existing <kbd>JIRA_HOME</kbd> directory.</li>
<li>Copy any modified files from the old Jira instance to the new one.</li>
<li>Start up the new Jira instance.</li>
<li>Update the add-ons once Jira starts successfully.</li>
<li>Remove the previous installation directory to avoid confusion.</li>
</ol>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>What we did here essentially involved setting up a new instance of Jira and pointing it at the old Jira instance's data. When we start up the new Jira instance, it will connect to the existing Jira database by reading the <kbd>dbconfig.xml</kbd> file from the <kbd>JIRA_HOME</kbd> directory, and will perform an in-place upgrade to make all the necessary schema changes.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Migrating Jira to another environment</h1>
                
            
            
                
<p>Now that we have gone through upgrading a Jira instance, we will look at how to move a Jira instance to another server environment. This is a common use case when you need to move an application to a virtualized environment or data center.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>The following things need to be checked before you start with this recipe:</p>
<ul>
<li>Make sure you have a valid Jira license.</li>
<li>Check whether your new environment is compatible with Jira system requirements.</li>
<li>Ensure that both the old and new Jira instances are of the same major or minor version. If you intend to run a newer version of Jira in the new environment, it is recommended that you upgrade once the migration is successful.</li>
</ul>
<p>Migrating a system can be very disruptive for users. Make sure you communicate this to your users and allocate sufficient time for rollbacks.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>To migrate an existing Jira instance to another server, perform the following steps:</p>
<ol>
<li>Download and install a brand-new Jira instance in your new environment with an empty database.</li>
</ol>
<ol start="2">
<li>Note down the files listed under <strong>Modified Files </strong>and <strong>Removed Files</strong> in the <strong>System Info</strong> page for your current Jira. The following screenshot shows an example:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/6c2fb69f-dc03-4953-b613-12a98e22e051.png" style="width:35.92em;height:4.75em;"/></p>
<ol start="3">
<li>Shut down your current Jira instance.</li>
<li>Back up your current Jira database with the database's native backup utility.</li>
<li>Back up your current <kbd>JIRA_HOME</kbd> directory.</li>
<li>Take your new Jira offline.</li>
<li>Copy over your <kbd>JIRA_HOME</kbd> backup and replace the new <kbd>JIRA_HOME</kbd> directory with it.</li>
<li>Update the <kbd>dbconfig.xml</kbd> file with the new Jira database details.</li>
<li>Copy your database backup and restore the new Jira database.</li>
<li>Start up the new Jira instance.</li>
<li>Apply the same changes to the new Jira instance from step 2.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up the context path for Jira</h1>
                
            
            
                
<p>If you have multiple web applications running on the same domain, you might want to set up a context path for Jira—for example, <kbd>http://example.com/jira</kbd>, where <kbd>/jira</kbd> is the context path.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Perform the following steps to set up a context path for Jira:</p>
<ol>
<li>Shut down Jira if it is running.</li>
<li>Open up <kbd>JIRA_INSTALL/conf/server.xml</kbd> in a text editor.</li>
</ol>
<ol start="3">
<li>Locate the following line and enter the context path for the <kbd>path</kbd> attribute—for example, <kbd>path="/jira"</kbd>:</li>
</ol>
<pre style="padding-left: 60px">&lt;Context path="/jira"docBase="${catalina.home}
/atlassian-jira" reloadable="false"
useHttpOnly="true"&gt;</pre>
<p class="mce-root"/>
<ol start="4">
<li>Save the file and restart Jira. If you are doing this after Jira has been installed, you will have to update Jira's base URL option so that its links will reflect the change.</li>
<li>Log into Jira as an administrator.</li>
<li>Navigate to <strong>Administration</strong> &gt; <strong>Systems</strong> &gt; <strong>General Configuration</strong>.</li>
<li>Click on the <strong>Edit Settings </strong>button.</li>
<li>Enter the fully qualified URL in Jira, including the context path, in the <strong>Base URL </strong>field.</li>
<li>Click on <strong>Update </strong>to apply the change.</li>
</ol>
<p>After you have all this set up, you will be able to access Jira with the new context path, and all the links, including those from Jira's notification emails, will be the context path in the URL.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up SSL</h1>
                
            
            
                
<p>By default, Jira runs with a standard non-encrypted HTTP protocol. This is acceptable if you are running Jira in a secure environment, such as an internal network. However, if you plan to open up access to Jira over the internet, you need to tighten up security by encrypting sensitive data, such as the usernames and passwords that are sent, by enabling HTTP over <strong>SSL</strong> (<strong>HTTPS</strong>).</p>
<p>This recipe describes how to install SSL on the Jira Tomcat application server. If you have an HTTP web server such as Apache in front of Jira, you can install the SSL certificate on the web server instead.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>You need to have the following set up before you can step through this recipe:</p>
<ol>
<li><strong>Obtain a valid SSL certificate</strong>: You can either use a self-signed certificate or obtain one from a <strong>certificate authority </strong>(<strong>CA</strong>) such as <strong>Verisign</strong>. Using a self-signed certificate will display a warning message when users first visit the site, as shown in the following screenshot:</li>
</ol>
<div><img src="img/aabe9ac8-5bab-4a7a-9441-a5b9cf8e6ba6.png"/></div>
<ol start="2">
<li>Ensure that the <kbd>JAVA_HOME</kbd> environment variable is set properly.</li>
<li>Make sure you know which JDK/JRE Jira is using. You can find this information from the <strong>System Info </strong>page in Jira, where you need to look for the <kbd>java.home</kbd> property.</li>
<li>Make sure your JRE/JDK's <kbd>bin</kbd> directory is added to your <kbd>PATH</kbd> environment variable, and the <kbd>keytool</kbd> command will output its usage, as shown in the following screenshot:</li>
</ol>
<div><img src="img/f5ccb9bf-75b2-4cc7-8f08-4b0e8353673f.png" style="width:37.92em;height:27.92em;"/></div>
<p>Now let's get started with the steps for this recipe.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Perform the following steps to import an SSL certificate:</p>
<ol>
<li>Open up a command window and go to the directory where the certificate file resides.</li>
<li>Generate a <strong>Java KeyStore </strong>(<strong>JKS</strong>) for Jira by running the <kbd>keytool -genkey -alias jira -keyalg RSA -keystore $JIRA_HOME/jira.jks</kbd> command.</li>
<li>Import the certificate into the KeyStore repository by running the <kbd>keytool -import -alias jira -keystore $JIRA_HOME/jira.jks -file file.crt</kbd> command, where <kbd>file.crt</kbd> is the certificate file.</li>
<li>Open the <kbd>server.xml</kbd> file located in the <kbd>JIRA_INSTALL/conf</kbd> directory in a text editor.</li>
</ol>
<ol start="5">
<li>Locate and uncomment the following XML configuration snippet:</li>
</ol>
<pre style="padding-left: 60px">&lt;Connector port="8443" <br/>maxHttpHeaderSize="8192" SSLEnabled="true" 
maxThreads="150" 
minSpareThreads="25" maxSpareThreads="75" 
enableLookups="false"
disableUploadTimeout="true" 
acceptCount="100" scheme="https" secure="true" 
clientAuth="false" 
sslProtocol="TLS" useBodyEncodingForURI="true"/&gt;</pre>
<ol start="6">
<li>Add a few new attributes to the <kbd>Connector</kbd> tag and save the file, as follows:</li>
</ol>
<pre style="padding-left: 60px">keystoreFile="PATH_TO_YOUR_KEYSTORE" 
keystorePass="PASSWORD_FOR_YOUR_KEYSTORE" 
keyAlias="jira" 
keystoreType="JKS" </pre>
<ol start="7">
<li>Restart Jira to apply the changes.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>We first created a new Java KeyStore repository for Jira to store its own SSL certificate with Java's keytool utility. During this step, you are prompted to provide information about the store as well as a password to access the KeyStore repository.</p>
<p>Do not lose the password to the KeyStore repository.</p>
<p>After we created the KeyStore repository, we imported the certificate (and then enabled an additional connector to listen for HTTPS connections) by uncommenting the connector XML tag. We also added new attributes to the tag so that Tomcat knows where our new KeyStore repository is and how to access it to get to the certificate.</p>
<p>You can also change the port number for the connector if you want to run HTTPS on a more common port, <kbd>443</kbd>, instead of the default port, <kbd>8443</kbd>, and your final XML snippet will look something similar to the following:</p>
<pre>&lt;Connector port="443"
maxHttpHeaderSize="8192" SSLEnabled="true" maxThreads="150" minSpareThreads="25"
maxSpareThreads="75" enableLookups="false"
disableUploadTimeout="true" acceptCount="100"
scheme="https" secure="true" clientAuth="false"
sslProtocol="TLS" useBodyEncodingForURI="true"
keystoreFile="/opt/jira/jira.jks" 
keystorePass="changeme"
keyAlias="jira" keystoreType="JKS"/&gt;</pre>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>At this point, users can access Jira with both HTTP and HTTPS, and you need to configure Jira so that it will automatically redirect all HTTP traffic to HTTPS. Jira comes with a handy configuration utility that can help you set up this configuration.</p>
<p>You should first make sure your HTTPS configuration is working correctly before attempting this recipe.</p>
<p>Perform the following steps:</p>
<ol>
<li>Open the Command Prompt and go to the <kbd>JIRA_INSTALL/bin</kbd> directory.</li>
<li>Depending on your OS, run the <kbd>config.bat</kbd> (Windows) or <kbd>config.sh</kbd> (Linux / OS X) file.</li>
<li>Select the Web Server<strong> </strong>tab from the JIRA Configuration Tool window.</li>
<li>Select the <strong>HTTP and HTTPs (redirect HTTP to HTTPs) </strong>option for <strong>Profile</strong>.</li>
<li>Click on the <strong>Save </strong>button at the bottom of the window, as shown in the following screenshot.</li>
</ol>
<ol start="6">
<li>Restart Jira to apply the change:</li>
</ol>
<div><img src="img/836ef919-db10-4d1f-9a16-83238bb2f394.png" style="width:41.50em;height:22.67em;"/></div>
<p>If you cannot use the JIRA Configuration Tool, you can perform the following steps to set up the configuration manually:</p>
<ol>
<li>Open the <kbd>web.xml</kbd> file located in the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF</kbd> directory.</li>
<li>Add the following XML snippet at the end of the file just before the closing <kbd>&lt;/webapp&gt;</kbd> tag:</li>
</ol>
<pre style="padding-left: 60px">&lt;security-constraint&gt; 
 &lt;display-name&gt;HTTP to HTTPs Redirection&lt;/display-name&gt; 
&lt;web-resource-collection&gt; 
 &lt;web-resource-name&gt;all-except-
 attachments&lt;/web-resource-name&gt; 
 &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt; 
 &lt;url-pattern&gt;*.jspa&lt;/url-pattern&gt; 
 &lt;url-pattern&gt;/browse/*&lt;/url-pattern&gt; 
&lt;/web-resource-collection&gt; 
&lt;user-data-constraint&gt; 
 &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt; 
 &lt;/user-data-constraint&gt; 
&lt;/security-constraint&gt; </pre>
<ol start="3">
<li>Restart Jira to apply the change.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">See also</h1>
                
            
            
                
<p>For information on connecting Jira to other applications that run on SSL, refer to the next recipe.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Installing SSL certificates from other applications</h1>
                
            
            
                
<p>You might need to connect Jira to other services, such as LDAP, mail servers, and other websites. Often, these services make use of SSL. In such cases, the connection will fail, and you will see the following errors in your Jira log file:</p>
<pre>javax.net.ssl.SSLHandshakeException: 
sun.security.validator.ValidatorException: PKIX path building failed:  
sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification
path to requested target</pre>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, we will use the Java keytool utility, so make sure you have the following configuration set up:</p>
<ul>
<li>Obtain the required SSL certificate from the target system.</li>
<li>Ensure that the <kbd>JAVA_HOME</kbd> environment variable is set properly.</li>
<li>Make sure you know which JDK/JRE Jira is using. You can find this information on the <strong>System Info </strong>page, where you need to look for the <kbd>java.home</kbd> property.</li>
<li>Make sure your JRE/JDK's <kbd>bin</kbd> directory is added to your <kbd>PATH</kbd> environment variable, and the <kbd>keytool</kbd> command will output its usage.</li>
<li>Obtain the password for the Java trust store used by Jira.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>In this recipe, let's assume we want to connect Jira to an LDAP server that is running on SSL. Perform the following steps to make it a trusted site inside Jira:</p>
<ol>
<li>Open up a Command Prompt and go to the directory where the certificate file resides.</li>
</ol>
<ol start="2">
<li>Import the certificate into the trust store by running <kbd>keytool -import -alias tomcat -file file.cer $JAVA_HOME/jre/lib/security/cacertscommand</kbd>, where <kbd>file.cer</kbd> is the certificate file.</li>
<li>Restart Jira to apply the changes.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>When Jira attempts to connect to an SSL-protected service, it will first check whether the target service's certificate can be trusted. This is done by checking to see whether the certificate is present in what is called the Java trust store. If the certificate is not present, the connection will fail.</p>
<p>The trust store is a special KeyStore repository, usually called <kbd>cacerts</kbd>, and is located in the <kbd>$JAVA_HOME/lib/security</kbd> directory on the server.</p>
<p>We used the keytool utility to import the certificate to our local trust store, so the target service will be registered as a trusted service and will allow Jira to connect to it successfully.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Resetting the Jira administrator password</h1>
                
            
            
                
<p>Sometimes, you might forget or lose the password to the account with the Jira administrator or Jira System Administrator permission, and you cannot retrieve it using the password reset option. For example, suppose Jira does not have an SMTP server configured, or you restored Jira from a data dump and do not know the account and/or password. In these cases, you need to reset the administrator password directly in the database.</p>
<p>This recipe only applies to Jira instances that use the default internal user directory option. External user management, such as LDAP, will not work with this recipe.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>As we will reset the password stored in Jira's database, make sure you do the following:</p>
<ul>
<li>Connect to the Jira database via either the command line or a GUI.</li>
<li>Update the Jira database records.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Let's assume we use the default <kbd>mysql</kbd> command-line tool and MySQL as the backend database for Jira. If you are using a different database, you may need to change the following SQL statements accordingly:</p>
<ol>
<li>Connect to the Jira database with a client tool by running the <kbd>mysql -u jirauser -p</kbd> command, where <kbd>jirauser</kbd> is the username used by Jira to access the Jira database.</li>
<li>You can find Jira's database details from the <kbd>dbconfig.xml</kbd> file located in <kbd>JIRA_HOME</kbd>.</li>
<li>Change to the Jira database by running the <kbd>use jiradb</kbd> command, where <kbd>jiradb</kbd> is the name of Jira's database.</li>
<li>Determine the groups that have the Jira System Administrator global permission with the following SQL statement:</li>
</ol>
<pre style="padding-left: 60px"><strong>select perm_parameter from 
schemepermissions where PERMISSION=44;</strong></pre>
<ol start="5">
<li>Find users that belong to the groups returned in the previous step by running the following SQL statement, where <kbd>jira-administrators</kbd> is a group returned from the previous step:</li>
</ol>
<pre style="padding-left: 60px"><strong>select child_name, directory_id
from cwd_membership where
parent_name='jira-administrators';</strong></pre>
<p>The <kbd>jira-administrators</kbd> group is the default group that administrators belong to. You might get a different group if you customize the permission configurations. The table column for the username is <kbd>child-name</kbd>.</p>
<ol start="6">
<li>Reset the user's password in the database with the following SQL statement, where <kbd>admin</kbd> is a user returned in the previous step:</li>
</ol>
<pre style="padding-left: 60px">update cwd_user set
credential='uQieO/1CGMUIXXftw3ynrsaYLShI+
GTcPS4LdUGWbIusFvHPfUzD7
CZvms6yMMvA8I7FViHVEqr6Mj4pCLKAFQ==' where
user_name='admin';</pre>
<ol start="7">
<li>Restart Jira to apply the change.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>With Jira's internal user directory, all user and group data is stored in the Jira database. The value <kbd>44</kbd> is the ID of the Jira System Administrator global permission.</p>
<p>If you do not know which groups or users are granted the Jira System Administrator global permission, you will first have to find this information using steps 4 and 5. Otherwise, you can skip to step 6 in order to reset the password.</p>
<p>Jira's user password is stored in the <kbd>cwd_user</kbd> table. As Jira only stores the hash value of the password, we changed the user's admin password hash to <kbd>uQieO/1CGMUIXXftw3ynrsaYLShI+GTcPS4LdUGWbIusFvHPfUzD7CZvms6yMMvA8I7FViHVEqr6Mj4pCLKAFQ==</kbd>, which is the UTF-8-encoded hash value of <kbd>sphere</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Importing data from CSV</h1>
                
            
            
                
<p>Often, you will need to import data from other systems into Jira. For example, you might want to migrate data from an older bug-tracking system, or if you have data coming out of other systems, you may want to use this output to populate your project.</p>
<p>As systems often have their own data structure, it is often not this straightforward to perform data migration. However, the good news is that most systems can export data in CSV (or Excel, which can be easily transformed into CSV format); we will look at using CSV as a way to import data into Jira in this recipe.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>When importing data into Jira, the most important thing is to prepare your input data file and make sure it is formatted correctly and contains all the necessary information. To help the importer, keep the following in mind:</p>
<ul>
<li>Remove any non-data-related content, especially if you created your CSV file from a spreadsheet, which will help to keep the file size down.</li>
<li>If your file contains users who need to be imported into fields such as <strong>Assignee</strong>, make sure you use either their usernames or email addresses that can be matched against corresponding accounts in Jira.</li>
<li>If your file contains dates that need to be imported into fields, such as <kbd>Due date</kbd>, make sure they are all formatted using the same date format. This is so that Jira can process date values consistently.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>To import data from other systems, perform the following steps:</p>
<ol>
<li>Log in to Jira as an administrator.</li>
<li>Select the <strong>Projects </strong>menu from the top and select the <strong>Import External Project</strong> option.</li>
<li>Select the <strong>CSV </strong>option. If, however, you see your system in the list, you can choose that instead. The process of using a system-specific importer will be mostly the same as the CSV importer, with some minor differences.</li>
</ol>
<ol start="4">
<li>Select the CSV file for the <strong>CSV Source File </strong>field. If you are performing an import for the first time, do not select the <strong>Use an existing configuration</strong> option. We will generate the configuration at the end of the import, and you will be able to use this to fast-track future imports.</li>
</ol>
<ol start="5">
<li>Expand the <strong>Advanced </strong>option if your file uses a different file encoding or uses a character other than a comma (<kbd>,</kbd>) as its separators. Click on the <strong>Next</strong> button to proceed to step 2 of the wizard:</li>
</ol>
<div><img src="img/66fdc8e4-80d0-48a7-a049-ab5d0fd5a2bc.png" style="width:48.17em;height:43.92em;"/></div>
<ol start="6">
<li>Select the project to import your data into. If you do not have a project, you can select the <strong>Select New </strong>option and create a project on-the-fly.</li>
</ol>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Generally, it is best to have the project created beforehand to ensure that it is set up with the correct configuration schemes, such as the workflow and fields.</p>
<ol start="7">
<li>Verify the <strong>E-mail Suffix for New Users </strong>and <strong>Date format</strong> values used in your CSV file. This will ensure that data such as dates will be correctly parsed while being imported and saved in Jira's date fields, such as <kbd>Due dates</kbd>:</li>
</ol>
<div><img src="img/428c337c-3c50-46bc-b21e-7769dd56a008.png" style="width:46.67em;height:28.67em;"/></div>
<ol start="8">
<li>Select and map the CSV columns to Jira fields. Certain fields, such as the <strong>Summary </strong>field, must have a corresponding column in the file; otherwise, Jira will not allow you to proceed. If you do not want to map a column, you can select the <strong>Don't map this field</strong> option.</li>
</ol>
<ol start="9">
<li>Select the <strong>Map field value </strong>option for any columns mapping to a selected list style field. This will allow you to map individual values from the CSV file column to options available in Jira. Unless you are sure that your file contents can be mapped to the Jira field options exactly, it is best to manually verify this; otherwise, you will end up with duplicated values due to, for example, case sensitivity:</li>
</ol>
<div><img src="img/fcbbc146-13f5-4109-b30c-cc6b2623d47b.png" style="width:43.92em;height:46.92em;"/></div>
<ol start="10">
<li>If you opt to map field values, review all of the listed values and map them to their corresponding field options in Jira. If a value does not have an option, you can type in the desired option and Jira will create it.</li>
<li>Click on the <strong>Begin Import </strong>button to start importing your data into Jira: </li>
</ol>
<div><img src="img/a383d060-d2b0-4c79-aa84-e0d6edc5d81a.png" style="width:36.17em;height:36.08em;"/></div>
<ol start="12">
<li>After the import process is completed, review the result. You can click on the D<strong>ownload a detailed log </strong>link to get a full log of the process if the import fails. You can also click on the S<strong>ave the configuration </strong>link to get a copy of the mapping files so that, next time, you do not have to remap everything from scratch.</li>
</ol>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>Using CSV files to import custom data into Jira is the most versatile approach since many systems can export their data into CSV. However, as you will have noted already, Jira comes with a number of specialized importers for various systems. These importers often have additional features to help with data import. The Atlassian Marketplace website (<a href="https://marketplace.atlassian.com/" target="_blank">https://marketplace.atlassian.com</a>) also has a number of importers created by third parties. If you do not see your system listed in the out-of-the-box importers, make sure you do a search in the marketplace and check whether someone has already created an importer for it.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Copying configuration settings between Jira instances</h1>
                
            
            
                
<p>If you have a controlled IT environment where changes need to go through development, testing/staging, and production processes, then, without a doubt, you will know how painful it is to promote Jira configuration changes across different environments. Since Jira does not provide a way to export configurations out of the box, all changes will need to be manually applied to each environment, which is both time-consuming and error-prone.</p>
<p>In this recipe, we will look at using a specialized tool that can help to make this process easier.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, we need to have the Configuration Manager for Jira add-on installed on both the source Jira instance as well as the target Jira instance. You can install it directly from the Universal Plugin Manager, or download it from the following link: <a href="https://marketplace.atlassian.com/plugins/com.botronsoft.jira.configurationmanager">https://marketplace.atlassian.com/plugins/com.botronsoft.jira.configurationmanager</a>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>The Configuration Manager for Jira add-on requires you to first create a snapshot. A snapshot contains all the configuration settings you want to copy over to a different Jira instance.</p>
<p>You can create two types of snapshot:</p>
<ul>
<li><strong>System</strong>: This includes all configurations in Jira.</li>
<li><strong>Project</strong>: This includes only configurations required for the selected project.</li>
</ul>
<p>Proceed with the following steps to create a configuration snapshot:</p>
<ol>
<li>Navigate to <strong>Administration</strong> &gt; <strong>Configuration Management</strong> &gt; <strong>Snapshots</strong>.</li>
<li>Click on the Add Snapshot button.</li>
<li>Opt to create either a <strong>System Configuration</strong> or <strong>Project Configuration</strong> snapshot.</li>
<li>Enter a name for the snapshot.</li>
<li>Click on the <strong>Create</strong> button. The following screenshot shows the details of the snapshot we created:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/f282d195-9eb8-4007-bd5c-6aeebc23d474.png"/></p>
<p>Having created the snapshot, there are several ways in which we can promote and deploy changes to another Jira instance. We can either download the snapshot ZIP file and upload it or link the two Jira instances together with Application Link and load the snapshot remotely. We will use the snapshot file option in this recipe. Proceed with the following steps to deploy a snapshot:</p>
<ol>
<li>Log in to the other Jira instance as an administrator.</li>
<li>Navigate to <strong>Administration</strong> &gt; <strong>Configuration Management</strong> &gt; Deploy.</li>
<li>Select the <strong>From Snapshot File</strong> option.</li>
<li>Choose the snapshot ZIP file.</li>
<li>Click on the <strong>Deploy</strong> link to start the deployment.</li>
</ol>
<p class="mce-root"/>
<p>The add-on will walk you through a deployment wizard, where it will analyze the contents of the snapshot and determine whether your current Jira system meets all the necessary requirements. For example, in the following screenshot, it has informed us that there is an add-on version mismatch:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/9b7e78a4-d9c3-4d0f-91e1-0322cf53b10a.png" style="width:44.67em;height:19.17em;"/></p>
<p>After the add-on has determined that all the requirements are met, it will provide a quick summary of all the changes that will be applied (seen in the following screenshot). This is a good time to review the list of items to make sure we are not introducing unwanted changes accidentally, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/0e8f181f-8f56-4fe7-b157-e03ae4218b51.png" style="width:42.25em;height:18.75em;"/></p>
<p>If everything looks good, we can finish migrating the configuration changes and deploy them to the target instance.</p>


            

            
        
    </body></html>