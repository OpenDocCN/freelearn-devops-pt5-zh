<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Security Monitoring</h1>
                
            
            <article>
                
<p class="calibre2">The topic of incident response was discussed in the previous chapter. In this chapter, we will introduce some <span class="calibre6">security monitoring </span><span class="calibre6">techniques. The objective of this chapter is to prepare our security monitoring mechanism to protect and prevent our cloud services from being attacked. To be prepared for this, our security monitoring procedures should include logging, monitoring the framework, threat intelligence, and security scanning for malicious programs. The topics that will be covered in this chapter are as follows:</span><strong class="calibre4"> </strong></p>
<ul class="calibre10">
<li class="calibre11">Logging policy</li>
<li class="calibre11">Security monitoring framework</li>
<li class="calibre11">Source of information</li>
<li class="calibre11">Threat intelligence toolset</li>
<li class="calibre11">Security scanning toolset</li>
<li class="calibre11">Malware behavior matching—YARA</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Logging policy</h1>
                
            
            <article>
                
<p class="calibre2">The general objective of security monitoring is to understand the existing security posture of the data, the network, endpoint hosts, gateway, cloud services, web services, databases, applications, and security configurations. This monitoring can be done by various kinds of security tools, such as host IDS, network IDS/IPS, antivirus software, firewalls, and also <strong class="calibre4">security information and event management</strong> (<strong class="calibre4"><span class="calibre6">SIEM</span></strong>). The security monitoring scenario will decide which logs should be collected, what should be monitored, and the focus of the threat visualization.</p>
<p class="calibre2">If the logs are collected too often, the information can be overwhelming and occupy too many resources, such as storage and network traffic. On the other hand, if the logs that are collected are not detailed enough, it's likely that the security professionals may not be able to identify potential risks or perform the post-mortem of a security event.</p>
<p class="calibre2"/>
<p class="calibre2">The NIST SP 800-92 Guide to Computer Security Log Management suggests that the log collection configuration should be based on the security impact to the systems. It is suggested that the logging collection and retention policies should be based on the value of the data and the business impact. An organization may define such security policies to manage the whole log infrastructure. The following table is an example of some logging policies:</p>
<p class="calibre2"><strong class="calibre4">Examples of logging configuration settings by NIST SP 800-92</strong>:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Category</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Low impact</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Moderate impact</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">High impact</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">How long to retain log data</p>
<p class="calibre2">(Keep in mind that the cybersecurity law may also have explicitly requested the log retention period. The number here is just an example.)</p>
</td>
<td class="calibre28">
<p class="calibre2">One to two weeks</p>
</td>
<td class="calibre28">
<p class="calibre2">One to three months</p>
</td>
<td class="calibre28">
<p class="calibre2">Three to 12 months</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">How often to rotate logs</p>
</td>
<td class="calibre28">
<p class="calibre2">Optional (if performed, at least every week, or for every 25 MB)</p>
</td>
<td class="calibre28">
<p class="calibre2">Every six to 24 hours, or every 2 to 5 MB</p>
</td>
<td class="calibre28">
<p class="calibre2">Every 15 to 60 minutes or every 0.5 to 1.0 MB</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><span class="calibre6">How frequently</span> the organization requires the system to transfer log data to the log management infrastructure, if it has this policy</p>
</td>
<td class="calibre28">
<p class="calibre2">Every 3 to 24 hours</p>
</td>
<td class="calibre28">
<p class="calibre2">Every 15 to 60 minutes</p>
</td>
<td class="calibre28">
<p class="calibre2">At least every five minutes</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">How often log data needs to be analyzed locally (through automated or manual means)</p>
</td>
<td class="calibre28">
<p class="calibre2">Every 1 to 7 days</p>
</td>
<td class="calibre28">
<p class="calibre2">Every 12 to 24 hours</p>
</td>
<td class="calibre28">
<p class="calibre2">At least six times a day</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Whether log file integrity checking needs to be performed for rotated logs</p>
</td>
<td class="calibre28">
<p class="calibre2">Optional</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Whether rotated logs need to be encrypted</p>
</td>
<td class="calibre28">
<p class="calibre2">Optional</p>
</td>
<td class="calibre28">
<p class="calibre2">Optional</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Whether log data transfers to the log management infrastructure need to be encrypted or performed on a separate logging network</p>
</td>
<td class="calibre28">
<p class="calibre2">Optional</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes, if feasible</p>
</td>
<td class="calibre28">
<p class="calibre2">Yes</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Security monitoring framework</h1>
                
            
            <article>
                
<p class="calibre2">Once the security detection solutions are in place, security monitoring management can be planned to perform security events correlation analysis. The purpose of the security monitoring framework is not to replace existing endpoint or network security solutions, it's to provide the security posture, the security trending, and the security events correlation of the whole environment. Some advanced security monitoring frameworks may even apply machine learning for the security events correlation to identify the abnormalities. Don't just assume that setting up a security monitoring management framework will do everything related to security monitoring. Building a complete security monitoring framework involves incorporating the following key components:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">Log collector</strong>: This is responsible for collecting and forwarding all the logs to the security monitoring team for further analysis. In the production environment, the concern of the log collection is the performance impact of the host and the number of logs needed to be forwarded. Syslog is the most common way to send the logs to security monitoring management.</li>
<li class="calibre11"><strong class="calibre1">Security monitoring</strong> <strong class="calibre1">(SIEM)</strong>: This gives the security administrator a visualized security overview of the whole environment. An ideal SIEM can even do automated security correlation analysis based on predefined rules to identify abnormalities and potential risks.</li>
<li class="calibre11"><strong class="calibre1">Threat intelligence</strong>: Threat intelligence is used to correlate the collected in-house security logs with external threat information, such as blacklisted IPs, Tor exit nodes, known malicious domains, user agents, file hashes, and the <strong class="calibre1">indicators of compromise</strong> (<strong class="calibre1">IOC</strong>).</li>
<li class="calibre11"><strong class="calibre1">Threat intelligence feeds</strong>: These form the threat database that includes known current threat information provided by cybersecurity communities, security vendors, or customer submissions. An organization may use the external threat intelligence feeds to correct internal security events in order to identify whether there are any suspicious activities, such as internal hosts connected to a known cybercrime IP.</li>
</ul>
<p class="calibre2">In practice, it's suggested that you build the threat intelligence and security monitoring after the security scanning solutions, such as host IDS/IPS and network security, are deployed and optimized. Security monitoring and threat intelligence may help you to visualize and correlate the security events across hosts and network segments, but those security monitoring technologies still rely on the host and network IDS/IPS detection and actions.</p>
<p class="calibre2">The following diagram shows the typical scope of security monitoring:</p>
<p class="cdpaligncenter1"><img class="alignnone29" src="../images/00049.jpeg"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Source of information </h1>
                
            
            <article>
                
<p class="calibre2">The various log sources will help you to provide security events in different respects. Here are some of the general recommendations of the security monitoring focuses: </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Source of information</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Security monitoring focuses</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Application logs</p>
</td>
<td class="calibre28">
<p class="calibre2">These are the operational and error logs generated by the application. If the application is a web service, the logs may be included in Apache or nginx logs:</p>
<ul class="calibre10">
<li class="calibre11">Monitor the user activities, especially those activities that involve access to sensitive data</li>
<li class="calibre11">Monitor the major changes of user profiles, such as login IPs, abnormal endpoint devices, non-browser connection clients, and concurrent connections from different IP sources</li>
<li class="calibre11">Monitor the activities of administration and service accounts</li>
<li class="calibre11">Monitor login failures and web errors, such as 401, 404, and 501</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Host security,</p>
<p class="calibre2">database logs</p>
</td>
<td class="calibre28">
<p class="calibre2">These mainly rely on the host-based IDS/IPS detection logs, OS, and database logs:</p>
<ul class="calibre10">
<li class="calibre11">Successful and failed authentication of users</li>
<li class="calibre11">Administrative access and changes</li>
<li class="calibre11">Unauthorized login failure</li>
<li class="calibre11">Major configuration file changes, such as mysql.cnf</li>
<li class="calibre11">Database accounts added</li>
<li class="calibre11">Massive data transmission to specific hosts</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Vulnerability</p>
</td>
<td class="calibre28">
<p class="calibre2">The OpenVAS or NMAP scanning results of CVE vulnerabilities</p>
<p class="calibre2">Insecure communication ports or protocols, such as Telnet, SSH v1, SSL, and FTP</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">OpenSCAP</p>
</td>
<td class="calibre28">
<p class="calibre2">The adoption of OpenSCAP scanning tools can help you to identify the insecure configuration of the applications, OS, database, and web services</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Network security,</p>
<p class="calibre2">firewalls</p>
</td>
<td class="calibre28">
<p class="calibre2">Rely on the network IDS/IPS detection logs, and also the logs from the load balancer, switches, and routers. For the updated firewall rules for IPtables, Snort, and Suricata, refer to the EmergingThreats website. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Web security</p>
</td>
<td class="calibre28">
<p class="calibre2">Rely on the web application firewall detection logs:</p>
<ul class="calibre10">
<li class="calibre11">Client IP is from a blacklisted IP</li>
<li class="calibre11">User-agent associated with suspicious clients</li>
<li class="calibre11">Too many errors in the weblogs, such as 401, 404, and 500</li>
<li class="calibre11">Refer to the OWASP ModSecurity CRS which includes the web application firewall ruleset. </li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Email security</p>
</td>
<td class="calibre28">
<p class="calibre2">Reply to the email security scanning and detection logs:</p>
<ul class="calibre10">
<li class="calibre11">Unusual mail receivers or senders</li>
<li class="calibre11">Malicious attachment files</li>
<li class="calibre11">Malicious URL in the message body</li>
</ul>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Threat intelligence toolset</h1>
                
            
            <article>
                
<p class="calibre2">The purpose of threat intelligence is to help an organization to prepare for known and unknown threats. To address the unknown threats, the external threat feeds can be used to identify whether the existing environment may have similar threats, and also be used to optimize the security detection rules. For example, a known cybercrime IP or the Tor exit IP can be used to block the outbound connection IP lists in the firewall.</p>
<p class="calibre2">Integrate the internal threat log information, and the external threat feeds will help to combine the known and unknown threats and take proactive steps. The whole threat intelligence process normally includes the following key components:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">The log collector</strong>: This is used to collect the internal system, applications, and security logs</li>
<li class="calibre11"><strong class="calibre1">SIEM/visualization</strong>: This is used to visualize the security posture in one dashboard</li>
<li class="calibre11"><strong class="calibre1">Threat intelligence platform</strong>: This is used to correlate the internal and external threat information</li>
<li class="calibre11"><span><strong class="calibre1">Threat intelligence feeds</strong></span>: <span>This is the external threat database, such as the blacklist IP, malicious hash, suspicious domain, and so on</span></li>
</ul>
<p class="calibre2">Here are some of the open source tools that will help you to build the whole threat intelligence solution:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Category</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Open source security tools</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Log collector/sensor</p>
</td>
<td class="calibre28">
<p class="calibre2"> </p>
<p class="calibre2"><strong class="calibre4">Syslog-NG</strong>: S<span class="calibre6">yslog-ng is an enhanced log daemon which can handle not only standard syslog message but also unstructured data. </span></p>
<p class="calibre2"><strong class="calibre4">Rsyslog</strong>: <span class="calibre6">Rsyslog stands for a </span><strong class="calibre4">r</strong><span class="calibre6">ocket-fast </span><strong class="calibre4">sys</strong><span class="calibre6">tem for </span><strong class="calibre4">log</strong><span class="calibre6"> processing. </span></p>
<p class="calibre2"><strong class="calibre4">FileBeat</strong>: <span class="calibre6">Filebeat provides a backpressure-sensitive protocol that controls the flow of sending data to Logstash or Elasticsearch</span></p>
<p class="calibre2"><strong class="calibre4">LogStash</strong>: Logstash is a data processing pipeline that collects the data, transforms it, and then sends it to Elasticsearch. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">SIEM/visualization</p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Kibana</strong>: <span class="calibre6">Kibana provides the visualization of the Elasticsearch data.</span></p>
<p class="calibre2"><strong class="calibre4">ElasticSearch</strong>: <span class="calibre6">Search, index and analyze the data in real time.</span></p>
<p class="calibre2"><strong class="calibre4">AlienValut OSSIM</strong>: It's an open source SIEM (Security Information and Event Management) solution provided by AlienValut.</p>
<p class="calibre2"><strong class="calibre4">Grafana</strong>: <span class="calibre6">It provides a quick solution for log query and visualization regardless of the data store.</span></p>
<p class="calibre2"><strong class="calibre4">GrayLog</strong>: It's an open soure solution for enterprise log management.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Threat intelligence platforms</p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">MISP - open source threat intelligence platform</strong>:</p>
<span>The MISP is the threat sharing platform which can search and correlate IoC (Indicators of Compromise), threat intelligence feeds and vulnerability information.</span></td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Threat intelligence feeds</p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">External threat feeds for blacklisted IP list and firewall rules suggestions</strong>:</p>
<ul class="calibre10">
<li class="calibre11"><a href="https://rules.emergingthreats.net/fwrules/" class="calibre9">https://rules.emergingthreats.net/fwrules/</a></li>
<li class="calibre11"><a href="https://www.spamhaus.org/drop/" class="calibre9">https://www.spamhaus.org/drop/</a></li>
<li class="calibre11"><a href="https://rules.emergingthreats.net/fwrules/emerging-Block-IPs.txt" class="calibre9">https://rules.emergingthreats.net/fwrules/emerging-Block-IPs.txt</a></li>
<li class="calibre11"><a href="https://check.torproject.org/exit-addresses" class="calibre9">https://check.torproject.org/exit-addresses</a></li>
<li class="calibre11"><a href="http://iplists.firehol.org/" class="calibre9">http://iplists.firehol.org/</a></li>
</ul>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Security scanning toolset</h1>
                
            
            <article>
                
<p class="calibre2">Here are some open source tools that can perform security monitoring, scanning, and detection. Although your <span class="calibre6">organization </span>may have some commercial security solutions in place, these open source security detection rules can be a good reference when optimizing the existing security detection, such as the IDS/IPS, firewall, and web security.</p>
<p class="calibre2">You may find the following rules helpful to update or improve your existing firewall rules:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">Wazuh host IDS rules</strong>: Host-based intrusion defense rules. </li>
<li class="calibre11"><strong class="calibre1">OSSEC host IDS rules</strong>: Host-based intrusion defense rules.</li>
<li class="calibre11"><strong class="calibre1">ModSecurity WAF rules</strong>: Web Application Firewall rules.</li>
<li class="calibre11"><strong class="calibre1">Suricata network IDS/IPS rules</strong>: Network-based intrusion prevention firewall rules.</li>
<li class="calibre11"><strong class="calibre1">Snort network IDS/IPS rules</strong>: Network-based intrusion prevention firewall rules. </li>
</ul>
<p class="calibre2">The table lists the security monitoring tools in each category.</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Category</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Open source security monitoring tools</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">All-in-one security scanning (host, network, visualization)</p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Security Onion</strong>: <a href="https://github.com/Security-Onion-Solutions" class="calibre9">https://github.com/Security-Onion-Solutions</a></p>
<p class="calibre2">This includes <span class="calibre6">several open source security tools, such as Elasticsearch, Logstash, Kibana, Snort, Suricata, Bro, OSSEC, Sguil, Squert, and NetworkMiner.</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">All-in-one host-based IDS, secure configuration, and visualization</p>
</td>
<td class="calibre28">
<p class="calibre2">The Wazuh integrates the <span class="calibre6">OSSEC (a host-based IDS), OpenSCAP (secure configuration scanner), and Elastic Stack (threat visualization). </span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Secure configuration</p>
</td>
<td class="calibre28">
<p class="calibre2">The OpenSCAP defines the secure configuration for OS, Web, database, and application.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Vulnerability</p>
</td>
<td class="calibre28">The OpenVAS and OWASP dependency are two of popular open source vulnerability scanners.</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"> </p>
<p class="calibre2">Antivirus</p>
</td>
<td class="calibre28">
<p class="calibre2">The CalmAV is the open source antivirus for Windows.</p>
<p class="calibre2">The LMD (Linux Malware Detect) is the Linux version open source antivirus.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Host IDS/IPS</p>
</td>
<td class="calibre28">
<p class="calibre2">The OSSEC and Samhain are two of open source host IDS/IPS solutions to be considered.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Web application firewall (WAF)</p>
</td>
<td class="calibre28">
<p class="calibre2">The ModSecurity which is one of OWASP open source project is a light-weight web application firewall. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Network IDS/IPS</p>
</td>
<td class="calibre28">
<p class="calibre2">Snort and Suricata are two of the popular open source network IDS/IPS solutions. These two solutions also provide frequently updated rules.</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Malware behavior matching – YARA</h1>
                
            
            <article>
                
<p class="calibre2">YARA (<a href="https://virustotal.github.io/yara/" class="calibre9">https://virustotal.github.io/yara/</a>) is a pattern-matching Swiss army knife for malware detection. YARA rules consist of the descriptions of malware characteristics based on textual or binary patterns. YARA can be used to perform malware detection, and the detection signatures can also be easily defined. The YARA scanner/rules can be seen as an antivirus scanner and signatures.  </p>
<p class="calibre2">For example, say that one host identifies suspicious webshell activities, but the antivirus software does not detect any suspicious activities. The security administrator can use the YARA detector with predefined YARA rules to scan all the files on the host or to scan the collected logs. Here is one <span class="calibre6">example</span><span class="calibre6"> of a </span><span class="calibre6">YARA rule to detect the web shell:</span></p>
<pre class="calibre41">rule  php_webshell : webshell<br class="title-page-name"/>{<br class="title-page-name"/>    meta:<br class="title-page-name"/>        description = “This is a sample of a PHP webshell detection rule.”<br class="title-page-name"/>    strings:<br class="title-page-name"/>         $x1 = “eval(\\\x65\\x76\\x6C”<br class="title-page-name"/>         $x2 = “Dim wshell, intReturn, strPresult”  fullword   ascii<br class="title-page-name"/>    condition:<br class="title-page-name"/>         filesize &lt; 15KB and all of them<br class="title-page-name"/>}</pre>
<p class="calibre2"><span class="calibre6">The YARA rules define two characteristics of a web shell. When the YARA rules are scanned with any binary files, and if the files match the conditions where the file size is less than 15 KB and the criteria stipulated under</span> <span class="calibre6"><kbd class="calibre12">x1</kbd> and <kbd class="calibre12">x2</kbd> are also met, then the YARA scanner will identify a match.</span></p>
<p class="calibre2">The YARA scanner can be executed as a standalone command-line tool or as a Python plugin. Refer to the YARA introductory guide <em class="calibre16">Compiling and Installing YARA</em> to get your YARA scanner on Windows, Linux, and macOS. You can find the guide at <a href="https://yara.readthedocs.io/" class="calibre9">https://yara.readthedocs.io/</a><span class="calibre6">.</span></p>
<p class="calibre2"/>
<p class="calibre2">The latest YARA rules—as well as the signatures and <span class="calibre6">detection</span> <span class="calibre6">of malware, malicious emails,</span><span class="calibre6"> </span><span class="calibre6">webshells, packers, documents, exploit kits, CVEs, and cryptography—can be found at the following links:</span></p>
<ul class="calibre10">
<li class="calibre11"><a href="https://github.com/Yara-Rules/rules" class="calibre9">https://github.com/Yara-Rules/rules</a></li>
<li class="calibre11"><a href="https://github.com/Neo23x0/signature-base" class="calibre9">https://github.com/Neo23x0/signature-base</a></li>
<li class="calibre11"><a href="https://github.com/InQuest/awesome-yara" class="calibre9">https://github.com/InQuest/awesome-yara</a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we discussed using the NIST 800-92 Guide to Computer Security Log Management to define the logging policy. We also explored the key components of a security monitoring framework, such as the log collector, SIEM, and threat intelligence. The security monitoring framework requires a source of information logs. We also discussed the source of information and stated what we are looking for in the logs. The application logs, host security logs, database logs, vulnerability scanning results, network security logs, and web and email security logs are typically the source logs for security monitoring.</p>
<p class="calibre2">We also introduced the toolset that you need to build your own in-house threat intelligence framework. <span class="calibre6">We apply the threat intelligence framework to identify known and unknown threats. Some of the open source tools that are used to build a threat intelligence framework are also shared, such as the MISP—an open source threat intelligence platform. </span>There are three key categories of tools—, the log collector, the SIEM/visualization, and the threat intelligence feeds. On the other hand, open source security scanning toolsets are also available, such as Security Onion, host IDS, vulnerability scanner, antivirus, WAF, network security, and the adoption of YARA.</p>
<p class="calibre2">In summary, security monitoring relies on the security scanning tools, the correlation of logs from various sources by SIEM, and also the threat intelligence feeds that are used to identify known and unknown threats.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Questions</h1>
                
            
            <article>
                
<ol class="calibre13">
<li class="calibre11" value="1">Which of the following is not a part of the security monitoring framework?
<ol class="calibre14">
<li class="calibre11" value="1">Log collector</li>
<li class="calibre11" value="2">Security monitoring</li>
<li class="calibre11" value="3">Threat intelligence</li>
<li class="calibre11" value="4">Encryption</li>
</ol>
</li>
<li class="calibre11" value="2">What kinds of logs will help security monitoring?
<ol class="calibre14">
<li class="calibre11" value="1">Application logs</li>
<li class="calibre11" value="2">Host security logs</li>
<li class="calibre11" value="3">Vulnerability scanning results</li>
<li class="calibre11" value="4">All of the above</li>
</ol>
</li>
</ol>
<ol start="3" class="calibre13">
<li class="calibre11" value="3">Which of the following facts is not directly related to web security?
<ol class="calibre14">
<li class="calibre11" value="1">Client IP is from blacklisted IP</li>
<li class="calibre11" value="2">User-agent is associated with suspicious clients</li>
<li class="calibre11" value="3">Unusual mail receivers or senders</li>
<li class="calibre11" value="4">Too many errors in the weblogs, such as 401, 404, 500</li>
</ol>
</li>
<li class="calibre11" value="4">Which one of the following tools is not a log collector/sensor?
<ol class="calibre14">
<li class="calibre11" value="1">Syslog</li>
<li class="calibre11" value="2">Kibana</li>
<li class="calibre11" value="3">FileBeat</li>
<li class="calibre11" value="4">LogStash</li>
</ol>
</li>
<li class="calibre11" value="5">What is Security Onion used for?
<ol class="calibre14">
<li class="calibre11" value="1">It's an all-in-one security scanning and monitoring tool (host, network, visualization)</li>
<li class="calibre11" value="2">It's a vulnerability scanner</li>
<li class="calibre11" value="3">It's an antivirus scanner</li>
<li class="calibre11" value="4">It's a WAF (web application firewall)</li>
</ol>
</li>
<li class="calibre11" value="6">What is YARA?
<ol class="calibre14">
<li class="calibre11" value="1">It's an encryption module</li>
<li class="calibre11" value="2">YARA is a pattern-matching Swiss army knife for malware detection</li>
<li class="calibre11" value="3">It's a vulnerability scanner</li>
<li class="calibre11" value="4">It's an automation framework</li>
</ol>
</li>
</ol>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Further reading</h1>
                
            
            <article>
                
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">SANS Continuous Monitoring—What It Is, Why It Is Needed, and How to Use It</strong>: <a href="https://www.sans.org/reading-room/whitepapers/analyst/continuous-monitoring-is-needed-35030" class="calibre9">https://www.sans.org/reading-room/whitepapers/analyst/continuous-monitoring-is-needed-35030</a></li>
<li class="calibre11"><strong class="calibre1">PCI DSS Part 11 - Regularly test security systems and processes</strong>: <a href="https://www.pcisecuritystandards.org/document_library?category=pcidss&amp;document=pci_dss" class="calibre9">https://www.pcisecuritystandards.org/document_library?category=pcidss&amp;document=pci_dss</a></li>
<li class="calibre11"><strong class="calibre1">Guide to Computer Security Log Management (SP 800-92)</strong>: <a href="https://ws680.nist.gov/publication/get_pdf.cfm?pub_id=50881" class="calibre9">https://ws680.nist.gov/publication/get_pdf.cfm?pub_id=50881</a></li>
<li class="calibre11"><strong class="calibre1">NIST 800-137 Information Security Continuous Monitoring</strong>: <a href="https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-137.pdf" class="calibre9">https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-137.pdf</a></li>
<li class="calibre11"><span><strong class="calibre1">Loki - Simple IOC and Incident Response Scanner</strong>: </span><a href="https://github.com/Neo23x0/Loki" class="calibre9">https://github.com/Neo23x0/Loki</a></li>
<li class="calibre11"><strong class="calibre1">Malware Indicators</strong>: <a href="https://github.com/citizenlab/malware-indicators" class="calibre9">https://github.com/citizenlab/malware-indicators</a></li>
<li class="calibre11"><strong class="calibre1">OSINT Threat Feeds</strong>: <a href="https://www.circl.lu/doc/misp/feed-osint/" class="calibre9">https://www.circl.lu/doc/misp/feed-osint/</a></li>
<li class="calibre11"><strong class="calibre1">SANS How to Use Threat Intelligence effectively</strong>: <a href="https://www.sans.org/reading-room/whitepapers/analyst/threat-intelligence-is-effectively-37282" class="calibre9">https://www.sans.org/reading-room/whitepapers/analyst/threat-intelligence-is-effectively-37282</a></li>
<li class="calibre11"><strong class="calibre1">NIST 800-150 Guide to Cyber Threat Information Sharing</strong>: <a href="https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-150.pdf" class="calibre9">https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-150.pdf</a></li>
</ul>


            </article>

            
        </section>
    </body></html>