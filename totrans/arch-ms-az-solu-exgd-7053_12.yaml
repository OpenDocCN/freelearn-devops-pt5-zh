- en: Artificial Intelligence, IoT, and Media Services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapter, we covered Governance and Policies, such as standard
    and custom roles in Azure, when to use Azure Role-based Access Security, and Azure
    Resource Policies.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, you will learn about the various features and capabilities
    that Azure offers for Artificial Intelligence, IoT, and for streaming media content.
    By the end of this chapter, you will know how to design state-of-the-art solutions
    using Azure Cognitive Services, the Azure Bot Service, IoT Hub, Azure Media Services,
    and more.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following topics will be covered:'
  prefs: []
  type: TYPE_NORMAL
- en: Azure Cognitive Services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Bot Service
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Machine Learning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IoT Hub, Event Hubs, and IoT Edge
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Stream Analytics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Time Series Insights
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Media Services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'This chapter uses the following tools for the examples:'
  prefs: []
  type: TYPE_NORMAL
- en: Visual Studio 2017: [https://www.visualstudio.com/downloads/](https://www.visualstudio.com/downloads/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The source code for this chapter can be downloaded from the following link:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://github.com/SjoukjeZaal/AzureArchitectureBook/tree/master/Chapter%2012](https://github.com/SjoukjeZaal/AzureArchitectureBook/tree/master/Chapter%2012)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Cognitive Services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With Azure Cognitive Services, you can create modern and intelligent applications.
    It offers various AI and machine learning APIs and SDKs, which can be used in
    applications to make them more intelligent, such as speech and facial recognition, speech
    and language understanding, and more.
  prefs: []
  type: TYPE_NORMAL
- en: Cognitive Services is part of the AI offering of Azure. It offers APIs that
    can be consumed *as-is* and APIs that need training and can be used to create
    your own custom AI solutions.
  prefs: []
  type: TYPE_NORMAL
- en: The APIs are split up into multiple categories, such as vision, speech, language,
    knowledge, and search APIs. These categories with the available APIs are covered
    in more detail in the upcoming sections.
  prefs: []
  type: TYPE_NORMAL
- en: Cognitive Services offers a set of APIs and SDKs that are still in the experimental
    stage as well. These services are added to the labs category. By the time of writing
    this book, the Labs section offers a gesture, event tracking, academic knowledge,
    local insights, knowledge exploration service, and entity linking service.
  prefs: []
  type: TYPE_NORMAL
- en: Available services and APIs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Azure Cognitive Services offers the following APIs and services:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Vision**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Computer Vision API**: This API provides image processing and recognition.
    You can use this API for categorizing images, tagging images based on content,
    recognizing handwritten text, flagging adult content, cropping images, detecting
    human faces, and more.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Content Moderator**: The content moderator offers automatic moderator capabilities
    such as detecting possible adult and racy content in videos. It offers review
    tooling where automatic moderation can be used in conjunction with human involvement as
    well.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Custom Vision Service**: This API offers a tool in order to build custom
    image classifiers. This can be used to identify images, such as certain flowers
    or dogs for instance. This API needs to be trained by uploading images to it.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Face API**: This API can detect human faces in an image. It can extract information
    from the images, such as pose, facial hair, glasses, gender, age, and head pose.
    You can use this API for face verification, face grouping, face identification,
    and finding similar faces.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Emotion API**: This API is part of the Face API and can be used as a standalone
    API as well. You can use it to detect the emotion of people in images.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Video Indexer**: This API can extract insights from your videos using various
    artificial intelligence technologies. This API is used inside Azure Media Services
    as well and will be covered in more detail later in this chapter.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Speech**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Microsoft Speech API**: This API provides speech-enabled features, such as
    voice command control and speech transcription and dictation. It offers speech
    to text, where human speech is converted into text, which can be used to control
    applications by speech and text to speech, where text is converted to audio streams,
    which can be played back in applications.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Custom Speech Service**: This enables you to create customized language models
    and acoustic models aimed at a specific user population or used for applications
    in a particular environment. You can train the API to learn product names or jargon.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Speaker Recognition API**:  This API provides speaker verification, which
    can be used to identify a person using voice commands for authentication. It provides
    speaker identification, where it can recognize a person in a group of speakers
    by their voice.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Translator Speech API**: This API offers a service that translates conversational
    speech from one language into the text of another language.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Language**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Language Understanding (LUIS)**: LUIS can extract meanings from text. It
    uses machine learning to train the API.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bing Spell Check API**: This offers a spell checker and a contextual grammar
    tool. It is based on all the web searches in Bing and uses machine learning to
    dynamically train the API.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Linguistic Analysis API**: This API offers three different tools for natural
    language processing, such as sentence separation and tokenization, part-of-speech
    tagging, and constituency parsing.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Text Analytics API**: This API provides natural language processing over
    raw text and includes the features mentioned here. One of the features is language
    detection for up to 120 languages. It returns a language code and a score indicating
    the strength of the analyzation. It also provides Key Phrase Extraction, where
    it extracts key phrases to identify the main points in sentences, and it offers
    sentiment analysis, which you can use to find out what people think of certain
    things by analyzing text.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Translator Text API**: This API can be used to provide text-to-text language
    translation in more then 60 different languages.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Web Language Model API**: This offers a variety of standard natural language processing
    tasks. The models are trained using Bing data at web-scale.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Knowledge**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Custom Decision Service**: You can use this API to create a personal experience
    for your users. It can personalize content or videos on a website or portal. You
    can use it for ad placement and ranking items in shops.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**QnA Maker**: This offers a web API that trains an AI model to respond to
    user''s questions in a more natural, conversational way. It can be trained using
    FAQ, URLs/documents, and more.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Search:**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bing Search APIs**: This API consists of multiple APIs and functions. It
    includes all Bing search APIs, such as the Bing web search API, Bing image search
    API, Bing video search API, and Bing news search API.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bing Autosuggest API**: This offers suggestions when you are typing the first
    few characters of a word. You can use it to populate a drop-down box under search
    boxes.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bing Custom Search API**: This offers tailored search experiences. You can
    tailor results based on interests. So, instead of letting users go through pages
    to search for relevant content, you can filter irrelevant content before providing
    it to your users.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bing Entity Search API:** This API provides search results that includes
    entities and places that can be used for tourist attractions, for instance.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: For a complete overview of all the Cognitive Services APIs, you can refer to: [https://docs.microsoft.com/en-us/azure/#pivot=products&panel=ai](https://docs.microsoft.com/en-us/azure/#pivot=products&panel=ai).
    Want to get started with Cognitive Services? You can refer to the following page
    to obtain free trial API keys for the various APIs that Cognitive Service offers: [https://azure.microsoft.com/en-us/try/cognitive-services/](https://azure.microsoft.com/en-us/try/cognitive-services/).
    These trial plans have rate limits. The Azure Portal has paid offerings. You can
    create Cognitive Services APIs in there as well.
  prefs: []
  type: TYPE_NORMAL
- en: Using the Computer Vision API
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this example, we are going to create an application that uses the Computer
    Vision API to analyze some pictures.
  prefs: []
  type: TYPE_NORMAL
- en: First, you need to obtain an API subscription key from [https://docs.microsoft.com/en-us/azure/cognitive-services/Computer-vision/Vision-API-How-to-Topics/HowToSubscribe](https://docs.microsoft.com/en-us/azure/cognitive-services/Computer-vision/Vision-API-How-to-Topics/HowToSubscribe).
  prefs: []
  type: TYPE_NORMAL
- en: Next you have to open up Visual Studio 2017.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on File | New | Project, and in the New Project window, select Console
    App. Name the project and click on OK:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c6a04c61-16ce-4b2b-85dc-dfd3bb1d94b6.png)'
  prefs: []
  type: TYPE_IMG
- en: Creating Console application
  prefs: []
  type: TYPE_NORMAL
- en: 'Create a new class, named `Extensions.cs`, and replace the code with the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following namespaces to the `Main.cs`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following variables to the `Main.cs`. Replace the `subscriptionKey`
    value with your valid subscription key:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Replace the `Main` method with the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following method for creating a request and send it to the customer
    service API of the class:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following method to import the celebrity image below the previous method:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the last method in order to display the JSON results in the Console below
    the previous method:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Now, download a celebrity image, run the application, and provide the full image
    path.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For a detailed overview of all the capabilities of the Computer Vision API,
    you can refer to: [https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/home#Categorizing](https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/home#Categorizing).
  prefs: []
  type: TYPE_NORMAL
- en: Azure Bot Service
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure Bot Service offers a complete environment to build and deploy Bots. A
    Bot is an app that can interact with users in a conversational way. It can communicate
    with users using speech, text, and cards. You can create Bots that communicate
    with users using a freeform approach, where a users asks a question in a chatbox,
    for instance, and gets an answer back from the Bot, or you can use a more guided
    approach, where you provide choices to the users and take actions based on the
    choice they make.
  prefs: []
  type: TYPE_NORMAL
- en: You can integrate Bots in all types of applications, such as custom web applications
    and Azure Functions. You can create bots that integrate in Azure SaaS applications
    as well. Azure Bot Service offers different channels to connect your Bot to Skype,
    Facebook, Teams, Slack, SMS, and more. Bots can be created using .NET or Node.js,
    and there are five different templates provided to get you up to speed with developing
    them. You can choose from a Basic Bot, a Form Bot that collects user input, a
    language understanding Bot, which leverages LUIS, a Bot to use for FAQs, and a
    Bot that alerts users about events.
  prefs: []
  type: TYPE_NORMAL
- en: 'Azure Bot Service offers the following two different pricing tiers:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Free**: This offers unlimited messages for Standard channels and 10,000 messages
    per month on Premium Channels (such as Microsoft Teams and Skype).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Standard S1**: This offers unlimited messages for Standard channels, and
    you pay a certain amount for 1,000 messages at a time on Premium channels. This
    pricing tier offers SLA as well.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can use Bots from the Azure Portal or from Visual Studio 2017. Microsoft
    offers a complete solution for building and deploying Bots, which is included
    in the Bot Builder SDK for .NET. You need to download templates that can be installed
    inside the Visual Studio `Template` folder. This template will then be a starting
    point for developing Bots.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a Bot from the Azure Portal
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this example, we are going to create a Bot that can be deployed in a Web
    App from the Azure Portal:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure Portal by opening: [https://portal.azure.com/](https://portal.azure.com/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on New and type `Web App Bot`in the search bar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Enter the following settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f07a0fbc-a252-46c5-8f5b-6052a43537c3.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Web App Bot settings
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on Bot template, select the Form template, and click on Select:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2dd9637b-e9a8-4cc5-901f-9d029a102ca2.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Selecting Bot template
  prefs: []
  type: TYPE_NORMAL
- en: 'When created, you can navigate to the Bot in the Azure Portal. When you click
    on Build in the left menu, you can make changes to the code in the online code
    editor. There are a couple of tools integrated in the online editor, such as Git,
    Kudu, and more. You can download the ZIP file to make changes in Visual Studio,
    and you can configure Continuous Deployment as well:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/908bd0f2-136c-42c4-b965-d92057f74786.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Bot Build settings
  prefs: []
  type: TYPE_NORMAL
- en: 'To test the Bot, click on Test in Web Chat in the left menu. This Bot provides
    an example of a sandwich ordering service, using a guided approach. So, if you
    type anything in the message box, you get a set of options for sandwiches to order.
    Pick one, and you can select the length of your sandwich:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5700fe11-32c9-45d8-ba7d-249ff7dd2773.png)'
  prefs: []
  type: TYPE_IMG
- en: Example of bot
  prefs: []
  type: TYPE_NORMAL
- en: 'For channel registration, you can click on Channels in the left menu. Here,
    you can register the different channels that you want your Bot to connect to:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/cfc44974-5a1e-4072-9916-2e629feaf22a.png)'
  prefs: []
  type: TYPE_IMG
- en: Different bot channels
  prefs: []
  type: TYPE_NORMAL
- en: For more information about how to create Bots using Visual Studio 2017, you
    can refer to [https://docs.microsoft.com/en-us/bot-framework/dotnet/bot-builder-dotnet-quickstart](https://docs.microsoft.com/en-us/bot-framework/dotnet/bot-builder-dotnet-quickstart).
  prefs: []
  type: TYPE_NORMAL
- en: Azure Machine Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We all produce massive amounts of data these days. Data created in the past
    can give us valuable insights into the future.
  prefs: []
  type: TYPE_NORMAL
- en: Machine learning provides a set of algorithms that can apply complex mathematical
    calculations to big data automatically and can eventually learn from this data. It
    is a data science technique, which can be used to predict the future by forecasting
    outcomes and trends. Applications using this technique can learn from data and
    experiences without being explicitly programmed. Machine learning models can be
    trained using large amounts of historical data which applications can act upon.
  prefs: []
  type: TYPE_NORMAL
- en: Fraud detection, self-driving vehicles, and personal recommendations on websites
    are all examples of applications that use machine learning. Artificial intelligence
    and machine learning possibilities are endless and will have an enormous impact
    on our daily lives in the near future.
  prefs: []
  type: TYPE_NORMAL
- en: 'Azure Machine Learning provides a set of tools and capabilities for data scientists
    and developers to leverage machine learning in their applications. The following
    tools and capabilities are offered:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Machine Learning Studio**: Machine Learning Studio is a drag and drop tool,
    which you can use to create predictive models. You can use it to deploy and test
    your solutions as well. You can create **Experiments** on which you can drag and
    drop datasets and data analyzation activities, named **Modules**. You can train
    the **Experiments** using parts of the data from the datasets, and when the models
    are trained properly, you can convert them into **Predictive** experiments and
    publish them as web services.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure Machine Learning Workbench**:At the time of writing this book, this
    tool is still in preview. It offers an integrated end-to-end data science solution
    for data scientists to prepare data, develop experiences, and deploy models to
    Azure.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure AI Gallery**: The AI Gallery provides various community-driven solutions
    built with different AI features of Azure. You can use these solutions for learning
    purposes or as a resource for developing your custom solutions.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Machine Learning Modules**: You can use out-of-the box machine learning models
    in your experiments for analyzing data. There are machine learning algorithms,
    data input and output modules, data transformation modules, text analytics modules,
    and Microsoft-specific modules with algorithms from Bing and Xbox.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data Science**** Virtual Machines**: Azure offers virtual machines that are
    configured for data science workloads. There are Windows and Linux Data Science
    VMs and Deep Learning VMs. You can deploy containers for data science workloads
    as well:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/a3c8bbd2-4d53-4468-aa75-f779023566fe.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Machine Learning studio
  prefs: []
  type: TYPE_NORMAL
- en: Data science is a specialization; however, Microsoft offers a series of videos
    that can give some basic understanding of data science. For these series of videos,
    you can refer to: [https://docs.microsoft.com/en-us/azure/machine-learning/studio/data-science-for-beginners-the-5-questions-data-science-answers#other-videos-in-this-series](https://docs.microsoft.com/en-us/azure/machine-learning/studio/data-science-for-beginners-the-5-questions-data-science-answers#other-videos-in-this-series).
  prefs: []
  type: TYPE_NORMAL
- en: Azure IoT Hub
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In an Internet of Things (IoT) solution, devices send massive amounts of data
    to Azure for further processing. The IoT Hub is used to connect these devices
    securely and route the messages from those devices to different resources in Azure
    for further processing.
  prefs: []
  type: TYPE_NORMAL
- en: 'The IoT Hub offers the following capabilities:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bi-directional communication**: It provides bi-directional communication
    between devices and Azure, such as one-way messaging, file transfer, and request-reply
    messaging. Devices can send data to Azure IoT Hub, but the IoT Hub can send data
    to the devices as well. It supports various communication protocols, such as HTTPS,
    AMQP, and MQTT. It provides built-in declarative message routing to other Azure
    services.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Secure Connectivity**:Communication between devices and the IoT Hub can be
    secured using per-device security keys or X.509 certificates. Azure IoT Hub does
    not open any connections, only connected devices initiate all the connections.
    IoT Hub stores the messages inside a per device queue for two days and waits for
    the device to connect. It uses Azure AD for user authentication and authorization.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Scaling**: IoT Hub offers massive scaling because it can scale up to millions
    of simultaneously connected devices and millions of events per second.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Monitoring**:It offers a monitoring solution in Azure. IoT Hub is integrated
    with Azure Monitor, which gives you detailed information about device management
    operations and connectivity events.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure IoT Hub offers the Azure IoT SDK, which consists of Device SDKs and can
    be used to create apps that run on IoT devices and send data to the IoT Hub. The
    SDK also offers Service SDKs, which can be used to manage the IoT Hub, and it
    offers the Azure IoT Edge, which is covered in more detail later in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: 'IoT Hub comes in the following pricing tiers:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Free**:This offers total 8,000 messages per unit a day. This tier is most
    suitable for testing scenarios.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Standard S1**: This offers up to 400,000 messages per day across all connected
    devices. This is must suitable for scenarios that generate small amounts of data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Standard S2**: This offers up to 6 million messages per unit a day across
    all connected devices. This is suitable for scenarios with large amounts of data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Standard S3**: This offers up to 300 million messages per unit a day across
    all connected devices. This is suitable for scenarios with large amounts of data
    as well.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Next to the IoT Hub, Azure offers the Azure Event Hub. The Azure Event Hub offers
    similar capabilities such as the Azure IoT Hub, except that the IoT Hub offers
    more advanced capabilities. If your architecture demands cloud-to-device communication
    or per device security and performance management, the IoT Hub is the best solution.
  prefs: []
  type: TYPE_NORMAL
- en: 'The Event Hub is covered in more detail in the next section. Azure also offers
    IoT Edge, which offers additional functionality and will be covered in the next
    section as well:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/229d6043-97de-4ed7-a9af-26b6797bffb5.png)'
  prefs: []
  type: TYPE_IMG
- en: IoT architecture overview
  prefs: []
  type: TYPE_NORMAL
- en: Azure Event Hub
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure Event Hub is designed for high throughput ingress of data streams generated
    by devices and services. It provides a telemetry ingestion service that can collect,
    transform, and store millions of events.
  prefs: []
  type: TYPE_NORMAL
- en: It offers similar capabilities such as the IoT Hub, but there are differences
    as well. When to use which solutions depends on the scenario. If your solution
    demands high throughput data ingestion only, Azure Event Hubs is a more cost-effective
    solution than the IoT Hub. However, if your solution needs bi-directional communication,
    such as communicating from the cloud to your devices, IoT Hub is a better solution.
  prefs: []
  type: TYPE_NORMAL
- en: 'To make the right decision on which solution to use for your IoT architecture,
    you can look at the following differences:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Device Protocol Support**: Azure Event Hub supports HTTPS, AMQP, and AMQP
    where the IoT Hub supports  MQTT, MQTT over WebSockets, AMQP, AMQP over WebSockets,
    and HTTPS, MQTT, MQTT over WebSockets, AMQP, AMQP over WebSockets. IoT Hub supports
    file upload as well.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Communications Patterns**: The Event Hub only supports event ingress where
    the IoT Hub supports device-to-cloud communications and cloud-to-device communications
    as well.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Security**:The Event Hub supports Shared Access Policies, where the IoT Hub
    supports per device identity and revocable access control.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Monitoring**: The IoT Hub offers a complete set of monitoring capabilities,
    where the Event Hub only offers aggregate metrics.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Scale**:IoT Hub can scale up to millions of simultaneously connected devices
    and millions of events per second, where the Event Hub can scale up to 5,000 AMQP
    connections per namespace.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SDKs**: Event Hubs supports .NET and C, where IoT Hub supports .NET, C, Node.js,
    Java, and Python.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For a complete overview of the differences between the Event Hub and the IoT
    Hub, you can refer to: [https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-compare-event-hubs](https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-compare-event-hubs).
  prefs: []
  type: TYPE_NORMAL
- en: 'Azure Event Hub offers the following three different pricing tiers:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Basic**: This offers a maximum of 20 throughput units with 1 MB/s ingress
    and 2 MB/s egress per unit. Maximum message size is 256 KB. A message retention
    of 1 day, 1 consumer group, and 100 brokered connections.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Standard**:On top of the basic features, the standard plan offers lower costs
    for throughput units and messages. It offers 20 consumer groups and 1,000 brokered
    connections.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Dedicated**: This offers a dedicated environment for customers. Offers a
    maximum message size of 1 MB and 50 throughput units, a retention period of 7
    days and 25,000 brokered connections.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure IoT Edge
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure IoT Edge is an additional feature of Azure IoT Hub, which is installed
    at the edge of the on-premises network, inside a DMZ or inside the corporate network.
    Instead of sending messages to Azure, the messages can be sent to Azure IoT Edge,
    which takes less time because it doesn't have to be sent beyond the on-premises
    network. Data can be stored and analyzed on the device as well.
  prefs: []
  type: TYPE_NORMAL
- en: You can register the IoT Edge inside the IoT Hub settings page in the Azure
    Portal. The IoT Edge runtime can then be installed on the IoT Edge device. Devices
    can be a Windows or Linux machine, a container, or a Raspberry Pi, for instance.
    This IoT Edge device can then connect to the Azure IoT Hub, collect the data from
    the devices, and send it to the IoT Hub.
  prefs: []
  type: TYPE_NORMAL
- en: Azure Stream Analytics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure Stream Analytics is part of Azure's IoT Suite and offers a pipeline for
    event processing and real-time analytics for the data that is streaming from various
    sources. You can use it for scenarios that require real-time analytics on data,
    such as stock analysis, fraud detection, and analyzing data that comes from a
    massive amount of sensors, for instance.
  prefs: []
  type: TYPE_NORMAL
- en: Data can come from various sources, such as custom applications, sensors, Azure
    IoT Hub, and Azure Event Hubs. It can come from Blob Storage as well. Stream Analytics
    can handle an ingest of data up to 1 GB per second. You can create a Stream Analytics
    **Job**, where you configure the data source. You can create a **Transformation**,
    where you can query the data for patterns or relationships using a SQL-like language.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can create filter, sort, or aggregate the data from the data sources. Finally,
    the data is sent to an output source, which can be Azure Data Lake, Power BI for
    creating dashboards, using machine learning, or storing it in a SQL Data Warehouse:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/937c2d1a-678a-46bf-8908-7b20edc0a912.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure Stream Analytics
  prefs: []
  type: TYPE_NORMAL
- en: Azure Time Series Insights
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Time Series Insights offers a portal that can be used to get valuable insights
    in your IoT data. It offers database storage for a massive amount of data sent
    from IoT Hub and Event Hubs. It can join different types of data easily, such
    as metadata and telemetry, and then visualize this data.
  prefs: []
  type: TYPE_NORMAL
- en: 'Time Series Insights offers the following features:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Integration**: It offers out-of-the-box integration with Azure IoT Hub and
    Event Hub.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data Storage**: Time Series Insights stores your data on SSDs and in memory
    for up to 400 days.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Visualization**: This offers a dedicated portal that offers visualization
    of your data using the TSI Explorer.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Query Service**: Time Series insights offers a query service inside the TSI
    Explorer and APIs that can be called from your custom applications. By integrating
    Time Series Insights in your applications, you can leverage it as a backend for
    indexing, storing, and aggregating data. You can then build your custom visualization
    tool on top of it.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/ce469e89-14c2-440e-903e-95b06ccbd088.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Azure Time Series Insights TSI Explorer
  prefs: []
  type: TYPE_NORMAL
- en: Azure Media Services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure Media Services offers a secure and high-quality service in order to stream
    content to all sorts of devices. It can stream videos or audio files and offers
    REST APIs to upload, store, and encode package content. Audios and videos can
    be delivered to clients, such as TVs, computers, and mobile devices using both
    on-demand streaming and live streaming.
  prefs: []
  type: TYPE_NORMAL
- en: 'Azure Media Services supports the following flow:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Upload**: You can upload your videos using the Azure Portal, .NET SDK, REST
    API, and you can copy files from Blob Storage.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Encode**:AMS offers two different encoding tiers, such as Media Encoder Standard
    and Media Encoder Premium Workflow. The former offers an encoding service which
    encodes video and audio files, which are suitable for playback on a variety of
    devices, such as smartphones and PCs. The latter offers encoding for video and
    audio files that require a more complex workflow. It offers a Workflow Designer
    tool, which can be used for combining multiple input files or to create decision-based
    workflows with dynamic values using parameters. It also supports formats that
    are required for broadcasting and movies.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Secure**: You can secure your media using dynamic encryption using the Advanced
    Encryption Standard (AES-128) or other major digital rights management (DRM) systems.
    It offers AES keys and DRM licenses to authorized clients as well. You can secure
    your Media Services Channels with IP restrictions, so users can only upload media
    content from allowed IP addresses, and you can access the Azure Media Services
    API with Azure AD authentication. AMS still supports the Azure Access Control
    service authentication model using tokens. However, this will be deprecated in
    the near future, so Azure AD authentication is the preferred authentication method
    now.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Analyze**:AMS offers Media Analytics in order to extract insights from media
    content. It offers a collection of speech and computer vision APIs from Azure
    Cognitive Services. This is described in the following section in more detail.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Media Analytics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Azure Media Analytics uses various Cognitive Services APIs to analyze media
    content. It offers the following capabilities:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Indexer**: Using the Indexer, you can create closed-captioning tracks and
    make the media file searchable. By the time of writing, the Indexer offers two
    different versions of the service, where the Azure Media Indexer 2, which is still
    in preview, has faster indexing and broader language support.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Hyperlapse**: This offers time lapse capabilities and capabilities to create
    stable videos from first person or action camera content.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Motion Detector**: This offers motion detection, which can be used on static
    camera footage to identify parts in the video where motion occurs. It generates
    a metadata file with timestamps of when the motion occurred. This is very useful
    for security camera footage.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Video Summarization**: This can create summaries for videos by generating
    snippets from different sections of the video. These snippets can be placed as
    an overview of all the different sections of the video.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Optical Character Recognition**: Azure Media optical character recognition
    (OCR) offers converting text content in videos into editable and searchable digital
    text. For instance, you can use this for making the content of videos of PowerPoint
    presentations searchable in search engines.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Scalable Face Redaction**: You can use scalable face redaction for blurring
    faces of individuals on video content automatically.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Content Moderation**:Azure Content Moderator offers automatic moderator capabilities
    such as detecting possible adult and racy content in videos. It offers review
    tooling where automatic moderation can be used in conjunction with human involvement as
    well.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using the Azure Media Analytics Indexer
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the following example, we are going to create closed caption files for a
    video using the Azure Media Analytics Media Indexer. Microsoft recommends using
    Azure Media Analytics over the Video API from Cognitive Services, so that's what
    we are going to use here. We are going to use the speech to text feature of the
    Azure Media Indexer 2 Preview media processor (MP) to create subtitles for the
    video from a Console Application.
  prefs: []
  type: TYPE_NORMAL
- en: For this example, you need to create a Media Service Account in the Azure Portal.
    For a complete walkthrough on how to create this, you can refer to: [https://docs.microsoft.com/en-us/azure/media-services/media-services-portal-create-account](https://docs.microsoft.com/en-us/azure/media-services/media-services-portal-create-account).
  prefs: []
  type: TYPE_NORMAL
- en: 'When the Azure Media Service account is created, you can copy the `PacktIndexer`
    folder from GitHub to your `C:` drive. You can download the video from the following
    website and put it inside the `InputFiles` folder together with the JSON file:
    [https://peach.blender.org/download/](https://peach.blender.org/download/). These
    files will be used for the example. Create a new folder named `OutputFiles` in
    the `PacktIndexer` folder as well.'
  prefs: []
  type: TYPE_NORMAL
- en: Next, open up Visual Studio 2017 and create a new project.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on File | New | Project, and in the New Project windows, select Console
    App. Name the project and click on OK:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ddbbf32e-e642-4bd4-b3fc-5d3cb79b7a7c.png)'
  prefs: []
  type: TYPE_IMG
- en: Create a new Console Application
  prefs: []
  type: TYPE_NORMAL
- en: Install the `windowsazure.mediaservices.extensions` and the `windowsazure.mediaservices`NuGet
    packages.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The first step is adding Azure AD authentication to the project. For this demo,
    we are using **Service principal authentication**.You can set this up easily in
    the Azure Portal in the access blade of the Azure Media Service Account settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2fee99bf-ae84-498b-a3dc-2df2f8eca281.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Creating a App Service Principal
  prefs: []
  type: TYPE_NORMAL
- en: 'Copy the Azure AD tenant name, the API URL, client ID, and client secret from
    the Azure Portal and add them to the following code:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following code to the `Main` method below the authentication code:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following method for creating and running the `Index Job`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following method in order to create the `Asset`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following method for downloading the `Asset` after indexing:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'Add the following code for obtaining the `MediaProcessor` that processes the
    video:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'At last, add the following code in order to display the process inside the
    console:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: Run the App, and after indexing, you should have a `WebVtt` and `ttml` file
    in the `output` folder according to the values in the JSON input files.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this example, we have created closed caption files. You can call other methods
    for indexing the video as well. The following website provides you with some more
    examples for the other capabilities that are described earlier: [http://azuremedialabs.azurewebsites.net/demos/Analytics.html](http://azuremedialabs.azurewebsites.net/demos/Analytics.html).
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we covered how to design solutions using the various AI services
    that Azure offers. We covered Azure Machine Learning, IoT features, and Azure
    Media Services.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we are going to cover the different messaging capabilities
    that Azure provides and how to design effective messaging architectures.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Answer the following questions to test your knowledge of the information in
    this chapter. You can find the answers in the *Assessments* section at the end
    of this book.
  prefs: []
  type: TYPE_NORMAL
- en: You are designing an IoT Solution using the IoT Hub that needs to process 5
    million events a day. Does the Standard S1 tier suit your needs?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Does Azure Media Services use various Azure Cognitive Services APIs underneath?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Should you use Azure Event Hubs in scenario where bi-directional communication
    between Azure and devices is required?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can check the following links for more information about the topics that
    were covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Cognitive Services Directory**: [https://azure.microsoft.com/en-us/services/cognitive-services/directory/lang/](https://azure.microsoft.com/en-us/services/cognitive-services/directory/lang/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**About Bot Service**: [https://docs.microsoft.com/en-us/bot-framework/bot-service-overview-introduction](https://docs.microsoft.com/en-us/bot-framework/bot-service-overview-introduction)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Introduction to Machine Learning in the Azure Cloud**: [https://docs.microsoft.com/en-us/azure/machine-learning/studio/what-is-machine-learning](https://docs.microsoft.com/en-us/azure/machine-learning/studio/what-is-machine-learning)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**What is Azure Machine Learning Studio?**: [https://docs.microsoft.com/en-us/azure/machine-learning/studio/what-is-ml-studio](https://docs.microsoft.com/en-us/azure/machine-learning/studio/what-is-ml-studio)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Share and discover resources in the Azure AI Gallery**: [https://docs.microsoft.com/en-us/azure/machine-learning/studio/gallery-how-to-use-contribute-publish](https://docs.microsoft.com/en-us/azure/machine-learning/studio/gallery-how-to-use-contribute-publish)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure Machine Learning WorkBench**: [https://blogs.msdn.microsoft.com/uk_faculty_connection/2017/09/29/azure-machine-learning-workbench/](https://blogs.msdn.microsoft.com/uk_faculty_connection/2017/09/29/azure-machine-learning-workbench/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure Machine Learning Studio Algorithm and Module Reference**: [https://docs.microsoft.com/en-us/azure/machine-learning/studio-module-reference/index](https://docs.microsoft.com/en-us/azure/machine-learning/studio-module-reference/index)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure IoT Suite**: [https://azure.microsoft.com/en-us/suites/iot-suite/](https://azure.microsoft.com/en-us/suites/iot-suite/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Overview of the Azure IoT Hub service**: [https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-what-is-iot-hub](https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-what-is-iot-hub)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Event Hubs Documentation**: [https://docs.microsoft.com/en-us/azure/event-hubs/](https://docs.microsoft.com/en-us/azure/event-hubs/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure IoT Edge**: [https://docs.microsoft.com/en-us/azure/iot-edge/](https://docs.microsoft.com/en-us/azure/iot-edge/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Stream Analytics Documentation**: [https://docs.microsoft.com/en-us/azure/stream-analytics/](https://docs.microsoft.com/en-us/azure/stream-analytics/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure Time Series Insights**: [https://docs.microsoft.com/en-us/azure/time-series-insights/](https://docs.microsoft.com/en-us/azure/time-series-insights/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Media Services Documentation**: [https://docs.microsoft.com/en-us/azure/media-services/](https://docs.microsoft.com/en-us/azure/media-services/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
