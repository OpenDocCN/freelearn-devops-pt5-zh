<html><head></head><body>
        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Cloud Computing and Configuration Management</h1>
            

            <article>
                
<div class="packtquote1">"Change is hard because people overestimate the value of what they have and underestimate the value of what they may gain by giving that up." <br class="title-page-name"/>
                                                                                                                                                                                                                                       – James Belasco and Ralph Stayer</div>
<p class="calibre2">In the previous chapter, we have seen an overview of Docker containers. In this chapter, we will focus on creating and configuring the environment for application deployment in the cloud. We will use <strong class="calibre1">Infrastructure as a Service</strong> (<strong class="calibre1">IaaS</strong>) and the configuration management tool, Chef, to create a platform so that we can deploy an application in the later part using automation.<br class="title-page-name"/>
<br class="title-page-name"/>
Chef is a configuration management tool that can be utilized to create a runtime environment for application deployment on a physical machine, virtualized infrastructure, or in the public or private cloud infrastructure.<br class="title-page-name"/>
<br class="title-page-name"/>
In this chapter, we will cover the following topics:</p>
<ul class="calibre10">
<li class="calibre11">An overview of the Chef configuration management tool</li>
<li class="calibre11">Installing and configuring a Chef workstation</li>
<li class="calibre11">Converging a Chef node using a Chef workstation</li>
<li class="calibre11">Installing Tomcat packages using community cookbooks  </li>
</ul>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">An overview of the Chef configuration management tool</h1>
            

            <article>
                
<p class="calibre2">Chef is one of the most popular configuration tools. It comes in two flavors:</p>
<ul class="calibre10">
<li class="calibre11">Open source Chef server</li>
<li class="calibre11">Hosted Chef</li>
</ul>
<p class="calibre2">What we intend to do here is to show how to prepare a runtime environment for application deployment. Let's understand it in terms of application life cycle management:</p>
<ol class="calibre17">
<li value="1" class="calibre11">We have a Java-based Spring application package ready after continuous integration.</li>
<li value="2" class="calibre11">We need to deploy the application in the Tomcat web server.</li>
<li value="3" class="calibre11">The Tomcat server can be installed in a physical system, virtualized environment, Amazon EC2 instances, or Microsoft Azure virtual machines.</li>
<li value="4" class="calibre11">We also need to install Java.</li>
</ol>
<p class="calibre2">In all these, except for the first point, we need to do the installation and configuration activity manual avoid such a repetitive scenario, we can use the Chef configuration management tool to create a virtual machine in AWS or in Microsoft Azure and then install Tomcat with all the dependencies in order to deploy our <span>Java-based spring application.</span></p>
<p class="calibre2">However, let's look at the basics of the Chef configuration management tool so that we can understand how Chef works and how it performs various steps.</p>
<p class="calibre2">There are three important parts of the Chef configuration management tool:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">The open source Chef server or hosted Chef</strong>: The Chef server installed on-premise or the hosted Chef, is the heart of this automation process of installing the runtime environment. It is a centralized repository of cookbooks and details of registered nodes. A Chef workstation is used to upload cookbooks and make changes in the configurations so that they can be applied to the nodes available in the AWS and Microsoft Azure.</li>
<li class="calibre11"><strong class="calibre1">The Chef workstation</strong>: A Chef workstation is a system where we can manage cookbooks and other changes. We can perform all the administrative tasks from the Chef workstation. Knife is used to upload cookbooks to the Chef server and execute plugin commands. Knife plugins can be used to perform various operations in AWS and Microsoft Azure Cloud.</li>
<li class="calibre11"><strong class="calibre1">Node</strong>: A node is a physical or virtual machine. This virtual machine can be in a virtualized environment, a private cloud empowered by Openstack or VMware, or in a public cloud such as AWS or Microsoft Azure:
<ul class="calibre24">
<li class="calibre11">The node communicates with the open source or hosted Chef server</li>
<li class="calibre11">Node gets the configuration details related to itself, and then starts executing the steps based on these to maintain itself in compliance with what the administrator has decided</li>
</ul>
</li>
</ul>
<p class="calibre2">Go to the official Chef website at <a href="https://chef.io" class="calibre4">https://chef.io</a> and visit the Chef homepage. We can use the on-premise Chef server by installing and managing it on our own or we can use the hosted Chef:</p>
<div class="CDPAlignCenter"><img class="image-border37" src="../images/00147.jpeg"/></div>
<ol class="calibre17">
<li value="1" class="calibre11">Click on <span>MANAGEMENT CONSOLE</span> on <a href="https://chef.io" class="calibre4">https://chef.io</a>  or navigate to <a href="https://manage.chef.io/login" class="calibre4">https://manage.chef.io/login<span>.</span></a></li>
<li value="2" class="calibre11">On <a href="https://manage.chef.io/login" class="calibre4">https://manage.chef.io/login</a>  click on <span>Click here to get started!<span>.</span></span></li>
<li value="3" class="calibre11">Provide the <span>Full Name</span>, <span>Company</span> name, <span>Email ID</span>, and <span>Username<span>.</span></span></li>
<li value="4" class="calibre11">Check the box that says <span>I agree to the Terms of Service and the Master License and Services Agreement<span>.</span></span></li>
<li value="5" class="calibre11">Click on the <span>Get Started</span> button.</li>
</ol>
<p class="calibre2">Refer to the following screenshot:</p>
<div class="CDPAlignCenter"><img class="image-border38" src="../images/00014.jpeg"/></div>
<p class="calibre2">So the obvious next step is to go to the mailbox and verify the e-mail ID to complete the registration process. We will get an e-mail verification successful message:</p>
<ol class="calibre17">
<li value="1" class="calibre11"><span>Provide the password and click on the <span><span>Create User</span></span> button.</span></li>
<li value="2" class="calibre11">Now create an organization.</li>
<li value="3" class="calibre11">Click on <span>Create New Organization<span>.</span></span></li>
<li value="4" class="calibre11">Provide the <span>Full Name</span> and <span>Short Name</span> of the organization<span>.</span></li>
<li value="5" class="calibre11">Click on the <span>Create Organization</span> button<span>.</span></li>
</ol>
<p class="calibre2">Refer to the following screenshot:</p>
<div class="CDPAlignCenter"><img class="image-border39" src="../images/00151.jpeg"/></div>
<p class="calibre2">Now, download a starter kit:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00025.jpeg"/></div>
<ol class="calibre17">
<li value="1" class="calibre11">Click on <span>Download Starter Kit</span>.</li>
<li value="2" class="calibre11">We will get confirmation dialog; click on <span>Proceed</span>.</li>
<li value="3" class="calibre11">Let's verify the operations available on the hosted Chef.</li>
</ol>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">We haven't configured any node, so the node list is empty. Click on <span>Nodes</span>. Once we create the node and register it, we will get all the details about that node in the Chef server or on the hosted Chef.</li>
<li value="5" class="calibre11">Go to the <span>Administration</span> menu and click on <span>Users</span> in the sidebar.</li>
<li value="6" class="calibre11">Verify the <span>User Name</span>, <span>Full Name</span>, and <span>Email</span> ID created at the time of registration:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00156.jpeg"/></div>
<p class="calibre2">Check the <span>Reports</span> tab and we won't find any data. The reason for this is that the process of <span>convergence, where nodes become compliant based on the configuration available on the Chef server, has not taken place and hence there is no data.</span></p>
<p class="calibre2">At this stage, we have a hosted Chef account available.</p>
<p class="calibre2">Now, let's configure a Chef workstation so that we can communicate with the hosted Chef and converge the nodes in AWS and Microsoft Azure Cloud:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Based on the operating system, download the Chef client installable file. In our case, we are using CentOS; therefore, we will download the Red Hat version of the Chef client from <a href="https://downloads.chef.io/chef-client/redhat/" class="calibre4">https://downloads.chef.io/chef-client/redhat/</a>.</li>
<li value="2" class="calibre11">Select the operating system type.</li>
<li value="3" class="calibre11">Select the Chef client version.</li>
<li value="4" class="calibre11">Download the installation files.</li>
</ol>
<p class="calibre2">The Chef-dk or Chef development kit is used for installing development tools, and it can also be used to install knife plugins for AWS and Microsoft Azure. Download it from <a href="https://downloads.chef.io/chef-dk/" class="calibre4">https://downloads.chef.io/chef-dk/</a>. This will help us to install <kbd class="calibre15">knife-ec2</kbd> and <kbd class="calibre15">knife-azure</kbd> plugins so that we can create and manage virtual machines in the cloud environment.</p>
<p class="calibre2">Once we have installable files ready for the Chef client and Chef development kit and the hosted Chef account is also available, it is time to install and configure the Chef workstation. Let's do it in the next section.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Installing and configuring a Chef workstation</h1>
            

            <article>
                
<p class="calibre2">Let's verify whether the Chef client has been installed on the system or virtual machine where we want to configure the Chef workstation:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Execute the <kbd class="calibre15">chef-client -version</kbd> command; if we get the command not found error, then it means that the Chef client is not installed. If the Chef client is installed, then it will give the version number:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [mitesh@devops1 Desktop]$ chef-client -version</strong><br class="title-page-name"/><strong class="calibre1">        bash: chef-client: command not found</strong>
</pre>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">Go to the directory where the Chef client installable is downloaded:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [mitesh@devops1 Desktop]$ cd chef/</strong><br class="title-page-name"/><strong class="calibre1">        [mitesh@devops1 chef]$ ls</strong><br class="title-page-name"/><strong class="calibre1">        chef-12.9.41-1.el6.x86_64.rpmchefdk-0.13.21-<br class="title-page-name"/>        1.el6.x86_64.rpm</strong>
</pre>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">Run the Chef client RPM using <kbd class="calibre15">rpm -ivh chef-&lt;version&gt;.rpm</kbd>:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [mitesh@devops1 chef]$ rpm -ivh chef-12.9.41-   <br class="title-page-name"/>        1.el6.x86_64.rpm<br class="title-page-name"/></strong><strong class="calibre1">        warning: chef-12.9.41-1.el6.x86_64.rpm: Header <br class="title-page-name"/>        V4DSA/SHA1 Signature, key ID<br class="title-page-name"/></strong><strong class="calibre1">        83ef826a: NOKEY<br class="title-page-name"/></strong><strong class="calibre1">        error: can't create transaction lock on <br class="title-page-name"/>        /var/lib/rpm/.rpm.lock (Permission   <br class="title-page-name"/>        denied)</strong>
</pre>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">If the permission is denied while installing the Chef RPM, then use <kbd class="calibre15">sudo</kbd> to run the command:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [mitesh@devops1 chef]$ sudo rpm -ivh chef-12.9.41-<br class="title-page-name"/>        1.el6.x86_64.rpm</strong><br class="title-page-name"/><strong class="calibre1">        [sudo] password for mitesh:</strong><br class="title-page-name"/><strong class="calibre1">        warning: chef-12.9.41-1.el6.x86_64.rpm: Header <br class="title-page-name"/>        V4DSA/SHA1 Signature, key ID <br class="title-page-name"/>        83ef826a: NOKEY</strong><br class="title-page-name"/><strong class="calibre1">        Preparing...                <br class="title-page-name"/>        ########################################### [100%]</strong><br class="title-page-name"/><strong class="calibre1">        1:chef                   <br class="title-page-name"/>        ########################################### [100%]</strong><br class="title-page-name"/><strong class="calibre1">        Thank you for installing Chef!</strong>
</pre>
<ol start="5" class="calibre17">
<li value="5" class="calibre11">After successful installation, verify the Chef client version and this time we will get the version number of the Chef client:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [mitesh@devops1 chef]$ chef-client -version</strong><br class="title-page-name"/><strong class="calibre1">        Chef: 12.9.41</strong>
</pre>
<p class="calibre2">Now we will use the Chef starter kit that we downloaded while creating an account in the hosted Chef:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Extract <kbd class="calibre15">chef-repo</kbd>. Copy the <kbd class="calibre15">.chef</kbd> directory into the root or user folder:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border40" src="../images/00051.jpeg"/></div>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">Verify the <kbd class="calibre15">cookbooks</kbd> folder available in the <kbd class="calibre15">chef-repo</kbd> directory:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border41" src="../images/00221.jpeg"/></div>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">In the <kbd class="calibre15">.chef</kbd> folder, open the <kbd class="calibre15">knife.rb</kbd> file in the editor, which contains various configurations. Modify the path of the cookbooks directory if required:</li>
</ol>
<pre class="calibre26">
        current_dir = File.dirname(__FILE__)<br class="title-page-name"/>        log_level                :info<br class="title-page-name"/>        log_locationSTDOUT<br class="title-page-name"/>        node_name"discovertechno51"<br class="title-page-name"/>        client_key"#{current_dir}/discovertechno51.pem"<br class="title-page-name"/>        validation_client_name"dtechno-validator"<br class="title-page-name"/>        validation_key"#{current_dir}/dtechno-validator.pem"<br class="title-page-name"/>        chef_server_url"https://api.chef.io/organizations/dtechno"<br class="title-page-name"/>        cookbook_path            ["#{current_dir}/../cookbooks"]
</pre>
<p class="calibre2">With that, we've finished configuring our Chef workstation. The next step is using it to converge the node.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Converging a Chef node using a Chef workstation</h1>
            

            <article>
                
<p class="calibre2">In this section, we will set up the runtime environment in the node (physical/virtual machine) using the Chef workstation.</p>
<p class="calibre2">Log in to the Chef workstation:</p>
<ol class="calibre17">
<li value="1" class="calibre11">
<p class="calibre27">Open the terminal and verify the IP address by executing the <kbd class="calibre15">ifconfig</kbd> command:</p>
</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef-repo]#ifconfig</strong><br class="title-page-name"/><strong class="calibre1">        eth3      Link encap:EthernetHWaddr00:0C:29:D9:30:7F</strong><br class="title-page-name"/><strong class="calibre1">        inetaddr:192.168.1.35Bcast:192.168.1.255Mask:255.255.255.0</strong><br class="title-page-name"/><strong class="calibre1">        inet6addr: fe80::20c:29ff:fed9:307f/64 Scope:Link</strong><br class="title-page-name"/><strong class="calibre1">                  UP BROADCAST RUNNING MULTICAST  MTU:1500Metric:1</strong><br class="title-page-name"/><strong class="calibre1">                  RX packets:841351errors:0dropped:0overruns:0frame:0</strong><br class="title-page-name"/><strong class="calibre1">                  TX packets:610551errors:0dropped:0overruns:0carrier:0</strong><br class="title-page-name"/><strong class="calibre1">        collisions:0txqueuelen:1000</strong><br class="title-page-name"/><strong class="calibre1">                  RX bytes:520196141 (496.0 MiB)<br class="title-page-name"/>                  TX bytes:278125183 (265.2 MiB)</strong><br class="title-page-name"/><strong class="calibre1">        lo        Link encap:Local Loopback </strong><br class="title-page-name"/><strong class="calibre1">        inetaddr:127.0.0.1Mask:255.0.0.0</strong><br class="title-page-name"/><strong class="calibre1">        inet6addr: ::1/128 Scope:Host</strong><br class="title-page-name"/><strong class="calibre1">                  UP LOOPBACK RUNNING  MTU:65536Metric:1</strong><br class="title-page-name"/><strong class="calibre1">                  RX packets:1680errors:0dropped:0overruns:0frame:0</strong><br class="title-page-name"/><strong class="calibre1">                  TX packets:1680errors:0dropped:0overruns:0carrier:0</strong><br class="title-page-name"/><strong class="calibre1">        collisions:0txqueuelen:0</strong><br class="title-page-name"/><strong class="calibre1">                  RX bytes:521152 (508.9 KiB)  TX bytes:521152 (508.9 KiB)</strong>
</pre>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">Verify the knife version installed on the Chef workstation with <kbd class="calibre15">knife --version</kbd>:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef]#knife --version</strong><br class="title-page-name"/><strong class="calibre1">        Chef: 12.9.41</strong>
</pre>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">The <kbd class="calibre15">knife node list</kbd> command is used to obtain the list of nodes served by the Chef server in our case, the hosted Chef. As we haven't converged any nodes, the list will be empty:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef-repo]#knife node list</strong>
</pre>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">Create a virtual machine using VMware Workstation or VirtualBox. Install CentOS. Once the VM is ready, find its IP address and note it down.</li>
<li value="5" class="calibre11">On our Chef workstation, open a terminal and, using the <kbd class="calibre15">ssh</kbd> command, try to connect to the node or VM we just created:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef-repo]#sshroot@192.168.1.37</strong><br class="title-page-name"/><strong class="calibre1">        The authenticity of the host 192.168.1.37 can't be established:</strong><br class="title-page-name"/><strong class="calibre1">        RSA key fingerprint is <br class="title-page-name"/>        4b:56:28:62:53:59:e8:e0:5e:5f:54:08:c1:0c:1e:6c.</strong><br class="title-page-name"/><strong class="calibre1">        Are you sure you want to continue connecting (yes/no)? yes</strong><br class="title-page-name"/><strong class="calibre1">        Warning: Permanently added '192.168.1.37' (RSA)<br class="title-page-name"/>        to the list of known hosts.</strong><br class="title-page-name"/><strong class="calibre1">        root@192.168.1.37's password:</strong><br class="title-page-name"/><strong class="calibre1">        Last login: Thu May 28 10:26:06 2015 from 192.168.1.15</strong>
</pre>
<ol start="6" class="calibre17">
<li value="6" class="calibre11">We now have an SSH session on the node from the Chef workstation. If you verify the IP address, you'll know that you are accessing a different machine by remote (SSH) access:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@localhost ~]#ifconfig</strong><br class="title-page-name"/><strong class="calibre1">        eth1      Link encap:EthernetHWaddr00:0C:29:44:9B:4B</strong><br class="title-page-name"/><strong class="calibre1">        inetaddr:192.168.1.37Bcast:192.168.1.255Mask:255.255.255.0</strong><br class="title-page-name"/><strong class="calibre1">        inet6addr: fe80::20c:29ff:fe44:9b4b/64 Scope:Link</strong><br class="title-page-name"/><strong class="calibre1">                  UP BROADCAST RUNNING MULTICAST  MTU:1500Metric:1</strong><br class="title-page-name"/><strong class="calibre1">                  RX packets:11252errors:0dropped:0overruns:0frame:0</strong><br class="title-page-name"/><strong class="calibre1">                  TX packets:6628errors:0dropped:0overruns:0carrier:0</strong><br class="title-page-name"/><strong class="calibre1">        collisions:0txqueuelen:1000</strong><br class="title-page-name"/><strong class="calibre1">                  RX bytes:14158681 (13.5 MiB)  TX bytes:466365 (455.4 KiB)</strong><br class="title-page-name"/><strong class="calibre1">        lo        Link encap:Local Loopback  </strong><br class="title-page-name"/><strong class="calibre1">        inetaddr:127.0.0.1Mask:255.0.0.0</strong><br class="title-page-name"/><strong class="calibre1">        inet6addr: ::1/128 Scope:Host</strong><br class="title-page-name"/><strong class="calibre1">                  UP LOOPBACK RUNNING  MTU:65536Metric:1</strong><br class="title-page-name"/><strong class="calibre1">                  RX packets:59513errors:0dropped:0overruns:0frame:0</strong><br class="title-page-name"/><strong class="calibre1">                  TX packets:59513errors:0dropped:0overruns:0carrier:0</strong><br class="title-page-name"/><strong class="calibre1">        collisions:0txqueuelen:0</strong><br class="title-page-name"/><strong class="calibre1">                  RX bytes:224567119 (214.1 MiB)<br class="title-page-name"/>                  TX bytes:224567119 (214.1 MiB)</strong><br class="title-page-name"/><strong class="calibre1">        [root@localhost ~]#</strong>
</pre>
<ol start="7" class="calibre17">
<li value="7" class="calibre11">Use knife to converge the node. Provide the IP address/DNS name, user, password, and name of the node.</li>
<li value="8" class="calibre11">Verify the output:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef-repo]# knife bootstrap <br class="title-page-name"/>        192.168.1.37 -x root -P cloud@123 -<br class="title-page-name"/>        N tomcatserver</strong><br class="title-page-name"/><strong class="calibre1">        Doing old-style registration with the validation    <br class="title-page-name"/>        key at /home/mitesh/chef-               <br class="title-page-name"/>        repo/.chef/dtechno-validator.pem...</strong><br class="title-page-name"/><strong class="calibre1">        Delete your validation key in order to use your <br class="title-page-name"/>        user credentials instead</strong><br class="title-page-name"/><strong class="calibre1">        Connecting to 192.168.1.37</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 -----&gt; Installing Chef Omnibus (-v 12)</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 downloading<br class="title-page-name"/>        https://omnitruck-direct.chef.io/chef/install.sh</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37   to file /tmp/install.sh.26574/install.sh</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 trying wget...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 el 6 x86_64</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Getting information for chef stable 12 for el...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 downloading https://omnitruck-<br class="title-page-name"/>        direct.chef.io/stable/chef/metadata?v=12&amp;p=el&amp;pv=6&amp;m=x86_64</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37   to file /tmp/install.sh.26586/metadata.txt</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 trying wget...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 sha1859bc9be9a40b8b13fb88744079ceef1832831b0</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37   <br class="title-page-name"/>        sha256c43f48e5a2de56e4eda473a3e<br class="title-page-name"/>        e0a80aa1aaa6c8621d9084e033d8b9cf3efc328  </strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 urlhttps://packages.chef.io/stable/el/6/chef-12.9.41-<br class="title-page-name"/>        1.el6.x86_64.rpm</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 version12.9.41</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 downloaded metadata file looks valid...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 downloading <br class="title-page-name"/>        https://packages.chef.io/stable/el/6/chef-12.9.41-<br class="title-page-name"/>        1.el6.x86_64.rpm</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37   to file /tmp/install.sh.26586/chef-<br class="title-page-name"/>        12.9.41-1.el6.x86_64.rpm</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 trying wget...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Comparing checksum with sha256sum...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Installing chef 12</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 installing with rpm...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 warning: /tmp/install.sh.26586/chef-<br class="title-page-name"/>        12.9.41-1.el6.x86_64.rpm:      <br class="title-page-name"/>        Header V4DSA/SHA1 Signature, key ID 83ef826a: NOKEY</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Preparing...                ########################################### [100%]</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37    1:chef                  <br class="title-page-name"/>              ########################################### [100%]</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Thank you for installing Chef!</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Starting the first Chef Client run...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Starting Chef Client, version 12.9.41</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Creating a new client identity for <br class="title-page-name"/>        tomcatserver using the validator key.</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 resolving cookbooks for run list: []</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Synchronizing Cookbooks:</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Installing Cookbook Gems:</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Compiling Cookbooks...</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 [2016-05-12T23:47:49-07:00] WARN: <br class="title-page-name"/>        Node tomcatserver has an empty <br class="title-page-name"/>        run list.</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Converging 0 resources</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Running handlers:</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Running handlers complete</strong><br class="title-page-name"/><strong class="calibre1">        192.168.1.37 Chef Client finished, 0/0 resources <br class="title-page-name"/>        updated in 37 seconds</strong>
</pre>
<ol start="9" class="calibre17">
<li value="9" class="calibre11">The node convergence is successful:
<ol class="calibre19">
<li value="1" class="calibre11">Verify the first Chef client run in the log.</li>
<li value="2" class="calibre11">Verify the Chef client version that is installed.</li>
<li value="3" class="calibre11">Verify the empty run list message in the log.</li>
<li value="4" class="calibre11">Verify converging 0 resource messages.</li>
</ol>
</li>
<li value="10" class="calibre11">We can check whether the preceding process is successful or not by navigating to the hosted Chef account and verifying whether <span>Node Name</span> and <span>IP Address</span> in the <span>Nodes</span> section is available or not.</li>
<li value="11" class="calibre11">In the dashboard, go to the <span>Details</span> tab to get more information about the node; verify <span>Attributes</span> associated with the node and also <span>Permissions</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00290.jpeg"/></div>
<ol start="12" class="calibre17">
<li value="12" class="calibre11">In the bottom section of the hosted Chef <span>Dashboard</span>, verify the CPU attributes and other details of the node.</li>
</ol>
<ol start="13" class="calibre17">
<li value="13" class="calibre11">The report section provides details on <span>Runs Summary</span>, <span>Run Durations</span>, and <span>Run Counts</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00309.jpeg"/></div>
<p class="calibre2">In the next section, we will try to install Tomcat using Chef.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Installing software packages using cookbooks </h1>
            

            <article>
                
<p class="calibre2">Until now, we've performed the following tasks:</p>
<ul class="calibre10">
<li class="calibre11">Creating a hosted Chef account</li>
<li class="calibre11">Configuring a Chef workstation</li>
<li class="calibre11">Converging a node using a Chef workstation</li>
</ul>
<p class="calibre2">Now we will install application packages using community cookbooks.</p>
<p class="calibre2"> To set up the runtime environment automatically, it's best to use the Chef community cookbooks:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Visit <a href="https://github.com/chef-cookbooks" class="calibre4">https://github.com/chef-cookbooks</a>  and find all the community cookbooks required to set up a runtime environment.</li>
<li value="2" class="calibre11">We are using a sample Spring application, namely, PetClinic. We need to install Java and Tomcat to run Java EE applications such as this.</li>
<li value="3" class="calibre11">Download the Tomcat cookbook from <a href="https://supermarket.chef.io/cookbooks/tomcat" class="calibre4">https://supermarket.chef.io/cookbooks/tomcat</a>  and navigate to the <span>Dependencies</span> section on that page. Without the dependencies uploaded to our Chef server, we can't upload the Tomcat cookbook to use it.</li>
</ol>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">Download OpenSSL and Chef sugar from <a href="https://supermarket.chef.io/cookbooks/openssl" class="calibre4">https://supermarket.chef.io/cookbooks/openssl</a> and <a href="https://supermarket.chef.io/cookbooks/chef-sugar" class="calibre4">https://supermarket.chef.io/cookbooks/chef-sugar</a> respectively.</li>
<li value="5" class="calibre11">To install Java, download the cookbook from <a href="https://supermarket.chef.io/cookbooks/java" class="calibre4">https://supermarket.chef.io/cookbooks/java</a>  and its dependency as well from <a href="https://supermarket.chef.io/cookbooks/apt" class="calibre4">https://supermarket.chef.io/cookbooks/apt</a>. Extract all the compressed files to the cookbook's directory:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border42" src="../images/00019.jpeg"/></div>
<ol start="6" class="calibre17">
<li value="6" class="calibre11">Go to cookbooks in the terminal and execute the <kbd class="calibre15">ls</kbd> command to verify the subdirectories of the community cookbooks which we downloaded earlier:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 cookbooks]# ls</strong><br class="title-page-name"/><strong class="calibre1">        apt  chefignore  chef-sugar  java  openssl  starter  tomcat</strong><br class="title-page-name"/><strong class="calibre1">        [root@devops1 cookbooks]# cd ..</strong>
</pre>
<ol start="7" class="calibre17">
<li value="7" class="calibre11">Let's upload one of the cookbooks and verify whether it is uploaded on the hosted Chef or not. Upload the apt cookbook with the <kbd class="calibre15">knife cookbook upload apt</kbd> command as shown here:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef-repo]# knife cookbook upload apt</strong><br class="title-page-name"/><strong class="calibre1">        Uploading apt          [3.0.0]</strong><br class="title-page-name"/><strong class="calibre1">        Uploaded 1 cookbook.</strong>
</pre>
<ol start="8" class="calibre17">
<li value="8" class="calibre11">Go to the hosted the <span>Dashboard</span> and click on <span>Policy</span>. Go to the <span>Cookbook</span> section on the hosted Chef instance and see if the <span>apt Cookbook</span> has been uploaded:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00022.jpeg"/></div>
<ol start="9" class="calibre17">
<li value="9" class="calibre11">We need to upload all dependencies in terms of cookbooks for the Tomcat cookbook to be uploaded, otherwise it will give us an error. Upload all other cookbooks in order:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef-repo]# knife cookbook upload chef-sugar</strong><br class="title-page-name"/><strong class="calibre1">        Uploading chef-sugar     [3.3.0]</strong><br class="title-page-name"/><strong class="calibre1">        Uploaded 1 cookbook.</strong><br class="title-page-name"/><strong class="calibre1">        [root@devops1 chef-repo]# knife cookbook upload java</strong><br class="title-page-name"/><strong class="calibre1">        Uploading java           [1.39.0]</strong><br class="title-page-name"/><strong class="calibre1">        Uploaded 1 cookbook.</strong><br class="title-page-name"/><strong class="calibre1">        [root@devops1 chef-repo]# knife cookbook upload openssl</strong><br class="title-page-name"/><strong class="calibre1">        Uploading openssl        [4.4.0]</strong><br class="title-page-name"/><strong class="calibre1">        Uploaded 1 cookbook.</strong><br class="title-page-name"/><strong class="calibre1">        [root@devops1 chef-repo]# knife cookbook upload tomcat</strong><br class="title-page-name"/><strong class="calibre1">        Uploading tomcat         [0.17.0]</strong><br class="title-page-name"/><strong class="calibre1">        Uploaded 1 cookbook.</strong>
</pre>
<ol start="10" class="calibre17">
<li value="10" class="calibre11">Go to the hosted Chef <span>Dashboard</span> and verify all the <span>Cookbooks</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00024.jpeg"/></div>
<p class="calibre2">Once we have uploaded all the cookbooks to the hosted Chef, let's create a role.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Creating a role</h1>
            

            <article>
                
<p class="calibre2">At this stage, all the required cookbooks are uploaded on the hosted Chef. Now, let's create a role on the hosted Chef.</p>
<p class="calibre2">Before creating a role, let's understand what it means.</p>
<p class="calibre2">A role is created for a specific function. It provides a path for various patterns and workflow processes.</p>
<p class="calibre2">For example, the web server role can consist of Tomcat server recipes and any custom attributes:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Go to <span>Policy</span> in the hosted Chef <span>Dashboard</span> and click on <span>Roles</span> in the sidebar menu. Click on <span>Create Role</span> to create a role.</li>
<li value="2" class="calibre11">In the <span>Create Role</span> window, provide a <span>Name</span> and <kbd class="calibre15">Description</kbd>.</li>
<li value="3" class="calibre11">Click on <span>Next<span>.</span></span></li>
</ol>
<p class="calibre2">Refer to the following screenshot:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00269.jpeg"/></div>
<ol class="calibre17">
<li value="1" class="calibre11">A <span>Run List</span> keeps roles/recipes in a specific manner and order. It can be considered as the specifications of a node.</li>
<li value="2" class="calibre11">Select Tomcat from the <span>Available Recipes</span> list<span>.</span></li>
<li value="3" class="calibre11">Drag the T<span>omcat recipe</span> to the <span>Current Run List<span>.</span></span></li>
<li value="4" class="calibre11">Click on <span>Create Role<span>.</span></span></li>
</ol>
<p class="calibre2">Refer to the following screenshot:</p>
<div class="CDPAlignCenter"><img class="image-border43" src="../images/00027.jpeg"/></div>
<ol class="calibre17">
<li value="1" class="calibre11">Check the newly added role in the hosted Chef <span>Dashboard</span> in the <span>Policy</span> tab:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00029.jpeg"/></div>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">Now, let's specify a role while converging the node in the terminal. Add the role to the node with <kbd class="calibre15">knife node run_list add tomcatserver "role[v-tomcat]"</kbd>:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@devops1 chef-repo]# knife node run_list add <br class="title-page-name"/>        tomcatserver "role[v-tomcat]"</strong><br class="title-page-name"/><strong class="calibre1">        tomcatserver:</strong><br class="title-page-name"/><strong class="calibre1">        run_list: role[v-tomcat]</strong><br class="title-page-name"/><strong class="calibre1">        [root@devops1 chef-repo]#</strong>
</pre>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">The <kbd class="calibre15">v-tomcat</kbd> role is now being associated with the <kbd class="calibre15">tomcatserver</kbd> node.</li>
<li value="4" class="calibre11">Go to node and execute <kbd class="calibre15">chef-client</kbd>; it will execute the steps to bring the node status in compliance with the role assigned:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@localhost Desktop]# chef-client</strong><br class="title-page-name"/><strong class="calibre1">        Starting Chef Client, version 12.9.41</strong><br class="title-page-name"/><strong class="calibre1">        resolving cookbooks for run list: ["tomcat"]</strong><br class="title-page-name"/><strong class="calibre1">        Synchronizing Cookbooks:</strong><br class="title-page-name"/><strong class="calibre1">          - tomcat (0.17.0)</strong><br class="title-page-name"/><strong class="calibre1">          - chef-sugar (3.3.0)</strong><br class="title-page-name"/><strong class="calibre1">          - java (1.39.0) </strong><br class="title-page-name"/><strong class="calibre1">          - apt (3.0.0)</strong><br class="title-page-name"/><strong class="calibre1">          - openssl (4.4.0)</strong><br class="title-page-name"/><strong class="calibre1">        Installing Cookbook Gems:</strong><br class="title-page-name"/><strong class="calibre1">        Compiling Cookbooks...</strong><br class="title-page-name"/><strong class="calibre1">        .</strong><br class="title-page-name"/><strong class="calibre1">        .</strong><br class="title-page-name"/><strong class="calibre1">        .</strong><br class="title-page-name"/><strong class="calibre1">        Chef Client finished, 11/15 resources updated in 09 minutes 59 <br class="title-page-name"/>        seconds</strong><br class="title-page-name"/><strong class="calibre1">        You have new mail in /var/spool/mail/root</strong>
</pre>
<ol start="5" class="calibre17">
<li value="5" class="calibre11">Go to the node and check whether Tomcat is available or not:</li>
</ol>
<pre class="calibre26">
<strong class="calibre1">        [root@localhost Desktop]# service tomcat6 status</strong><br class="title-page-name"/><strong class="calibre1">        tomcat6 (pid 39782) is running...                          [  OK  ]</strong><br class="title-page-name"/><strong class="calibre1">        You have new mail in /var/spool/mail/root</strong>
</pre>
<ol start="6" class="calibre17">
<li value="6" class="calibre11">Go to the <span>Reports</span> tab in the hosted Chef account to get the latest details about the node convergence:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00031.jpeg"/></div>
<p class="calibre2">At this stage, we are ready with a hosted Chef account, configured workstation, and converged node. </p>
<p class="calibre2">In the next section, we will install knife plugins for some popular cloud platforms.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Installing knife plugins for Amazon Web Services and Microsoft Azure</h1>
            

            <article>
                
<p class="calibre2">Our objective is to install application packages to provide the runtime environment for our Java-based Petclinic application. In the traditional environment, we raise the acquisition request for the physical server and then the infrastructure team helps us to install different software on it to provide the runtime environment for our application. With Chef, we can install these packages using community cookbooks and hence we can automate it easily.</p>
<p class="calibre2">In this section, we will use cloud resources. Amazon EC2 and Microsoft Azure are two very popular public cloud resource providers. We will create virtual machines in the cloud environment and then install different application packages using the Chef configuration management tool:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00033.jpeg"/></div>
<ol class="calibre17">
<li value="1" class="calibre11">First, we will provision <span>virtual machines in Amazon EC2 and Microsoft Azure</span> using knife plugins using a Chef workstation.</li>
<li value="2" class="calibre11">Go to the Chef workstation.</li>
<li value="3" class="calibre11">Execute <kbd class="calibre15">knife</kbd> commands to create instances (Chef nodes) in <span>Amazon EC2 and Microsoft Azure</span>.</li>
</ol>
<p class="calibre2">The following is how the process will work:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Execute the command on the Chef workstation to create a new instance in your cloud environment.</li>
<li value="2" class="calibre11">A new instance is created in <span>Amazon EC2 and Microsoft Azure and it is </span>up and running (the Chef node is available).</li>
<li value="3" class="calibre11">The Chef node communicates with the Chef server.</li>
<li value="4" class="calibre11">The Chef server instructs the Chef node to execute a list of tasks and download the Chef client.</li>
<li value="5" class="calibre11">A secure handshake takes place between the Chef server and the Chef node; the Chef server generates a security certificate that is used to authenticate the new node's upcoming queries.</li>
<li value="6" class="calibre11">The Chef node executes tasks and informs the Chef server regarding its compliance.</li>
</ol>
<p class="calibre2">The following are the major benefits of using the Chef configuration management tool with different public cloud service providers as follows:</p>
<ul class="calibre10">
<li class="calibre11">Faster time to market</li>
<li class="calibre11">Centralized control</li>
<li class="calibre11">Standard policies</li>
<li class="calibre11">Consistent environment to deploy the application</li>
<li class="calibre11">Less or no manual effort and errors due to manual limitations</li>
<li class="calibre11">Rapid application development</li>
<li class="calibre11">Easy rollback</li>
<li class="calibre11">High availability and disaster recovery for business continuity that is essential in today's day and age</li>
<li class="calibre11">Community cookbooks accessible to all</li>
</ul>
<p class="calibre2">The <strong class="calibre1">Chef Development Kit</strong> (<strong class="calibre1">ChefDK</strong>) provides development tools built by the Chef community that makes installing knife plugins easier.</p>
<p class="calibre2">Go to <a href="https://downloads.chef.io/chef-dk/" class="calibre4">https://downloads.chef.io/chef-dk/</a> and download ChefDK based on the operating system we use.</p>
<p class="calibre2">In our case, select Red Hat Enterprise Linux and select the ChefDK version. Click on Red Hat Enterprise Linux 6 and download it, as it works on 64-bit (<kbd class="calibre15">x86_64</kbd>) versions of Red Hat Enterprise Linux and CentOS 6:</p>
<pre class="calibre26">
<strong class="calibre1">[root@localhost Desktop]# sudo rpm -ivh chefdk-0.13.21-1.el6.x86_64.rpm</strong><br class="title-page-name"/><strong class="calibre1">Preparing...                ###########################################    [100%]   1:chefdk                 ###########################################    [100%]</strong><br class="title-page-name"/><strong class="calibre1">Thank you for installing Chef Development Kit!</strong>
</pre>
<p class="calibre2">Execute the <kbd class="calibre15">chef gem install knife-ec2</kbd> command to create, bootstrap, and manage Amazon EC2 instances. More details are available at <a href="https://github.com/chef/knife-ec2" class="calibre4">https://github.com/chef/knife-ec2</a>:</p>
<pre class="calibre26">
<strong class="calibre1">[root@localhost Desktop]# chef gem install knife-ec2</strong><br class="title-page-name"/><strong class="calibre1">Fetching: knife-ec2-&lt;version&gt;.gem (100%)</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">Successfully installed knife-ec2-&lt;version&gt;</strong><br class="title-page-name"/><strong class="calibre1">1 gem installed</strong>
</pre>
<p class="calibre2">Execute the <kbd class="calibre15">knife ec2 --help</kbd> command to check the available Amazon EC2 commands:</p>
<pre class="calibre26">
<strong class="calibre1">[root@localhost Desktop]# knife ec2 --help</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">** EC2 COMMANDS **</strong><br class="title-page-name"/><strong class="calibre1">knife ec2 amis ubuntu DISTRO [TYPE] (options)</strong><br class="title-page-name"/><strong class="calibre1">knife ec2 flavor list (options)</strong><br class="title-page-name"/><strong class="calibre1">knife ec2 server create (options)</strong><br class="title-page-name"/><strong class="calibre1">knife ec2 server delete SERVER [SERVER] (options)</strong><br class="title-page-name"/><strong class="calibre1">knife ec2 server list (options)</strong>
</pre>
<p class="calibre2">Configure Amazon EC2 credentials for the <kbd class="calibre15">knife</kbd> plugin in the <kbd class="calibre15">knife.rb</kbd> file.</p>
<p class="calibre2">Use <kbd class="calibre15">knife[:aws_access_key_id]</kbd> and <kbd class="calibre15">knife[:aws_secret_access_key]</kbd> as shown here:</p>
<pre class="calibre26">
<strong class="calibre1">knife[:aws_access_key_id] = "Your AWS Access Key ID"</strong><br class="title-page-name"/><strong class="calibre1">knife[:aws_secret_access_key] = "Your AWS Secret Access Key"</strong>
</pre>
<p class="calibre2"><span>Execute the <kbd class="calibre15">chef gem install knife-azure</kbd> command to create, bootstrap, and manage Microsoft Azure virtual machines. More details are available at <a href="https://github.com/chef/knife-ec2" class="calibre4">https://github.com/chef/knife-ec2</a>:</span></p>
<pre class="calibre26">
<strong class="calibre1">[root@localhost Desktop]# chef gem install knife-azure -v 1.5.2</strong><br class="title-page-name"/><strong class="calibre1">Fetching: knife-azure-1.5.2.gem (100%)</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">Successfully installed knife-azure-1.5.2</strong><br class="title-page-name"/><strong class="calibre1">1 gem installed</strong>
</pre>
<p class="calibre2">Verify the available Azure commands using <kbd class="calibre15">knife azure --help</kbd>:</p>
<pre class="calibre26">
<strong class="calibre1">[root@localhost Desktop]# knife azure --help</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">** AZURE COMMANDS **</strong><br class="title-page-name"/><strong class="calibre1">knife azure ag create (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure ag list (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure image list (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure internal lb create (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure internal lb list (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure server create (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure server delete SERVER [SERVER] (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure server list (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure server show SERVER [SERVER]</strong><br class="title-page-name"/><strong class="calibre1">knife azure vnet create (options)</strong><br class="title-page-name"/><strong class="calibre1">knife azure vnet list (options)</strong>
</pre>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Creating and configuring a virtual machine in Amazon EC2</h1>
            

            <article>
                
<p class="calibre2">Use the <kbd class="calibre15">knife node list</kbd> command to get the list of nodes to get clarity on how many nodes are already configured using Chef:</p>
<pre class="calibre26">
<strong class="calibre1">root@devops1 Desktop]# knife node list</strong><br class="title-page-name"/><strong class="calibre1">tomcatserver</strong>
</pre>
<p class="calibre2">Use the <kbd class="calibre15">knife ec2 server create</kbd> command with the following parameters to create a new virtual machine:</p>
<table class="calibre23">
<tbody class="calibre7">
<tr class="calibre8">
<td class="calibre9"><strong class="calibre1">Parameter</strong></td>
<td class="calibre9"><strong class="calibre1">Value</strong></td>
<td class="calibre9"><strong class="calibre1">Description</strong></td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">-I</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">ami-1ecae776</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the ID of the Amazon machine image</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">-f</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">t2.micro</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the type of the virtual machine</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">-N</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">DevOpsVMonAWS</p>
</td>
<td class="calibre9">
<p class="calibre2">This is the name of the Chef node</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--aws-access-key-id</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">Your access key ID</p>
</td>
<td class="calibre9">
<p class="calibre2">This is the access key ID of the AWS account</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--aws-secret-access-key</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">Your secret access key</p>
</td>
<td class="calibre9">
<p class="calibre2">This is the secret access key of the AWS account</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">-S</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">Book</p>
</td>
<td class="calibre9">
<p class="calibre2">This is the SSH key</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--identity-file</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">book.pem</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the PEM file</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--ssh-user</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">ec2-user</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the user for the AWS instance</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">-r</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">role[v-tomcat]</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the Chef role</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2">Let's create an EC2 instance using the <kbd class="calibre15">knife</kbd> plugin:</p>
<pre class="calibre26">
<strong class="calibre1">[root@devops1 Desktop]# knife ec2 server create -I ami-1ecae776 -f t2.micro -N DevOpsVMonAWS --aws-access-key-id '&lt; Your Access Key ID &gt;' --aws-secret-access-key '&lt; Your Secret Access Key &gt;' -S book --identity-file book.pem --ssh-user ec2-user -r role[v-tomcat] </strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">Instance ID: i-640d2de3</strong><br class="title-page-name"/><strong class="calibre1">Flavor: t2.micro</strong><br class="title-page-name"/><strong class="calibre1">Image: ami-1ecae776</strong><br class="title-page-name"/><strong class="calibre1">Region: us-east-1</strong><br class="title-page-name"/><strong class="calibre1">Availability Zone: us-east-1a</strong><br class="title-page-name"/><strong class="calibre1">Security Groups: default</strong><br class="title-page-name"/><strong class="calibre1">Tags: Name: DevOpsVMonAWS</strong><br class="title-page-name"/><strong class="calibre1">SSH Key: book</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">Waiting for EC2 to create the instance......</strong><br class="title-page-name"/><strong class="calibre1">Public DNS Name: ********************.compute-1.amazonaws.com</strong><br class="title-page-name"/><strong class="calibre1">Public IP Address: **.**.***.***</strong><br class="title-page-name"/><strong class="calibre1">Private DNS Name: ip-***-**-1-27.ec2.internal</strong><br class="title-page-name"/><strong class="calibre1">Private IP Address: ***.**.*.27</strong>
</pre>
<p class="calibre2">At this stage, the AWS EC2 instance has been created and is <kbd class="calibre15">Waiting for sshd access to become available</kbd>:</p>
<pre class="calibre26">
<br class="title-page-name"/><strong class="calibre1">Waiting for sshd access to become available....................done </strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">Creating new client for DevOpsVMonAWS</strong><br class="title-page-name"/><strong class="calibre1">Creating new node for DevOpsVMonAWS</strong><br class="title-page-name"/><strong class="calibre1">Connecting to ec2-**-**-***-***.compute-1.amazonaws.com</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com -----&gt; Installing Chef Omnibus (-v 12)</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com version12.9.41</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com downloaded metadata file looks valid...</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com downloading https://packages.chef.io/stable/el/6/chef-12.9.41-1.el6.x86_64.rpm</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com    1:chef-12.9.41-1.el6               ################################# [100%]</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Thank you for installing Chef! </strong>
</pre>
<p class="calibre2">Now, the Chef client has been installed on the AWS instance. It is ready for the initial <kbd class="calibre15">Chef Client run</kbd> with <kbd class="calibre15">version 12.9.41</kbd>:</p>
<pre class="calibre26">
<strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Starting the first Chef Client run...</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Starting Chef Client, version 12.9.41</strong>
</pre>
<p class="calibre2">It is now ready to resolve cookbooks based on the role and install runtime environments:</p>
<pre class="calibre26">
<strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com resolving cookbooks for run list: ["tomcat"] </strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Synchronizing Cookbooks:</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   - tomcat (0.17.0)</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   - java (1.39.0)</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   - apt (3.0.0)</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   - openssl (4.4.0)</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   - chef-sugar (3.3.0)</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Installing Cookbook Gems:</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Compiling Cookbooks...</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Converging 3 resources</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Recipe: tomcat::default</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   * yum_package[tomcat6] action install</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com     - install version 6.0.45-1.4.amzn1 of package tomcat6</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   * yum_package[tomcat6-admin-webapps] action install</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com     - install version 6.0.45-1.4.amzn1 of package tomcat6-admin-webapps</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   * tomcat_instance[base] action configure (up to date)</strong>
</pre>
<p class="calibre2">The runtime environment is available now and it is time to start Tomcat services in the AWS instance; verify the logs:</p>
<pre class="calibre26">
<strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com    </strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com   * service[tomcat6] action start</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">ec2-**-**-***-***.compute-1.amazonaws.com Chef Client finished, 13/15 resources updated in 01 minutes 13 seconds</strong>
</pre>
<p class="calibre2">Here are the details of the newly created AWS instance:</p>
<pre class="calibre26">
<strong class="calibre1">Instance ID: i-********</strong><br class="title-page-name"/><strong class="calibre1">Flavor: t2.micro</strong><br class="title-page-name"/><strong class="calibre1">Image: ami-1ecae776</strong><br class="title-page-name"/><strong class="calibre1">Region: us-****-1</strong><br class="title-page-name"/><strong class="calibre1">Availability Zone: us-****-1a</strong><br class="title-page-name"/><strong class="calibre1">Security Groups: default</strong><br class="title-page-name"/><strong class="calibre1">Security Group Ids: default</strong><br class="title-page-name"/><strong class="calibre1">Tags: Name: DevOpsVMonAWS</strong><br class="title-page-name"/><strong class="calibre1">SSH Key: book</strong><br class="title-page-name"/><strong class="calibre1">Root Device Type: ebs</strong><br class="title-page-name"/><strong class="calibre1">Root Volume ID: vol-1e0e83b5</strong><br class="title-page-name"/><strong class="calibre1">Root Device Name: /dev/xvda</strong><br class="title-page-name"/><strong class="calibre1">Root Device Delete on Terminate: true</strong><br class="title-page-name"/><strong class="calibre1">Public DNS Name: ec2-**-**-***-***.compute-1.amazonaws.com</strong><br class="title-page-name"/><strong class="calibre1">Public IP Address: 52.90.219.205</strong><br class="title-page-name"/><strong class="calibre1">Private DNS Name: ip-172-31-1-27.ec2.internal</strong><br class="title-page-name"/><strong class="calibre1">Private IP Address: 172.31.1.27</strong><br class="title-page-name"/><strong class="calibre1">Environment: _default</strong><br class="title-page-name"/><strong class="calibre1">Run List: role[v-tomcat]</strong><br class="title-page-name"/><strong class="calibre1">You have new mail in /var/spool/mail/root</strong><br class="title-page-name"/><strong class="calibre1">[root@devops1 Desktop]#</strong>
</pre>
<p class="calibre2">Go to <a href="https://aws.amazon.com/" class="calibre4">https://aws.amazon.com/</a> and sign in.</p>
<p class="calibre2">Go to the <span>Amazon EC2</span> section and click on <span>Instances</span> in the left-hand sidebar or on <span>Running Instances</span> on the <span>Resources</span> page get to the details about AWS instances.</p>
<p class="calibre2">Verify the <span>Name</span>, <span>Tags</span>, <span>Public DNS</span>, and other details that we get in the Chef client run with the details available on the Amazon <span>Dashboard</span>:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00035.jpeg"/></div>
<p class="calibre2">Now, let's go to the hosted Chef <span>Dashboard</span> and click on <span>Nodes</span> to verify the newly created/converged node in Amazon EC2:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00036.jpeg"/></div>
<p class="calibre2">Verify the instance <span>Details</span> and <span>Run List</span>:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00038.jpeg"/></div>
<p class="calibre2">An instance is created in Amazon EC2 and Tomcat is also installed and its service is also started, we can verify whether it is actually running or not.</p>
<p class="calibre2">Let's try to access the Tomcat server installed on the AWS instance using the public domain name of the instance:</p>
<ol class="calibre17">
<li value="1" class="calibre11">If it gives the connection has timed out error, then the reason for this is the restriction of security groups in AWS. Go to the <span>Security Group</span> in the AWS instance:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00040.jpeg"/></div>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">In the <span>AWS</span> portal, go to the <span>Security Group</span> section. Select the default security group to verify the inbound rules. We can see only the <span>SSH</span> rule available; we need to allow port <kbd class="calibre15">8080</kbd> so that we can access it:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00043.jpeg"/></div>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">Let's create a new custom rule with port <span>8080</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00047.jpeg"/></div>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">Now, try to access the public domain URL, and we will get the Tomcat page on our AWS instance.</li>
</ol>
<p class="calibre2">In the next section, we will create and configure a virtual machine in Microsoft Azure.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Creating and configuring a virtual machine in Microsoft Azure</h1>
            

            <article>
                
<p class="calibre2">To create and configure Chef and Microsoft Azure integration, we need to provide the Microsoft Azure account and credentials. To get Microsoft Azure credentials, download the <kbd class="calibre15">publishsettings</kbd> file and perform the following steps:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Login to the Microsoft Azure portal using the login name and password and download a <kbd class="calibre15">publishsettings</kbd> file from <a href="https://manage.windowsazure.com/publishsettings/index?client=xplat" class="calibre4">https://manage.windowsazure.com/publishsettings/index?client=xplat</a>.</li>
<li value="2" class="calibre11">Copy it on a Chef workstation and refer to this local file by creating an entry in the <kbd class="calibre15">knife.rb</kbd> file:</li>
</ol>
<pre class="calibre26">
        knife[:azure_publish_settings_file] = "~/&lt;name&gt;.publishsettings"
</pre>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">The following are the parameters to create a virtual machine in the Microsoft Azure public cloud:</li>
</ol>
<table class="calibre23">
<tbody class="calibre7">
<tr class="calibre8">
<td class="calibre9"><strong class="calibre1">Parameter</strong></td>
<td class="calibre9"><strong class="calibre1">Value</strong></td>
<td class="calibre9"><strong class="calibre1">Description</strong></td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--azure-dns-name</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">distechnodemo</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the DNS name</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9"><kbd class="calibre28">--azure-vm-name</kbd></td>
<td class="calibre9"><kbd class="calibre28">dtserver02</kbd></td>
<td class="calibre9">
<p class="calibre2">This is the name of the virtual machine</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--azure-vm-size</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">Small</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the size of the virtual machine</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">-N</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">DevOpsVMonAzure2</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the name of the Chef node</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--azure-storage-account</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">classicstorage9883</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is Azure's storage account</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--bootstrap-protocol</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">cloud-api</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the Bootstrap protocol</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--azure-source-image</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">5112500ae3b842c8b9c604889f8753c3__OpenLogic-CentOS-67-20160310</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the name of the Azure source image</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--azure-service-location</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">Central US</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the Azure location to host the virtual machine</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--ssh-user</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">dtechno</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the SSH user</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--ssh-password</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">&lt;YOUR PASSWORD&gt;</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the SSH password</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">-r</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">role[v-tomcat]</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the role</p>
</td>
</tr>
<tr class="calibre8">
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">--ssh-port</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2"><kbd class="calibre15">22</kbd></p>
</td>
<td class="calibre9">
<p class="calibre2">This is the SSH port</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2">We have installed the <kbd class="calibre15">knife azure</kbd> plugin successfully. Now we can create the virtual machine in Microsoft Azure Cloud by executing the <kbd class="calibre15">knife azure server create</kbd> command as follows:</p>
<pre class="calibre26">
<strong class="calibre1">[root@devops1 Desktop]# knife azure server create --azure-dns-name 'distechnodemo' --azure-vm-name 'dtserver02' --azure-vm-size 'Small' -N DevOpsVMonAzure2 --azure-storage-account 'classicstorage9883' --bootstrap-protocol 'cloud-api' --azure-source-image '5112500ae3b842c8b9c604889f8753c3__OpenLogic-CentOS-67-20160310' --azure-service-location 'Central US' --ssh-user 'dtechno' --ssh-password 'cloud@321' -r role[v-tomcat] --ssh-port 22 </strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">.</strong><br class="title-page-name"/><strong class="calibre1">Creating new node for DevOpsVMonAzure2</strong><br class="title-page-name"/><strong class="calibre1">.........</strong><br class="title-page-name"/><strong class="calibre1">Waiting for virtual machine to reach status 'provisioning'..............vm state 'provisioning' reached after 2.47 minutes.</strong><br class="title-page-name"/><strong class="calibre1">..</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">DNS Name: distechnodemo.cloudapp.net</strong><br class="title-page-name"/><strong class="calibre1">VM Name: dtserver02</strong><br class="title-page-name"/><strong class="calibre1">Size: Small</strong><br class="title-page-name"/><strong class="calibre1">Azure Source Image: 5112500ae3b842c8b9c604889f8753c3__OpenLogic-CentOS-67-20160310</strong><br class="title-page-name"/><strong class="calibre1">Azure Service Location: Central US</strong><br class="title-page-name"/><strong class="calibre1">Private Ip Address: 100.73.210.70</strong><br class="title-page-name"/><strong class="calibre1">Environment: _default</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">Runlist: ["role[v-tomcat]"]</strong><br class="title-page-name"/><br class="title-page-name"/>
</pre>
<p class="calibre2">Now we will start with resource provisioning in Microsoft Azure Public Cloud:</p>
<pre class="calibre26">
Waiting for Resource Extension to reach status 'wagent provisioning'.....Resource extension state 'wagent provisioning' reached after 0.17 minutes.<br class="title-page-name"/><br class="title-page-name"/>Waiting for Resource Extension to reach status 'installing'....................Resource extension state 'installing' reached after 2.21 minutes.<br class="title-page-name"/>Waiting for Resource Extension to reach status 'provisioning'.....Resource extension state 'provisioning' reached after 0.19 minutes.<br class="title-page-name"/>..<br class="title-page-name"/>DNS Name: distechnodemo.cloudapp.net<br class="title-page-name"/>VM Name: dtserver02<br class="title-page-name"/>Size: Small<br class="title-page-name"/>Azure Source Image: 5112500ae3b842c8b9c604889f8753c3__OpenLogic-CentOS-67-20160310<br class="title-page-name"/>Azure Service Location: Central US<br class="title-page-name"/>Private Ip Address: 100.73.210.70<br class="title-page-name"/>Environment: _default<br class="title-page-name"/>Runlist: ["role[v-tomcat]"]<br class="title-page-name"/>[root@devops1 Desktop]#
</pre>
<ol class="calibre17">
<li value="1" class="calibre11">Go to the hosted Chef account in the browser and click on the <span>Nodes</span> tab.</li>
<li value="2" class="calibre11">Verify that the new node we created on Microsoft Azure Public Cloud has been registered on the hosted Chef server.</li>
<li value="3" class="calibre11">We can see the <kbd class="calibre15">DevOpsVMonAzure2</kbd> <span>Node Name</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00007.jpeg"/></div>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">Go to the <span>Microsoft Azure</span> portal and click on the <span>VIRTUAL MACHINES</span> section to verify the newly created virtual machine using the Chef configuration management tool:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00012.jpeg"/></div>
<ol start="5" class="calibre17">
<li value="5" class="calibre11">Click on <span>VIRTUAL MACHINES</span> in the <span>Microsoft Azure</span><span> Dashboard</span>, and verify the details of virtual machines:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00053.jpeg"/></div>
<ol start="6" class="calibre17">
<li value="6" class="calibre11">Go to the bottom of the <span>virtual machines</span> page, and verify the <span>extensions</span> section.</li>
<li value="7" class="calibre11">Check whether it shows <span>chef-service enabled</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00054.jpeg"/></div>
<p class="calibre2"><span>We have now created virtual machines in Amazon EC2 and Microsoft Azure using <kbd class="calibre15">knife</kbd> plugins with installed runtime environment using role.<br class="title-page-name"/></span></p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
            

            <article>
                
<div class="title-page-name">
<p class="calibre2">In this chapter, we installed and configured a Chef workstation, we converged the node, created a role, and installed the runtime environment for Java-based web applications. We also used <kbd class="calibre15">knife</kbd> plugins to create virtual machines in Microsoft Azure and Amazon EC2 and used a role to install a runtime environment.</p>
<p class="calibre2">In the next chapter, we will see how to deploy Java-based web applications into the web server in an automated way using scripts or plugins. </p>
<p class="calibre2">We will deploy our WAR file into the local or remote Tomcat. The remote Tomcat will be on Amazon EC2, Microsoft Azure Virtual Machine, AWS Elastic Beanstalk, or Microsoft Azure Web Apps.</p>
</div>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    </body></html>