<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Incident Response</h1>
                
            
            <article>
                
<p class="calibre2"> Security testing plans, whitebox testing tips, security toolsets, and automation were illustrated in previous chapters. Starting with this chapter, we will now discuss incident responses for a security operation team. <span class="calibre6">We will mainly discuss the key activities in the key phases of the incident response process: preparation, containment, detection, and post-incident analysis. </span>The field of incident response includes how to handle public CVE vulnerability, how to respond to whitehat or security attacks, how we evaluate each security issue, the feedback loop to the development team, and the tools or practices we may apply in incident response. The topics that will be covered in this chapter are as follows:<span class="calibre6"> </span></p>
<ul class="calibre10">
<li class="calibre11">Security incident response process</li>
<li class="calibre11">Security operation team structure</li>
<li class="calibre11">Incident forensics techniques</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Security incident response process</h1>
                
            
            <article>
                
<p class="calibre2">Establishing a security incident response process is a must for not only very large enterprises but also small businesses. Cybersecurity laws or GDPR require not only a security incident process, but they also require a security incident notification to be sent to the supervisory authority and key stakeholders. A complete security incident process involves the security incident handling team, human resources, the legal department, and also external supervisory groups. Although there are many security technologies and tools that can help to identify, protect, detect, respond, and recover from threats, PR and public communication play critical roles in non-technical parts. We will mainly focus on the security <span class="calibre6">activities </span>during the preparation, detection, containment, and post-incident handling stages based on NIST SP 800-62.</p>
<p class="calibre2"/>
<p class="calibre2">Here are some of the recommended industry references related to security incident response: </p>
<ul class="calibre10">
<li class="calibre11">NIST SP 800-62 Computer Security Incident Handling Guide (<a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final" class="calibre9">https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final</a>)</li>
<li class="calibre11">SANS Incident Handler Handbook (<a href="https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901" class="calibre9">https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901</a>)</li>
<li class="calibre11">ENISA Cloud Computing Benefits, risks, and recommendations for information security (<a href="https://resilience.enisa.europa.eu/cloud-security-and-resilience/publications/cloud-computing-benefits-risks-and-recommendations-for-information-security" class="calibre9">https://resilience.enisa.europa.eu/cloud-security-and-resilience/publications/cloud-computing-benefits-risks-and-recommendations-for-information-security</a>)</li>
<li class="calibre11">MITRE Ten Strategies of a World-Class Cyber Security Operations Center (<a href="https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf" class="calibre9">https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf</a>)</li>
<li class="calibre11">FIRST (<a href="https://www.first.org/education/FIRST_PSIRT_Service_Framework_v1.0" class="calibre9">https://www.first.org/education/FIRST_PSIRT_Service_Framework_v1.0</a>)</li>
</ul>
<p class="calibre2">NIST SP 800-62 defines the incident response life cycle as consisting of four phases: preparation, detection and analysis, containment eradication and recovery, and post-incident activity. We will introduce some practical tools for each phase in the upcoming sections:</p>
<p class="cdpaligncenter1"><img class="alignnone28" src="../images/00047.jpeg"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Preparation</h1>
                
            
            <article>
                
<p class="calibre2">The preparation is the most critical part of the incident process. We cannot completely predict or avoid any security incident, but we can plan to have full preparation for a security incident. The preparation covers<span class="calibre6"> all the required processes, analysis tools, security technologies, and team resources to prevent and handle a security incident. Preparation not only helps in preventing security incidents but also minimizing the damage caused during a security incident.</span></p>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">Here are some suggested security practices to be performed in the incident response preparation phase:</p>
<ul class="calibre10">
<li class="calibre11">Incident handler communication plan</li>
<li class="calibre11">Incident analysis hardware and software tools (refer to the section on incident forensics)</li>
<li class="calibre11">Existing networking diagram and baselines</li>
<li class="calibre11">Prevention controls, such as risk assessments, host security, network security, malware protection, user awareness, and training (refer to the CIS security controls)</li>
<li class="calibre11">The blue and red team security exercise (refer to the following table)</li>
<li class="calibre11">Bounty program for whitehat hackers or security researchers to submit security issues </li>
</ul>
<p class="calibre2">It's suggested that you perform internal attack simulations regularly to test the effectiveness and weakness of existing endpoint and network detection security solutions, such as antivirus software, IPS, IDS, and firewalls. The security team can also analyze the existing logging and alerting capabilities and the response time. These kinds of simulated attacks give the security team a chance to review and optimize the existing security framework. </p>
<p class="calibre2">The following open source tools can help to generate an internal attack simulation without compromising business operations. These tools don't generate real attack samples, but simulate the behaviors of hacking or <strong class="calibre4">advanced persistent threat</strong> (<strong class="calibre4">APT</strong>) behaviors: </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Tools</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Simulation of APT</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">DumpsterFire  </p>
</td>
<td class="calibre28">
<p class="calibre2">The DumpsterFire tool includes various kinds of simulated attack scenarios, such as an account attack, file download, drop files, command execution, and web access in Python. It provides a user-friendly menu to customize the security incidents, even for those who don't understand Python.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">METTA </p>
</td>
<td class="calibre28">
<p class="calibre2">The METTA tool allows the security team to customize the simulation of APT attacks based on MITRE ATT&amp;CK. The simulated APT behaviors defined by YAML include credential access, evasion, discovery, execution, exfiltration, lateral movement, persistence, and privilege escalation.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Red Team Automation (RTA)</p>
</td>
<td class="calibre28">
<p class="calibre2">The Red Team Automation tool is a collection of Python and PowerShell scripts that can simulate over 50 malicious behaviors based on ATT&amp;CK. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Atomic Red Team (ART)</p>
</td>
<td class="calibre28">
<p class="calibre2">The Atomic Red Team tool provides Windows, macOS, and Linux shell scripts to simulate the MITRE ATT&amp;CK. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">APT Simulator</p>
</td>
<td class="calibre28">
<p class="calibre2">The APT Simulator tool is a collection of Windows BAT scripts that simulate APT behaviors. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Network Flight Simulator</p>
</td>
<td class="calibre28">
<p class="calibre2">The Network Flight Simulator tool can be used to generate malicious network traffic, such as DNS tunneling, C2 communication, DGA traffic, and port scans. </p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"><br class="calibre5"/>
During the security incident handling, the team may be occupied by the case, but forget to record the information. An incident case-tracking tool will help to keep records of the relevant information. The open source tool FIR (Fast Incident Response) is a security incident case-management tool that can help to record, track, and archive all the findings for each security incident case. This information will help to build an in-house security incident handling knowledge base and generate an incident report for post-mortem analysis (you can find the tool at <a href="https://github.com/certsocietegenerale/FIR/" class="calibre9">https://github.com/certsocietegenerale/FIR/</a>).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Detection and analysis</h1>
                
            
            <article>
                
<p class="calibre2">Identifying the signs of a security incident requires the deployment of various security solutions and log sensors. The sources of infections include IDS/IPS, SIEM, antivirus, file-integrity monitoring, OS/network logs, and public and known vulnerabilities. The deployment of the whole enterprise's security controls may refer to the CIS Critical Security Controls for Effective Cyber Defense (you can find the information at <a href="https://www.cisecurity.org/controls/boundary-defense/" class="calibre9">https://www.cisecurity.org/controls/</a>).</p>
<p class="calibre2">These consist of 20 security controls, as summarized in the following table. There are many commercial solutions in each security control, but only open source solutions are listed in the table: </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Cybersecurity controls</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Examples of security techniques and open source tools</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC1: Inventory of Authorized and Unauthorized Devices</p>
</td>
<td class="calibre28">
<p class="calibre2">Endpoint security, Asset Management</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC2: Inventory of Authorized and Unauthorized Software</p>
</td>
<td class="calibre28">
<p class="calibre2">Endpoint security, Asset Management</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CS3: Secure Configurations for Hardware and Software on Mobile Devices, Laptops, Workstations, and Servers</p>
</td>
<td class="calibre28">
<p class="calibre2">CIS Security Benchmark, OpenSCAP.</p>
<p class="calibre2"> </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC4: Continuous Vulnerability Assessment and Remediation</p>
</td>
<td class="calibre28">
<p class="calibre2">OpenVAS</p>
<p class="calibre2">Nmap </p>
<p class="calibre2">OWASP Dependency Check</p>
<p class="calibre2">OWASP Dependency-Track</p>
<p class="calibre2">vulscan </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 5: Controlled Use of Administrative Privileges</p>
</td>
<td class="calibre28">
<p class="calibre2">Strong password complexity</p>
<p class="calibre2">Auditing logs for root and administrator activities</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 6: Maintenance, Monitoring, and Analysis of Audit Logs</p>
</td>
<td class="calibre28">
<p class="calibre2">Syslog, Event Logs, SIEM</p>
<p class="calibre2">ELK</p>
<p class="calibre2">GrayLog</p>
<p class="calibre2">Security Onion </p>
<p class="calibre2">Malicious Traffic Detection </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 7: Email and Web Browser Protections</p>
</td>
<td class="calibre28">
<p class="calibre2">Email Protection, Anti-Spam, Web Application Firewall</p>
<p class="calibre2">ModSecurity </p>
<p class="calibre2">Email Encryption Scramble </p>
<p class="calibre2">Linux Malware Detection</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 8: Malware Defenses</p>
</td>
<td class="calibre28">
<p class="calibre2">Endpoint Protection, Antivirus, HIDS/HIPS</p>
<p class="calibre2">OSSEC</p>
<p class="calibre2">ClamAV</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 9: Limitation and Control of Network Ports, Protocols, and Services</p>
</td>
<td class="calibre28">
<p class="calibre2">Nmap </p>
<p class="calibre2">OpenSCAP</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 10: Data Recovery Capability</p>
</td>
<td class="calibre28">
<p class="calibre2">Bacula </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 11: Secure Configurations for Network Devices, such as Firewalls, Routers, and Switches</p>
</td>
<td class="calibre28">
<p class="calibre2">CIS Security Benchmark </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 12: Boundary Defense</p>
</td>
<td class="calibre28">
<p class="calibre2">Firewall, IPS, HoneyPot</p>
<p class="calibre2">Security Onion </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 13: Data Protection</p>
</td>
<td class="calibre28">
<p class="calibre2">OSQuery </p>
<p class="calibre2">Data Vault  </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 14: Controlled Access Based on the Need to Know</p>
</td>
<td class="calibre28">
<p class="calibre2">Data Classification, Firewall, VLAN, Logging</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 15: Wireless Access Control</p>
</td>
<td class="calibre28">
<p class="calibre2">VPN, SSL Certificate, WAP2</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 16: Account Monitoring and Control</p>
</td>
<td class="calibre28">
<p class="calibre2">Log Analysis Tools</p>
<p class="calibre2">Fail2ban </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 17: Security Skills Assessment and Appropriate Training to Fill Gaps</p>
</td>
<td class="calibre28">
<p class="calibre2"><span class="calibre6">Security Training and Labs Resource</span></p>
<p class="calibre2">CybraryIT </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 18: Application Software Security</p>
</td>
<td class="calibre28">
<p class="calibre2">OWASP </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 19: Incident Response and Management</p>
</td>
<td class="calibre28">
<p class="calibre2">NIST SP800-61 Computer Security Incident Handling Guide </p>
<p class="calibre2"><span class="calibre6">FIR (Fast Incident Response) </span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">CSC 20: Penetration Tests and Red Team Exercises</p>
</td>
<td class="calibre28">
<p class="calibre2">Refer to some of the open source tools we suggested in the <em class="calibre16">Preparation</em> section</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">When a security incident case is received, the security team should perform a prioritization of the security incident based on the impact that it has. The NIST SP800-61 Computer Security Incident Handling Guide suggests quantifying the impact level by the functional impact, the PII information impact, and the recoverability effort:</p>
<ul class="calibre10">
<li class="calibre11">The functional impact means the impact on business functions</li>
<li class="calibre11">The PII information impact is the <strong class="calibre1">confidentiality, integrity, and availability</strong> (<span><strong class="calibre1">CIA</strong>)</span> of the sensitive information</li>
<li class="calibre11">The recoverability effort refers to the amount of time and resources needed to recover from the incident</li>
</ul>
<p class="calibre2">The following table shows some sample definitions of each security incident alert level: </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Priority</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Impact</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Response</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">High</p>
</td>
<td class="calibre28">
<p class="calibre2">The functional impact, information leakage, or recoverability effort is classed as high.</p>
</td>
<td class="calibre28">
<p class="calibre2">Requires immediate <span class="calibre6">human</span><span class="calibre6"> </span><span class="calibre6">response.</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Medium</p>
</td>
<td class="calibre28">
<p class="calibre2">The functional impact, information leakage, or recoverability effort is classed as medium.</p>
</td>
<td class="calibre28">
<p class="calibre2">Requires response within 24 hours.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Low</p>
</td>
<td class="calibre28">
<p class="calibre2">The functional impact, information leakage, and recoverability effort are all defined as low.</p>
</td>
<td class="calibre28">
<p class="calibre2">Requires response during routine tasks.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Notification</p>
</td>
<td class="calibre28">
<p class="calibre2">No major signs are directly related to the functional impact or information leakage, but it can be a potential security issue.</p>
</td>
<td class="calibre28">
<p class="calibre2">Just a notice. This can be part of a quarterly threat-trending analysis.</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Containment and recovery</h1>
                
            
            <article>
                
<p class="calibre2">The short-term objective of containment is to isolate the infected hosts before a complete solution is ready. On the other hand, the long-term objective of recovery is to look for a security control that can avoid a similar security incident in the future, or that can perform automatic recovery when the security incident is detected. </p>
<p class="calibre2">For the containment, there are typical network- or host-containment criteria established by network policy enforcement. Whenever one of the criteria is met, the containment actions can include blocking that specific host, redirecting the traffic to apply the latest security patches, and rejecting specific communication traffic or ports. </p>
<p class="calibre2">The following are common security <span class="calibre6">policy enforcement criteria </span>that will trigger the network or host containment: </p>
<ul class="calibre10">
<li class="calibre11">The host hasn't installed any antivirus products.</li>
<li class="calibre11">The antivirus pattern/engine versions are not updated.</li>
<li class="calibre11">There are known vulnerable components on the host.</li>
<li class="calibre11">There is suspicious communication traffic on the specified ports.</li>
<li class="calibre11">A known virus is detected on the hosts.</li>
<li class="calibre11">There is outgoing communication to an external known malicious IP or domain. Refer to the following resources:
<ul class="calibre89">
<li class="calibre11"><a href="http://iplists.firehol.org/" class="calibre9">http://iplists.firehol.org/</a>  </li>
<li class="calibre11"><a href="https://www.spamhaus.org/drop/" class="calibre9">https://www.spamhaus.org/drop/</a> </li>
<li class="calibre11"><a href="https://rules.emergingthreats.net/fwrules/emerging-Block-IPs.txt" class="calibre9">https://rules.emergingthreats.net/fwrules/emerging-Block-IPs.txt</a></li>
<li class="calibre11"><a href="https://check.torproject.org/exit-addresses" class="calibre9">https://check.torproject.org/exit-addresses</a></li>
</ul>
</li>
</ul>
<p class="calibre2">In terms of recovery, the objective is to restore the infected applications or hosts back to normal operation. The activities of recovery not only include restoring the system but also removing compromised files, applying the latest patches, securing communication ports, increasing the complexity of passwords, and improving security controls, such as permission configurations, HIDS, SELinux, and firewalls. </p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Post-incident activity</h1>
                
            
            <article>
                
<p class="calibre2">Hosting a <em class="calibre16">lessons learned</em> meeting or post-mortem analysis report can help the team to learn from the incident. The primary objective of the lessons learned meeting is to look for the improvement of each phase during the security incident response process. This kind of meeting is often neglected once the security issue is solved. It's suggested that you at least document the process of the security incident and incorporate it into the knowledge base.</p>
<p class="calibre2">For a lessons learned meeting, the meeting should focus on how the team can improve <span class="calibre6">together</span><span class="calibre6"> </span><span class="calibre6">and prevent a similar issue in the future instead of blaming someone for the error. The inputs of the post-mortem meeting typically include the proposed security control changes, the case-handling information, and the root cause analysis report. It's expected that the team will think on what specific actions can be done to prevent similar issues. For example, specific email phishing awareness training can be increased. The security scanning rules in IDS can be optimized to reduce false positives. Security incident forensics can be done by automation. The period of the known vulnerabilities installation cycle can be shortened. These are the potential outputs of the meeting with the consensus among the stakeholders, such as the security, IT, development, business, and legal teams.</span></p>
<p class="calibre2">The expected post-mortem output report typically includes certain key sections answering key questions, such as what happened, the impact, root cause analysis, short-term and long-term mitigations, the activities that occurred during the incident timeline, what should be improved, and what should be kept. Here is an example of a post-mortem meeting output report:</p>
<p class="calibre2"><strong class="calibre4">Overview of the issue</strong></p>
<p class="calibre2">One of the services was identified as having abnormal unavailability. The WebLogic process had a CPU usage of 100%, and the log showed an abnormal and suspicious outbound IP connection.</p>
<p class="calibre2"><strong class="calibre4">What happened and the impact</strong></p>
<p class="calibre2">Business Functional Impact: Some of the services slowed down, and were unable to respond to the requests. The running process occupied 100% of the CPU resources. No data-leakage risks were identified.</p>
<p class="calibre2"><strong class="calibre4">Root Cause Analysis</strong></p>
<ul class="calibre10">
<li class="calibre11">IT identified that it was the WebLogic process that frequently had a CPU usage of over 80%.</li>
<li class="calibre11">After the security team checked the Linux connection logs, it was confirmed that the WebLogic process had an outbound connection to external hosts that were related to cryptojacking (c<span>ryptojacking refers to the use of compromised hosts to mine cryptocurrency</span>).</li>
<li class="calibre11">After searching the CVE database by the security team, the issue was likely related to CVE 2017-3248.</li>
</ul>
<p class="calibre2"><strong class="calibre4">Mitigation and Solutions</strong></p>
<ul class="calibre10">
<li class="calibre11">Short-term before the security patch is ready: Apply firewall rules to block outbound communication traffic to the cryptojacking servers, and inbound connections to the victim host.</li>
<li class="calibre11">Long-term:
<ul class="calibre89">
<li class="calibre11">Apply WebLogic security patch.</li>
<li class="calibre11">Update the antivirus security patterns.</li>
<li class="calibre11">Optimize the host-based intrusion detection rules for high-CPU usage processes and abnormal outbound connections behaviors.</li>
</ul>
</li>
</ul>
<p class="calibre2"><strong class="calibre4">Activities during the timeline</strong></p>
<p class="calibre2">Day 1 1000: IT service monitoring identified service unavailability.</p>
<p class="calibre2">Day 1 1020: IT identified that a WebLogic process occupied 100% CPU usage, and collected related logs for further analysis. As the issue happened frequently and impacted the service's availability, the case was also escalated to the security team to identify whether it was a security incident.</p>
<p class="calibre2">Day 1 1040: Security team completed the log analysis and identified abnormal connections.</p>
<p class="calibre2">Day 1 1145: The IT team was informed, and decided to disconnect the outbound connection to the malicious IP.</p>
<p class="calibre2"><strong class="calibre4">What should be improved or kept</strong></p>
<ul class="calibre10">
<li class="calibre11">Keep: Good collaboration between IT and security team.</li>
<li class="calibre11">Improvement: Automated log collection and analysis tools.</li>
<li class="calibre11">Improvement: Virtual patch by firewall before a security patch is ready.</li>
<li class="calibre11">Improvement: Networking log correlation with threat knowledge from<span> </span><a href="http://iplists.firehol.org/" class="calibre9">http://iplists.firehol.org/</a>.</li>
</ul>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Security incident response platforms (SIRP)</h1>
                
            
            <article>
                
<p class="calibre2">When handling a security incident, there will be lots of information that needs to be processed and analyzed. An ideal security incident response platform should be able to do the following: </p>
<ul class="calibre10">
<li class="calibre11">Receive alerts and security events from different sources (SIEM, IDS, email)</li>
<li class="calibre11">The security incident case management should allow a security analyst to add related logs, IOCs, or findings during the incident case handling life cycle</li>
<li class="calibre11">Compare its analysis with external threat information, such as VirusTotal, to identify the malicious behaviors of <span>a file, hash, domain, or IP address</span></li>
</ul>
<p class="calibre2">The open source tool TheHive can help you to provide a security incident response management platform. TheHive can also work with MISP, which is a threat intelligence platform for sharing and correlating indicators of compromise (which indicate that a targeted attack has taken place) and vulnerability information. Refer to the following  documentation for more information:  </p>
<ul class="calibre10">
<li class="calibre11"><a href="https://thehive-project.org/" class="calibre9">https://thehive-project.org/</a></li>
<li class="calibre11"><a href="http://www.misp-project.org/index.html" class="calibre9">http://www.misp-project.org/index.html</a></li>
</ul>
<p class="calibre2"><span class="calibre6">For more information on how TheHive, CorTex, and MISP can integrate together for a threat incident response, go to </span><a href="https://blog.thehive-project.org/2017/06/19/thehive-cortex-and-misp-how-they-all-fit-together/" class="calibre9">https://blog.thehive-project.org/2017/06/19/thehive-cortex-and-misp-how-they-all-fit-together/</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">SOC team</h1>
                
            
            <article>
                
<p class="calibre2">The <strong class="calibre4">security operations center</strong> (<span class="calibre6"><strong class="calibre4">SOC</strong>),</span> also known as the <strong class="calibre4">computer incident response team</strong> (<span class="calibre6"><strong class="calibre4">CIRT</strong>),</span> is the security team that handles and monitors daily security events. The organizational structure of SOC can include parts of the existing IT team, an outsourced team, or a dedicated security team. No matter what kind of structure it has, there are several key functions that the team will have:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Key functions</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Description</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Security incident analysis and forensics (call center)</p>
</td>
<td class="calibre28">
<p class="calibre2">This function team may include the Tier 1 case handling in the 24/7 security monitoring center. The Tier 1 team typically handles the case by following the predefined checklist or SOP to perform initial root-cause analysis or mitigation based on the incidents.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Security operations and administration</p>
</td>
<td class="calibre28">
<p class="calibre2">This functional team involves the following routine security activities. These are regular security checking activities for the production environments: </p>
<ul class="calibre10">
<li class="calibre11">Network scanning (weekly)</li>
<li class="calibre11">Vulnerability scanning (weekly)</li>
<li class="calibre11">Penetration testing (monthly)</li>
<li class="calibre11">Security awareness training (bi-monthly)</li>
<li class="calibre11">Security log trending analysis (monthly)</li>
<li class="calibre11">Security administration and monitoring (daily)</li>
<li class="calibre11">Patch or security signature update (daily/weekly)</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Security tools engineering</p>
</td>
<td class="calibre28">
<p class="calibre2">The security engineering team implement security tools for the security call center or security operations team. The security tools can be security automation, suspicious behaviors detectors, forensic analysis tools, security configurations checker, threat intelligence integration, threat signatures creation, and so on.</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">The SOC team can consist of parts of an IT call center or a dedicated security team depending on the size of the whole organization. A typical dedicated SOC team structure is shown in the following diagram:</p>
<div class="cdpaligncenter2"><img src="../images/00048.jpeg" class="calibre115"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Incident forensics techniques</h1>
                
            
            <article>
                
<p class="calibre2">The primary objective of incident forensics for an organization is to answer the following questions:</p>
<ul class="calibre10">
<li class="calibre11">Is the host infected with a malicious program?</li>
<li class="calibre11">How did the host get infected?</li>
<li class="calibre11">What can be improved to avoid the infection?</li>
</ul>
<p class="calibre2"/>
<p class="calibre2">The NIST SP 800-86 Guide to Integrating Forensic Techniques into Incident Response defines four major phases to perform digital forensics on a compromised computer:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">Collection</strong>: Collect all the relevant logs of the compromised computer or networking activities logs</li>
<li class="calibre11"><strong class="calibre1">Examination</strong>: Extract and correlate the information that may highly relate to suspicious behaviors</li>
<li class="calibre11"><strong class="calibre1">Analysis</strong>: Analyze all the information for root causes of the malicious infection</li>
<li class="calibre11"><strong class="calibre1">Reporting</strong>: Conclude the summary results</li>
</ul>
<p class="calibre2">The forensics techniques require the capability of the incident response team to perform the analysis. In the following table, we have listed some quick-win solutions that can perform semi-automated forensics, including collection, examination, and analysis: </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Category</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Tools</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Purpose and usage scenario</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Log Collection</p>
</td>
<td class="calibre28">
<p class="calibre2">OSX Collector</p>
</td>
<td class="calibre28">
<p class="calibre2"><span class="calibre6">Mac OS X Log Collector is a</span>n automated forensic evidence collection for macOS. The Python script, osxcollector.py, is the script that performs all the collection jobs. The tool will generate a JSON file as a summary of the collected information. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Log Collection</p>
</td>
<td class="calibre28">
<p class="calibre2">IR Rescue</p>
</td>
<td class="calibre28">
<p class="calibre2">IR Rescue is a Windows and Linux script for collecting host forensic data. For the Windows version, it integrates several utilities from the <span class="calibre6">from Sysinternals and NirSoft.</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Log Collection</p>
</td>
<td class="calibre28">
<p class="calibre2">FastIR Collector</p>
</td>
<td class="calibre28">
<p class="calibre2"><span class="calibre6">FastIR Collector (for Linux) </span>only requires one Python script to collect all related logs in Linux. </p>
<p class="calibre2"><span class="calibre6">For Windows systems, it will</span> require additional <span class="calibre6">modules and tools. Refer to</span> <a href="https://github.com/SekoiaLab/Fastir_Collector" class="calibre9">https://github.com/SekoiaLab/Fastir_Collector </a><span class="calibre6">for more information.</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Malware Detector</p>
</td>
<td class="calibre28">
<p class="calibre2">Linux Malware Scanner</p>
</td>
<td class="calibre28">
<p class="calibre2">Free malware scanners for Linux are available from the following links:</p>
<p class="calibre2">CalmAV: It's an open source antivirus software for Windows.</p>
<p class="calibre2">Linux Malware Detect (LMD): <span class="calibre6">It's an open source antivirus</span><span class="calibre6"> software for Linux.</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Suspicious Files Analysis</p>
</td>
<td class="calibre28">
<p class="calibre2">Cuckoo</p>
</td>
<td class="calibre28">
<p class="calibre2">Cuckoo is an automated malware analysis system. It can analyze the dynamic runtime and static behaviors of the unknown and suspicious files under Windows, Linux, macOS, and Android.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Client/Server log collector and analysis</p>
</td>
<td class="calibre28">
<p class="calibre2">GRR Rapid Response</p>
</td>
<td class="calibre28">
<p class="calibre2">You can use Google Remote Live forensics for incident response. It will require the installation of a Python agent on the target hosts to collect the logs and on the Python server to do the analysis. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Client/Server log collector and analysis</p>
</td>
<td class="calibre28">
<p class="calibre2">OSQuery</p>
</td>
<td class="calibre28">
<p class="calibre2">The OSQuery tool works in a similar way to GRR. The key difference is that OSQuery provides an SQL query to perform endpoint analysis.</p>
<p class="calibre2">For more information, you can read the documentation at the following links:</p>
<p class="calibre2"><a href="https://osquery.io/" class="calibre9">https://osquery.io/</a></p>
<p class="calibre2"><a href="https://osquery.readthedocs.io/en/stable/deployment/anomaly-detection/" class="calibre9">https://osquery.readthedocs.io/en/stable/deployment/anomaly-detection/</a></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we discussed the security incident response process and shared some of the industry practices, such as the NIST SP800-62, SANS Incident Handler Handbook, and MITRE's Ten Strategies of a World-Class Cyber Security Operations Center. We explored the incident response activities based on the phases defined by the NIST SP800-62, which are the preparation, detection and analysis, containment eradication, and post-incident activity phases.</p>
<p class="calibre2">In the preparation phase, we introduced some of the simulated attack tools for the red/blue team exercise. In the detection phase, we suggested applying CIS Critical Security Controls for Effective Cyber Defense to assess the detection and analysis capabilities. <span class="calibre6">We introduced some containment security policies when looking at the</span><span class="calibre6"> </span><span class="calibre6">containment phase. In the post-incident phase, we learned how to do a post-mortem review and looked at one incident post-mortem sample report. To link all the information from the different phases and teams, it's suggested that you have a</span> <strong class="calibre4">security incident response platform</strong> <span class="calibre6">(</span><strong class="calibre4">SIRP</strong><span class="calibre6">).</span></p>
<p class="calibre2">Last but not least, we discussed the SOC organization and the key functions that it should have. We also looked at some incident forensics techniques and tools.</p>
<p class="calibre2">In the next chapter, we will discuss security monitoring. Security incident response may be a one-time event for security case handling, but security monitoring will be a constant security-monitoring activity. </p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Questions</h1>
                
            
            <article>
                
<ol class="calibre13">
<li value="1" class="calibre11">What's the right order of the security incident response phases?
<ol class="calibre14">
<li value="1" class="calibre11">Detection -&gt; Preparation -&gt; Containment -&gt; Post-Incident Analysis</li>
<li value="2" class="calibre11">Containment -&gt; Detection -&gt; Preparation -&gt; Post-Incident Analysis</li>
<li value="3" class="calibre11">Preparation -&gt; Detection -&gt; Containment -&gt; Post-Incident Analysis</li>
<li value="4" class="calibre11">Preparation -&gt; Containment -&gt; Detection -&gt; Post-Incident Analysis</li>
</ol>
</li>
<li class="calibre11" value="2">What best describes a bounty program?
<ol class="calibre14">
<li class="calibre11" value="1">It's an incentive program for security researchers to submit security issues</li>
<li class="calibre11" value="2">It's a security awareness training program</li>
<li class="calibre11" value="3">It's an in-house security penetration exercise</li>
<li class="calibre11" value="4">It's a security design camp</li>
</ol>
</li>
<li class="calibre11" value="3">What's the purpose of attack simulations?
<ol class="calibre14">
<li class="calibre11" value="1">To test the weakness of endpoint detection</li>
<li class="calibre11" value="2">To test the detection capability of network security</li>
<li class="calibre11" value="3">To test the logging and alerting capability of the security system</li>
<li class="calibre11" value="4">All of the above</li>
</ol>
</li>
<li class="calibre11" value="4">What does the CIS Critical Security Controls for Effective Cyber Defense define?
<ol class="calibre14">
<li class="calibre11" value="1">It defines the 20 security controls for the whole enterprise security</li>
<li class="calibre11" value="2">It defines incident response processes</li>
<li class="calibre11" value="3">It defines the secure coding practices</li>
<li class="calibre11" value="4">It defines security automation practices</li>
</ol>
</li>
<li class="calibre11" value="5">The ELK, Graylog, and Syslogs are mainly used in which of the following security controls?
<ol class="calibre14">
<li class="calibre11" value="1">Monitoring and Analysis of Audit Logs</li>
<li class="calibre11" value="2">Email and Web Browser Protections</li>
<li class="calibre11" value="3">Malware Defenses</li>
<li class="calibre11" value="4">Data Recovery Capability</li>
</ol>
</li>
</ol>
<ol start="6" class="calibre13">
<li class="calibre11" value="6">Which should not be used to quantify the impact level?
<ol class="calibre14">
<li class="calibre11" value="1">The functional impact</li>
<li class="calibre11" value="2">The malware detection capability</li>
<li class="calibre11" value="3">The PII information impact</li>
<li class="calibre11" value="4">The recoverability efforts</li>
</ol>
</li>
<li value="7" class="calibre11">Which one of the following is the incorrect role/responsibility for the SOC team?
<ol class="calibre14">
<li value="1" class="calibre11">The primary objective of the Tier 1 call center is to perform malware analysis</li>
<li value="2" class="calibre11">The security operations team should perform network scanning on a regular basis</li>
<li value="3" class="calibre11">The security tools engineering team is in charge of security tools implementation</li>
<li value="4" class="calibre11">The security log analysis should be regularly summarized and analyzed</li>
</ol>
</li>
<li value="8" class="calibre11">What is the correct description of "cryptojacking<span> "?</span>
<ol class="calibre14">
<li value="1" class="calibre11"><span>Unauthorized use of a compromised host to mine cryptocurrency</span></li>
<li value="2" class="calibre11">Encryption of the compromised host without permission</li>
<li value="3" class="calibre11">Unauthorized access to the encrypted information</li>
<li value="4" class="calibre11">Unauthorized encryption of the compromised host</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Further reading</h1>
                
            
            <article>
                
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">NIST SP 800-62 Computer Security Incident Handling Guide</strong>: <a href="https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf" class="calibre9">https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf</a></li>
<li class="calibre11"><strong class="calibre1">ENISA Cloud Computing Benefits, risks, and recommendations for information security</strong>: <a href="https://www.enisa.europa.eu/publications/cloud-computing-risk-assessment" class="calibre9">https://www.enisa.europa.eu/publications/cloud-computing-risk-assessment</a></li>
<li class="calibre11"><strong class="calibre1">Handbook for Computer Security Incident Response Teams (CSIRTs)</strong>: <a href="https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=6305" class="calibre9">https://resources.sei.cmu.edu/library/asset-view.cfm?assetid=6305</a></li>
<li class="calibre11"><strong class="calibre1">SANS Security Checklists &amp; Step by Step Guides</strong>: <a href="https://www.sans.org/score/checklists" class="calibre9">https://www.sans.org/score/checklists</a></li>
<li class="calibre11"><strong class="calibre1">Awesome Incident Response</strong>: <a href="https://github.com/meirwah/awesome-incident-response/" class="calibre9">https://github.com/meirwah/awesome-incident-response/</a></li>
<li class="calibre11"><strong class="calibre1">InfoSec Tools</strong>: <a href="https://secure.dshield.org/tools/" class="calibre9">https://secure.dshield.org/tools/</a></li>
<li class="calibre11"><strong class="calibre1">Forming an Incident Response Team</strong>:  <a href="https://www.auscert.org.au/publications/forming-incident-response-team" class="calibre9">https://www.auscert.org.au/publications/forming-incident-response-team</a></li>
<li class="calibre11"><strong class="calibre1">Awesome Forensics</strong>: <a href="https://github.com/cugu/awesome-forensics/" class="calibre9">https://github.com/cugu/awesome-forensics/</a></li>
<li class="calibre11"><strong class="calibre1">Awesome Incident Response</strong>:  <a href="https://github.com/meirwah/awesome-incident-response/" class="calibre9">https://github.com/meirwah/awesome-incident-response/</a></li>
<li class="calibre11"><strong class="calibre1">Awesome List of Digital Forensic Tools</strong>: <a href="https://github.com/ivbeg/awesome-forensicstools/" class="calibre9">https://github.com/ivbeg/awesome-forensicstools/</a></li>
<li class="calibre11"><strong class="calibre1">Awesome Malware Analysis Tools</strong>: <a href="https://github.com/rshipp/awesome-malware-analysis/" class="calibre9">https://github.com/rshipp/awesome-malware-analysis/</a></li>
<li class="calibre11"><strong class="calibre1">Incident Response Playbooks</strong>: <a href="http://www.incidentresponse.com/playbooks/" class="calibre9">www.incidentresponse.com/playbooks/</a></li>
<li class="calibre11"><strong class="calibre1">SANS Incident Handler's Handbook</strong>: <a href="https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901" class="calibre9">https://www.sans.org/reading-room/whitepapers/incident/incident-handlers-handbook-33901</a></li>
<li class="calibre11"><strong class="calibre1">Incident Response Process</strong>: <a href="https://response.pagerduty.com" class="calibre9">https://response.pagerduty.com</a></li>
<li class="calibre11"><strong class="calibre1">NIST Framework for Improving Critical Infrastructure Cybersecurity</strong>: <a href="https://www.nist.gov/publications/framework-improving-critical-infrastructure-cybersecurity-version-11" class="calibre9">https://www.nist.gov/publications/framework-improving-critical-infrastructure-cybersecurity-version-11</a></li>
<li class="calibre11"><strong class="calibre1">Microsoft TechNet Responding to IT Security Incidents</strong>: <a href="https://technet.microsoft.com/en-us/library/cc700825.aspx" class="calibre9">https://technet.microsoft.com/en-us/library/cc700825.aspx</a></li>
<li class="calibre11"><strong class="calibre1">MITRE's Ten Strategies of a World-Class Cybersecurity Operations Center</strong>: <a href="https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf" class="calibre9">https://www.mitre.org/sites/default/files/publications/pr-13-1028-mitre-10-strategies-cyber-ops-center.pdf</a></li>
<li class="calibre11"><strong class="calibre1">Security 101 for SaaS Startup</strong>: <a href="https://github.com/forter/security-101-for-saas-startups/blob/english/security.md" class="calibre9">https://github.com/forter/security-101-for-saas-startups/blob/english/security.md</a></li>
<li class="calibre11"><strong class="calibre1">InfoSec Security Training and Labs Resource</strong>: <a href="https://github.com/onlurking/awesome-infosec" class="calibre9">https://github.com/onlurking/awesome-infosec</a></li>
<li class="calibre11"><strong class="calibre1">vFeed - The Correlated Vulnerability and Threat Intelligence Database Wrapper</strong>: <a href="https://vfeed.io/" class="calibre9">https://github.com/toolswatch/vFeedhttps://vfeed.io/</a></li>
<li class="calibre11"><strong class="calibre1">MITRE ATT&amp;CK</strong><span>:</span> <a href="https://attack.mitre.org/wiki/Main_Page" class="calibre9">https://attack.mitre.org/wiki/Main_Page</a></li>
<li class="calibre11"><strong class="calibre1">Red Team Automation</strong><span>:</span> <a href="https://github.com/endgameinc/RAT" class="calibre9">https://github.com/endgameinc/RAT</a></li>
<li class="calibre11"><strong class="calibre1">Atomic Red Team</strong><span>:</span> <a href="https://github.com/redcanaryco/atomic-red-team" class="calibre9">https://github.com/redcanaryco/atomic-red-team</a></li>
<li class="calibre11"><strong class="calibre1">APT Simulator</strong><span>:</span> <a href="https://github.com/NextronSystems/APTSimulator" class="calibre9">https://github.com/NextronSystems/APTSimulator</a></li>
<li class="calibre11"><strong class="calibre1">Network Flight Simulator</strong><span>:</span> <a href="https://github.com/alphasoc/flightsim" class="calibre9">https://github.com/alphasoc/flightsim</a></li>
<li class="calibre11">
<p class="calibre2"><strong class="calibre4">Awesome Information Security:</strong> <a href="https://github.com/onlurking/awesome-infosec" class="calibre9">https://github.com/onlurking/awesome-infosec</a></p>
</li>
<li class="calibre11">
<p class="calibre2"><strong class="calibre4">NIST SP800-61 Computer Security Incident Handling Guide:</strong> <a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final" class="calibre9">https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final</a></p>
</li>
</ul>


            </article>

            
        </section>
    </body></html>