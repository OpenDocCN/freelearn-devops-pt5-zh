<html><head></head><body>
        

                            
                    <h1 class="header-title">User Management</h1>
                
            
            
                
<p>User management is one of the most tedious, yet important, aspects of any system. It lays the foundation for many other system functions, such as security and notifications.</p>
<p>In this chapter, we will look at the different options available to create user accounts in Jira, and also how to manage users by using groups and project roles. We will also look at how to integrate Jira with external user-management systems, such as <strong>Lightweight Directory Access Protocol</strong> (<strong>LDAP</strong>), for both authentication and user management. Lastly, we will cover how to make Jira participate in various single sign-on environments.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li>Creating and importing multiple users</li>
<li>Enabling public user signup</li>
<li>Managing groups and group memberships</li>
<li>Managing project roles</li>
<li>Managing default project role memberships</li>
<li>Deactivating a user</li>
<li>Integrating and importing users from LDAP</li>
<li>Integrating with LDAP for authentication only</li>
<li>Integrating with Atlassian Crowd</li>
<li>Setting up single sign-on with Crowd</li>
<li>Setting up single sign-on with Google</li>
<li>Setting up Windows domain single sign-on</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating and importing multiple users</h1>
                
            
            
                
<p>As a Jira administrator, it is usually your responsibility to set up accounts for the new user whenever someone new joins the organization. This is usually fine on an ad hoc basis, but from time to time, you might be required to import many users at once. In these cases, you will need some additional tools to help you efficiently enable all these users to access the system without any delay.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, we will need the Jira <strong>command-line interface</strong> (<strong>CLI</strong>). You can retrieve it from <a href="https://marketplace.atlassian.com/plugins/org.swift.jira.cli/cloud/overview" target="_blank">https://marketplace.atlassian.com/plugins/org.swift.jira.cli/cloud/overview</a>.</p>
<p>The CLI app has two components. The first component is an app called CLI Connector that you can install via the <strong>Universal Plugin Manager</strong> (<strong>UPM</strong>) just like any other Jira apps. The second component is the actual CLI Client, which we will use to issue commands to Jira. You can download the latest command-line tool (<kbd>atlassian-cli-8.x.x-distribution.zip</kbd>) from <a href="https://bobswift.atlassian.net/wiki/spaces/info/pages/103022955/Downloads+-+CLI+Clients">https://bobswift.atlassian.net/wiki/spaces/info/pages/103022955/Downloads+-+CLI+Clients</a>.</p>
<p>You will also need to have an administrator account, as user creation is an administrative task.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Before we can start using the command-line client to import users into Jira, we first need to prepare our user data. The easiest way to do this is to create a <strong>comma-separated values</strong> (<strong>CSV</strong>) file containing the following information, in the order specified. You can use a spreadsheet application such as Microsoft Excel to create it:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td><strong>Username</strong></td>
<td><strong>Password</strong></td>
<td><strong>Email</strong></td>
<td><strong>Full name</strong></td>
<td><strong>Group A</strong></td>
</tr>
<tr>
<td><kbd>tester1</kbd></td>
<td><kbd>xxxxx</kbd></td>
<td><kbd>tester1@example.com</kbd></td>
<td><kbd>Test User</kbd></td>
<td><kbd>jira-softwareusers</kbd></td>
</tr>
</tbody>
</table>
<p> </p>
<p>The following list explains each column of the CSV file:</p>
<ul>
<li><strong>Username</strong>: The username of the user; note that usernames in Jira need to be unique.</li>
<li><strong>Password</strong>: The password for the new user. You can leave it blank, and let Jira automatically generate one for you.</li>
<li><strong>Email</strong>: The email address for the new user. Emails can be sent out to the user for him/her to reset the password once the account is created.</li>
<li><strong>Full name</strong>: The full name of the new user.</li>
<li><strong>Group</strong>: Groups to add the new user into. If you want to add the user to multiple groups, put each group into its separate column. Note that the group name you specify must already exist in Jira.</li>
</ul>
<p>Now that you have your data file, go through the following steps to import and create the user accounts in Jira:</p>
<ol>
<li>Unzip the CLI Client into a directory on your computer (for example, <kbd>/opt/cli</kbd>).</li>
<li>Copy the user's CSV file to a directory on your computer (for example, <kbd>/tmp/users.csv</kbd>).</li>
<li>Open a Command Prompt and navigate to the directory that contains the CLI Client—that is, the directory that contains the <kbd>jira.sh </kbd> or <kbd>jira.bat</kbd> file.</li>
<li>Make sure that the <kbd>jira.shfile</kbd> (Linux) or <kbd>jira.bat</kbd> (Windows) file is executable.</li>
<li>Run the following command to import users; make sure you substitute the administrator username and password in your Jira URL:</li>
</ol>
<pre style="padding-left: 60px"><strong>./jira.sh --action addUserWithFile --server
http://localhost:8080 --password &lt;password&gt;
--user &lt;username&gt; --file /tmp/users.csv</strong></pre>
<p>The preceding command assumes you are using Linux. If you are using Windows, use <kbd>jira.bat</kbd> instead.</p>
<p>If everything runs fine, you will see an output similar to the following one on your console:</p>
<div><img src="img/ac30e11e-645d-4b62-9fe7-0247c063c061.png"/></div>
<p>The result of the command, as shown in the preceding output, will show every new user added to Jira as defined in the CSV file. Since we did not specify a password for the <kbd>Tester Four</kbd> user, the user is assigned an autogenerated password. The last line in the output also provides a summary of the number of users added successfully and the number of failed ones, if any.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>The command-line client that we used to run the <kbd>addUserWithFile</kbd> command uses Jira's remote APIs to interact with Jira. Jira exposes many of its core functionalities via these APIs, such as the ability to create new users and issues.</p>
<p>When we run the <kbd>addUserWithFile</kbd> command, we pass in the CSV file that contains our new users, formatted in a way that the command-line client is able to understand and make an API call to Jira to create those users for us.</p>
<p>However, take note that the same security rules apply when using these remote APIs (with or without the command-line client). So in our case, since creating new users is an administrative task, we need to provide an administrator account in the command.</p>
<p>The Jira CLI app can do a lot more than just create users. Simply run <kbd>jira.sh</kbd> or <kbd>jira.bat</kbd> to see a full list of the commands and features it supports. The CLI Connector app installed in Jira provides many more additional remote APIs that will be used by some of the functions in the command-line client.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Enabling public user signup</h1>
                
            
            
                
<p>In the previous recipe, we looked at how to manually create new user accounts and import users from a CSV file. These are the two options that the Jira administrators have when your Jira instance is used internally.</p>
<p>However, if your Jira is set up to be used by the public, such as in a support system, you would want to let your customers freely sign up for a new account, rather than having them wait for the administrator to manually create each account.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to enable public user signup:</p>
<ol>
<li>Navigate to Administration &gt; <strong>System</strong> &gt; <strong>General configuration</strong>.</li>
<li>Click on the <strong>Edit Settings </strong>button.</li>
<li>Set the <strong>Mode </strong>option to <strong>Public</strong> and click on <strong>Update</strong>.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Jira can operate in two modes, public and private. In private mode, only the administrator can create new user accounts. For example, you can use the private mode for Jira instances that are used by internal engineering teams to track their projects.</p>
<p>Public mode allows anyone to sign up for new accounts. The new accounts that are created will have normal user permissions, so they will be able to start using Jira immediately:</p>
<div><img src="img/2f6cb528-d396-4010-ad5a-1d5604446251.png" style="width:28.75em;height:13.33em;"/></div>
<p>As shown in the preceding screenshot, you can sign up for a new account.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>To help prevent spammers, Jira comes with the CAPTCHA challenge response feature to make sure there is a real person signing up for a new account and not an automated bot. To enable the CAPTCHA feature, go through the following steps:</p>
<ol>
<li>Navigate to Administration &gt; System &gt; General configuration.</li>
<li>Click on the Edit Settings<strong> </strong>button.</li>
<li>Set the CAPTCHA on signup<strong> </strong>option to On, and click on Update.</li>
</ol>
<p>Once you have enabled CAPTCHA, the sign-up form will include a string of randomly generated alphanumeric characters that must be typed in correctly for a new account to be generated, as shown in the following screenshot:</p>
<div><img src="img/90238810-51f5-4d5c-ae2a-cb7b8620afb6.png" style="width:29.42em;height:26.08em;"/></div>
<p>An example of CAPTCHA is shown in the preceding screenshot.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Managing groups and group memberships</h1>
                
            
            
                
<p>In any information system, a common way of managing users is through the use of groups. Groups are based on positions and responsibilities within an organization; however, it is important to note that groups simply represent a collection of users. In Jira, groups provide an effective way to apply configuration settings, such as permissions and notifications, to users.</p>
<p>Groups are global in Jira—if you belong to the <kbd>jira-administrators</kbd> group, you will always be in that group regardless of the project you are accessing.</p>
<p>In this recipe, we will look at how to create a new group and add users to it.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to create a new group:</p>
<ol>
<li>Navigate to Administration &gt; User management &gt; Groups.</li>
<li>Enter the new group's name under the Add group<strong> </strong>section.</li>
<li>Click on the <strong>Add group </strong>button.</li>
</ol>
<p>Go through the following steps to add users to a group:</p>
<ol start="1">
<li>Navigate to Administration &gt; User management &gt; Groups.</li>
<li>Click on the Edit members<strong> </strong>link for the group you want to manage.</li>
<li>Type in the usernames for the users you want to add to the group. You can click on the select user icon and use the user picker to find your users.</li>
<li>Click on the Add selected users button to add users to the group, as shown in the following screenshot:</li>
</ol>
<div><img src="img/98162540-cebf-4a6e-a21e-6707638abab5.png" style="width:47.67em;height:26.33em;"/></div>
<p>This allows you to manage users in your group.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There's more...</h1>
                
            
            
                
<p>By editing the group's membership directly, you can add and remove multiple users to and from a group in one go; however, sometimes you only need to update a single user's group membership; in these cases, you might find it easier to manage this edit option via the user's group membership interface. Go through the following steps to edit user groups:</p>
<ol>
<li>Navigate to Administration &gt; User management &gt; Users.</li>
<li>Select the Edit user groups option from the menu for the user you want to manage.</li>
<li>Enter the name of the group you want to add the user to. Jira provides a type-ahead feature to help you find the group you want.</li>
<li>Click on the Join selected groups<strong> </strong>button to add users to the group, as shown in the following screenshot:</li>
</ol>
<div><img src="img/611b4ee2-d5b7-4253-aa42-2905f57ff569.png" style="width:14.83em;height:20.17em;"/></div>
<p>Now we have added our users to a group.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Managing project roles</h1>
                
            
            
                
<p>Using groups is the default method of managing multiple users in Jira; however, there are some limitations with using groups. The first limitation is that groups are global in Jira. This means that if a user is in a group, then that user is included in all projects in that group.</p>
<p>In real life, this is often not the case—for example, suppose a user is a manager in a project. He/she may not be a manager in a different project. This becomes a problem when it comes to configuring permissions and notifications.</p>
<p>The second limitation is that group memberships are controlled by the Jira administrator or central IT administrator if using LDAP. This means that using groups alone to control access to the project means that it is not managed by the project owners, and can result in a bottleneck.</p>
<p>So, to address these limitations, Jira provides us with project roles. Project roles are similar to groups; the only difference is that the membership of a project role is defined at the project level.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Jira comes with three project roles out of the box—Administrator, Developer, and User. We will first look at how to create a new project role.</p>
<p>Go through the following steps to create a new project role:</p>
<ol>
<li>Navigate to Administration &gt; System &gt; Project roles.</li>
<li>Enter the new project role's name and description.</li>
<li>Click on the <strong>Add Project Role </strong>button:</li>
</ol>
<div><img src="img/c77bfe3e-6bc0-4533-8546-23b77194daad.png" style="width:43.08em;height:22.00em;"/></div>
<p>Just like groups, project roles themselves are global in Jira, but their memberships are local to each project.</p>
<p>Once the project role has been created, we can start adding users and groups to the relevant role for each project. To add a new user and/or group to a project role, go through the following steps:</p>
<ol>
<li>Navigate to the target project.</li>
<li>Click on the <strong>Administration </strong>tab and select <strong>Users and roles</strong>.</li>
<li>Click the Add users to a role button.</li>
<li>Select the user and/or group, select the project role, and click on <strong>Add</strong>,<strong> </strong>as shown in the following screenshot:</li>
</ol>
<div><img src="img/628e1a17-634b-4de1-af4d-5272ffb08f9f.png" style="width:49.08em;height:27.75em;"/></div>
<p>This will help you manage your project roles.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Managing default project role memberships</h1>
                
            
            
                
<p>Project role memberships are defined per project; however, there are cases where certain users or groups need to be members of a given project role by default. In fact, Jira has the following default members out of the box:</p>
<ul>
<li><strong>Administrators</strong>: All members of the <kbd>jira-administrators</kbd> group</li>
<li><strong>Developers</strong>: All members of the <kbd>jira-developers</kbd> group</li>
</ul>
<p>With these default members, users are automatically added to the project role when a new project is created; this greatly reduces the amount of manual work required from a Jira administrator.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to define the default membership for project roles:</p>
<ol>
<li>Navigate to Administration &gt; System &gt; Project roles.</li>
<li>Click on the Manage Default Members<strong> </strong>link for the project role you want to configure.</li>
<li>Click on the <strong>Edit </strong>link of the <strong>Default Users</strong> column to add users to the project role.</li>
<li>Click on the <strong>Edit </strong>link of the <strong>Default Groups</strong> column to add groups to the project role, as shown in the following screenshot:</li>
</ol>
<div><img src="img/f0ac8357-73f7-4ffb-8df3-7bec458e152c.png" style="width:49.58em;height:13.92em;"/></div>
<p>This screenshot shows how to add groups to the project role.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>Once you have assigned users and groups as the default members of a project role, any newly created project will have those users and groups added to the role. A good practice is to use groups for the default project role membership, as a user's role and responsibilities are likely to change over time.</p>
<p>It is important to note that changes to the default membership will <em>not</em> be retroactively applied to existing projects.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Deactivating a user</h1>
                
            
            
                
<p>Once a user has created an issue or comment, Jira will not allow you to delete the user. In fact, deactivating a user is usually a better approach than deleting the user completely. Once the user is deactivated, the user cannot log in to Jira, and this will not count toward your license count.</p>
<p>You cannot deactivate a user when you are using external user-management systems, such as LDAP or Crowd from Jira—you need to do so from the user-management system of the source.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to deactivate a user:</p>
<ol>
<li>Navigate to Administration &gt; User management &gt; Users.</li>
<li>Click on the Edit link for the user that is to be deactivated.</li>
<li>Uncheck the Active option.</li>
<li>Click on the Update button to deactivate the user.</li>
</ol>
<p>Deactivated users will not be able to log in to Jira, and will have the Inactive option displayed next to their name.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Integrating and importing users from LDAP</h1>
                
            
            
                
<p>By default, Jira manages its users and groups internally. Most organizations today often use LDAP, such as Microsoft <strong>Active Directory</strong> (<strong>AD</strong>), for centralized user management, and you can integrate Jira with LDAP. Jira supports many different types of LDAP, including AD (<a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview</a>), OpenLDAP (<a href="https://www.openldap.org">https://www.openldap.org</a>), and more.</p>
<p>There are two options for integrating Jira with LDAP. In this recipe, we will explore the first option by using an <strong>LDAP connector</strong>, which will periodically synchronize users, their details, and group memberships between Jira and LDAP. We will look at the second option in the next recipe, <em>Integrating with LDAP for authentication only</em>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, you will need to have an LDAP server up and running. You need to make sure that the Jira server is able to access the LDAP server and that there are no network or access issues. For example, you need to make sure that LDAP connectivity is not blocked by firewalls. At a minimum, you will also need to have the following information:</p>
<ul>
<li>The hostname and port number of the LDAP server.</li>
<li>The base <strong>Distinguished Name</strong> (<strong>DN</strong>) to search for users and groups.</li>
<li>The credentials to access the LDAP server. If you want Jira to be able to make changes to LDAP, make sure that the credentials have write permissions.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to integrate Jira with an LDAP server:</p>
<ol>
<li>Navigate to Administration &gt; User management &gt; User Directories.</li>
<li>Click on the <strong>Add Directory </strong>button and select either Microsoft Active Directory or LDAP for non-AD directories.</li>
<li>Enter the LDAP server, schema, and permission settings. Refer to the following table for more details.</li>
<li>Click on the <strong>Quick Test </strong>button to validate Jira's connectivity to LDAP.</li>
<li>Click on the <strong>Save and Test </strong>button if there are no issues with connecting to LDAP.</li>
</ol>
<ol start="6">
<li>Type in a username and password to run a quick test. While doing this, make sure that Jira is able to connect to LDAP, to find the user and retrieve the user's group information, and to authenticate against LDAP.</li>
</ol>
<p>The following tables list all the configuration parameters for configuring LDAP. Each table includes the parameters for each section on the configuration page. Let's have a look at the following table:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td><strong>Server settings</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>Name</td>
<td>This is an identifier for the LDAP server.</td>
</tr>
<tr>
<td>Directory Type</td>
<td>This selects the type of the LDAP server—for example, Microsoft Active Directory. Jira automatically fills in the user and group schema details based on the type selected.</td>
</tr>
<tr>
<td>Hostname</td>
<td>This is the host of the LDAP server is hosted.</td>
</tr>
<tr>
<td>Port</td>
<td>This is the port that the LDAP server listens to for incoming connections.</td>
</tr>
<tr>
<td>Use SSL</td>
<td>This checks whether SSL is being used on LDAP.</td>
</tr>
<tr>
<td>Username</td>
<td>This is the user account that Jira uses to access LDAP. This should be a dedicated account for Jira.</td>
</tr>
<tr>
<td>Password</td>
<td>This is the password for the account.</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The following table lists LDAP schema parameters and their descriptions:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr style="height: 32px">
<td style="height: 32px"><strong>LDAP schema</strong></td>
<td style="height: 32px"><strong>Description</strong></td>
</tr>
<tr style="height: 34.6406px">
<td style="height: 34.6406px">Base DN</td>
<td style="height: 34.6406px">This is the root node where Jira starts the search for users and groups.</td>
</tr>
<tr style="height: 33px">
<td style="height: 33px">Additional User DN</td>
<td style="height: 33px">This is the additional DN to further restrict a user search.</td>
</tr>
<tr style="height: 33px">
<td style="height: 33px">Additional Group DN</td>
<td style="height: 33px">This is the additional DN to further restrict a group search.</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The following table lists LDAP permissions and their descriptions:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td><strong>LDAP permission</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>Read Only</td>
<td>Select this option if you do not want Jira to make any changes to LDAP. This is the ideal option if everything, including the user's group memberships, is managed with LDAP.</td>
</tr>
<tr>
<td>Read Only, with Local Groups</td>
<td>This option is similar to the Read Only option but lets you manage group memberships locally within Jira. With this option, the group membership changes you make will remain in Jira only. This is the ideal option when you only need user information from LDAP and want to manage Jira-related groups locally.</td>
</tr>
<tr>
<td>Read/Write</td>
<td>Select this option if you want Jira to be able to make direct changes to LDAP, assuming that Jira's LDAP account has the write permission as well.</td>
</tr>
</tbody>
</table>
<p>The following screenshot shows how to test the settings:</p>
<div><img src="img/df2e9c18-8d8b-403a-96de-508acc8cc889.png" style="width:43.33em;height:41.33em;"/></div>
<p>After you have added your LDAP server as a user directory, Jira will automatically start synchronizing its user and group data. Depending on the size of your LDAP, it may take a few minutes to complete the initial synchronization. You can click on Back to directory list to go to the directory list link and see the status of the synchronization process.</p>
<p>Once the process is completed, you will be able to see all your LDAP users and groups and use your LDAP credentials to access Jira.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>What we have just created in this recipe is called a connector. With a connector, Jira first pulls user and group information from LDAP and then creates a local copy. It then periodically synchronizes any deltas.</p>
<p>All authentication will be delegated to LDAP. So, if a user's password is updated in LDAP, it will be immediately reflected when the user attempts to log in to Jira. It is important to note that, with LDAP, users must still be in the necessary groups (for example, <kbd>jira-users</kbd>, by default) in order to access Jira, so you need to make sure that you either create a group called <kbd>jira-users</kbd> in LDAP and add everyone to it or grant the application access to LDAP groups, such as a group called <kbd>all-employees</kbd>.</p>
<p>Also, note that only users who have access to Jira will count toward your license count. This includes users in groups that have been granted application access to Jira.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">See also</h1>
                
            
            
                
<p>If you have a large user base in LDAP, and you only want to use LDAP for authentication, you may want to refer to the next recipe, <em>Integrating with LDAP for authentication only</em>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Integrating with LDAP for authentication only</h1>
                
            
            
                
<p>Sometimes, you might need LDAP only for authentication, and want to keep the group membership separate from LDAP for easy management. In this recipe, we will look at how to integrate Jira with LDAP only for authentication.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, you will need to have an LDAP server up and running. You need to make sure that the Jira server is able to access the LDAP server. For more details, refer to the previous recipe, <em>Integrating and importing users from LDAP</em>.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to integrate Jira with an LDAP server exclusively for authentication:</p>
<ol>
<li>Navigate to Administration &gt; User management &gt; User Directories.</li>
<li>Click on the Add Directory<strong> </strong>button and select the Internal with LDAP Authentication option.</li>
<li>Enter the LDAP server and schema settings. Most of the parameters are identical to those you use when creating a normal LDAP connection, with a few exceptions. Refer to the following table for details.</li>
<li>Click on the Quick Test<strong> </strong>button to validate Jira connectivity to LDAP.</li>
<li>Click on the Save and Test button if there are no issues connecting to LDAP.</li>
</ol>
<p>The following table lists configuration parameters that are specific for the Internal with LDAP Authentication option:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td><strong>Server settings</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>Copy User on Login</td>
<td>This automatically copies the user from LDAP into Jira when the user first successfully logs in to Jira.</td>
</tr>
<tr>
<td>Default Group Membership</td>
<td>This automatically adds the user into the groups specified here when the user first successfully logs in to Jira. This setting is not retrospectively applied to existing users. This is a useful feature to ensure that every user who can log in to Jira will be added to the necessary groups, such as <kbd>jira-users</kbd>.</td>
</tr>
<tr>
<td>Synchronize Group Memberships</td>
<td>This automatically copies the user's group membership to Jira when the user successfully logs in.</td>
</tr>
</tbody>
</table>


            

            
        
    

        

                            
                    <h1 class="header-title">How it works...</h1>
                
            
            
                
<p>This authentication option is similar to the previous recipe, but with a number of key differences:</p>
<ul>
<li>LDAP is only used for authentication</li>
<li>Jira does not periodically synchronize the user and group information from LDAP after the initial user login</li>
<li>Jira has read-only access to LDAP</li>
<li>Group membership is managed inside Jira</li>
</ul>
<p class="mce-root"/>
<p>With this setup, every time a user first successfully logs in to Jira, the user is copied from LDAP to Jira's local user repository, along with the group membership (if configured to do so). Since LDAP is only used at authentication time, with no initial overhead of synchronizing all the user information, this option can provide better performance for organizations that need to synchronize a large user base in LDAP.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Integrating with Atlassian Crowd</h1>
                
            
            
                
<p>In the previous recipe, <em>Integrating with LDAP for authentication only</em>, we looked at how to integrate Jira with an LDAP server for user and group information. Besides using LDAP, another popular option is to use <strong>Crowd</strong>, which is available at <a href="https://www.atlassian.com/software/crowd/overview" target="_blank">https://www.atlassian.com/software/crowd/overview</a>.</p>
<p>Crowd is a user-identity-management solution from Atlassian, and Jira supports Crowd integration out of the box. With Crowd, you can also set up a single sign-on option with other Crowd-enabled applications.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, you will need to have a Crowd server up and running. You need to make sure that the Jira server is able to access the Crowd server without any glitches—for example, you need to make sure that it is not blocked by firewalls.</p>
<p>At a minimum, you will also need to have the following information:</p>
<ul>
<li>The Crowd server URL</li>
<li>Credentials for the registered application in Crowd for Jira</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to integrate Jira with Crowd for user management:</p>
<ol>
<li>Navigate to Administration &gt; User management &gt; User Directories.</li>
<li>Click on the Add Directory<strong> </strong>button and select the Atlassian Crowd option.</li>
<li>Enter the Crowd server settings. Refer to the following table for details.</li>
<li>Click on the Test Settings button to validate Jira's connectivity with Crowd.</li>
<li>Click on the Save and Test<strong> </strong>button if there are no issues connecting with Crowd.</li>
</ol>
<p>The following tables list configuration parameters for setting up integration with Crowd:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td><strong>Server settings</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>Name</td>
<td>This is an identifier for the Crowd server.</td>
</tr>
<tr>
<td>Server URL</td>
<td>This is the Crowd's server URL.</td>
</tr>
<tr>
<td>Application Name</td>
<td>This is the registered application name for Jira inside Crowd.</td>
</tr>
<tr>
<td>Application Password</td>
<td>This is the password for the registered application.</td>
</tr>
<tr>
<td>Crowd Permissions</td>
<td>This is the column header.</td>
</tr>
<tr>
<td>Read Only</td>
<td>Select this option if you do not want Jira to make any changes to Crowd. This is the ideal option if everything, including the user's group membership, is managed with Crowd.</td>
</tr>
<tr>
<td>Read/Write</td>
<td>Select this option to let Jira synchronize any changes back to Crowd.</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The advanced settings are listed in the following table:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td><strong>Advanced settings</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>Enable Nested Groups</td>
<td>This allows groups to contain other groups as members.</td>
</tr>
<tr>
<td>Enable Incremental Synchronization</td>
<td>This will only synchronize deltas. Enabling this option can help improve performance.</td>
</tr>
<tr>
<td>Synchronization Interval</td>
<td>This determines how often (in minutes) Jira should synchronize with Crowd for changes. Shorter intervals may cause performance issues.</td>
</tr>
</tbody>
</table>


            

            
        
    

        

                            
                    <h1 class="header-title">See also</h1>
                
            
            
                
<p>Refer to the <em>Setting up a single sign-on with Crowd</em> recipe to learn how to take advantage of Crowd's single sign-on capability with Jira and other Crowd-enabled applications.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up a single sign-on functionality with Crowd</h1>
                
            
            
                
<p>In previous recipes, we have looked at the different options available for Jira to use external centralized user repositories, including Crowd. One of the advantages of integrating Jira with Crowd is its <strong>single sign-on</strong> (<strong>SSO</strong>) abilities.</p>
<p>Web-based applications integrated with Crowd are able to participate in an SSO environment, so when a user is logged in to one application, he/she will be automatically logged in to all other applications.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>If you are looking for single sign-on functionalities in a Windows environment, where users will be automatically logged on to applications with their workstation, read the next recipe, <em>Setting up a Windows domain single sign-on</em>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>Before you can set up SSO with Crowd, you first need to integrate Jira with Crowd for user management. Refer to the <em>Integrating with Atlassian Crowd</em> recipe for details.</p>
<p>If you have already integrated Jira with Crowd, you will need to have the following information:</p>
<ul>
<li>The application name assigned to Jira in Crowd</li>
<li>The password for Jira to access Crowd</li>
<li>A copy of the <kbd>crowd.properties</kbd> file from the <kbd>CROWD_INSTALL/client/conf</kbd> directory</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Go through the following steps to enable SSO with Crowd:</p>
<ol>
<li>Shut down Jira if it is running.</li>
<li>Open the <kbd>seraph-config.xml</kbd> file located in the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes</kbd> directory in a text editor.</li>
<li>Locate the line that contains <kbd>com.atlassian.jira.security.login.JiraSeraphAuthenticator</kbd>. Comment it out so that it looks like the following:</li>
</ol>
<pre style="padding-left: 60px">&lt;!--
&lt;authenticator  class="com.atlassian.jira
.security.login.JiraSeraphAuthenticator"/&gt;
--&gt;</pre>
<ol start="4">
<li>Locate the line that contains <kbd>com.atlassian.jira.security.login.SSOSeraphAuthenticator</kbd>. Uncomment it so that it looks like the following:</li>
</ol>
<pre style="padding-left: 60px">&lt;authenticator class="com.atlassian.jira
.security.login.SSOSeraphAuthenticator"/&gt;</pre>
<ol start="5">
<li>Copy the <kbd>crowd.properties</kbd> file to the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes</kbd> directory.</li>
<li>Open <kbd>crowd.properties</kbd> in a text editor and update the properties listed in the following table.</li>
<li>Start up Jira again.</li>
</ol>
<p>The following table lists the configuration parameters from the <kbd>crowd.properties</kbd> file:</p>
<table border="1" style="border-collapse: collapse;width: 100%">
<tbody>
<tr>
<td><strong>Parameter</strong></td>
<td><strong>Value</strong></td>
</tr>
<tr>
<td><kbd>application.name</kbd></td>
<td>This is the application name configured in Crowd for Jira.</td>
</tr>
<tr>
<td><kbd>application.password</kbd></td>
<td>This is the password for the application.</td>
</tr>
<tr>
<td><kbd>application.login.url</kbd></td>
<td>This is Jira's base URL (you can get this from Jira's general configurations).</td>
</tr>
<tr>
<td><kbd>crowd.base.url</kbd></td>
<td>This is Crowd's base URL.</td>
</tr>
<tr>
<td><kbd>session.validationinterval</kbd></td>
<td>This is the duration (in minutes) that a Crowd SSO session will remain valid. Setting this to <kbd>0</kbd> will invalidate the session immediately, and will have a performance penalty. It is recommended that you set this at a higher value.</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Once Jira has started up again, it will participate in SSO sessions in all Crowd SSO-enabled applications—for example, if you have multiple Jira instances integrated with Crowd for SSO, you will only need to log in to one of Jira's.</p>
<p>Make sure you also have a backup copy of the file before you make any changes.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up a single sign-on with Google</h1>
                
            
            
                
<p>If your organization uses Google to manage user details, or you simply want to allow people with valid Google accounts to be able to log into your Jira instance (especially if it is a public instance), you can integrate Jira with Google so that users can log into Jira with their Google account details with a single click.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, we will need the Jira CLI. You can get it at <a href="https://docs.appfusions.com/display/GAPPSAUTHJ/Downloads+and+Notes">https://docs.appfusions.com/display/GAPPSAUTHJ/Downloads+and+Notes</a>.</p>
<p class="mce-root"/>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>The first step to set up SSO with Google is to create a set of Google API credentials by going through the following steps:</p>
<ol>
<li>Browse to Google API Console at <a href="https://console.developers.google.com/apis/credentials">https://console.developers.google.com/apis/credentials</a>.</li>
<li>Click on the Create credentials drop-down menu.</li>
<li>Select OAuth client ID and then Web application.</li>
<li>Enter a name for the API credential and your Jira's URL for authorized JavaScript origins.</li>
<li>Create the new API credential and note down the Client ID and Client Secret: we will need them both later.</li>
</ol>
<p>With the Google API credentials created, we can configure the SSO integration:</p>
<ol>
<li>Navigate to Administration &gt; Manage apps &gt; Google SSO.</li>
<li>Click on the Edit this configuration… link at the bottom of the page.</li>
<li>Enter the Client ID and Client Secret from earlier.</li>
<li>Select where you would like the Google sign-in button to appear on the login page.</li>
<li>Click on Save to apply the changes:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="img/af9f4404-e758-4c22-8870-7f951569c160.png" style="width:33.67em;height:23.92em;"/></p>
<p>Since we will be logging into Jira via Google, it is recommended that you disable web <kbd>sudo</kbd>, as Jira does not know the Google user account's password.</p>
<p>Once you have configured Jira with Google API credentials, a new Sign in with Google button will be displayed on Jira's login page, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/91619fbb-cae4-4df9-8e65-3b880010c463.png" style="width:32.50em;height:20.42em;"/></p>
<p class="mce-root">Clicking on that will take you to Google's login page if you are not already logged into Google, or pass you straight through if you are already logged into Google. Now you are ready to log into Jira.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Setting up a Windows domain single sign-on</h1>
                
            
            
                
<p>If your organization is running a Windows domain, you can configure Jira so that users are automatically logged in when they log in to the domain with their workstations.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>For this recipe, we will need the Kerberos SSO Authenticator for Jira. You can get it at <a href="http://www.appfusions.com/display/KBRSCJ/Home" target="_blank">http://www.appfusions.com/display/KBRSCJ/Home</a>.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>You will also need to have the following set up:</p>
<ul>
<li>A service account in AD for Jira to use</li>
<li>A <strong>service principal name </strong>(<strong>SPN</strong>) for Jira</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<p>Setting up the Windows domain SSO is not a simple task, as it involves many aspects of your network configuration. It is highly recommended that you work with the product vendor and someone who is familiar with your AD environment to ensure a smooth implementation.</p>
<p>Go through the following steps to set up the Windows domain SSO:</p>
<ol>
<li>Shut down Jira if it is running.</li>
<li>Copy <kbd>login.conf</kbd>, <kbd>krb5.conf</kbd>, and <kbd>spnego-exclusion.properties</kbd> to the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes</kbd> directory.</li>
<li>Copy <kbd>appfusions-jira-seraph-4.0.0.jar</kbd> and <kbd>appfusions-spnego-r7_3.jar</kbd> to the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/lib</kbd> directory.</li>
<li>Open the <kbd>web.xml</kbd> file located in the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF</kbd> directory in a text editor.</li>
<li>Add the following XML snippet before the <kbd>THIS MUST BE THE LAST FILTER IN THE DEFINED CHAIN</kbd> entry. Make sure you update the values for the following parameters:
<ul>
<li>For <kbd>spnego.krb5.conf</kbd>, use the full path to the <kbd>spnego.krb5.conf</kbd> file.</li>
<li>For <kbd>spnego.login.conf</kbd>, use the full path to the <kbd>spnego.login.conf</kbd> file.</li>
<li>For <kbd>spnego.preauth.username</kbd>, use the username of the service account.</li>
<li>For <kbd>spnego.preauth.password</kbd>, use the password of the service account:</li>
</ul>
</li>
</ol>
<pre style="padding-left: 120px">&lt;filter&gt;
 &lt;filter-name&gt;SpnegoHttpFilter&lt;/filter-name&gt;

 &lt;filter-class&gt;net.sourceforge.spnego
 .SpnegoHttpFilter&lt;/filter-class&gt;

 &lt;init-param&gt;

 &lt;param-name&gt;spnego.allow.basic&lt;/param-name&gt;

  &lt;param-value&gt;true&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.allow.localhost
  &lt;/param-name&gt;

  &lt;param-value&gt;true&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.allow.unsecure.basic
  &lt;/param-name&gt;

  &lt;param-value&gt;true&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.login.client.module
  &lt;/param-name&gt;

  &lt;param-value&gt;spnego-client&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.krb5.conf&lt;/param-name&gt;

  &lt;param-value&gt;FULL_PATH/krb5.conf
  &lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.login.conf&lt;/param-name&gt;

  &lt;param-value&gt;FULL_PATH/login.conf
  &lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.preauth.username
  &lt;/param-name&gt;

  &lt;param-value&gt;SPN_USERNAME&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.preauth.password
  &lt;/param-name&gt;

  &lt;param-value&gt;SPN_PASSWORD&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.login.server.module
  &lt;/param-name&gt;

  &lt;param-value&gt;spnego-server&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.prompt.ntlm&lt;/param-name&gt;

  &lt;param-value&gt;true&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.logger.level&lt;/param-name&gt;

  &lt;param-value&gt;1&lt;/param-value&gt;

 &lt;/init-param&gt;

 &lt;init-param&gt;

  &lt;param-name&gt;spnego.skip.client.internet
  &lt;/param-name&gt;

  &lt;param-value&gt;false&lt;/param-value&gt;

 &lt;/init-param&gt;

&lt;/filter&gt;</pre>
<ol start="6">
<li>Add the following XML snippet before the <kbd>login</kbd> entry:</li>
</ol>
<pre style="padding-left: 60px">&lt;filter-mapping&gt;
&lt;filter-name&gt;SpnegoHttpFilter&lt;/filter-name&gt;
&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;</pre>
<ol start="7">
<li>Open the <kbd>seraph-config.xml</kbd> file located in the <kbd>JIRA_INSTALL/atlassian-jira/WEB-INF/classes</kbd> directory in a text editor.</li>
<li>Locate the line that contains <kbd>com.atlassian.jira.security.login.JiraSeraphAuthenticator</kbd>. Comment it out so that it looks like the following:</li>
</ol>
<pre style="padding-left: 60px">&lt;!--
&lt;authenticator class=
"com.atlassian.jira.security
.login.JiraSeraphAuthenticator"/&gt;
--&gt;</pre>
<ol start="9">
<li>Add the following XML snippet under the line that's been commented out:</li>
</ol>
<pre style="padding-left: 60px">&lt;authenticator
class="com.appfusions.jira.SeraphAuthenticator"
/&gt;</pre>
<ol start="10">
<li>Restart Jira.</li>
<li>Add your Jira's URL to the local intranet zone in your browser.</li>
</ol>
<p>Once Jira is restarted, you should be automatically logged in every time you log into the Windows domain. Make sure you also have a backup copy of the file before making any changes.</p>


            

            
        
    </body></html>