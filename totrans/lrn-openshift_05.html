<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Building an OpenShift Lab</h1>
                
            
            <article>
                
<p class="calibre2">In the previous chapter, we briefly discussed the differences between IaaS and PaaS solutions. We also discussed OpenShift as a part of the PaaS solution. We provided a <span class="calibre11">basic explanation of OpenShift's business value and the main OpenShift components.</span></p>
<p class="calibre2">Some OpenShift users don't want to spend time deploying and configuring the OpenShift development or evaluation environment. However, they may need the environment to perform day to day operations. In this chapter, we are going to show you how to quickly set up a ready-to-use development environment on most popular desktop operating systems, using the most popular approaches.</p>
<p class="calibre2">We will cover the following topics in this chapter:</p>
<ul class="calibre9">
<li class="calibre10"><span>Why use a development environment?</span></li>
<li class="calibre10">Deployment variants</li>
<li class="calibre10">Working with oc cluster up</li>
<li class="calibre10">Working with Minishift</li>
<li class="calibre10">Working with Vagrant</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Technical requirements</h1>
                
            
            <article>
                
<p class="calibre2">To successfully perform the labs in this chapter, you will need the following:</p>
<ul class="calibre9">
<li class="calibre10">One of the following desktop operating systems:
<ul class="calibre29">
<li class="calibre10">macOS</li>
<li class="calibre10">Linux (CentOS 7)</li>
<li class="calibre10">Windows</li>
</ul>
</li>
<li class="calibre10">Bash for Linux or macOS</li>
<li class="calibre10">Brew package manager for macOS</li>
<li class="calibre10">VirtualBox</li>
</ul>
<ul class="calibre9">
<li class="calibre10">Virtualization support</li>
<li class="calibre10">Docker for macOS/Linux/Windows</li>
<li class="calibre10">The OpenShift client utility</li>
</ul>
<p class="calibre2">You will also be asked to download and install some dependencies and binaries.</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Why use a development environment?</h1>
                
            
            <article>
                
<p class="calibre2">As we mentioned in the previous chapter, OpenShift is an application delivery platform that can simplify day to day duties for infrastructure engineers and development teams. If a company's software delivery strategy is aligned with containers, OpenShift can significantly help to reduce production time.</p>
<p class="calibre2">Every platform has a community. It is an ecosystem around the platform that helps to improve the platform's functionality, aligns the platform with end user needs, and so on. OpenShift has a community that includes some important members that use the platform: software developers, QA specialists, system administrators, IT architects, and so on. It is very important for OpenShift to extend its community and involve new team members and customers. <span class="calibre11">To achieve this, all team members should have access to the</span> OpenShift <span class="calibre11">environment; depending on their roles, specialists will perform software development, testing, and software delivery. Not every software developer or QA team member will be able to set OpenShift up from scratch, and that is the main reason they seek an easy way to start working with OpenShift.</span></p>
<p class="calibre2">The OpenShift development environment can be created easily and doesn't require significant effort. Usually, this environment is located on a local PC and doesn't have a large capacity.</p>
<p class="calibre2">There are a number of benefits in having an easy-to-use development environment:</p>
<ul class="calibre9">
<li class="calibre10"><strong class="calibre1">OpenShift evaluation</strong>: Sometimes, users want to understand how OpenShift is aligned with their needs. They may have no experience with OpenShift, and may want to touch it on a real system. For most technical people, marketing presentations/demonstrations don't mean anything. A fast and easy deployment process for the development environment can help.</li>
<li class="calibre10"><strong class="calibre1">A quick environment for developers/QAs</strong>: Developers usually don't want to get too involved with deploying an environment. A fast method for deploying OpenShift can save some effort, allowing them to focus on primary activities (such as software development and testing).</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Deployment variants</h1>
                
            
            <article>
                
<p class="calibre2">There are several ways to set up and start a development environment. Usually, the development environment is run on a workstation, and it is important to cover the most popular workstation operating systems. In the next section, we will describe several ways to quickly deploy OpenShift on workstations on different platforms. The most popular desktops are Windows, macOS, and Linux. </p>
<div class="packt_infobox">Please be aware that a development environment is not equal to a production environment, due to capacity, scalability, and security limitations.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Working with oc cluster up</h1>
                
            
            <article>
                
<p class="calibre2">The OpenShift client utility named <kbd class="calibre12">oc</kbd> can start a local OpenShift cluster, which includes all of the required services, such as an internal registry, a router, templates, and so on. This is one of the easiest ways to start a development environment. <kbd class="calibre12">oc cluster up</kbd> creates a default user and project, and once it is complete, it will allow you to use any commands to work with the OpenShift environment, such as <kbd class="calibre12">oc new-app</kbd>.</p>
<div class="packt_infobox">This method provides a containerized OpenShift environment that can easily be run on a number of platforms.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">System requirements and prerequisites</h1>
                
            
            <article>
                
<p class="calibre2">The <kbd class="calibre12">oc cluster up</kbd> method supports Linux, macOS, and Windows-based workstations. By default, the method requires an environment with a Docker machine installed. However, the command can create a Docker machine by itself. The following table shows the available deployment scenarios:</p>
<table border="1" class="calibre22">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre25"><strong class="calibre1">Operating system</strong></td>
<td class="calibre25"><strong class="calibre1">Docker implementation</strong></td>
</tr>
<tr class="calibre24">
<td class="calibre25">Linux</td>
<td class="calibre25">Default docker daemon for OS</td>
</tr>
<tr class="calibre24">
<td class="calibre25">macOS</td>
<td class="calibre25">Docker for macOS</td>
</tr>
<tr class="calibre24">
<td class="calibre25">macOS</td>
<td class="calibre25">Docker Toolbox</td>
</tr>
<tr class="calibre24">
<td class="calibre25">Windows</td>
<td class="calibre25">Docker for Windows</td>
</tr>
<tr class="calibre24">
<td class="calibre25">Windows</td>
<td class="calibre25">Docker Toolbox</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">CentOS 7</h1>
                
            
            <article>
                
<div class="packt_infobox">This method can also be used on Fedora or RHEL based hosts.</div>
<p class="calibre2">The deployment process involves several steps:</p>
<ol class="calibre13">
<li value="1" class="calibre10">Install Docker</li>
<li value="2" class="calibre10">Configure an insecure registry</li>
<li value="3" class="calibre10">Allow ports on the firewall</li>
<li value="4" class="calibre10">Download the OpenShift client utility</li>
<li value="5" class="calibre10">Start a cluster</li>
</ol>
<p class="calibre2">Let's study these steps in detail:</p>
<ol class="calibre13">
<li value="1" class="calibre10"><strong class="calibre1">Docker installation</strong>:<strong class="calibre1"> </strong>This doesn't involve anything special, and was described in previous chapters. The following commands must be run under the root account:</li>
</ol>
<pre class="calibre30"><strong class="calibre1">$ sudo -i</strong><br class="title-page-name"/><strong class="calibre1"># sudo yum -y install docker</strong><br class="title-page-name"/><strong class="calibre1"># systemctl enable docker</strong></pre>
<ol start="2" class="calibre13">
<li value="2" class="calibre10"><strong class="calibre1">Configuring an insecure registry</strong>:<strong class="calibre1"> </strong>This is required to be able to use an internal Docker registry, which comes with OpenShift installation. If this is not configured, <kbd class="calibre12">oc cluster up</kbd> will fail.</li>
</ol>
<p class="calibre27">To allow for an insecure OpenShift registry, run the following commands under the root user:</p>
<pre class="calibre30"><strong class="calibre1"># cat &lt;&lt; EOF </strong><span><strong class="calibre1">&gt;/etc/docker/daemon.json</strong><br class="title-page-name"/></span>{<br class="title-page-name"/>   "insecure-registries": [<br class="title-page-name"/>     "172.30.0.0/16"<br class="title-page-name"/>   ]<br class="title-page-name"/>}<br class="title-page-name"/>EOF<br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1"># systemctl start docker</strong></pre>
<div class="packt_infobox">This requires restarting the Docker daemon so as to apply the new configuration.</div>
<ol start="3" class="calibre13">
<li value="3" class="calibre10"><strong class="calibre1">Configuring the firewall</strong>: The default firewall configuration doesn't enable all of the ports required for an OpenShift cluster. You need to adjust the settings using <kbd class="calibre12">firewall-cmd</kbd>:</li>
</ol>
<table border="1" class="calibre22">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre25"><strong class="calibre1">Port</strong></td>
<td class="calibre25"><strong class="calibre1">Description</strong></td>
</tr>
<tr class="calibre24">
<td class="calibre25"><kbd class="calibre12">8443</kbd>/<kbd class="calibre12">tcp</kbd></td>
<td class="calibre25"><kbd class="calibre12">API port</kbd></td>
</tr>
<tr class="calibre24">
<td class="calibre25"><kbd class="calibre12">53</kbd>/<kbd class="calibre12">udp</kbd></td>
<td class="calibre25"><kbd class="calibre12">DND</kbd></td>
</tr>
<tr class="calibre24">
<td class="calibre25"><kbd class="calibre12">8053</kbd>/<kbd class="calibre12">udp</kbd></td>
<td class="calibre25"><kbd class="calibre12">Internal DNS</kbd></td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">This can be achieved through the following snippet:</p>
<pre class="calibre19"><strong class="calibre1"># firewall-cmd --permanent --new-zone dockerc</strong><br class="title-page-name"/><strong class="calibre1"># firewall-cmd --permanent --zone dockerc --add-source 172.17.0.0/16</strong><br class="title-page-name"/><strong class="calibre1"># firewall-cmd --permanent --zone dockerc --add-port 8443/tcp</strong><br class="title-page-name"/><strong class="calibre1"># firewall-cmd --permanent --zone dockerc --add-port 53/udp</strong><br class="title-page-name"/><strong class="calibre1"># firewall-cmd --permanent --zone dockerc --add-port 8053/udp</strong><br class="title-page-name"/><strong class="calibre1"># firewall-cmd --reload</strong></pre>
<div class="packt_tip">In most cases, the firewall is not an issue in the development environment, and can be stopped with <kbd class="calibre26">systemctl stop firewalld</kbd> and <kbd class="calibre26">systemctl disable firewalld</kbd>.<br class="title-page-name"/>
<br class="title-page-name"/>
You can determine the network address of Docker by running<br class="title-page-name"/>
<kbd class="calibre26">docker network inspect -f "{{range .IPAM.Config }}{{ .Subnet }}{{end}}" bridge</kbd>.</div>
<ol start="4" class="calibre13">
<li value="4" class="calibre10"><strong class="calibre1">Downloading the</strong> <strong class="calibre1">oc</strong> <strong class="calibre1">utility</strong>:<strong class="calibre1"> </strong>The OpenShift client utility named <kbd class="calibre12">oc</kbd> is available in standard repositories; however, it is possible to download the utility from <a href="https://github.com/openshift/origin/releases" class="calibre8">https://github.com/openshift/origin/releases</a><span>. We would recommend using the standard CentOS repositories:</span></li>
</ol>
<pre class="calibre30"><strong class="calibre1"># yum -y install centos-release-openshift-origin39</strong><br class="title-page-name"/><strong class="calibre1"># yum -y install origin-clients</strong></pre>
<div class="packt_infobox">We omitted the output of the commands. It is expected that these commands will install a number of dependencies.</div>
<ol start="5" class="calibre13">
<li value="5" class="calibre10"><strong class="calibre1">Starting an OpenShift cluster</strong>:<strong class="calibre1"> </strong>Once all of the prerequisites are met, you will be able to start the cluster by running <kbd class="calibre12">oc cluster up</kbd>. The command will download all of the required Docker images from public repositories, and then run all of the required containers:</li>
</ol>
<pre class="calibre30"><strong class="calibre1"># oc cluster up --version=v3.9.0</strong><br class="title-page-name"/>Starting OpenShift using openshift/origin:v3.9.0 ...<br class="title-page-name"/>...<br class="title-page-name"/>output truncated for brevity<br class="title-page-name"/>...<br class="title-page-name"/>OpenShift server started.<br class="title-page-name"/><br class="title-page-name"/>The server is accessible via web console at:<br class="title-page-name"/>    https://127.0.0.1:8443<br class="title-page-name"/><br class="title-page-name"/>You are logged in as:<br class="title-page-name"/>    User: developer<br class="title-page-name"/>    Password: &lt;any value&gt;<br class="title-page-name"/><br class="title-page-name"/>To login as administrator:<br class="title-page-name"/>    oc login -u system:admin</pre>
<div class="packt_infobox">In the preceding example, we statically bound the version of the OpenShift cluster to <kbd class="calibre26">v3.9.0</kbd>. In most cases, you don't have to specify a version. So, you just need <kbd class="calibre26">oc cluster up</kbd> without any arguments.</div>
<p class="calibre27">As you can see, <kbd class="calibre12">oc cluster up</kbd> deployed a ready-to-use, one-node OpenShift environment.</p>
<p class="calibre27">By default, this OpenShift environment was configured to listen on the loopback interface (<kbd class="calibre12">127.0.0.1</kbd>). This means that you may connect to the cluster using <kbd class="calibre12">https://127.0.0.1:8443</kbd>. This behavior can be changed by adding special parameters, such as <kbd class="calibre12">--public-hostname=</kbd>. A full list of available options can be shown by using the following command:</p>
<pre class="calibre30"><strong class="calibre1"># oc cluster up --help</strong></pre>
<ol start="6" class="calibre13">
<li value="6" class="calibre10"><strong class="calibre1">Verification</strong>:<strong class="calibre1"> </strong>Once the cluster has deployed, you can verify that it is ready to use. The default OpenShift configuration points you to an unprivileged user, named <kbd class="calibre12">developer</kbd>. You may raise your permissions by using the following commands:</li>
</ol>
<pre class="calibre30"><strong class="calibre1"># oc login -u system:admin</strong><br class="title-page-name"/>Logged into "https://127.0.0.1:8443" as "system:admin" using existing credentials.<br class="title-page-name"/><br class="title-page-name"/>You have access to the following projects and can switch between them with 'oc project &lt;projectname&gt;':<br class="title-page-name"/><br class="title-page-name"/>    default<br class="title-page-name"/>    kube-public<br class="title-page-name"/>    kube-system<br class="title-page-name"/>  * myproject<br class="title-page-name"/>    openshift<br class="title-page-name"/>    openshift-infra<br class="title-page-name"/>    openshift-node<br class="title-page-name"/><br class="title-page-name"/>Using project "myproject".</pre>
<p class="calibre27">Once you have admin access rights, you can verify the node configuration with <kbd class="calibre12">oc get node</kbd>:</p>
<pre class="calibre30"><strong class="calibre1"># oc get node</strong><br class="title-page-name"/>NAME      STATUS  AGE     VERSION<br class="title-page-name"/>localhost Ready   9m       v1.7.6+a08f5eeb62</pre>
<ol start="7" class="calibre13">
<li value="7" class="calibre10"><strong class="calibre1">Shutting down</strong>:<strong class="calibre1"> </strong>Once an <kbd class="calibre12">oc cluster up</kbd> environment has deployed, it can be shut down with <kbd class="calibre12">oc cluster down</kbd>.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">macOS</h1>
                
            
            <article>
                
<p class="calibre2">The installation and configuration process for macOS is very similar to that for Linux. It assumes that Docker for macOS is being used. The deployment process involves the following:</p>
<ul class="calibre9">
<li class="calibre10">Docker for macOS installation and configuration</li>
<li class="calibre10">Installation of <kbd class="calibre12">openshift-cli</kbd> and required packages</li>
<li class="calibre10">Starting a cluster</li>
</ul>
<div class="packt_infobox">The <kbd class="calibre26">oc cluster up</kbd> command requires Docker to be installed on your system, because essentially, it creates a Docker container and runs OpenShift inside that Docker container. It is a very elegant and clean solution.<br class="title-page-name"/>
<br class="title-page-name"/>
The Docker for macOS installation process is described at the official portal: <a href="https://docs.docker.com/docker-for-mac" class="calibre6">https://docs.docker.com/docker-for-mac</a>.</div>
<p class="calibre2">Once the Docker service is running, you need to configure the insecure registry (<kbd class="calibre12">172.30.0.0/16</kbd>). From the Docker menu in the toolbar, you need to select the <span class="calibre11">Preferences</span> menu and click on the <span class="calibre11">Daemon</span> icon. In the <span class="calibre11">Basic</span> tab of the configuration dialog, click on the <span class="calibre11">+</span> icon under <span class="calibre11">Insecure registries</span> and add the following new entry: <kbd class="calibre12">172.30.0.0/16</kbd>:</p>
<div class="cdpaligncenter2"><img class="alignnone33" src="../images/00038.jpeg"/></div>
<p class="calibre2">When finished, click on <span class="calibre11">Apply &amp; Restart</span>. </p>
<p class="calibre2">Once the Docker service is configured, we need to install all the required software and start the cluster using the following steps:</p>
<ol class="calibre13">
<li value="1" class="calibre10"><strong class="calibre1">OpenShift client installation</strong>: Install the <kbd class="calibre12">socat</kbd> and <kbd class="calibre12">openshift-cli</kbd> packages on your system as follows:</li>
</ol>
<pre class="calibre19"><strong class="calibre1">$ brew install openshift-cli socat --force</strong></pre>
<div class="packt_tip1">If you do not have <kbd class="calibre26">brew</kbd> installed, find the installation process at <a href="https://brew.sh/" class="calibre6">https://brew.sh/</a>.</div>
<ol start="2" class="calibre13">
<li value="2" class="calibre10"><strong class="calibre1">Starting and stopping the OpenShift cluster</strong>:<strong class="calibre1"> </strong>The cluster can be started just like it was in Linux:</li>
</ol>
<pre class="calibre19"><strong class="calibre1">$ oc cluster up</strong><br class="title-page-name"/>Starting OpenShift using registry.access.redhat.com/openshift3/ose:v3.7.23 ...<br class="title-page-name"/>OpenShift server started.<br class="title-page-name"/><br class="title-page-name"/>The server is accessible via web console at:<br class="title-page-name"/>https://127.0.0.1:8443<br class="title-page-name"/><br class="title-page-name"/>You are logged in as:<br class="title-page-name"/>User: developer<br class="title-page-name"/>Password: &lt;any value&gt;<br class="title-page-name"/><br class="title-page-name"/>To login as administrator:<br class="title-page-name"/>oc login -u system:admin</pre>
<div class="packt_infobox">At the time of writing this book, <kbd class="calibre26">oc cluster up</kbd> on macOS didn't work for version 3.9. I would recommend you to temporarily use 3.7 version of the client utility.</div>
<p class="calibre27">An installation verification can be performed by the OpenShift admin user, as follows:</p>
<pre class="calibre19"><strong class="calibre1">$ oc login -u system:admin</strong><br class="title-page-name"/>Logged into "https://127.0.0.1:8443" as "system:admin" using existing credentials.<br class="title-page-name"/><br class="title-page-name"/>You have access to the following projects and can switch between them with 'oc project &lt;projectname&gt;':<br class="title-page-name"/><br class="title-page-name"/>default<br class="title-page-name"/>kube-public<br class="title-page-name"/>kube-system<br class="title-page-name"/>* myproject<br class="title-page-name"/>openshift<br class="title-page-name"/>openshift-infra<br class="title-page-name"/>openshift-node<br class="title-page-name"/><br class="title-page-name"/>Using project "myproject".</pre>
<p class="calibre27">The Openshift cluster is up and ready for work. We may check the status of the cluster using the following command:</p>
<pre class="calibre19"><strong class="calibre1">$ oc get nodes</strong><br class="title-page-name"/>NAME      STATUS AGE VERSION<br class="title-page-name"/>localhost Ready 20h  v1.7.6+a08f5eeb62</pre>
<p class="calibre27">The cluster can be stopped as follows:</p>
<pre class="calibre19"><strong class="calibre1">$ oc cluster down</strong></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Windows</h1>
                
            
            <article>
                
<p class="calibre2">The OpenShift environment can be deployed on Windows on a machine that supports Docker for Windows.</p>
<ul class="calibre9">
<li class="calibre10"><strong class="calibre1">Docker for Windows installation and configuration</strong>:</li>
</ul>
<div class="packt_infobox">The Docker for Windows installation process is described at <a href="https://docs.docker.com/docker-for-windows" class="calibre6">https://docs.docker.com/docker-for-windows</a>.</div>
<p class="calibre2">Once Docker is running, you will need to configure the insecure registry settings, as follows:</p>
<ol class="calibre13">
<li value="1" class="calibre10">Right-click on the <span>Docker</span> icon in the notification area, and select <span>Settings</span>.</li>
<li value="2" class="calibre10">Click on <span>Docker Daemon</span> in the <span>Settings</span> dialog. </li>
</ol>
<ol start="3" class="calibre13">
<li value="3" class="calibre10">Edit the Docker daemon configuration by adding <kbd class="calibre12">172.30.0.0/16</kbd> to the <kbd class="calibre12">"insecure-registries":</kbd> setting:</li>
</ol>
<pre class="calibre19">{<br class="title-page-name"/>"registry-mirrors": [],<br class="title-page-name"/>"insecure-registries": [ "172.30.0.0/16" ]<br class="title-page-name"/>}</pre>
<ol start="4" class="calibre13">
<li value="4" class="calibre10">Click on <span>Apply</span>, and Docker will restart.</li>
</ol>
<p class="calibre2">Once Docker service is configured, the OpenShift client <kbd class="calibre12">oc</kbd> can be installed as shown below. The example also shows how to start the cluster:</p>
<ul class="calibre9">
<li class="calibre10"><strong class="calibre1">OpenShift client installation</strong>:<strong class="calibre1"> </strong>Download the Windows <kbd class="calibre12">oc.exe</kbd> binary from <a href="https://github.com/openshift/origin/releases/download/v3.7.1/openshift-origin-client-tools-v3.7.1-ab0f056-mac.zip" class="calibre8">https://github.com/openshift/origin/releases/download/v3.7.1/openshift-origin-client-tools-v3.7.1-ab0f056-mac.zip</a>,<a href="https://github.com/openshift/origin/releases/download/v3.7.1/openshift-origin-client-tools-v3.7.1-ab0f056-mac.zip" class="calibre8"><span> </span></a><span>and place it in</span> <span><kbd class="calibre12"><span>C:\Windows\system32</span></kbd></span><span> or another path </span><span>folder.</span></li>
</ul>
<p class="calibre27">You can also download the latest code from <a href="https://github.com/openshift/origin/releases" class="calibre8">https://github.com/openshift/origin/releases</a> under <kbd class="calibre12">Assets</kbd>.</p>
<ul class="calibre9">
<li class="calibre10"><strong class="calibre1">Starting/stopping a cluster</strong>: The Windows version of the OpenShift client is also able to start and stop the cluster, as follows:</li>
</ul>
<pre class="calibre19"><strong class="calibre1">C:\&gt; oc cluster up</strong></pre>
<p class="calibre27">The Openshift cluster is up. You may want to check the status of the cluster using the following:</p>
<pre class="calibre19"><strong class="calibre1">C:\&gt; oc get node</strong><br class="title-page-name"/>NAME STATUS AGE<br class="title-page-name"/>origin Ready 1d</pre>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Accessing OpenShift through a web browser</h1>
                
            
            <article>
                
<p class="calibre2">Whether you use <kbd class="calibre12">oc cluster up</kbd> or any other solution, when OpenShift is up and running, you can access it via a web browser. OpenShift is available on port <kbd class="calibre12">8443</kbd>, by default. In the case of <kbd class="calibre12">oc cluster up</kbd>, you can reach the OpenShift login page at <kbd class="calibre12">https://localhost:8443/</kbd>:</p>
<p class="cdpaligncenter"><img class="alignnone34" src="../images/00039.jpeg"/></p>
<p class="calibre2">Use the developer login, with any password, to log in to OpenShift. We are going to work with the OpenShift web interface later in this book, while developing and running microservice applications.</p>
<p class="calibre2">Once you log in, you will be presented with the service catalog, which lets you to choose from available language runtimes:</p>
<p class="cdpaligncenter"><img src="../images/00040.jpeg" class="calibre31"/></p>
<p class="calibre2"><em class="calibre17">Project</em> in OpenShift extend the concept of namespaces from Kubernetes and serve as means of separating teams and individual users working with the same OpenShift cluster. Another term often used for projects is <em class="calibre17">tenant </em>(for example, in OpenStack). You can create projects from the web console by clicking on the Create Project button and specifying its name:</p>
<p class="cdpaligncenter"><img src="../images/00041.jpeg" class="calibre32"/></p>
<p class="calibre2">After the project is created, you can click on its name on the right side of the screen and you will be redirected to the project's overview page, from where you can create applications and other resources:</p>
<p class="cdpaligncenter"><img class="alignnone35" src="../images/00042.jpeg"/></p>
<p class="calibre2">Just to give you the basic understanding of how to navigate through OpenShift web console, see the short guide below:</p>
<ul class="calibre9">
<li class="calibre10"><span>Applications</span> menu is used to access resources, directly responsible for your application, like <span>Deployments</span>, <span>Pods</span>, <span>Services</span>, <span>Stateful Sets</span>, and <span>Routes</span></li>
<li class="calibre10"><span>Builds</span> menu lets you manage configuration of <span>Builds</span> and build strategies, such as <span>Pipelines</span>, as well as <span>Images</span> used to build your application from source code</li>
<li class="calibre10"><span>Resources</span> menu gives you access to other secondary resources that can be used by your application in advanced use cases, such as <span>Quota</span>s, <span>Config Maps</span>, <span>Secrets</span>, and <span>Other Resources</span>. You can also use this menu to view and manage <span>Membership</span> for your project</li>
<li class="calibre10"><span>Storage</span> menu is used to request persistent storage by creating persistent storage claims</li>
<li class="calibre10"><span>Monitoring</span> menu provides you with access to various metrics collected by OpenShift on CPU, RAM, and network bandwidth utilization (if you have metrics enabled), as well as <span>Events</span> going on in real time</li>
<li class="calibre10">Finally, <span>Catalog</span> menu is a shortcut you can take to access service catalog directly from the project you are currently in without having to go back to the first page. This was introduced in OpenShift Origin 3.9.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Working with Minishift</h1>
                
            
            <article>
                
<p class="calibre2">Minishift is another way to deploy OpenShift locally, by running a single-node OpenShift cluster inside a virtual machine. Recently, we showed you how to use Minikube to deploy a development environment for Kubernetes. Minishift uses the same approach, because it was <span class="calibre11">developed by Kubernetes community as a continuation of Minikube, mentioned in the <a target="_blank" href="part0071.html#23MNU0-78aafb146b304cdeb9b3261a70edabde" class="calibre8">Chapter 2</a>, <em class="calibre17">Kubernetes Overview</em></span>, <span class="calibre11">so it uses the same command line syntax</span>. Minishift deployment is supported on the Windows, macOS, and Linux operating systems. Minishift uses<span class="calibre11"> </span>libmachine<span class="calibre11"> </span>to provision a virtual machine, boot2docker as OS, and<span class="calibre11"> </span>OpenShift Origin<span class="calibre11"> </span>to run the cluster. Minishift requires a hypervisor to run the virtual machine containing OpenShift.</p>
<p class="calibre2">Depending on your host operating system, you have a choice between the following hypervisors:</p>
<table border="1" class="calibre22">
<tbody class="calibre23">
<tr class="calibre24">
<td class="calibre25"><strong class="calibre1">Operating system</strong></td>
<td class="calibre25"><strong class="calibre1">Hypervisor</strong></td>
<td class="calibre25"><strong class="calibre1">Platform</strong></td>
</tr>
<tr class="calibre24">
<td class="calibre25">macOS</td>
<td class="calibre25">xhyve</td>
<td class="calibre25">VirtualBox</td>
</tr>
<tr class="calibre24">
<td class="calibre25">Linux</td>
<td class="calibre25">KVM</td>
<td class="calibre25">VirtualBox</td>
</tr>
<tr class="calibre24">
<td class="calibre25">Windows</td>
<td class="calibre25">Hyper-V</td>
<td class="calibre25">VirtualBox</td>
</tr>
</tbody>
</table>
<div class="packt_infobox"><span><kbd class="calibre26">boot2docker</kbd> is a lightweight Linux distribution based on Tiny Core Linux, built specifically to run containers. The project is now deprecated.</span></div>
<p class="calibre2">Before you begin, you need to configure virtualization support (<a href="https://docs.openshift.org/latest/minishift/getting-started/installing.html#install-prerequisites" class="calibre8">https://docs.openshift.org/latest/minishift/getting-started/installing.html#install-prerequisites</a>) and install VirtualBox.</p>
<p class="calibre2">Then, you need to download the archive for your operating system from the Minishift releases page (<a href="https://github.com/minishift/minishift/releases" class="calibre8">https://github.com/minishift/minishift/releases</a>) and unpack it. The <kbd class="calibre12">minishift</kbd> binary file from the archive needs to be copied to the OS's preferred location, and the location should be added to your <kbd class="calibre12">PATH</kbd> environment variable. Minishift will use the SSH binary found in the system <kbd class="calibre12">PATH</kbd> environment.</p>
<div class="packt_tip">
<p class="calibre2">On macOS, you can also use Homebrew Cask to install a stable version of Minishift:</p>
<p class="calibre2"><kbd class="calibre26">$ brew cask install minishift</kbd><br class="calibre5"/>
<br class="calibre5"/>
To update the binary, run the following command:</p>
<p class="calibre2"><kbd class="calibre26">$ brew cask install --force minishif</kbd></p>
</div>
<p class="calibre2">If all of the prerequisites are met, you can start a cluster using <kbd class="calibre12">minishift start</kbd>.</p>
<pre class="calibre19"><strong class="calibre1">$ minishift start --vm-driver=virtualbox</strong><br class="title-page-name"/>-- Starting profile 'minishift'<br class="title-page-name"/>-- Checking if requested OpenShift version 'v3.7.1' is valid ... OK<br class="title-page-name"/>...<br class="title-page-name"/>output truncated for brevity<br class="title-page-name"/>...<br class="title-page-name"/>OpenShift server started.<br class="title-page-name"/><br class="title-page-name"/>The server is accessible via web console at:<br class="title-page-name"/>    https://192.168.64.2:8443<br class="title-page-name"/><br class="title-page-name"/>You are logged in as:<br class="title-page-name"/>    User: developer<br class="title-page-name"/>    Password: &lt;any value&gt;<br class="title-page-name"/><br class="title-page-name"/>To login as administrator:<br class="title-page-name"/>    oc login -u system:admin<br class="title-page-name"/><br class="title-page-name"/>-- Exporting of OpenShift images is occuring in background process with pid 7123.</pre>
<p class="calibre2">Once the deployment process is complete, you will be able to connect using the OpenShift client:</p>
<pre class="calibre19"><strong class="calibre1">$ oc login -u system:admin</strong><br class="title-page-name"/>Logged into "https://192.168.64.2:8443" as "system:admin" using existing credentials.<br class="title-page-name"/><br class="title-page-name"/>You have access to the following projects and can switch between them with 'oc project &lt;projectname&gt;':<br class="title-page-name"/><br class="title-page-name"/>* default<br class="title-page-name"/>kube-public<br class="title-page-name"/>kube-system<br class="title-page-name"/>myproject<br class="title-page-name"/>openshift<br class="title-page-name"/>openshift-infra<br class="title-page-name"/>openshift-node<br class="title-page-name"/><br class="title-page-name"/>Using project "default".</pre>
<div class="packt_infobox">You will need to install <kbd class="calibre26">oc client</kbd>, as well. You can refer to the previous sections in this chapter for the <kbd class="calibre26">oc client</kbd> installation procedure. </div>
<p class="calibre2">The OpenShift cluster is up. You may want to check its status using <kbd class="calibre12">oc get nodes</kbd> as it is shown in the following command:</p>
<pre class="calibre18"><strong class="calibre1">$ oc get nodes</strong><br class="title-page-name"/>NAME      STATUS   AGE  VERSION<br class="title-page-name"/>localhost Ready   20h   v1.7.6+a08f5eeb62</pre>
<div class="packt_tip">You can connect to the Minishift VM using <kbd class="calibre26">minishift ssh</kbd>. The Minishift cluster can be stopped with <kbd class="calibre26">minishift stop</kbd>.<br class="title-page-name"/>
<br class="title-page-name"/>
Depending on the <kbd class="calibre26">oc client</kbd> and OpenShift versions, your output may vary.</div>
<p class="calibre2">To stop a Minishift environment and delete it, you can use <kbd class="calibre12">minishift stop</kbd> and <span class="calibre11"><kbd class="calibre12">minishift delete</kbd>, as follows:</span></p>
<pre class="calibre18"><strong class="calibre1">$ minishift stop</strong><br class="title-page-name"/>Stopping local OpenShift cluster...<br class="title-page-name"/>Cluster stopped.<br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">$ minishift delete</strong><br class="title-page-name"/>You are deleting the Minishift VM: 'minishift'. Do you want to continue [y/N]?: <strong class="calibre1">y</strong><br class="title-page-name"/>Deleting the Minishift VM...<br class="title-page-name"/>Minishift VM deleted.</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Working with Vagrant</h1>
                
            
            <article>
                
<p class="calibre2">This method allows for using an available Vagrant box, that has all the OpenShift software installed on a single VM. </p>
<p class="calibre2">Vagrant software allows for simplifying the deployment and the initial configuration of virtual machines, by using different underlying virtualization technologies. In most cases, a plain text file called <kbd class="calibre12">Vagrantfile</kbd> describes the parameters of the VM (such as the name, hostname, RAM, vCPUs, storage, and so on). Once <kbd class="calibre12">Vagrantfile</kbd> is ready, the Vagrant software can use it to create, stop, and destroy a VM.</p>
<p class="calibre2">The beauty of using Vagrant is that we can redeploy VMs as many times as we need to, and each time, we will have the same result:</p>
<div class="cdpaligncenter2"><img class="alignnone36" src="../images/00043.gif"/></div>
<div class="cdpaligncenter1">Vagrant architecture</div>
<p class="calibre2">Vagrant includes the following main components:</p>
<ul class="calibre9">
<li class="calibre10"><strong class="calibre1">Vagrant software</strong>: Automates virtual machine building and configuration. Has the vagrant CLI utility, available for different operating systems.</li>
<li class="calibre10"><strong class="calibre1">Box</strong>: A TAR file that contains a virtual machine image, with metadata. Box files and their contained images are specific to each provider.</li>
<li class="calibre10"><strong class="calibre1">Provider</strong>: The interface that allows Vagrant to communicate with different virtualization platforms. By default, it uses VirtualBox. Libvirt, KVM, OpenStack, and other providers are also available .</li>
<li class="calibre10"><strong class="calibre1">Vagrantfile</strong>: A plain text file that contains the instructions for how to create virtual machines. The instructions are written using Ruby-based <strong class="calibre1">Domain Specific Language</strong> (<strong class="calibre1">DSL</strong>). Plain Ruby can also be used, for advanced use cases.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Vagrant installation</h1>
                
            
            <article>
                
<p class="calibre2">The Vagrant instructions and the software to download are available at <a href="https://www.vagrantup.com/docs/installation/" class="calibre8">https://www.vagrantup.com/docs/installation/</a>.</p>
<p class="calibre2">Just download the package for your OS, and then install it. Vagrant also requires a virtualization platform, like Vmware, KVM, VirtualBox, AWS, Hyper-V, or Docker. You will be required to install the appropriate virtualization platform, depending on your operating system.</p>
<p class="calibre2"><strong class="calibre4">For macOS, install the following</strong>:</p>
<ol class="calibre13">
<li value="1" class="calibre10">Download the latest Vagrant software from the preceding link, and install it.</li>
<li value="2" class="calibre10">Download and install VirtualBox from <a href="https://www.virtualbox.org/wiki/Downloads" class="calibre8">https://www.virtualbox.org/wiki/Downloads</a>.</li>
</ol>
<p class="calibre2"><strong class="calibre4">For CentOS, install the following</strong>:</p>
<ol class="calibre13">
<li value="1" class="calibre10">Download the latest Vagrant software from the preceding link, and install it.</li>
<li value="2" class="calibre10">Install <kbd class="calibre12">libvirt</kbd> drivers and <kbd class="calibre12">kvm</kbd>:</li>
</ol>
<pre class="calibre19"><strong class="calibre1"># yum install epel-release -y</strong><br class="title-page-name"/><strong class="calibre1"># yum localinstall https://releases.hashicorp.com/vagrant/1.9.5/vagrant_1.9.5_x86_64.rpm</strong><br class="title-page-name"/><strong class="calibre1"># yum install qemu libvirt libvirt-devel ruby-devel gcc qemu-kvm -y</strong><br class="title-page-name"/><strong class="calibre1"># vagrant plugin install vagrant-libvirt</strong></pre>
<p class="calibre2"><strong class="calibre4">For Windows install the following</strong>:</p>
<ol class="calibre13">
<li value="1" class="calibre10">Download the latest Vagrant software from the preceding link, and install it.</li>
<li value="2" class="calibre10">Download and install VirtualBox from<span> </span><a href="https://www.virtualbox.org/wiki/Downloads" class="calibre8">https://www.virtualbox.org/wiki/Downloads</a>.</li>
</ol>
<p class="calibre2">Once you are done, verify that Vagrant is installed by checking the Vagrant software version:</p>
<pre class="calibre18"><strong class="calibre1">$ vagrant --version</strong><br class="title-page-name"/>Vagrant 1.9.5</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Installing OpenShift with an all-in-one Vagrant box</h1>
                
            
            <article>
                
<p class="calibre2">Before introduction of Minishift in May 2017, users mostly relied on <kbd class="calibre12">openshift/origin-all-in-one</kbd> <span class="calibre11">Vagrant all-in-one box</span>. This method is not so popular, because the box hasn't been updated for almost 2 years and represents OpenShift Origin 1.3, which lacks in features, as well as in stability, so it's mostly of historical interest today. Even though it can still be used for testing purposes, we suggest you rely on <kbd class="calibre12">oc cluster up</kbd> and Minishift. </p>
<p class="calibre2">A Vagrant-based environment can be deployed as follows:</p>
<pre class="calibre18"><strong class="calibre1">$ vagrant init openshift/origin-all-in-one</strong><br class="title-page-name"/><strong class="calibre1">$ vagrant up</strong></pre>
<p class="calibre2">The preceding command will create the following <kbd class="calibre12">Vagrantfile</kbd>:</p>
<pre class="calibre18"><strong class="calibre1">$ cat Vagrantfile</strong><br class="title-page-name"/>Vagrant.configure("2") do |config|<br class="title-page-name"/>   config.vm.box = "openshift/origin-all-in-one"<br class="title-page-name"/>end</pre>
<p class="calibre2">Once the box has deployed, you can log in using <kbd class="calibre12">admin</kbd> and a password, as follows:</p>
<pre class="calibre18"><strong class="calibre1">$ oc login</strong><br class="title-page-name"/>Server [https://localhost:8443]:<br class="title-page-name"/>The server uses a certificate signed by an unknown authority.<br class="title-page-name"/>You can bypass the certificate check, but any data you send to the server could be intercepted by others.<br class="title-page-name"/>Use insecure connections? (y/n): <strong class="calibre1">y</strong><br class="title-page-name"/><br class="title-page-name"/>Authentication required for https://localhost:8443 (openshift)<br class="title-page-name"/>Username: <strong class="calibre1">admin</strong><br class="title-page-name"/>Password: <strong class="calibre1">admin</strong><br class="title-page-name"/>Login successful.<br class="title-page-name"/><br class="title-page-name"/>You have access to the following projects and can switch between them with 'oc project &lt;projectname&gt;':<br class="title-page-name"/><br class="title-page-name"/>cockpit<br class="title-page-name"/>* default<br class="title-page-name"/>kube-system<br class="title-page-name"/>openshift<br class="title-page-name"/>openshift-infra<br class="title-page-name"/><br class="title-page-name"/>Using project "default".<br class="title-page-name"/>Welcome! See 'oc help' to get started.</pre>
<p class="calibre2">The OpenShift cluster is up. You may want to check the cluster status as shown in the following command:</p>
<pre class="calibre18"><strong class="calibre1">$ oc get node</strong><br class="title-page-name"/>NAME STATUS AGE<br class="title-page-name"/>origin Ready 1y</pre>
<div class="packt_infobox">Please keep in mind that the Vagrant box for this method is 2 years behind latest version of OpenShift, so if you want to see most recent features, we recommend using another option. </div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we discussed how to create an OpenShift lab environment quickly and easily, using the most popular and simple methods:<span class="calibre11"> </span><kbd class="calibre12">oc cluster up</kbd>, Minishift, and Vagrant, on the CentOS 7, macOS, and Windows operating systems. </p>
<p class="calibre2">In the next chapter, you will learn about the hardware and software requirements of OpenShift Origin. You will get a basic understanding of OpenShift deployment scenarios and installation methods. Also, you will perform an advanced installation of OpenShift using Ansible, and you will learn about the various options to customize your setup with Ansible inventory.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Questions</h1>
                
            
            <article>
                
<ol class="calibre13">
<li value="1" class="calibre10"><span>What is the main prerequisite for the <kbd class="calibre12">oc cluster up</kbd> solution?</span> (Choose one):
<ol class="calibre14">
<li value="1" class="calibre10">Docker</li>
<li value="2" class="calibre10">Minishift</li>
<li value="3" class="calibre10">Virtualbox</li>
<li value="4" class="calibre10">Hyper-V</li>
</ol>
</li>
<li value="2" class="calibre10">What port is used, by default, to reach the OpenShift management web page? choose one:
<ol class="calibre14">
<li value="1" class="calibre10">8443</li>
<li value="2" class="calibre10">443</li>
<li value="3" class="calibre10">8080</li>
<li value="4" class="calibre10">80</li>
</ol>
</li>
</ol>
<ol start="3" class="calibre13">
<li value="3" class="calibre10">The <kbd class="calibre12">oc cluster up</kbd> command uses a VM to bring up the Openshift cluster:
<ol class="calibre14">
<li value="1" class="calibre10">True</li>
<li value="2" class="calibre10">False</li>
</ol>
</li>
<li value="4" class="calibre10">What command is used to log in to Openshift via the CLI? choose one:
<ol class="calibre14">
<li value="1" class="calibre10">oc login system:admin</li>
<li value="2" class="calibre10">oc login -u system:admin</li>
<li value="3" class="calibre10">oc login -u admin</li>
<li value="4" class="calibre10">oc login admin</li>
</ol>
</li>
<li value="5" class="calibre10">What are the commands to start and stop the OpenShift demo cluster with the <kbd class="calibre12">oc</kbd> command? choose one:
<ol class="calibre14">
<li value="1" class="calibre10">oc cluster up</li>
<li value="2" class="calibre10">oc cluster start</li>
<li value="3" class="calibre10">oc cluster down</li>
<li value="4" class="calibre10">oc cluster stop</li>
</ol>
</li>
<li value="6" class="calibre10">The <kbd class="calibre12">minishift start</kbd> command uses a VM to bring up the Openshift Cluster:
<ol class="calibre14">
<li value="1" class="calibre10">True</li>
<li value="2" class="calibre10">False</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Further reading</h1>
                
            
            <article>
                
<p class="calibre2"><span class="calibre11">Take a look at the following links, if you are interested in learning more or are facing some issues in your lab environment:</span></p>
<ul class="calibre9">
<li class="calibre10"><strong class="calibre1">oc cluster up installation</strong>: <a href="https://github.com/openshift/origin/blob/master/docs/cluster_up_down.md" class="calibre8">https://github.com/openshift/origin/blob/master/docs/cluster_up_down.md</a></li>
<li class="calibre10"><strong class="calibre1">Minishift installation</strong>: <a href="https://docs.openshift.org/latest/minishift/getting-started/installing.html" class="calibre8">https://docs.openshift.org/latest/minishift/getting-started/installing.html</a></li>
<li class="calibre10"><strong class="calibre1">Vagrant installation</strong>: <a href="https://www.vagrantup.com/intro/getting-started/install.html" class="calibre8">https://www.vagrantup.com/intro/getting-started/install.html</a></li>
<li class="calibre10"><span><strong class="calibre1">An alternative method to install the OpenShift cluster in a VM</strong>: <a href="https://blog.openshift.com/openshift-developers-set-full-cluster-30-minutes/" class="calibre8">https://blog.openshift.com/openshift-developers-set-full-cluster-30-minutes/</a></span></li>
<li class="calibre10"><strong class="calibre1">4 ways to set up a development environment on OpenShift</strong>: <a href="https://developers.redhat.com/blog/2016/10/11/four-creative-ways-to-create-an-openshiftkubernetes-dev-environment/" class="calibre8">https://developers.redhat.com/blog/2016/10/11/four-creative-ways-to-create-an-openshiftkubernetes-dev-environment/</a></li>
</ul>


            </article>

            
        </section>
    </body></html>