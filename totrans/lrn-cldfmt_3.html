<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Developing AWS CloudFormation Templates</h1>
                
            
            <article>
                
<p class="calibre2">Building AWS CloudFormation needs knowledge on how to write IaC for AWS. In this chapter, we'll explore how to develop IaC scripts using JSON and YAML. We'll also review how to access AWS resources from IaC scripts.</p>
<p class="calibre2">The following topics will be covered in this chapter:</p>
<ul class="calibre11">
<li class="calibre12">Reviewing the AWS CloudFormation template format</li>
<li class="calibre12">Reviewing JSON and YAML for <span>AWS CloudFormation</span></li>
<li class="calibre12">The programming model for AWS CloudFormation templates</li>
<li class="calibre12">Writing JSON and YAML for creating AWS CloudFormation templates</li>
<li class="calibre12">Getting input from the CloudFormation template</li>
<li class="calibre12">Introduction to AWS CloudFormation Designer</li>
<li class="calibre12">Giving template description</li>
<li class="calibre12">Selecting input from options</li>
<li class="calibre12">Mapping parameters</li>
<li class="calibre12">Working with intrinsic functions</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Reviewing the AWS CloudFormation template format</h1>
                
            
            <article>
                
<p class="calibre2">IaC technology is designed to enable developers to build infrastructure by writing scripts. AWS CloudFormation uses the IaC approach to build infrastructure-based AWS technology stacks. Each AWS resource can be declared in a scripting form. Developers can make their own infrastructures by declaring AWS resources in the <span class="calibre7">AWS CloudFormation template.</span></p>
<p class="calibre2"/>
<p class="calibre2">To develop <span class="calibre7">AWS CloudFormation, we should understand what the AWS CloudFormation template is and how to build that template. The AWS resource is defined in the AWS service. For instance, Amazon S3 can be defined in the AWS CloudFormation template in JSON format, which is shown as follows:</span></p>
<pre class="calibre19">{<br class="title-page-name"/> "Type" : "AWS::S3::Bucket",<br class="title-page-name"/> "Properties" : {<br class="title-page-name"/> "AccessControl" : String,<br class="title-page-name"/> "AccelerateConfiguration" : AccelerateConfiguration,<br class="title-page-name"/> "AnalyticsConfigurations" : [ AnalyticsConfiguration, ... ],<br class="title-page-name"/> "BucketEncryption" : BucketEncryption,<br class="title-page-name"/> "BucketName" : String,<br class="title-page-name"/> "CorsConfiguration" : CorsConfiguration,<br class="title-page-name"/> "InventoryConfigurations" : [ InventoryConfiguration, ... ],<br class="title-page-name"/> "LifecycleConfiguration" : LifecycleConfiguration,<br class="title-page-name"/> "LoggingConfiguration" : LoggingConfiguration,<br class="title-page-name"/> "MetricsConfigurations" : [ MetricsConfiguration, ... ]<br class="title-page-name"/> "NotificationConfiguration" : NotificationConfiguration,<br class="title-page-name"/> "ReplicationConfiguration" : ReplicationConfiguration,<br class="title-page-name"/> "Tags" : [ Resource Tag, ... ],<br class="title-page-name"/> "VersioningConfiguration" : VersioningConfiguration,<br class="title-page-name"/> "WebsiteConfiguration" : WebsiteConfiguration<br class="title-page-name"/> }<br class="title-page-name"/>}</pre>
<p class="calibre2">This template can also be declared in the YAML format:</p>
<pre class="calibre19">Type: "AWS::S3::Bucket"<br class="title-page-name"/>Properties: <br class="title-page-name"/> AccessControl: String<br class="title-page-name"/> AccelerateConfiguration:<br class="title-page-name"/> AccelerateConfiguration<br class="title-page-name"/> AnalyticsConfigurations:<br class="title-page-name"/> - AnalyticsConfiguration<br class="title-page-name"/> BucketEncryption: <br class="title-page-name"/> BucketEncryption<br class="title-page-name"/> BucketName: String<br class="title-page-name"/> CorsConfiguration:<br class="title-page-name"/> CorsConfiguration<br class="title-page-name"/> InventoryConfigurations:<br class="title-page-name"/> - InventoryConfiguration <br class="title-page-name"/> LifecycleConfiguration:<br class="title-page-name"/> LifecycleConfiguration<br class="title-page-name"/> LoggingConfiguration:<br class="title-page-name"/> LoggingConfiguration<br class="title-page-name"/> MetricsConfigurations: <br class="title-page-name"/> - MetricsConfiguration<br class="title-page-name"/> NotificationConfiguration:<br class="title-page-name"/> NotificationConfiguration<br class="title-page-name"/> ReplicationConfiguration:<br class="title-page-name"/> ReplicationConfiguration<br class="title-page-name"/> Tags:<br class="title-page-name"/> - Resource Tag<br class="title-page-name"/> VersioningConfiguration:<br class="title-page-name"/> VersioningConfiguration<br class="title-page-name"/> WebsiteConfiguration:<br class="title-page-name"/> WebsiteConfiguration</pre>
<p class="calibre2">We can see that each AWS resource can be declared as a resource type. In general, the AWS resource type can be defined as follows:</p>
<pre class="calibre19">AWS::aws-product-name::data-type-name</pre>
<p class="calibre2">We should about know AWS resource types if we want to use those resources. A sample of the AWS resource type list can be seen in the following table:</p>
<table border="1" class="calibre28">
<tbody class="calibre29">
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter"><strong class="calibre1">AWS resource name</strong></div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><strong class="calibre1">AWS resource type</strong></div>
</td>
</tr>
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter">AWS EC2 instance</div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><kbd class="calibre13">AWS::EC2::Instance</kbd></div>
</td>
</tr>
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter">AWS EC2 VPC</div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><kbd class="calibre13">AWS::EC2::VPC</kbd></div>
</td>
</tr>
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter">AWS IAM user</div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><kbd class="calibre13">AWS::IAM::User</kbd></div>
</td>
</tr>
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter">AWS IoT device thing</div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><kbd class="calibre13">AWS::IoT::Thing</kbd></div>
</td>
</tr>
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter">AWS Lambda function</div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><kbd class="calibre13">AWS::Lambda::Function</kbd></div>
</td>
</tr>
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter">AWS RDS database instance</div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><kbd class="calibre13">AWS::RDS::DBInstance</kbd></div>
</td>
</tr>
<tr class="calibre30">
<td class="calibre31">
<div class="cdpaligncenter">AWS S3 bucket</div>
</td>
<td class="calibre32">
<div class="cdpaligncenter"><kbd class="calibre13">AWS::S3::Bucket</kbd></div>
</td>
</tr>
</tbody>
</table>
<div class="packt_figref"><span>Table 3.1: A sample list of </span><span>AWS resource types</span></div>
<div class="packt_infobox">Further information about various AWS resource types can be found at <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html" target="_blank" class="calibre22">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html</a>.</div>
<p class="calibre2">An <span class="calibre7">AWS CloudFormation template consists of various AWS resource types, depending on your needs in the infrastructure.</span> In general, the AWS CloudFormation template format can be described in the following diagram. The template consists of various attributes, such as <strong class="calibre5">AWSTemplateFormatVersion</strong>, <strong class="calibre5">Description</strong>, <strong class="calibre5">Metadata</strong>, and <strong class="calibre5">Parameters</strong>:</p>
<div class="cdpaligncenter"><img src="../images/00048.jpeg" class="calibre33"/></div>
<div class="packt_figref">Figure 3.1: AWS CloudFormation template format</div>
<p class="calibre2">Each AWS CloudFormation template has one or more of the following attributes:</p>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">AWSTemplateFormatVersion</kbd>: This is the AWS CloudFormation template version that is not the same as the API or WSDL version. This attribute is optional.</li>
<li class="calibre12"><kbd class="calibre13">Description</kbd>: This defines a text string that describes the template. This attribute is optional.</li>
<li class="calibre12"><kbd class="calibre13">Metadata</kbd>: This defines objects that provide additional information about the template. This attribute is optional.</li>
<li class="calibre12"><kbd class="calibre13">Parameters</kbd>: This defines values to pass to your template at runtime. You can refer to parameters from the <kbd class="calibre13">Resources</kbd> and <kbd class="calibre13">Outputs</kbd> sections of the template. This attribute is optional.</li>
<li class="calibre12"><kbd class="calibre13">Mappings</kbd>: This is a mapping of keys and associated values that you can use to specify conditional parameter values. This attribute is optional.</li>
<li class="calibre12"><kbd class="calibre13">Conditions</kbd>: This defines conditions that control whether certain resources are created or whether certain resource properties are assigned a value during stack-creation or <span>stack-update</span>. This attribute is optional.</li>
<li class="calibre12"><kbd class="calibre13">Transform</kbd>: This helps simplify template authoring by condensing the expression of AWS infrastructure as code and enabling the reuse of template components.</li>
<li class="calibre12"><kbd class="calibre13">Resources</kbd>: This specifies the stack resources and their properties, such as EC2 and Amazon S3. This attribute is required.</li>
<li class="calibre12"><kbd class="calibre13">Output</kbd>: This describes the values that are returned whenever you view your stack's properties. This attribute is optional.</li>
</ul>
<p class="calibre2">Since <span class="calibre7">AWS CloudFormation templates are written in JSON and YAML, we will learn how to develop both JSON and YAML. We'll explore these programming methods in the next section.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Reviewing JSON and YAML programming</h1>
                
            
            <article>
                
<p class="calibre2">In this section, we will learn a bit about programming for JSON and YAML. We should know about JSON and YAML in order to build AWS CloudFormation templates. Technically, JSON and YAML are part of a scripting language. We will explore each topic in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">JSON programming</h1>
                
            
            <article>
                
<p class="calibre2">JSON is a data-interchange format. This format is based on ECMA-404. For more information, refer to <a href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf" target="_blank" class="calibre10">http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf</a>. JSON can be defined as a key-value model. We can write the following script:</p>
<pre class="calibre19">{<br class="title-page-name"/> key: value<br class="title-page-name"/>}</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">For instance, we can define a JSON object for the <kbd class="calibre13">Employee</kbd> data. We can write the following scripts:</p>
<pre class="calibre19">{<br class="title-page-name"/> "id": 1,<br class="title-page-name"/> "name": "michael",<br class="title-page-name"/> "country": "us"<br class="title-page-name"/>}</pre>
<p class="calibre2">You can see that the <kbd class="calibre13">Employee</kbd> object has three attributes—<kbd class="calibre13">id</kbd>, <kbd class="calibre13">name</kbd>, and <kbd class="calibre13">country</kbd>. Technically, we can declare an attribute in numeric and string types. We can also define a collection of the <kbd class="calibre13">Employee</kbd> object using <kbd class="calibre13">[]</kbd>. Each object is defined in <kbd class="calibre13">{}</kbd>. We can write the scripts as follows:</p>
<pre class="calibre19">[<br class="title-page-name"/> {<br class="title-page-name"/>  "id": 1,<br class="title-page-name"/>  "name": "michael",<br class="title-page-name"/>  "country": "us"<br class="title-page-name"/> },<br class="title-page-name"/> {<br class="title-page-name"/>  "id": 2,<br class="title-page-name"/>  "name": "jason",<br class="title-page-name"/>  "country": "uk"<br class="title-page-name"/> },<br class="title-page-name"/> {<br class="title-page-name"/>  "id": 3,<br class="title-page-name"/>  "name": "ryu",<br class="title-page-name"/>  "country": "jp"<br class="title-page-name"/> }<br class="title-page-name"/>]</pre>
<p class="calibre2">JSON supports unlimited parent-child attributes. For instance, each <kbd class="calibre13">Employee</kbd> object probably has two or more addresses. We can declare them as follows:</p>
<pre class="calibre19">{<br class="title-page-name"/> "id": 1,<br class="title-page-name"/> "name": "michael",<br class="title-page-name"/> "address":[<br class="title-page-name"/>      {<br class="title-page-name"/>        "street": "abc street",<br class="title-page-name"/>        "city": "new york"<br class="title-page-name"/>      },<br class="title-page-name"/>      {<br class="title-page-name"/>        "street": "vue street",<br class="title-page-name"/>        "city": "hoston"<br class="title-page-name"/>      }<br class="title-page-name"/> ],<br class="title-page-name"/> "country": "us"<br class="title-page-name"/>}</pre>
<p class="calibre2">This is the end of the JSON programming section. Next, we'll learn how to develop YAML.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">YAML programming</h1>
                
            
            <article>
                
<p class="calibre2">YAML is a data-serialization language designed to be directly writable and readable by humans. A simple YAML object can be defined as follows:</p>
<pre class="calibre19">key:<br class="title-page-name"/> value</pre>
<p class="calibre2">In the JSON format, we use <kbd class="calibre13">{}</kbd> and <kbd class="calibre13">:</kbd> for key-value data. In YAML, we only use <kbd class="calibre13">:</kbd>.</p>
<p class="calibre2">In the previous section, we declared the <kbd class="calibre13">Employee</kbd> object in JSON. We can convert it to YAML with the following scripts:</p>
<pre class="calibre19">id:<br class="title-page-name"/> 1<br class="title-page-name"/>name:<br class="title-page-name"/> "michael"<br class="title-page-name"/>country:<br class="title-page-name"/> "us"</pre>
<p class="calibre2">If we want to define a collection of YAML objects, we can use the <kbd class="calibre13">-</kbd> syntax to represent an item of a collection. Let's rewrite the collection of <kbd class="calibre13">Employee</kbd> from JSON into YAML. We can write the following scripts:</p>
<pre class="calibre19">- id: 1<br class="title-page-name"/>  name: "michael"<br class="title-page-name"/>  country: "us"<br class="title-page-name"/>- id: 2<br class="title-page-name"/>  name: "jason"<br class="title-page-name"/>  country: "uk"<br class="title-page-name"/>- id: 3<br class="title-page-name"/>  name: "ryu"<br class="title-page-name"/>  country: "jp"</pre>
<p class="calibre2">To declare a parent-child of a YAML object, we can use <kbd class="calibre13">:</kbd> by passing the YAML object. For instance, we add an <kbd class="calibre13">address</kbd> object from the <kbd class="calibre13">Employee</kbd> object. We can write the following scripts to implement it:</p>
<pre class="calibre19">id:<br class="title-page-name"/> 1<br class="title-page-name"/>name:<br class="title-page-name"/> "michael"<br class="title-page-name"/>address:<br class="title-page-name"/>    - street: "abc street"<br class="title-page-name"/>      city: "new york"<br class="title-page-name"/>    - street: "vue street"<br class="title-page-name"/>      city: "hoston"<br class="title-page-name"/>country: <br class="title-page-name"/> "us"</pre>
<p class="calibre2">That's a simple implementation for writing a YAML object. Next, we'll build AWS CloudFormation templates in JSON and YAML.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">The programming model for AWS CloudFormation templates</h1>
                
            
            <article>
                
<p class="calibre2">Developing AWS CloudFormation templates means we write scripts for infrastructure-based AWS technology. In this model, we can apply the <strong class="calibre5">Software Development Life Cycle</strong> (<strong class="calibre5">SDLC</strong>). In general, we represent the development model for <span class="calibre7">AWS CloudFormation templates in the following diagram:</span></p>
<div class="cdpaligncenter"><img src="../images/00049.jpeg" class="calibre34"/></div>
<div class="packt_figref">Figure 3.2: CloudFormation template development cycle</div>
<p class="calibre2">From the preceding diagram, we can perform the following tasks:</p>
<ul class="calibre11">
<li class="calibre12"><strong class="calibre1">Analyze problems</strong>: We identity what the problems are and decide which problems to fix.</li>
<li class="calibre12"><strong class="calibre1">Build an infrastructure design</strong>:<strong class="calibre1"> </strong>Based on your problem and solution, we define an infrastructure design, including some AWS resources to implement.</li>
<li class="calibre12"><strong class="calibre1">Develop a CloudFormation template</strong>: After you have built the infrastructure design, you write the CloudFormation template. You define all AWS resources on your scripts. You can write the template using JSON and YAML files or with CloudFormation Designer.</li>
<li class="calibre12"><strong class="calibre1">Deploy AWS CloudFormation</strong>:<strong class="calibre1"> </strong>After you complete the CloudFormation template, you can upload and provision those scripts.</li>
<li class="calibre12"><strong class="calibre1">Testing</strong>:<strong class="calibre1"> </strong>You can test your infrastructure. If you find a problem in testing, you can modify your scripts and then perform testing again.</li>
</ul>
<p class="calibre2">In term of SDLC, you can use an agile methodology while developing CloudFormation templates. There are a lot of agile methodology models, such as scrum and <strong class="calibre5">Extreme Programming</strong> (<strong class="calibre5">XP</strong>). You can also use source control to manage <span class="calibre7">CloudFormation template files. </span>Next, we'll write scripts for CloudFormation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Writing JSON and YAML to create AWS CloudFormation templates</h1>
                
            
            <article>
                
<p class="calibre2">We have learned the CloudFormation template format that is described in <em class="calibre17">Figure 3.1</em>. Clo<span class="calibre7">udFormation templates can be implemented in JSON and YAML. From</span> <em class="calibre17">Figure 3.1</em><span class="calibre7">, we can implement the CloudFormation template in JSON format as follows:</span></p>
<pre class="calibre19">{<br class="title-page-name"/> "AWSTemplateFormatVersion" : "version date",<br class="title-page-name"/> "Description" : "JSON string",<br class="title-page-name"/> "Metadata" : {<br class="title-page-name"/>   template metadata<br class="title-page-name"/> },<br class="title-page-name"/> "Parameters" : {<br class="title-page-name"/>   set of parameters<br class="title-page-name"/> },<br class="title-page-name"/> "Mappings" : {<br class="title-page-name"/>   set of mappings<br class="title-page-name"/> },<br class="title-page-name"/> "Conditions" : {<br class="title-page-name"/>   set of conditions<br class="title-page-name"/> },<br class="title-page-name"/> "Transform" : {<br class="title-page-name"/>   set of transforms<br class="title-page-name"/> },<br class="title-page-name"/> "Resources" : {<br class="title-page-name"/>   set of resources<br class="title-page-name"/> },<br class="title-page-name"/> "Outputs" : {<br class="title-page-name"/>   set of outputs<br class="title-page-name"/> }<br class="title-page-name"/>}</pre>
<p class="calibre2">All attributes in CloudFormation are not required. Only the <kbd class="calibre13">Resources</kbd> attribute should be defined on your CloudFormation template. You can also define the <span class="calibre7">CloudFormation template in YAML. We can declare the CloudFormation template from <em class="calibre17">F</em></span><em class="calibre17">igure 3.1</em> <span class="calibre7">in YAML as follows:</span></p>
<pre class="calibre19">AWSTemplateFormatVersion: "version date"<br class="title-page-name"/>Description:<br class="title-page-name"/> String<br class="title-page-name"/>Metadata:<br class="title-page-name"/> template metadata<br class="title-page-name"/>Parameters:<br class="title-page-name"/> set of parameters<br class="title-page-name"/>Mappings:<br class="title-page-name"/> set of mappings<br class="title-page-name"/>Conditions:<br class="title-page-name"/> set of conditions<br class="title-page-name"/>Transform:<br class="title-page-name"/> set of transforms<br class="title-page-name"/>Resources:<br class="title-page-name"/> set of resources<br class="title-page-name"/>Outputs:<br class="title-page-name"/> set of outputs</pre>
<p class="calibre2">Some attributes from <span class="calibre7">CloudFormation templates will be explored in this book with various use cases and scenarios. In the next section, we'll build a CloudFormation template to get input from users.</span></p>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Getting input from the CloudFormation template</h1>
                
            
            <article>
                
<p class="calibre2">In <a target="_blank" href="part0032.html#UGI00-ff9c6455e1444393ad97060c22881bf4" class="calibre10">Chapter 2</a>, <em class="calibre17">Building Your First AWS CloudFormation Project</em>, we built CloudFormation while applying Amazon S3 resources. Since we didn't specify the S3 bucket name, Amazon S3 will generate a random name for our bucket. In this section, we'll build CloudFormation, which gets input from users to set the Amazon S3 bucket name.</p>
<p class="calibre2">We can use the <kbd class="calibre13">Parameters</kbd> attribute from the <span class="calibre7">CloudFormation</span> template. The value of the <kbd class="calibre13">Parameters</kbd> attribute will be passed to our Amazon AWS resources. To get <kbd class="calibre13">Parameters</kbd> from resources, you can use <kbd class="calibre13">Ref</kbd> by passing the parameter name. For instance, I have a parameter <kbd class="calibre13">YourBucketName</kbd>. This parameter passes to my resource <kbd class="calibre13">MySimpleBucket</kbd>, on the <kbd class="calibre13">BucketName</kbd> attribute, shown as follows:</p>
<pre class="calibre19">{ <br class="title-page-name"/>  "Parameters": { <br class="title-page-name"/>    "YourBucketName":{<br class="title-page-name"/>      "Description": "Amazon S3 Bucket name",<br class="title-page-name"/>      "Type": "String"<br class="title-page-name"/>    }<br class="title-page-name"/> },<br class="title-page-name"/> "Resources" : {<br class="title-page-name"/>    "MySimpleBucket" : {<br class="title-page-name"/>      "Type" : "AWS::S3::Bucket",<br class="title-page-name"/>      "Properties" : {<br class="title-page-name"/>        "AccessControl" : "PublicRead",<br class="title-page-name"/>        "BucketName" : {<br class="title-page-name"/>           "Ref": "YourBucketName"<br class="title-page-name"/>        }<br class="title-page-name"/>      } <br class="title-page-name"/>    }<br class="title-page-name"/>  }<br class="title-page-name"/>}</pre>
<p class="calibre2">For demonstration purposes, we will create Amazon S3 with a custom bucket name that is filled in by the user. You can perform the following steps to implement the demo:</p>
<ol class="calibre14">
<li value="1" class="calibre12">Prepare the CloudFormation template on your local computer.</li>
<li value="2" class="calibre12">Create a JSON or YAML file to build the CloudFormation template.</li>
<li value="3" class="calibre12">Give a template file for JSON format as <kbd class="calibre13">simple-s3.json</kbd> and the <kbd class="calibre13">simple-s3.yaml</kbd> file in YAML format. You can write the following scripts.</li>
</ol>
<p class="calibre2"/>
<p class="calibre25">The script for the <kbd class="calibre13">simple-s3.json</kbd> <span class="calibre7">file is as follows:</span></p>
<pre class="calibre35">{<br class="title-page-name"/>    "AWSTemplateFormatVersion": "2010-09-09",<br class="title-page-name"/>    "Description": "Amazon S3 with custom Bucket name",<br class="title-page-name"/>    "Parameters": {      <br class="title-page-name"/>      "YourBucketName":{<br class="title-page-name"/>          "Description": "Amazon S3 Bucket name",<br class="title-page-name"/>          "Type": "String"<br class="title-page-name"/>      }<br class="title-page-name"/>    },<br class="title-page-name"/>    "Resources" : {<br class="title-page-name"/>        "MySimpleBucket" : {<br class="title-page-name"/>            "Type" : "AWS::S3::Bucket",<br class="title-page-name"/>            "Properties" : {<br class="title-page-name"/>                "AccessControl" : "PublicRead",<br class="title-page-name"/>                "BucketName" : {<br class="title-page-name"/>                    "Ref": "YourBucketName"<br class="title-page-name"/>                  }<br class="title-page-name"/>            }                <br class="title-page-name"/>        }<br class="title-page-name"/>        <br class="title-page-name"/>    }<br class="title-page-name"/>}</pre>
<p class="calibre25">The script for the <kbd class="calibre13">simple-s3.yaml</kbd> file is as follows:</p>
<pre class="calibre35">AWSTemplateFormatVersion:<br class="title-page-name"/> "2010-09-09"<br class="title-page-name"/>Description:<br class="title-page-name"/> "Amazon S3 with custom Bucket name"<br class="title-page-name"/>Parameters:<br class="title-page-name"/> YourBucketName:<br class="title-page-name"/>   Description:<br class="title-page-name"/>     "Amazon S3 Bucket name"<br class="title-page-name"/>   Type:<br class="title-page-name"/>     "String"<br class="title-page-name"/>Resources:<br class="title-page-name"/> MySimpleBucket:<br class="title-page-name"/>   Type:<br class="title-page-name"/>     "AWS::S3::Bucket"<br class="title-page-name"/>   Properties:<br class="title-page-name"/>     AccessControl:<br class="title-page-name"/>        "PublicRead"<br class="title-page-name"/>   BucketName:<br class="title-page-name"/>     Ref:<br class="title-page-name"/>        "YourBucketName"</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<ol start="4" class="calibre14">
<li value="4" class="calibre12">Once done, save these scripts into a file.</li>
<li value="5" class="calibre12">Upload the template file to AWS CloudFormation.</li>
<li value="6" class="calibre12">Navigate to <a href="https://console.aws.amazon.com/cloudformation" target="_blank" class="calibre10">https://console.aws.amazon.com/cloudformation</a> and click on the <span>Create New Stack</span> button. You should see a screen, which is shown in the following screenshot.</li>
<li value="7" class="calibre12">Select the <span>Upload a template to Amazon S3</span> option.</li>
<li value="8" class="calibre12">Click on the <span>Choose File</span> button to upload the CloudFormation template file and then click on the <span>Next</span> button:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone38" src="../images/00050.jpeg"/></div>
<div class="packt_figref">Figure 3.3: Selecting the CloudFormation template</div>
<ol start="9" class="calibre14">
<li value="9" class="calibre12">You should see a screen, which is shown in <em class="calibre24">Figure 3.4</em>. You should use our defined parameter called <kbd class="calibre13">YourBucketName</kbd>. This is our S3 bucket name.</li>
<li value="10" class="calibre12">Fill in the <span>Stack name</span> and <span>YourBucketName</span><span> fields for the bucket name:</span></li>
</ol>
<div class="cdpaligncenter"><img class="alignnone39" src="../images/00051.jpeg"/></div>
<div class="packt_figref">Figure 3.4: Displaying parameters for CloudFormation templates</div>
<ol start="11" class="calibre14">
<li value="11" class="calibre12">For instance, I filled in my stack name as <kbd class="calibre13">my-simple-stack</kbd> and my bucket name as <kbd class="calibre13">my-simple-s3</kbd>. You can see my input in the following screenshot.</li>
<li value="12" class="calibre12">Once done, you can click on the <span>Next</span> button, as shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone40" src="../images/00052.jpeg"/></div>
<div class="packt_figref">Figure 3.5: Filling in the CloudFormation parameters</div>
<ol start="13" class="calibre14">
<li value="13" class="calibre12">After you have clicked the <span>Next</span> button, you should be asked to fill in the options. In this case, we don't fill in any items. Just click on the <span>Next</span> button:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone41" src="../images/00053.jpeg"/></div>
<div class="packt_figref">Figure 3.6: Setting the CloudFormation options</div>
<ol start="14" class="calibre14">
<li value="14" class="calibre12">You should have confirmation, as shown in the following screenshot, before provisioning your CloudFormation template.</li>
<li value="15" class="calibre12">If you are done, you can click on the <span>Create</span> button to deploy CloudFormation:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone42" src="../images/00054.jpeg"/></div>
<div class="packt_figref">Figure 3.7: Confirmation for CloudFormation</div>
<ol start="16" class="calibre14">
<li value="16" class="calibre12">AWS CloudFormation will create all the resources that are defined in the template.</li>
<li value="17" class="calibre12">You should see the provision status on the dashboard, which is shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone43" src="../images/00055.jpeg"/></div>
<div class="packt_figref">Figure 3.8: Deploying CloudFormation</div>
<ol start="18" class="calibre14">
<li value="18" class="calibre12">You can verify the Amazon S3 console to ensure your resource has been created by CloudFormation.</li>
<li value="19" class="calibre12">Check out the following screenshot, my Amazon S3 with my bucket name, <kbd class="calibre13">my-simple-s3</kbd>. This bucket name is filled in from our input from <em class="calibre24">Figure 3.5</em>:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone44" src="../images/00056.jpeg"/></div>
<div class="packt_figref">Figure 3.9: Amazon S3 is created from the CloudFormation template</div>
<p class="calibre2">If you prefer to run the CloudFormation template using the AWS CLI, you can do that easily. For instance, the template file is located on <kbd class="calibre13">home/user/templates/simple-s3.json</kbd>. We also set the stack name as <kbd class="calibre13">my-simple-stack</kbd> and pass parameters for <kbd class="calibre13">YourBucketName</kbd> with <kbd class="calibre13">my-simple-s3</kbd>. You can type the following command:</p>
<pre class="calibre19"><strong class="calibre1">$ aws cloudformation create-stack --stack-name my-simple-stack </strong><br class="title-page-name"/><strong class="calibre1"> --template-body file://home/user/templates/simple-s3.json </strong><br class="title-page-name"/><strong class="calibre1"> --parameters YourBucketName=my-simple-s3</strong></pre>
<p class="calibre2">The AWS CLI will deploy your CloudFormation based on its template file.</p>
<p class="calibre2">This is the end of our demo. We have created a resource, Amazon S3, and passed a parameter to define a bucket name. You can practice more with various parameters from the Amazon AWS resources.</p>
<p class="calibre2">Next, we will build CloudFormation Designer.</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Introducing AWS CloudFormation Designer</h1>
                
            
            <article>
                
<p class="calibre2">We have learned how to create a CloudFormation template manually by writing scripts, in JSON or YAML, with a text editor. In this section, we'll build a CloudFormation template graphically using CloudFormation Designer. You can click and drag AWS resources into the template. This tool will generate JSON or YAML files. Then, you can upload the template to AWS CloudFormation.</p>
<p class="calibre2">For a demo, we'll build a CloudFormation template using <span class="calibre7">CloudFormation Designer. We'll use Amazon S3 to show how CloudFormation Designer works. You can perform the following steps for the demo:</span></p>
<ol class="calibre14">
<li value="1" class="calibre12">Open your browser and navigate to the AWS CloudFormation console at <a href="https://console.aws.amazon.com/cloudformation" target="_blank" class="calibre10">https://console.aws.amazon.com/cloudformation</a>. You should see the <span>AWS CloudFormation console dashboard.</span></li>
<li value="2" class="calibre12"><span>To work with CloudFormation Designer, click on the </span><span>Design template</span> <span>button at the top of  the dashboard. </span>You should have the following CloudFormation Designer form:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone45" src="../images/00057.jpeg"/></div>
<div class="packt_figref">Figure 3.10: A form for CloudFormation designer</div>
<ol start="3" class="calibre14">
<li value="3" class="calibre12">You should see a list of AWS resource types on the left (see <em class="calibre24">Figure 3.10</em>). Find the S3 bucket on the list and drag it onto the right panel, as shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone46" src="../images/00058.jpeg"/></div>
<div class="packt_figref">Figure 3.11: Adding Amazon S3 into designer</div>
<ol start="4" class="calibre14">
<li value="4" class="calibre12">After dropping the AWS resource type into the right panel, there will be skeleton scripts on bottom.</li>
</ol>
<p class="calibre2"> </p>
<ol start="5" class="calibre14">
<li value="5" class="calibre12">Clicking on the <span>Properties</span> tab, you should see JSON or YAML scripts which are generated from the CloudFormation Designer.</li>
</ol>
<ol start="6" class="calibre14">
<li value="6" class="calibre12">Upload the template to Amazon S3 by clicking the cloud with the up-arrow icon. You should get a dialog box, which is shown in <em class="calibre24">Figure 3.12</em>.</li>
<li value="7" class="calibre12">Click the Amazon S3 bucket tab, fill in the template name, such as <kbd class="calibre13">mysimples3.template</kbd>, and click on the <span>Save</span> button:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone47" src="../images/00059.jpeg"/></div>
<div class="packt_figref">Figure 3.12: Saving the template to the Amazon S3 bucket</div>
<ol start="8" class="calibre14">
<li value="8" class="calibre12">You should get a dashboard for creating a stack. Since we have uploaded the template to Amazon S3, the dashboard has selected the URL on Amazon S3, as shown in the following screenshot. Click on the <span>Next</span> button:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone48" src="../images/00060.jpeg"/></div>
<div class="packt_figref">Figure 3.13: Uploading a designer to create a stack</div>
<ol start="9" class="calibre14">
<li value="9" class="calibre12">Follow the instructions until you review configurations, as shown in the following screenshot:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone49" src="../images/00061.jpeg"/></div>
<div class="packt_figref">Figure 3.14: Confirmation for creating CloudFormation</div>
<ol start="10" class="calibre14">
<li value="10" class="calibre12">AWS CloudFormation generates Amazon S3 based on your template. You can verify it by checking it on the Amazon S3 console:</li>
</ol>
<div class="cdpaligncenter"><img class="alignnone50" src="../images/00062.jpeg"/></div>
<div class="packt_figref">Figure 3.15: Amazon S3 is created from CloudFormation designer</div>
<p class="calibre2">We have finished creating the CloudFormation template and deploying it to AWS CloudFormation. You can now perform other experiments with various resource types.</p>
<p class="calibre2">Next, we'll work with template descriptions.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Giving a template description</h1>
                
            
            <article>
                
<p class="calibre2">The CloudFormation template provides the <kbd class="calibre13">Description</kbd> attribute to display information about your template. You must set a description as a literal string that is between 0 and 1,024 bytes in length. You can see our sample implementation for the <kbd class="calibre13">Description</kbd> attribute. A sample program for JSON is as follows:</p>
<pre class="calibre19">"AWSTemplateFormatVersion": "2010-09-09",<br class="title-page-name"/>    "Description": "Amazon S3 with custom Bucket name",<br class="title-page-name"/>    "Parameters": { <br class="title-page-name"/>      "YourBucketName":{<br class="title-page-name"/>          "Description": "Amazon S3 Bucket name",<br class="title-page-name"/>          "Type": "String"<br class="title-page-name"/>      }<br class="title-page-name"/>    }</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">For YAML, you can implement it with the following scripts:</p>
<pre class="calibre19">AWSTemplateFormatVersion:<br class="title-page-name"/>  "2010-09-09"<br class="title-page-name"/>Description:<br class="title-page-name"/>  "Amazon S3 with custom Bucket name"<br class="title-page-name"/>Parameters:<br class="title-page-name"/>  YourBucketName:<br class="title-page-name"/>    Description:<br class="title-page-name"/>      "Amazon S3 Bucket name"<br class="title-page-name"/>    Type:</pre>
<p class="calibre2">This attribute is optional. When you apply words on the <kbd class="calibre13">Description</kbd> attribute on the template, you can see it when you review the template. See <em class="calibre17">Figure 3.7</em> for more information. </p>
<p class="calibre2">Next, we'll learn how to select a value from various options in CloudFormation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Selecting the input from options</h1>
                
            
            <article>
                
<p class="calibre2">Sometimes, when you build an infrastructure in CloudFormation, you need input from users. In the previous section, we learned how to get input from users by filling in the Amazon S3 bucket name. Now, we want to learn how to select input from various options. </p>
<p class="calibre2">The scenario can be illustrated to get an EC2 instance type size. Users can select the instance types that we defined on the <kbd class="calibre13">Parameters</kbd> section. You can see the following scripts for implementation in JSON:</p>
<pre class="calibre19">{<br class="title-page-name"/> "AWSTemplateFormatVersion": "2010-09-09",<br class="title-page-name"/> "Description": "Amazon EC2 instance with Amazon Linux AMI.",<br class="title-page-name"/> "Parameters": { <br class="title-page-name"/>    "InstanceType": {<br class="title-page-name"/>      "Description": "EC2 instance type",<br class="title-page-name"/>      "Type": "String",<br class="title-page-name"/>      "Default": "t1.micro",<br class="title-page-name"/>      "AllowedValues": [<br class="title-page-name"/>        "t1.micro",<br class="title-page-name"/>        "t2.nano",<br class="title-page-name"/>        "t2.micro",<br class="title-page-name"/>        "t2.small"<br class="title-page-name"/>      ],<br class="title-page-name"/>      "ConstraintDescription": "must be a valid EC2 instance type."<br class="title-page-name"/>    } <br class="title-page-name"/> }</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">For YAML, you can use these scripts:</p>
<pre class="calibre19">AWSTemplateFormatVersion: '2010-09-09'<br class="title-page-name"/>Description: Amazon EC2 instance with Amazon Linux AMI.<br class="title-page-name"/>Parameters:<br class="title-page-name"/>  InstanceType:<br class="title-page-name"/>  Description: EC2 instance type<br class="title-page-name"/>  Type: String<br class="title-page-name"/>  Default: t1.micro<br class="title-page-name"/>  AllowedValues:<br class="title-page-name"/>    - t1.micro<br class="title-page-name"/>    - t2.nano<br class="title-page-name"/>    - t2.micro<br class="title-page-name"/>    - t2.small<br class="title-page-name"/>  ConstraintDescription: must be a valid EC2 instance type.</pre>
<p class="calibre2">You can see that we defined four instance types, which are defined in the <kbd class="calibre13">AllowedValues</kbd> attribute. Users can select one of the <span class="calibre7">instance types</span><span class="calibre7">. </span>The following is a list of options:</p>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">t1.micro</kbd></li>
<li class="calibre12"><kbd class="calibre13">t2.nano</kbd></li>
<li class="calibre12"><kbd class="calibre13">t2.micro</kbd></li>
<li class="calibre12"><kbd class="calibre13">t2.small</kbd></li>
</ul>
<p class="calibre2">There are a lot of EC2 instance types. In this demo, I set only four types. You can find a list of types supported for EC2 instance here at  <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html" class="calibre10">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html</a>. You can put all instance types if you need them.</p>
<p class="calibre2">We can also set a default value for our options. We can use the <kbd class="calibre13">Default</kbd> attribute and set its value as the default value. For instance, I set <kbd class="calibre13">t1.micro</kbd> as the default value.</p>
<p class="calibre2">Now, we can set this selection from the user on the <kbd class="calibre13">InstanceType</kbd> attribute from <kbd class="calibre13">EC2Instance</kbd>. The following is a sample program in JSON:</p>
<pre class="calibre19">"Resources": {<br class="title-page-name"/>   "EC2Instance": {<br class="title-page-name"/>     "Type": "AWS::EC2::Instance",<br class="title-page-name"/>     "Properties": {<br class="title-page-name"/>        "InstanceType": {<br class="title-page-name"/>           "Ref": "InstanceType"<br class="title-page-name"/>        },</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">In the YAML format, do the following:</p>
<pre class="calibre19">Resources:<br class="title-page-name"/> EC2Instance:<br class="title-page-name"/>   Type: AWS::EC2::Instance<br class="title-page-name"/>   Properties:<br class="title-page-name"/>     InstanceType:<br class="title-page-name"/>       Ref: InstanceType</pre>
<p class="calibre2">Now, if you deploy this template file (<kbd class="calibre13">simple-ec2.json</kbd> or <kbd class="calibre13">simple-ec2.yaml</kbd>) to CloudFormation, you should see a selection option on the <kbd class="calibre13">Parameters</kbd> section, as shown in the following screenshot:</p>
<div class="cdpaligncenter"><img src="../images/00063.jpeg" class="calibre23"/></div>
<div class="packt_figref">Figure 3.16: Selecting instance type for EC2</div>
<p class="calibre2">This is a simple sample to get input from some options. You can practice more by exploring some AWS resources.</p>
<p class="calibre2">Next, we'll learn how to use the <kbd class="calibre13">Mappings</kbd> attribute on CloudFormation.</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Mapping parameters</h1>
                
            
            <article>
                
<p class="calibre2">Some AWS resources need specific attribute types that probably do not become accommodated from a user's input. In this case, we can utilize the <kbd class="calibre13">Mappings</kbd> attribute on CloudFormation. For instance, we can map the EC2 instance type based on region. We can declare this on the <kbd class="calibre13">Mapping</kbd> attribute as follows:</p>
<pre class="calibre19">"Mappings" : {<br class="title-page-name"/>   "RegionMap" : {<br class="title-page-name"/>     "us-east-1" : { "32" : "ami-6411e20d"},<br class="title-page-name"/>     "us-west-1" : { "32" : "ami-c9c7978c"},<br class="title-page-name"/>     "eu-west-1" : { "32" : "ami-37c2f643"},<br class="title-page-name"/>     "ap-southeast-1" : { "32" : "ami-66f28c34"},<br class="title-page-name"/>     "ap-northeast-1" : { "32" : "ami-9c03a89d"}<br class="title-page-name"/>   }<br class="title-page-name"/>}</pre>
<p class="calibre2">Here is the preceding code in YAML format:</p>
<pre class="calibre19">Mappings<br class="title-page-name"/> RegionMap<br class="title-page-name"/>  us-east-1<br class="title-page-name"/>    32: ami-6411e20d<br class="title-page-name"/>  us-west-1<br class="title-page-name"/>    32 : ami-c9c7978c<br class="title-page-name"/>  eu-west-1<br class="title-page-name"/>    32 : ami-37c2f643<br class="title-page-name"/>  ap-southeast-1<br class="title-page-name"/>    32 : ami-66f28c34<br class="title-page-name"/>  ap-northeast-1<br class="title-page-name"/>    32 : ami-9c03a89d</pre>
<p class="calibre2">As you can see, <kbd class="calibre13">RegionMap</kbd> will map various values based on region input, such as <kbd class="calibre13">us-east-1</kbd>, <kbd class="calibre13">us-west-1</kbd>, and <kbd class="calibre13">eu-west-1</kbd>. If we choose <kbd class="calibre13">eu-west-1</kbd>, we will obtain <kbd class="calibre13">ami-37c2f643</kbd> for the <kbd class="calibre13">32</kbd> architecture.</p>
<p class="calibre2">In a real program, we usually use the <kbd class="calibre13">Mappings</kbd> attribute with the <kbd class="calibre13">Fn::FindInMap</kbd> intrinsic function that's available at <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-findinmap.html" target="_blank" class="calibre10">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-findinmap.html</a>. This function returns the value corresponding to keys in a two-level map that is declared in the <kbd class="calibre13">Mappings</kbd> section. <kbd class="calibre13">Fn::FindInMap</kbd> can be defined as follows:</p>
<p class="calibre2"/>
<p class="calibre2">Here it is in JSON:</p>
<pre class="calibre19">{ "Fn::FindInMap" : [ "MapName", "TopLevelKey", "SecondLevelKey"] }</pre>
<p class="calibre2">And here it is in YAML:</p>
<pre class="calibre19">Fn::FindInMap: [ MapName, TopLevelKey, SecondLevelKey ]</pre>
<p class="calibre2">For instance, we want to set the <kbd class="calibre13">ImageId</kbd> attribute from <kbd class="calibre13">EC2Instance</kbd>. We can look up <kbd class="calibre13">AWSRegionArch2AMI</kbd> and <kbd class="calibre13">AWSInstanceType2Arch</kbd> from the <kbd class="calibre13">Mappings</kbd> attribute. You can see a sample implementation of <kbd class="calibre13">Fn::FindInMap</kbd> in the following JSON scripts:</p>
<pre class="calibre19">     "Mappings": {<br class="title-page-name"/>      "AWSInstanceType2Arch": {<br class="title-page-name"/>        "t1.micro": {<br class="title-page-name"/>          "Arch": "PV64"<br class="title-page-name"/>        },<br class="title-page-name"/>        "t2.nano": {<br class="title-page-name"/>          "Arch": "HVM64"<br class="title-page-name"/>        },<br class="title-page-name"/>        "t2.micro": {<br class="title-page-name"/>          "Arch": "HVM64"<br class="title-page-name"/>        },<br class="title-page-name"/>        "t2.small": {<br class="title-page-name"/>          "Arch": "HVM64"<br class="title-page-name"/>        }<br class="title-page-name"/>      },<br class="title-page-name"/>       "AWSRegionArch2AMI": {<br class="title-page-name"/>        "us-east-1": {<br class="title-page-name"/>          "PV64": "ami-2a69aa47",<br class="title-page-name"/>          "HVM64": "ami-6869aa05",<br class="title-page-name"/>          "HVMG2": "ami-61e27177"<br class="title-page-name"/>        },<br class="title-page-name"/>        "us-west-2": {<br class="title-page-name"/>          "PV64": "ami-7f77b31f",<br class="title-page-name"/>          "HVM64": "ami-7172b611",<br class="title-page-name"/>          "HVMG2": "ami-60aa3700"<br class="title-page-name"/>        },<br class="title-page-name"/>        "us-west-1": {<br class="title-page-name"/>          "PV64": "ami-a2490dc2",<br class="title-page-name"/>          "HVM64": "ami-31490d51",<br class="title-page-name"/>          "HVMG2": "ami-4b694d2b"<br class="title-page-name"/>        }<br class="title-page-name"/>      }<br class="title-page-name"/>    },<br class="title-page-name"/>    "Resources": {<br class="title-page-name"/>      "EC2Instance": {<br class="title-page-name"/>        "Type": "AWS::EC2::Instance",<br class="title-page-name"/>        "Properties": {<br class="title-page-name"/>          "InstanceType": {<br class="title-page-name"/>            "Ref": "InstanceType"<br class="title-page-name"/>          }, <br class="title-page-name"/>          "ImageId": {<br class="title-page-name"/>            "Fn::FindInMap": [<br class="title-page-name"/>              "AWSRegionArch2AMI",<br class="title-page-name"/>              {<br class="title-page-name"/>                "Ref": "AWS::Region"<br class="title-page-name"/>              },<br class="title-page-name"/>              {<br class="title-page-name"/>                "Fn::FindInMap": [<br class="title-page-name"/>                  "AWSInstanceType2Arch",<br class="title-page-name"/>                  {<br class="title-page-name"/>                    "Ref": "InstanceType"<br class="title-page-name"/>                  },<br class="title-page-name"/>                  "Arch"<br class="title-page-name"/>                ]<br class="title-page-name"/>              }<br class="title-page-name"/>            ]<br class="title-page-name"/>          }<br class="title-page-name"/>        }<br class="title-page-name"/>      }<br class="title-page-name"/>    } </pre>
<p class="calibre2">The following script is for YAML:</p>
<pre class="calibre19">Mappings:<br class="title-page-name"/>  AWSInstanceType2Arch:<br class="title-page-name"/>    t1.micro:<br class="title-page-name"/>      Arch: PV64<br class="title-page-name"/>    t2.nano:<br class="title-page-name"/>      Arch: HVM64<br class="title-page-name"/>    t2.micro:<br class="title-page-name"/>      Arch: HVM64<br class="title-page-name"/>    t2.small:<br class="title-page-name"/>      Arch: HVM64<br class="title-page-name"/>  AWSInstanceType2NATArch:<br class="title-page-name"/>    t1.micro:<br class="title-page-name"/>      Arch: NATPV64<br class="title-page-name"/>    t2.nano:<br class="title-page-name"/>      Arch: NATHVM64<br class="title-page-name"/>    t2.micro:<br class="title-page-name"/>      Arch: NATHVM64<br class="title-page-name"/>    t2.small:<br class="title-page-name"/>      Arch: NATHVM64<br class="title-page-name"/>  AWSRegionArch2AMI:<br class="title-page-name"/>    us-east-1:<br class="title-page-name"/>      PV64: ami-2a69aa47<br class="title-page-name"/>      HVM64: ami-6869aa05<br class="title-page-name"/>      HVMG2: ami-61e27177<br class="title-page-name"/>    us-west-2:<br class="title-page-name"/>      PV64: ami-7f77b31f<br class="title-page-name"/>      HVM64: ami-7172b611<br class="title-page-name"/>      HVMG2: ami-60aa3700<br class="title-page-name"/>    us-west-1:<br class="title-page-name"/>      PV64: ami-a2490dc2<br class="title-page-name"/>      HVM64: ami-31490d51<br class="title-page-name"/>      HVMG2: ami-4b694d2b<br class="title-page-name"/>Resources:<br class="title-page-name"/>  EC2Instance:<br class="title-page-name"/>    Type: AWS::EC2::Instance<br class="title-page-name"/>    Properties:<br class="title-page-name"/>      InstanceType:<br class="title-page-name"/>        Ref: InstanceType<br class="title-page-name"/>      ImageId:<br class="title-page-name"/>        Fn::FindInMap:<br class="title-page-name"/>        - AWSRegionArch2AMI<br class="title-page-name"/>        - Ref: AWS::Region<br class="title-page-name"/>        - Fn::FindInMap:<br class="title-page-name"/>          - AWSInstanceType2Arch<br class="title-page-name"/>          - Ref: InstanceType<br class="title-page-name"/>          - Arch</pre>
<p class="calibre2">Keep practicing with the <kbd class="calibre13">Mappings</kbd> attribute in CloudFormation. Next, we'll learn how to use intrinsic functions on the CloudFormation template.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Working with intrinsic functions</h1>
                
            
            <article>
                
<p class="calibre2">Intrinsic functions enable us to put logic functions inside CloudFormation templates. Technically, we have used intrinsic functions, for example <kbd class="calibre13">Ref</kbd> and <kbd class="calibre13">Fn::FindInMap</kbd>, in previous CloudFormation templates.</p>
<p class="calibre2">In general, Amazon AWS provides some intrinsic functions that we can apply to CloudFormation templates. The following is a list of intrinsic functions:</p>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">Fn::Base64 </kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::Cidr</kbd></li>
<li class="calibre12"><kbd class="calibre13">Condition Functions</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::FindInMap</kbd></li>
<li class="calibre12"><kbd class="calibre13"><kbd class="calibre36">Fn::GetAtt</kbd></kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::GetAZs</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::ImportValue</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::Join</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::Select</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::Split</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::Sub</kbd></li>
<li class="calibre12"><kbd class="calibre13">Ref</kbd></li>
</ul>
<p class="calibre2">The various intrinsic functions are explained as follows:</p>
<ul class="calibre11">
<li class="calibre12">The <kbd class="calibre13">Fn::Base64</kbd> intrinsic function returns the Base64 representation of the input string. <kbd class="calibre13">Fn::Base64</kbd> is defined as follows.</li>
</ul>
<p class="calibre25">Here it is in JSON:</p>
<pre class="calibre35">{ "Fn::Base64" : valueToEncode }</pre>
<p class="calibre25">And here it is in YAML:</p>
<pre class="calibre35">Fn::Base64: valueToEncode</pre>
<ul class="calibre11">
<li class="calibre12">The <kbd class="calibre13">Fn::Cidr</kbd> intrinsic function returns the specified CIDR address block. You can declare this function as follows.</li>
</ul>
<p class="calibre25">Here it is in JSON:</p>
<pre class="calibre26">{ "Fn::Cidr" : [ipBlock, count, sizeMask]}</pre>
<p class="calibre25">And here it is in YAML:</p>
<pre class="calibre35">Fn::Cidr: [ ipBlock, count, sizeMask ]</pre>
<ul class="calibre11">
<li class="calibre12">Conditional functions apply logical conditional on a CloudFormation template. We can use the following conditional functions:
<ul class="calibre37">
<li class="calibre12"><kbd class="calibre13">Fn::And</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::Equals</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::If</kbd></li>
<li class="calibre12"><kbd class="calibre13">Fn::Not</kbd></li>
<li class="calibre12"><kbd class="calibre13"><kbd class="calibre36">Fn::Or</kbd></kbd></li>
</ul>
</li>
</ul>
<p class="calibre25">For example, we want to decide the volume size of EC2. We check <kbd class="calibre13">CreateLargeSize</kbd> if this is true, and we set the volume size as <kbd class="calibre13">100</kbd>. Otherwise, we set the volume size as <kbd class="calibre13">10</kbd>. The following is a sample program for JSON:</p>
<pre class="calibre35">"NewVolume" : {<br class="title-page-name"/>  "Type" : "AWS::EC2::Volume",<br class="title-page-name"/>  "Properties" : {<br class="title-page-name"/>    "Size" : {<br class="title-page-name"/>      "Fn::If" : [<br class="title-page-name"/>        "CreateLargeSize",<br class="title-page-name"/>        "100",<br class="title-page-name"/>        "10"<br class="title-page-name"/>      ]}, <br class="title-page-name"/>  }<br class="title-page-name"/>}</pre>
<p class="calibre25">Here it is in YAML:</p>
<pre class="calibre35">NewVolume:<br class="title-page-name"/>  Type: "AWS::EC2::Volume"<br class="title-page-name"/>  Properties: <br class="title-page-name"/>    Size: <br class="title-page-name"/>      !If [CreateLargeSize, 100, 10]</pre>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">Fn::FindInMap</kbd> returns the value corresponding to keys in a two-level map that is declared in the <kbd class="calibre13">Mappings</kbd> section. We have also learned how to use this function.</li>
<li class="calibre12">The <kbd class="calibre13">Fn::GetAtt</kbd> intrinsic function returns the value of an attribute from a resource in the template. We define <kbd class="calibre13">Fn::GetAtt</kbd> in JSON as follows:</li>
</ul>
<pre class="calibre35">{ "Fn::GetAtt" : [ "logicalNameOfResource", "attributeName" ] }</pre>
<p class="calibre25">Here it is in the YAML format:</p>
<pre class="calibre35">Fn::GetAtt: [ logicalNameOfResource, attributeName ]</pre>
<ul class="calibre11">
<li class="calibre12"><kbd class="calibre13">Fn::GetAZs</kbd> returns an array that lists the <strong class="calibre1">Availability Zones</strong> (<strong class="calibre1">AZs</strong>) for a specified region. This function is useful when you are working with multiple regions.</li>
<li class="calibre12">The <kbd class="calibre13">Fn::Join</kbd> intrinsic function appends a set of values into a single value, separated by the specified delimiter.</li>
<li class="calibre12">The <kbd class="calibre13">Fn::Select</kbd> <span>function returns a single object from a list of objects by index. The  </span><kbd class="calibre13">Fn::Select</kbd> <span>function is used to split a string into a list of string values.</span></li>
<li class="calibre12"><kbd class="calibre13">Fn::Sub</kbd> <span>substitutes variables in an input string with values that you specify.</span></li>
</ul>
<div class="packt_infobox">For more information about intrinsic functions, check out <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference.html" target="_blank" class="calibre22">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference.html</a>.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Working with Metadata on the CloudFormation template</h1>
                
            
            <article>
                
<p class="calibre2">The CloudFormation template offers an optional attribute, <kbd class="calibre13">Metadata</kbd>, that provides details about the template. For example, you can include template implementation details about specific resources, such as the <kbd class="calibre13">AWS::ElasticLoadBalancing::LoadBalancer</kbd> resource. You can write the scripts as follows:</p>
<pre class="calibre19">  "Resources" : {<br class="title-page-name"/>    "ElasticLoadBalancer" : {<br class="title-page-name"/>      "Type" : "AWS::ElasticLoadBalancing::LoadBalancer",<br class="title-page-name"/>      "Metadata" : {<br class="title-page-name"/>        "Comment1" : "Configure the Load Balancer with a simple health check and cookie-based stickiness",<br class="title-page-name"/>        "Comment2" : "Use install path for healthcheck to avoid redirects - ELB healthcheck does not handle 302 return codes"<br class="title-page-name"/>      },</pre>
<p class="calibre2">You cannot change the <kbd class="calibre13">Metadata</kbd> attribute once you update the CloudFormation template.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">CloudFormation resources</h1>
                
            
            <article>
                
<p class="calibre2">The <kbd class="calibre13">Resources</kbd> attribute is one of the required attributes in the CloudFormation template. You can declare one or more AWS resources in your template. For instance, you can use the Amazon EC2 instance and an Amazon S3 bucket in one template. In general, the <kbd class="calibre13">Resources</kbd> attribute in CloudFormation can be defined as follows:</p>
<pre class="calibre19">"Resources" : {<br class="title-page-name"/>    "Logical ID" : {<br class="title-page-name"/>        "Type" : "Resource type",<br class="title-page-name"/>        "Properties" : {<br class="title-page-name"/>            Set of properties<br class="title-page-name"/>        }<br class="title-page-name"/>    }<br class="title-page-name"/>}</pre>
<p class="calibre2">Here it is in YAML:</p>
<pre class="calibre19">Resources:<br class="title-page-name"/>  Logical ID:<br class="title-page-name"/>    Type: Resource type<br class="title-page-name"/>    Properties:<br class="title-page-name"/>      Set of properties</pre>
<p class="calibre2"><kbd class="calibre13">Logical ID</kbd> is a unique ID for AWS resources. You can declare it in alphanumeric form (A-Z a-z 0-9). The <kbd class="calibre13">Type</kbd> attribute is defined for AWS resource types. You can check a list of resource types that you can use in the template. Check them out at <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html" target="_blank" class="calibre10">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html</a>.</p>
<p class="calibre2">Each resource type has properties. You probably want to set the resource properties on the <kbd class="calibre13">Properties</kbd> attribute. You should match between resource type and resource type properties.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">CloudFormation output</h1>
                
            
            <article>
                
<p class="calibre2">If we want to get responses from AWS resources after they're deployed, we can import those responses into your CloudFormation. We can use the <kbd class="calibre13">Outputs</kbd> attribute. It will return in response (to describe stack calls), or view on the AWS CloudFormation console.</p>
<p class="calibre2">The <kbd class="calibre13">Outputs</kbd> section consists of the key name <kbd class="calibre13">Outputs</kbd>, followed by a space and a single colon. You can declare a maximum of 60 output in a template.</p>
<p class="calibre2">We can declare the <kbd class="calibre13">Outputs</kbd> attribute in JSON as follows:</p>
<pre class="calibre19">"Outputs" : {<br class="title-page-name"/>  "Logical ID" : {<br class="title-page-name"/>    "Description" : "Information about the value",<br class="title-page-name"/>    "Value" : "Value to return",<br class="title-page-name"/>    "Export" : {<br class="title-page-name"/>      "Name" : "Value to export"<br class="title-page-name"/>    }<br class="title-page-name"/>  }<br class="title-page-name"/>}</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">Here it is in the YAML format:</p>
<pre class="calibre19">Outputs:<br class="title-page-name"/>  Logical ID:<br class="title-page-name"/>    Description: Information about the value<br class="title-page-name"/>    Value: Value to return<br class="title-page-name"/>    Export:<br class="title-page-name"/>      Name: Value to export</pre>
<p class="calibre2">For a demo, we want to retrieve the bucket name when we create an Amazon S3 bucket. We pass our bucket resource into the <kbd class="calibre13">Outputs</kbd> section. We can implement it with the following scripts in JSON:</p>
<pre class="calibre19">{<br class="title-page-name"/>    "AWSTemplateFormatVersion": "2010-09-09",<br class="title-page-name"/>    "Description": "Amazon S3 with output", <br class="title-page-name"/>    "Resources" : {<br class="title-page-name"/>        "MySimpleBucket" : {<br class="title-page-name"/>            "Type" : "AWS::S3::Bucket" <br class="title-page-name"/>        }<br class="title-page-name"/>        <br class="title-page-name"/>    },<br class="title-page-name"/>    "Outputs" : {<br class="title-page-name"/>        "BucketName" : {<br class="title-page-name"/>            "Value" : { "Ref" : "MySimpleBucket" }<br class="title-page-name"/>        }<br class="title-page-name"/>    }<br class="title-page-name"/>}</pre>
<p class="calibre2">Here it is in YAML:</p>
<pre class="calibre19">AWSTemplateFormatVersion: '2010-09-09'<br class="title-page-name"/>Description: Amazon S3 with custom Bucket name<br class="title-page-name"/>Resources:<br class="title-page-name"/>  MySimpleBucket:<br class="title-page-name"/>    Type: AWS::S3::Bucket <br class="title-page-name"/>Outputs:<br class="title-page-name"/>  BucketName:<br class="title-page-name"/>    Value:<br class="title-page-name"/>      Ref: MySimpleBucket</pre>
<p class="calibre2">Save this file as <kbd class="calibre13">simple-s3-outputs.json</kbd> or <span class="calibre7"><kbd class="calibre13">simple-s3-outputs.yaml</kbd>.</span></p>
<p class="calibre2">Then, you can upload this template to CloudFormation. If done, you should see the Amazon S3 bucket name on the <span class="calibre7">Outputs</span> tab in your stack:</p>
<p class="calibre2"/>
<div class="cdpaligncenter"><img class="alignnone51" src="../images/00064.jpeg"/></div>
<div class="packt_figref">Figure 3.17: Output messages from CloudFormation</div>
<p class="calibre2">You have learned about CloudFormation output. Keep practicing by applying some output from various AWS resources.</p>
<p class="calibre2">Next, we'll try to build EC2 using CloudFormation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Demo – building Amazon EC2 using AWS CloudFormation</h1>
                
            
            <article>
                
<p class="calibre2">In this section, we will build Amazon EC2 using CloudFormation. We explored some of the CloudFormation attributes for EC2 in previous sections. Just so you know, Amazon EC2 may not be free, so you may be charged.</p>
<p class="calibre2">Next, we'll prepare before we build EC2 on CloudFormation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Preparing</h1>
                
            
            <article>
                
<p class="calibre2">To work with the EC2 instance, we should have a key-pair to access EC2. If you don't have a key-pair yet, you can create it through the EC2 management <span class="calibre7">console</span>.</p>
<p class="calibre2"/>
<p class="calibre2">Open your browser and navigate to <a href="https://console.aws.amazon.com/ec2" target="_blank" class="calibre10">https://console.aws.amazon.com/ec2</a>. You should see the EC2 management console dashboard. You can click on the <span class="calibre7">Key Pairs</span> option on the left menu so that you get the following screen:</p>
<div class="cdpaligncenter"><img class="alignnone52" src="../images/00065.jpeg"/></div>
<div class="packt_figref">Figure 3.18: AWS EC2 console management</div>
<p class="calibre2">You can click on the <span class="calibre7">Create Key Pair</span> button to create a new key-pair. You should get a dialog box, as shown in the following screenshot. Fill in the <span class="calibre7">Key pair name</span> field and click on the <span class="calibre7">Create</span> button in the dialog box:</p>
<div class="cdpaligncenter"><img class="alignnone53" src="../images/00066.jpeg"/></div>
<div class="packt_figref">Figure 3.19: Creating a key-pair on AWS EC2 management <span>console </span></div>
<p class="calibre2">Now you have a key-pair that we can use in our EC2 instance. Next, we'll develop a CloudFormation template for EC2.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Developing a CloudFormation template</h1>
                
            
            <article>
                
<p class="calibre2">In this section, we'll develop a CloudFormation template for EC2. Some attributes have already been explained in the previous sections in this chapter. Since we need a key-pair on EC2, we set it on the <kbd class="calibre13">Parameters</kbd> attribute so that users can select their key-pairs. The following is a sample program in JSON:</p>
<pre class="calibre19">"KeyName": {<br class="title-page-name"/>        "Description": "Name of an existing EC2 KeyPair to enable SSH <br class="title-page-name"/>        access to the instance",<br class="title-page-name"/>        "Type": "AWS::EC2::KeyPair::KeyName",<br class="title-page-name"/>        "ConstraintDescription": "must be the name of an existing EC2 <br class="title-page-name"/>        KeyPair."<br class="title-page-name"/>},</pre>
<p class="calibre2">Here it is in the YAML format:</p>
<pre class="calibre19">  KeyName:<br class="title-page-name"/>    Description: Name of an existing EC2 KeyPair to enable SSH access  <br class="title-page-name"/>    to the instance<br class="title-page-name"/>    Type: AWS::EC2::KeyPair::KeyName<br class="title-page-name"/>    ConstraintDescription: must be the name of an existing EC2 KeyPair.</pre>
<p class="calibre2">A key-pair from the <kbd class="calibre13">KeyName</kbd> parameter will be used on the EC2 instance. We put it on the resource as follows:</p>
<pre class="calibre19">   "Resources": {<br class="title-page-name"/>      "EC2Instance": {<br class="title-page-name"/>        "Type": "AWS::EC2::Instance",<br class="title-page-name"/>        "Properties": {<br class="title-page-name"/>          ...<br class="title-page-name"/>          "KeyName": {<br class="title-page-name"/>            "Ref": "KeyName"<br class="title-page-name"/>          },</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">Here is it in YAML:</p>
<pre class="calibre19">   Resources:<br class="title-page-name"/>      EC2Instance: <br class="title-page-name"/>        Type: AWS::EC2::Instance<br class="title-page-name"/>        Properties: <br class="title-page-name"/>          ...<br class="title-page-name"/>          KeyName: <br class="title-page-name"/>            Ref: KeyName</pre>
<p class="calibre2">We also need a public IP address for the EC2 instance, so we access it from SSH. We define it on the <kbd class="calibre13">SSHLocation</kbd> section from the <kbd class="calibre13">Parameters</kbd> attribute. The JSON format is as follows:</p>
<pre class="calibre19">      "SSHLocation": {<br class="title-page-name"/>        "Description": "The IP address range that can be used to SSH to the EC2 instances",<br class="title-page-name"/>        "Type": "String",<br class="title-page-name"/>        "MinLength": "9",<br class="title-page-name"/>        "MaxLength": "18",<br class="title-page-name"/>        "Default": "0.0.0.0/0",<br class="title-page-name"/>        "AllowedPattern": "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})",<br class="title-page-name"/>        "ConstraintDescription": "must be a valid IP CIDR range of the form x.x.x.x/x."<br class="title-page-name"/>      }</pre>
<p class="calibre2">Here it is in YAML:</p>
<pre class="calibre19">SSHLocation:<br class="title-page-name"/>    Description: The IP address range that can be used to SSH to the EC2 instances<br class="title-page-name"/>    Type: String<br class="title-page-name"/>    MinLength: '9'<br class="title-page-name"/>    MaxLength: '18'<br class="title-page-name"/>    Default: 0.0.0.0/0<br class="title-page-name"/>    AllowedPattern: "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})"<br class="title-page-name"/>    ConstraintDescription: must be a valid IP CIDR range of the form x.x.x.x/x.</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">For details of the EC2 instance template, check out <kbd class="calibre13">ec2demo.json</kbd> and <kbd class="calibre13">ec2demo.yaml</kbd>. You can start deploying this template to AWS CloudFormation. We'll perform this task in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Deploying the template</h1>
                
            
            <article>
                
<p class="calibre2">After completing our CloudFormation template for EC2, you can upload it on AWS CloudFormation. You should select the <span class="calibre7">KeyName</span> and other options on the template:</p>
<div class="cdpaligncenter"><img class="alignnone54" src="../images/00067.jpeg"/></div>
<div class="packt_figref">Figure 3.20: Deploying EC2 through AWS CloudFormation</div>
<p class="calibre2">You probably set the IP address for SSH access on the <span class="calibre7">SSHLocation</span> parameter. Then, follow the instructions to deploy the template.</p>
<p class="calibre2"/>
<p class="calibre2"><span class="calibre7">After this has been created, you can check the progress of CloudFormation provision on the CloudFormation dashboard:</span></p>
<div class="cdpaligncenter"><img class="alignnone55" src="../images/00068.jpeg"/></div>
<div class="packt_figref">Figure 3.21: AWS EC2 instance has created</div>
<p class="calibre2"><span class="calibre7">After creating the EC2 instance, you can verify this on the EC2 management console. You should see the EC2 instance as shown in the following screenshot:</span></p>
<div class="cdpaligncenter"><img class="alignnone56" src="../images/00069.jpeg"/></div>
<div class="packt_figref">Figure 3.22: Verifying EC2 instance on EC2 management <span>console </span></div>
<p class="calibre2">Now, you can manage your EC2 instance on the management<span class="calibre7"> console </span>. If you want to modify your EC2 instance, you can update the CloudFormation template. Then, you can provision that template.</p>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">We have learned how to build AWS CloudFormation templates using JSON and YAML. We reviewed the <span class="calibre7">CloudFormation template format. Then, we looked at some attributes from the CloudFormation template. Finally, we deployed Amazon EC2 using the CloudFormation template.</span></p>
<p class="calibre2">In the next chapter, we will learn about CloudFormation StackSets.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Questions</h1>
                
            
            <article>
                
<ol class="calibre14">
<li value="1" class="calibre12">What is the CloudFormation template?</li>
<li value="2" class="calibre12">How do we develop the <span>CloudFormation template?</span></li>
<li value="3" class="calibre12">How do you implement AWS resources in the <span>CloudFormation template?</span></li>
</ol>


            </article>

            
        </section>
    </body></html>