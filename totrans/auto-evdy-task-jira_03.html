<html><head></head><body>
		<div><h1 id="_idParaDest-43"><em class="italic"><a id="_idTextAnchor038"/>Chapter 2</em>: Automating Jira Issues</h1>
			<p>In the previous chapter, we introduced you to some of the key concepts of automation rules in Jira and looked at the basic building blocks of rules. To really get to grips with automation rules, we need to understand how we can use those building blocks to automate issues within Jira, and this is what this chapter is all about.</p>
			<p>Here, we will learn how the various conditions work and when to use each of them. We will also cover how we can work with related issues, such as sub-tasks, linked issues, and stories within Epics. Importantly, you will learn how to use issue actions to make changes to your issue fields.</p>
			<p>We will also cover how to use the advanced field editing function for those rare occasions when the standard field editors are not sufficient and finally, we will look at how to transition issues through their workflows and how to create scheduled rules.</p>
			<p>We are going to cover the following main topics:</p>
			<ul>
				<li>Understanding conditions</li>
				<li>Working with branch rules and related issues</li>
				<li>Editing issue fields</li>
				<li>Advanced field editing</li>
				<li>Transitioning issues</li>
				<li>Scheduling tasks</li>
			</ul>
			<p>By the end of this chapter you should have a solid understanding of how you can use automation conditions and actions within your rules to effectively work with issues in Jira.</p>
			<h1 id="_idParaDest-44"><a id="_idTextAnchor039"/>Technical requirements</h1>
			<p>The requirements for this chapter are as follows:</p>
			<ul>
				<li><strong class="bold">Jira Cloud environment</strong>: If you don't already have access to Jira, you can create a free Jira Cloud account at <a href="https://www.atlassian.com/software/jira/free">https://www.atlassian.com/software/jira/free</a> and ensure that you have both Jira Software and Jira Service Management selected; or</li>
				<li><strong class="bold">Jira Server environment</strong>: If you are using Jira Server (available from <a href="https://www.atlassian.com/software/jira/download">https://www.atlassian.com/software/jira/download</a>), ensure that you have licenses for both Jira Software and Jira Service Management. In addition, you will also need to ensure that you install the <em class="italic">Automation for Jira</em> app, available from the Atlassian Marketplace.</li>
			</ul>
			<p>In both instances, you will need to have at least project administrator access to a Service Management project and a Scrum Software project in order to be able to follow the examples in this chapter. For the examples in this chapter, we have used the IT Service Management project template to create the Service Management project, and the Scrum Software project template to create the Software project.</p>
			<p>You can download the latest code samples for this chapter from this book's official GitHub repository at <a href="https://github.com/PacktPublishing/Automate-Everyday-Tasks-in-Jira">https://github.com/PacktPublishing/Automate-Everyday-Tasks-in-Jira</a>. The Code in Action videos for this chapter are available at <a href="https://bit.ly/2XPMdR7">https://bit.ly/2XPMdR7</a>.</p>
			<h1 id="_idParaDest-45"><a id="_idTextAnchor040"/>Understanding conditions</h1>
			<p>Conditions give us the ability to make our rules much more powerful and flexible as they enable us to <a id="_idIndexMarker057"/>both narrow the scope of our rules and, in the case of <strong class="bold">if/else </strong>blocks, alter the <a id="_idIndexMarker058"/>control flow of the rule.</p>
			<p>In this section, we will look at each of the conditions that we introduced in <a href="B16551_01_Final_ASB_ePub.xhtml#_idTextAnchor017"><em class="italic">Chapter 1</em></a>, <em class="italic">Key Concepts of Automation</em>, in more detail, exploring what each of them can do and how we can make use of them in automation rules.</p>
			<p>Let's start by taking a look at the <strong class="bold">Issue fields condition</strong>.</p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor041"/>The Issue fields condition</h2>
			<p>The Issue fields condition is the simplest of the conditions. It allows you to test most Jira fields against certain criteria without requiring the use of smart values or <strong class="bold">JQL</strong> (short for <strong class="bold">Jira Query Language</strong>).</p>
			<p>You can use <a id="_idIndexMarker059"/>it to compare a field against a value or set of values, and it can also be used to test the field against another field in either the same issue or certain related issues, such as a parent issue, an epic issue, a destination issue, or the issue that triggered the rule.</p>
			<p>In addition, these conditions can be chained together to form more complex conditions by using an additive operation.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">The Issue fields condition should be used ahead of any of the other conditions wherever possible, as it is not only simpler to configure, but it also has performance benefits over conditions such as the JQL and Advanced compare conditions.</p>
			<p>Let's now <a id="_idIndexMarker060"/>take a look at how we can use this condition in a rule.</p>
			<h3 id="_idParaDest-47">Creating a rule to generate sub-tasks for a story task</h3>
			<p>In this example, we'll assume a development team has a requirement that every user story requires <a id="_idIndexMarker061"/>the following three sub-tasks to be created at the same time that the user story is created:</p>
			<ul>
				<li>Develop the feature</li>
				<li>Perform QA tasks</li>
				<li>Document the feature</li>
			</ul>
			<p>We'll create a rule that adds these sub-tasks when a user story is created to demonstrate the Issue fields condition:</p>
			<ol>
				<li>If you're using Jira Cloud, navigate to <strong class="bold">Project settings</strong> and click on the <strong class="bold">Automation</strong> tab of your Software project, or, for Jira Server, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Project automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select <strong class="bold">Issue created</strong> as the trigger and then click <strong class="bold">Save</strong>.</li>
				<li>Next, select <strong class="bold">New condition</strong> and then select <strong class="bold">Issue fields condition</strong>.</li>
				<li>Set <strong class="bold">Field</strong> to <strong class="bold">Issue Type</strong>, <strong class="bold">Condition</strong> to <strong class="bold">equals</strong>, and finally, set <strong class="bold">Value</strong> to <strong class="bold">Story</strong>, and then click <strong class="bold">Save</strong>.</li>
				<li>Finally, select <code>Develop feature</code></p><p><code>Perform QA tasks</code></p><p><code>Document feature</code></p><p>Your rule should appear as follows:</p><div><img src="img/Figure_2.1_B16551.jpg" alt="Figure 2.1 – Completed Create sub-tasks rule&#13;&#10;"/></div><p class="figure-caption">Figure 2.1 – Completed Create sub-tasks rule</p></li>
				<li>Finally, name the rule <code>Create story sub-tasks</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule as seen in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_2.2_B16551_a.jpg" alt="Figure 2.2 – Naming and enabling the automation rule&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.2 – Naming and enabling the automation rule</p>
			<p>In this section, we have seen how we can use the Issue fields condition to create a decision point <a id="_idIndexMarker062"/>in a rule by simply selecting what we would like to evaluate from the available list of fields, conditions, and values.</p>
			<p>In the next section, we'll look at the JQL condition and how we can use this in our automation rules.</p>
			<h2 id="_idParaDest-48"><a id="_idTextAnchor042"/>JQL condition</h2>
			<p>The <strong class="bold">JQL condition</strong> allows you <a id="_idIndexMarker063"/>to test an issue against any valid JQL query. In addition to standard JQL, smart values can <a id="_idIndexMarker064"/>also be used in the query. We will cover smart values in more detail in <a href="B16551_03_Final_ASB_ePub.xhtml#_idTextAnchor065"><em class="italic">Chapter 3</em></a>, <em class="italic">Enhancing Rules with Smart Values</em>.</p>
			<p>Let's see how we can make use of the JQL condition in an example rule.</p>
			<h3 id="_idParaDest-49">Creating a rule to create a high-priority incident reminder</h3>
			<p>In this <a id="_idIndexMarker065"/>example, we want to ensure that the assigned team member updates a high-priority incident if it is about to breach and the reporter has not been informed of the progress of the incident within the last 15 minutes:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> tab, and then click the <strong class="bold">Create rule</strong> button.</li>
				<li>We want to check when the Time to resolution SLA is about to breach within the next 30 minutes, so we select the <strong class="bold">SLA threshold breached</strong> trigger. Select <strong class="bold">Time to resolution SLA</strong> and then select the <strong class="bold">will breach in the next</strong> option, ensuring 30 minutes is selected, and then click <strong class="bold">Save</strong>.</li>
				<li>Next, select <code>type = Incident AND priority in (Highest, High) AND updated &gt;= "-15m"</code></p><p>The <a id="_idIndexMarker066"/>following screenshot demonstrates how your rule should look at this point:</p><div><img src="img/Figure_2.2_B16551.jpg" alt="Figure 2.3 – Adding a JQL condition&#13;&#10;"/></div><p class="figure-caption">Figure 2.3 – Adding a JQL condition</p></li>
				<li>We want the rule to notify the assignee by email, so select <code>Issue {{issue.key}} is about to breach without update</code></p><p>Now, set the <code>The issue {{issue.key}} - {{issue.summary}} is about to breach in 30 minutes and requires an update.</code></p><p><code>Please add a comment to the above issue or update it as required.</code></p><p><code>Many thanks,</code></p><p><code>Jira Automation</code></p><p>Your <a id="_idIndexMarker067"/>rule should now look similar to the following screenshot:</p><div><img src="img/Figure_2.3_B16551.jpg" alt="Figure 2.4 – The High priority incident reminder rule&#13;&#10;"/></div><p class="figure-caption">Figure 2.4 – The High priority incident reminder rule</p></li>
				<li>Finally, click <code>High priority incident reminder</code>, and then click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this section, we have seen how we can use any valid JQL query as a condition in our rules.</p>
			<p>In the next section, we'll look at how we can use the <code>User</code> condition in automation rules.</p>
			<h2 id="_idParaDest-50"><a id="_idTextAnchor043"/>User condition</h2>
			<p>The <strong class="bold">User condition</strong> allows you <a id="_idIndexMarker068"/>to check whether a particular type of user exists, and whether they are in a particular role or group or are a certain type of user. This condition also allows you to add multiple criteria in a single condition and you can specify whether <em class="italic">all</em> criteria should match or only <em class="italic">one</em> of the criteria specified is sufficient.</p>
			<p>Where this condition really shines though is in a Service Management project, where a customer can be a reporter, a request participant, or a member of a customer organization, and the User condition provides us with a criterion, <em class="italic">User is a customer</em>, to check a user against all of these conditions in a single operation. In addition, we can also check whether a user belongs to a particular organization and apply specific actions accordingly.</p>
			<p>Let's now look at how we can use this condition in a rule.</p>
			<h3 id="_idParaDest-51">Creating a rule to add a relationship manager to customer requests</h3>
			<p>In this rule, we want to add the customer relationship manager as a watcher to any issues raised by <a id="_idIndexMarker069"/>users in our Service Management project from our more important customers. You will need to create the following organizations in your Service Management project and also create a few customers in each:</p>
			<ul>
				<li>Kate Price looks after <em class="italic">ACME</em> and <em class="italic">The Widget Co</em></li>
				<li>Pete Kramer looks after <em class="italic">Rain Forest Books</em><p class="callout-heading">Tip</p><p class="callout">To add users to Jira so as to follow this example, you will need to supply each user with a unique email address. If your mail server supports email sub-addressing or tags, such as Gmail or Outlook 365, you can use this feature to create unique email addresses that get delivered to your own email. For example, if your email address is <em class="italic">your.name@yourcompany.com</em>, using the email address <em class="italic">your.name+kateprice@yourcompany.com</em> will be both unique and deliver emails to your inbox with the email tag <em class="italic">kateprice</em>.</p></li>
			</ul>
			<p>Let's create our rule:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click the <strong class="bold">Automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select <strong class="bold">Issue created</strong> as the trigger and then click <strong class="bold">Save</strong>.</li>
				<li>Now, select <code>Reporter</code></p><p><code>is in organization</code></p><p><code>ACME, The Widget Co</code></p><p>Your condition should look as per the following screenshot:</p><div><img src="img/Figure_2.4_B16551.jpg" alt="Figure 2.5 – User condition for a reporter in an organization&#13;&#10;"/></div><p class="figure-caption">Figure 2.5 – User condition for a reporter in an organization</p></li>
				<li>Select <strong class="bold">New Action</strong>, followed by <strong class="bold">Manage watchers</strong>, select <strong class="bold">Kate Price</strong> in the <strong class="bold">Add these watchers</strong> field, and then click <strong class="bold">Save</strong>.</li>
				<li>Add <code>Reporter</code></p><p><code>is in organization</code></p><p><code>Rain Forest Books</code></p></li>
				<li>Select <strong class="bold">New Action</strong>, followed by <strong class="bold">Manage watchers</strong>, select <strong class="bold">Pete Kramer</strong> in the <strong class="bold">Add these watchers</strong> field, and then click <strong class="bold">Save</strong>. Your rule should look like the following screenshot:<div><img src="img/Figure_2.5_B16551.jpg" alt="Figure 2.6 – Adding relationship managers as watchers&#13;&#10;"/></div><p class="figure-caption">Figure 2.6 – Adding relationship managers as watchers</p></li>
				<li>Finally, name your rule <code>Add relationship manager to customer request</code> and then click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In <a id="_idIndexMarker071"/>this section, we looked at how the User condition allows us to validate the existence of a user and whether a user belongs to a particular group, role, or organization.</p>
			<p>Next, we'll take a look at the Related issues condition and how we can use this to test for issues related to the trigger issue.</p>
			<h2 id="_idParaDest-52"><a id="_idTextAnchor044"/>Related issues condition</h2>
			<p>The <strong class="bold">Related issues</strong> condition <a id="_idIndexMarker072"/>allows you to check the state of issues related to the current issue in the rule context, be that the issue that triggered the rule, or each issue in a branch rule.</p>
			<p>With this condition, you can check whether the related issues exist, whether all of them match a given JQL condition, or even whether only some of the related issues match the condition.</p>
			<p>Let's take a look at an example rule that uses the <strong class="bold">Related issues</strong> condition.</p>
			<h3 id="_idParaDest-53">Creating a rule to close parent bug or story tasks when all sub-tasks are complete</h3>
			<p>When an <a id="_idIndexMarker073"/>issue has sub-tasks, we need to autoclose the main issue when all the sub-tasks attain <strong class="bold">Done</strong> status. We'll need to use the Related issues condition to achieve this as follows:</p>
			<ol>
				<li value="1">In your Software project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> tab (or the <strong class="bold">Project automation</strong> tab if you're using Jira Server), and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select the <strong class="bold">Issue transitioned</strong> trigger and then select <strong class="bold">Done</strong> in the <strong class="bold">To</strong> status field and click <strong class="bold">Save</strong>.</li>
				<li>Then, select <code>Issue Type</code></p><p><code>equals</code></p><p><code>Sub-task</code></p></li>
				<li>Next, select <strong class="bold">Branch rule / related issues</strong> and then select <strong class="bold">Parent</strong> as <strong class="bold">Type of related issue</strong>.</li>
				<li>Now select <code>Sub-tasks</code></p><p><code>All match specified JQL</code></p><p><code>status = Done</code></p><p>Your rule should now look similar to the following screenshot:</p><div><img src="img/Figure_2.6_B16551.jpg" alt="Figure 2.7 – Configuring the Related issues condition&#13;&#10;"/></div><p class="figure-caption">Figure 2.7 – Configuring the Related issues condition</p></li>
				<li>Then, select <strong class="bold">New action</strong> followed by <strong class="bold">Transition issue</strong>. In this case, the parent issue, either <strong class="bold">Bug</strong> or <strong class="bold">Story</strong>, shares the same final status as the sub-tasks, so we can leave <strong class="bold">Destination status</strong> as <strong class="bold">Copy from trigger issue</strong>.</li>
				<li>Click <code>Close parent when sub-tasks complete</code>, and then click <strong class="bold">Turn it on</strong> to save and enable the rule.<p class="callout-heading">Tip</p><p class="callout">When a rule needs to work with related issues in other projects, it needs to be able to execute in those projects that contain the related issues and the rule should therefore be either a global or multi-project rule.</p><p class="callout">This means that only Jira global administrators will be able create and manage these rules.</p></li>
			</ol>
			<p>In this section, we have seen how to use the Related issues condition to perform actions against issues related to the issue that triggered the automation rule.</p>
			<p>In the next section, we'll take a look at the Advanced compare condition.</p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor045"/>Advanced compare condition</h2>
			<p>For most rules, the Issue fields condition will be adequate; however, there will be times when you <a id="_idIndexMarker075"/>need that extra bit of flexibility when writing rules and this is where the <strong class="bold">Advanced compare condition</strong> comes in. This condition allows you to use compare smart values, functions and regular expressions against smart values or functions!</p>
			<p>We will be looking at smart values and functions in detail in <a href="B16551_03_Final_ASB_ePub.xhtml#_idTextAnchor065"><em class="italic">Chapter 3</em></a>, <em class="italic">Enhancing Rules with Smart Values</em>, so for now, let's take a look at a rule that uses this condition.</p>
			<p>Let's take a look at how we use the Advanced compare condition in an example rule.</p>
			<h3 id="_idParaDest-55">Creating a rule to reopen an issue when the reporter creates a comment</h3>
			<p>In most cases, when a customer creates a request, the service desk team, or indeed an automation <a id="_idIndexMarker076"/>rule, will resolve the request without further input from the customer. In some cases, however, the request may not have been resolved to the customer's satisfaction and instead of creating a new request, we want to be able to reopen the original request when a new comment is added by the customer who opened the request.</p>
			<p>Let's see how we can leverage the Advanced compare condition to achieve this:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click the <strong class="bold">Automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Then, select the <strong class="bold">Issue commented</strong> trigger and click <strong class="bold">Save</strong>.</li>
				<li>Next, select <code>{{comment.author.accountId}}</code></p><p><code>equals</code></p><p><code>{{issue.reporter.accountId}}</code></p><p>Your condition should look like the following screenshot:</p><div><img src="img/Figure_2.7_B16551.jpg" alt=""/></div><p class="figure-caption">Figure 2.8 – Configuring the Advanced compare condition</p><p class="callout-heading">Tip</p><p class="callout">The <strong class="bold">accountId</strong> field for users is only applicable to Jira Cloud. If you are using Jira Server or Jira Data Center, you will need to use <em class="italic">{{comment.author}}</em> and <em class="italic">{{issue.reporter}}</em> instead.</p></li>
				<li>Then, select <code>Status</code></p><p><code>equals</code></p><p><code>Resolved</code></p></li>
				<li>Now select <strong class="bold">New action</strong>, then <strong class="bold">Transition issue</strong>, and then set the <strong class="bold">Destination status</strong> field to <strong class="bold">In Progress</strong> and click <strong class="bold">Save</strong>.</li>
				<li>Finally, name your rule <code>Re-open ticket on reporter comment</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this section, we looked at when we should use the Advanced compare condition and how it allows us to compare items using smart values.</p>
			<p>In the following section, we'll explore the <strong class="bold">if/else</strong> block and how we can use it to perform alternate actions based on different conditions.</p>
			<h2 id="_idParaDest-56"><a id="_idTextAnchor046"/>If/else block</h2>
			<p>The if/else <a id="_idIndexMarker078"/>statement is arguably the most powerful condition in the automation toolbox. It allows us to perform alternate actions based on whether the specified conditions match.</p>
			<p>Let's take a look at how we can use the <strong class="bold">if/else</strong> block in an example rule.</p>
			<h3 id="_idParaDest-57">Creating a rule to define an incident priority matrix</h3>
			<p>The correct prioritization of an incident is critical in determining the relative importance of an issue. Relying <a id="_idIndexMarker079"/>on users to select the correct priority of incidents results, more often than not, in a large number of incidents being incorrectly prioritized.</p>
			<p>It is more common practice to define the priority of incidents based on their impact and urgency instead. The following table shows a typical priority matrix based on the impact and urgency selected and we'll use this to help define our automation rule.</p>
			<div><div><img src="img/Figure_2.8_B16551.jpg" alt="Figure 2.9 – Incident priority matrix&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.9 – Incident priority matrix</p>
			<p>We are going to create our rule in a Service Management project created using the IT Service Management template. We have adjusted the custom fields, <strong class="bold">Impact</strong> and <strong class="bold">Urgency</strong>, with the options shown in the preceding incident priority matrix. You will also need to add these two fields to the <strong class="bold">Request</strong> form for the Incident Request types in your Service Management project.</p>
			<p>Using the preceding matrix as a reference, let's create our rule:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>We want this rule to trigger when the issue is created and also if any changes are made to either the <strong class="bold">Impact</strong> or <strong class="bold">Urgency</strong> fields, so we'll select the <strong class="bold">Field value changed</strong> trigger and then select the <strong class="bold">Impact</strong> and <strong class="bold">Urgency</strong> fields in the <strong class="bold">Fields to monitor for changes</strong> dropdown. We also want to trigger this rule only when an incident is created or edited, so we'll only select those two operations in the <strong class="bold">For</strong> dropdown <a id="_idIndexMarker080"/>and save our changes, as shown in the following screenshot:<div><img src="img/Figure_2.9_B16551.jpg" alt="Figure 2.10 – Incident priority matrix trigger&#13;&#10;"/></div><p class="figure-caption">Figure 2.10 – Incident priority matrix trigger</p></li>
				<li>Next, we'll add a <strong class="bold">New condition</strong> field and select <strong class="bold">If/else</strong> block.<p>In the <strong class="bold">If</strong> block, we are going to configure our first criterion to test for the highest priority, when both <strong class="bold">Impact</strong> and <strong class="bold">Urgency</strong> are set to <strong class="bold">High</strong>.</p></li>
				<li>Select <strong class="bold">Add conditions…</strong>, then <strong class="bold">Issue fields condition</strong>, set <strong class="bold">Field</strong> to <strong class="bold">Impact</strong>, <strong class="bold">Condition</strong> to <strong class="bold">Equals</strong>, select <strong class="bold">High</strong> in the <strong class="bold">Value</strong> field, and then repeat the exact same steps for the <strong class="bold">Urgency</strong> field.<p>Your rule should now look similar to the following screenshot:</p><div><img src="img/Figure_2.10_B16551.jpg" alt="Figure 2.11 – Configuring the If block&#13;&#10;"/></div><p class="figure-caption">Figure 2.11 – Configuring the If block</p></li>
				<li>Now, we <a id="_idIndexMarker081"/>need to add the action to perform when the preceding condition is met, so select <strong class="bold">New action</strong>, followed by <strong class="bold">Edit issue</strong>, find the <strong class="bold">Priority</strong> field in the <strong class="bold">Choose fields to set…</strong> dropdown, set <strong class="bold">Value</strong> to <strong class="bold">Highest</strong>, and then click <strong class="bold">Save</strong>.<div><img src="img/Figure_2.11_B16551.jpg" alt="Figure 2.12 – Editing the issue priority field&#13;&#10;"/></div><p class="figure-caption">Figure 2.12 – Editing the issue priority field</p></li>
				<li>Let's <a id="_idIndexMarker082"/>build out the rest of the matrix. Click on <strong class="bold">Add else</strong> in the <strong class="bold">Rule-chain</strong> view and then on <strong class="bold">Add conditions</strong>, followed by <strong class="bold">Issue fields condition</strong>. Set <strong class="bold">Field</strong> to <strong class="bold">Impact</strong>, <strong class="bold">Condition</strong> to <strong class="bold">Equals</strong>, and <strong class="bold">Value</strong> to <strong class="bold">High</strong>. Repeat for the <strong class="bold">Urgency</strong> field, setting <strong class="bold">Value</strong> to <strong class="bold">Medium</strong>, and then click <strong class="bold">Save</strong>.</li>
				<li>We need to add the action to perform when the <strong class="bold">else</strong> block condition is satisfied, so click on <strong class="bold">New action</strong>, followed by <strong class="bold">Edit issue</strong>. Then, set the <strong class="bold">Priority</strong> field to <strong class="bold">High</strong> in line with the preceding matrix:<div><img src="img/Figure_2.12_B16551.jpg" alt="Figure 2.13 – Adding the first Else-if block&#13;&#10;"/></div><p class="figure-caption">Figure 2.13 – Adding the first Else-if block</p></li>
				<li>Repeat <em class="italic">steps 6</em> and <em class="italic">7</em> for the remaining priorities in the incident priority matrix shown previously. You should end up with one <strong class="bold">If</strong> block followed by eight <strong class="bold">Else-if</strong> blocks <a id="_idIndexMarker083"/>corresponding to each intersection of <strong class="bold">Impact</strong> and <strong class="bold">Urgency</strong> in the priority matrix.</li>
				<li>Finally, name the rule <strong class="bold">Incident priority matrix</strong>, and click <strong class="bold">Turn it on</strong> to save and enable it.</li>
			</ol>
			<p>In this section, we have seen how we can use conditions to ensure we target the correct issues in our rule, and we have also learned how to control the flow of a rule using the powerful <strong class="bold">If</strong>/<strong class="bold">else</strong> block. </p>
			<p>Next, we'll take a look at branch rules and how to work with related issues.</p>
			<h1 id="_idParaDest-58"><a id="_idTextAnchor047"/>Working with branch rules and related issues</h1>
			<p>It is not often that issues exist in isolation. In fact, in many cases, there are always other issues that <a id="_idIndexMarker084"/>relate to any given issue. This could be in the form of sub-tasks, stories linked to a larger epic, or issues linked to other issues using relationships <a id="_idIndexMarker085"/>such as blocked, duplicated, and more.</p>
			<p>You will therefore often come across situations when creating automation rules where you need to perform actions against not only the issue that triggered the rule, but also against issues related to the source issue.</p>
			<p>This is where the <strong class="bold">Branch</strong> rule component and its companion condition, the <strong class="bold">Related issues</strong> condition, prove most useful, allowing you to create rules that can work across complex issue relationships.</p>
			<h2 id="_idParaDest-59"><a id="_idTextAnchor048"/>Branch rule/related issues</h2>
			<p>When we use the Branch rule component to perform actions against a related issue or list of issues, the rule <a id="_idIndexMarker086"/>no longer executes in a linear fashion, instead <a id="_idIndexMarker087"/>expanding into multiple sub-branches representing each related issue. When using smart values, which we will discuss in more detail in the next chapter, the smart value <em class="italic">{{issue}}</em> refers to the related issue in the current sub-branch, and not the issue that triggered the rule, which can be found instead using the smart value <em class="italic">{{triggerIssue}}</em>.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Branches on <em class="italic">multiple issues</em> run in separate processes in parallel and there is therefore no guarantee that any one branch will finish execution before the next.</p>
			<p class="callout">Additionally, the main branch will continue to execute before the sub-branches start.</p>
			<p class="callout">If you have only a single related issue, the main branch will block until the sub-branch has completed its execution.</p>
			<p>Let's now see how we can use the Branch rule/related issues component in an example rule.</p>
			<h3 id="_idParaDest-60">Creating a rule to keep an Epic task in sync with its user story tasks</h3>
			<p>A common <a id="_idIndexMarker088"/>requirement in development <a id="_idIndexMarker089"/>projects is for Epic to transition to <strong class="bold">In Progress</strong> when the first story it contains transitions to In Progress. This is a perfect scenario for the Branch rules component. Let's see how we can do this:</p>
			<ol>
				<li value="1">In your Software project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> tab (or the <strong class="bold">Project automation</strong> tab if you're using Jira Server), and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select the <strong class="bold">Issue transitioned</strong> trigger and then click <strong class="bold">Save</strong>.</li>
				<li>Leave the <strong class="bold">From status</strong> field blank and select <strong class="bold">In Progress</strong> in the <strong class="bold">To status</strong> field and then click <strong class="bold">Save</strong>.</li>
				<li>Next, select <code>Epic</code></p><p><code>Matches specified JQL</code></p><p><code>status != "In Progress"</code></p></li>
				<li>Now select <strong class="bold">Branch rule / related issues</strong> and set the <strong class="bold">Type of related issues</strong> field to <strong class="bold">Epic (Parent)</strong> and click <strong class="bold">Save</strong>.</li>
				<li>Finally, select <strong class="bold">New action</strong>, followed by <strong class="bold">Transition issue</strong>, choose <strong class="bold">In Progress</strong> as <strong class="bold">Destination status</strong>, and then click <strong class="bold">Save</strong>.<p>Your rule should now look as per the following screenshot:</p><div><img src="img/Figure_2.13_B16551.jpg" alt="Figure 2.14 – Moving Epic to In Progress when the story changes&#13;&#10;"/></div><p class="figure-caption">Figure 2.14 – Moving Epic to In Progress when the story changes</p></li>
				<li>As always, the final step is to name your rule <code>Sync Epic status to stories</code> and then click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>We have <a id="_idIndexMarker092"/>learned in this section <a id="_idIndexMarker093"/>how we can make use of the Branch rules component to create powerful rules enabling us to target issues related to the issue that triggered the rule.</p>
			<p>In the next section, we will look at editing issue fields in more detail. </p>
			<h1 id="_idParaDest-61"><a id="_idTextAnchor049"/>Editing issue fields</h1>
			<p>In the <a id="_idIndexMarker094"/>majority of your automation rules, you will be editing information in issues. In this section, we are going to cover some of the more common actions you will need to understand when creating your rules, including assignments, commenting on issues, linking issues to other issues and, of course, editing fields within issues.</p>
			<h2 id="_idParaDest-62"><a id="_idTextAnchor050"/>Assigning issues</h2>
			<p>One of the more tedious tasks usually encountered in Jira is having team members track a queue of <a id="_idIndexMarker095"/>unassigned issues and take ownership of these issues. The other common approach is to have someone such as a team lead go through these issues and apportion them off to members of the team based on certain criteria.</p>
			<p>We can instead use automation to handle these tasks for us, and the following list is a few of the capabilities we have at our disposal when it comes to assigning issues:</p>
			<ul>
				<li>Assigning based on current workload</li>
				<li>Assigning in a round-robin fashion</li>
				<li>Assigning to a previous assignee or commenter</li>
				<li>Assigning from a related issue or JQL query</li>
			</ul>
			<p>Let's take a look at how we can use this in a rule.</p>
			<h3 id="_idParaDest-63">Creating a rule to autoassign incoming bugs to developers</h3>
			<p>In this rule, we are going to assign any incoming issue of the bug type to the development team <a id="_idIndexMarker096"/>based on how much work each team member currently has, as long as the issue does not already have an assigned user. The development team are all members of the developer role in the project:</p>
			<ol>
				<li value="1">In your Software project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> tab (or the <strong class="bold">Project automation</strong> tab if you're using Jira Server), and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select the <strong class="bold">Issue created</strong> trigger and then click <strong class="bold">Save</strong>.</li>
				<li>Next we need to ensure that we only assign issues of the bug type. Select <strong class="bold">New condition</strong> and then choose <strong class="bold">Issue fields condition</strong>. Set the <strong class="bold">Field</strong> to <strong class="bold">Issue Type</strong>, <strong class="bold">Condition</strong> to <strong class="bold">Equals</strong>, <strong class="bold">Value</strong> to <strong class="bold">Bug</strong>, and then click <strong class="bold">Save</strong>.</li>
				<li>Now we need to execute assignment of the new issue. Do this by selecting <strong class="bold">New action</strong> and then choosing <strong class="bold">Assign issue</strong>.</li>
				<li>In the <strong class="bold">Assign the issue to</strong> field, select <strong class="bold">User</strong> in a role. Then, select <strong class="bold">Balanced workload</strong> in the <strong class="bold">Method to choose assignee</strong> field.<p>Because we don't want to reassign any issues that already have an assignee set, we need to add a further restriction using JQL. Type the following query in the <strong class="bold">JQL to restrict issues</strong> field:</p><pre>assignee = Unassigned</pre><p>And finally, set <strong class="bold">Role</strong> to <strong class="bold">Developers</strong> and then click <strong class="bold">Save</strong>:</p><div><img src="img/Figure_2.14_B16551.jpg" alt="Figure 2.15 – Assigning users using Balanced workload&#13;&#10;"/></div><p class="figure-caption">Figure 2.15 – Assigning users using Balanced workload</p></li>
				<li>In the <a id="_idIndexMarker097"/>final screen, name the rule <code>Auto assign incoming bugs</code> and then click <strong class="bold">Turn it on</strong> to save and enable the rule.<p class="callout-heading">Note</p><p class="callout">If you are using Jira Server, you must ensure that the rule actor has the <strong class="bold">Assign Issues</strong> permission in order to assign issues to users. In Jira Cloud, the default permissions are designed to ensure that users in the <em class="italic">atlassian-addons-project-access</em> role, such as <em class="italic">Automation app user</em>, have the necessary permissions to edit and assign issues and you should only need to adjust this if you have made changes to the default permissions.</p></li>
			</ol>
			<p>In this section, we have seen how to use the <strong class="bold">Assign issues</strong> action to assign issues to users using various scenarios, including based on individual workload, round-robin, randomly, or by using <a id="_idIndexMarker098"/>input from related issues or queries.</p>
			<p>In the next section, we'll look at how to use the <strong class="bold">Edit issue</strong> fields action to update issues.</p>
			<h2 id="_idParaDest-64"><a id="_idTextAnchor051"/>Edit issue fields</h2>
			<p>The ability <a id="_idIndexMarker099"/>to edit fields within an issue is one of the main objectives of automation rules and a number of rule actions provide this functionality, these being the following:</p>
			<ul>
				<li>Cloning an issue</li>
				<li>Editing an issue</li>
				<li>Transitioning an issue</li>
			</ul>
			<p>The field editors are very flexible and allow you to clear values from fields, set new values, and even copy values from other fields within the current issue, a parent issue, trigger issue, epic issue, or destination issue.</p>
			<p>In addition, you are able to edit multiple fields in a single action and most fields support smart values and functions.</p>
			<p>Let's look at a rule to see how to use this action in practice.</p>
			<h3 id="_idParaDest-65">Creating a rule to align user story due dates and fix versions</h3>
			<p>In this <a id="_idIndexMarker100"/>example, when starting <a id="_idIndexMarker101"/>a sprint, we will update all the stories within that sprint, set the due date to the end date of the sprint, and set the fix version to the next unreleased version in the project:</p>
			<ol>
				<li value="1">In your Scrum Software project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> tab (or the <strong class="bold">Project automation</strong> tab if you're using Jira Server), and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select <strong class="bold">Sprint started</strong>, choose your Scrum board from the <strong class="bold">Boards</strong> available and then click <strong class="bold">Save</strong>.</li>
				<li>Next, select the <strong class="bold">Branch rules / related issues</strong> component and, in the <strong class="bold">Type of related issues</strong> field, select <strong class="bold">Issues</strong> in the sprint.</li>
				<li>Then, select <code>{{sprint.endDate}}</code></p><p><code>Next unreleased version</code></p><p class="callout-heading">TIP</p><p class="callout">We have used a smart value for the <strong class="bold">Due date</strong> field in this example and you can find the list of smart values which can be used in a rule at <a href="https://support.atlassian.com/jira-software-cloud/docs/smart-values-general">https://support.atlassian.com/jira-software-cloud/docs/smart-values-general</a>. We will cover smart values and smart value functions in more detail in <a href="B16551_03_Final_ASB_ePub.xhtml#_idTextAnchor065"><em class="italic">Chapter 3</em></a>, <em class="italic">Enhancing Rules with Smart Values</em>.</p><p>Your rule should look like the following screenshot:</p><div><img src="img/Figure_2.15_B16551.jpg" alt="Figure 2.16 – Editing issue fields&#13;&#10;"/></div><p class="figure-caption">Figure 2.16 – Editing issue fields</p></li>
				<li>Finally, name your rule <code>Align story version and dates to sprint</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this <a id="_idIndexMarker102"/>section, we covered <a id="_idIndexMarker103"/>some of the more common actions you will be using when creating automation rules. We learned how you can use the different algorithms to assign issues to team members in a more intelligent fashion, and we also learned how we can use actions to make modifications to issue fields.</p>
			<p>In certain cases, we may need more flexibility to edit issues and, in the next section, we will explore how to use the available advanced field editing functionality to achieve this.</p>
			<h1 id="_idParaDest-66"><a id="_idTextAnchor052"/>Advanced field editing</h1>
			<p>Not all fields in Jira are created equal, and more especially in the case of custom fields provided by third-party apps. In these cases, where it is not possible to update the fields using the <a id="_idIndexMarker104"/>default functionality provided by the actions, an <strong class="bold">advanced field editor</strong> is provided that we can utilize to apply the field updates we require.</p>
			<p>In this section, we will take a look at the advanced field editor and how we can use it to take advantage of those situations when we cannot use the standard field editors.</p>
			<h2 id="_idParaDest-67"><a id="_idTextAnchor053"/>The advanced field editor</h2>
			<p>The advanced <a id="_idIndexMarker105"/>field editor is present in a number of actions under the <strong class="bold">More options</strong> section and allows you to specify the fields to edit using a JSON object using the format specified in Jira's REST API.</p>
			<p>The actions that allow advanced field editing are as follows:</p>
			<ul>
				<li>Cloning an issue</li>
				<li>Creating an issue</li>
				<li>Creating a Service Management request</li>
				<li>Editing an issue</li>
				<li>Transitioning an issue</li>
			</ul>
			<p>Before we look at how to use the advanced field editor, we'll first need to understand how the JSON object required by the field editor is structured. </p>
			<h2 id="_idParaDest-68"><a id="_idTextAnchor054"/>Understanding the JSON object</h2>
			<p>There are <a id="_idIndexMarker106"/>two attributes that we can use in the JSON object:</p>
			<ul>
				<li><strong class="bold">update</strong>: You can <a id="_idIndexMarker107"/>use any of the supported field operations, such as add, set or remove, in the update attribute. It is most useful for fields with multiple values where you want to add values to, or remove values from, the existing set of values.</li>
				<li><strong class="bold">fields</strong>: This <a id="_idIndexMarker108"/>attribute is a shortcut for calling the update attribute with the set operation.</li>
			</ul>
			<p>The fields you can use in the advanced editor within either the <strong class="bold">update</strong> or <strong class="bold">fields</strong> attribute depends on whether you're using the advanced editor when creating a new issue or editing an existing one, and these fields can be found by using one of the following REST API calls: </p>
			<ul>
				<li><em class="italic">createmeta: </em><code>https://&lt;yourjira.domain.com&gt;/rest/api/latest/issue/createmeta?projectKeys={projectKey}&amp;expand=projects.issuetypes.fields</code> or</li>
				<li><em class="italic">editmeta</em>:  <code>https://&lt;yourjira.domain.com&gt;/rest/api/latest/{issueKey}/editmeta</code></li>
			</ul>
			<p>The response from these calls will return a JSON object listing all the fields available when creating or <a id="_idIndexMarker109"/>editing the issue, including the possible operations and values for each. You can read more about finding fields using the REST API in the official documentation available at <a href="https://support.atlassian.com/jira-software-cloud/docs/advanced-field-editing-json/">https://support.atlassian.com/jira-software-cloud/docs/advanced-field-editing-json/</a>.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">These API calls return a list of fields on the corresponding create or edit screen configured for the project and issue type. If you cannot find a field in the returned JSON, you will need to add it to the corresponding screen first.</p>
			<p>Let's now take a look at how we could use the advanced field editor in a rule.</p>
			<h2 id="_idParaDest-69"><a id="_idTextAnchor055"/>Creating a rule to demonstrate the advanced field editor</h2>
			<p>To demonstrate <a id="_idIndexMarker110"/>how to use the advanced field editing functionality, we are going to use a somewhat contrived situation.</p>
			<p>For this rule, we'll look for the word <em class="italic">printer</em> in the summary or description field and then add the <strong class="bold">Printers</strong> component to the <strong class="bold">Component</strong> field, add a new label, and update the description field. Let's begin:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click the <strong class="bold">Automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Add the <strong class="bold">Issue created</strong> trigger and click <strong class="bold">Save</strong>.</li>
				<li>Add a new <strong class="bold">Issue fields condition</strong>, set <strong class="bold">Issue Type</strong> equal to <strong class="bold">Service Request</strong>, and then click <strong class="bold">Save</strong>.</li>
				<li>Add a new <code>summary ~ printer OR description ~ printer</code></p></li>
				<li>Add an <strong class="bold">Edit issue</strong> action, expand the <strong class="bold">More options</strong> section, and then set <strong class="bold">Additional fields</strong> to the <a id="_idIndexMarker111"/>following JSON:<pre>{
  "update": {
    "labels": [
      {
        "add": "label-printer"
      }
    ]
  },
  "fields": {
    "description": "{{issue.description}}\n\nUpdated by Automation Rule",
    "components": [
      {
        "name": "Printers"
      }
    ]
  }
}</pre><p class="callout-heading">TIP</p><p class="callout">The JSON structure used in the advanced field editor is based on the Jira REST API which you can learn more about at <a href="https://developer.atlassian.com/cloud/jira/platform/rest">https://developer.atlassian.com/cloud/jira/platform/rest</a> for Jira Cloud and at <a href="https://developer.atlassian.com/server/jira/platform/rest-apis">https://developer.atlassian.com/server/jira/platform/rest-apis</a> for Jira Server and Jira Data Center.</p></li>
				<li>Your rule should look similar to the following screenshot:<div><img src="img/Figure_2.16_B16551.jpg" alt="Figure 2.17 – Advanced field editing rule&#13;&#10;"/></div><p class="figure-caption">Figure 2.17 – Advanced field editing rule</p></li>
				<li>Finally, click <code>Advanced field editing example</code>, and then click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this section, we have learned how to use the advanced field editor to update issue fields when the <a id="_idIndexMarker112"/>default field editors are not sufficient. We have also learned how to leverage the REST API to understand which fields are available and how to correctly format the JSON data in the advanced editor.</p>
			<p>In the following section, we will look at how to transition an issue through a workflow using automation.</p>
			<h1 id="_idParaDest-70"><a id="_idTextAnchor056"/>Transitioning issues</h1>
			<p>Jira, whether you're working in a Software, Service Management or Business project, is all about being able <a id="_idIndexMarker113"/>to track the progress of an issue through a particular workflow. The ability <a id="_idIndexMarker114"/>to automate the <strong class="bold">transitioning</strong> of an issue through the various statuses in the workflow is therefore key to completing the loop in terms of working with issues.</p>
			<p>In this section, we are going to learn how we can use automation to react to state transitions <a id="_idIndexMarker115"/>of an issue through its workflow, as well as how we can transition an issue through subsequent statuses within its workflow.</p>
			<h2 id="_idParaDest-71"><a id="_idTextAnchor057"/>Transitions and workflows</h2>
			<p>As we have <a id="_idIndexMarker116"/>mentioned, we can use automation to transition an issue through a workflow and, to be able to achieve this, your rules must be aligned to that issue type's particular workflow.</p>
			<p>If we take a look at the following workflow, which represents a service request in a Jira Service Management project, we could automate the transition from <strong class="bold">In Progress</strong> to <strong class="bold">Pending</strong>; however, as there is no direct transition from <strong class="bold">In Progress</strong> to <strong class="bold">Closed</strong>, any automation rule attempting to perform this transition would result in the rule failing and an error being recorded in the audit log:</p>
			<div><div><img src="img/Figure_2.17_B16551.jpg" alt="Figure 2.18 – A service request workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.18 – A service request workflow</p>
			<p>As you can see from the workflow representation in the preceding diagram, automation rules can <a id="_idIndexMarker117"/>only transition issues through a workflow where a transition already exists between two statuses in that workflow. </p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Another point to consider is that the rule actor must have permission to perform the particular transition. If, for example, you have a condition on the workflow transition that restricts it to certain users or groups, you will need to adjust the condition to allow the rule actor to also be allowed to perform the transition.</p>
			<p>Let's look at how we can transition issues through their workflow in an automation rule.</p>
			<h2 id="_idParaDest-72"><a id="_idTextAnchor058"/>Creating a rule to automatically escalate requests to the correct team</h2>
			<p>Let's assume a service desk team is usually inundated with requests, so, in order to free up some of <a id="_idIndexMarker118"/>their time, we want to automatically escalate any requests that we know are infrastructure-related to a member of the infrastructure team. We'll use the workflow in <em class="italic">Figure 2.17</em> as a guide:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click the <strong class="bold">Automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select the <code>Waiting for support</code> in the <strong class="bold">To</strong> status field, and finally click <strong class="bold">Save</strong>.</li>
				<li>Next, we select <code>Components</code></p><p><code>contains any of</code></p><p><code>Cloud Storage Services, Data Center Services, Office Network</code></p></li>
				<li>Now select <strong class="bold">New action</strong>, then <strong class="bold">Transition issue</strong>, and set <strong class="bold">Destination status</strong> to <strong class="bold">Escalated</strong>.<p>At this point, we could choose to set the <strong class="bold">Assignee</strong> field to a particular user; however, we want to distribute any tasks evenly across the infrastructure team, so click <strong class="bold">Save</strong>.</p><p>Your rule should now look similar to the following screenshot:</p><div><img src="img/Figure_2.18_B16551.jpg" alt="Figure 2.19 – Transitioning an issue to ESCALATED&#13;&#10;"/></div><p class="figure-caption">Figure 2.19 – Transitioning an issue to ESCALATED</p></li>
				<li>Let's <a id="_idIndexMarker119"/>add the assignment next. Select <code>User in a group</code></p><p><code>Round-robin</code></p><p><code>Infrastructure Team</code></p></li>
				<li>Finally, name your rule <code>Auto-escalate requests</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this section, you have learned how to create rules to respond to state transitions of an issue, as well as how you can automatically transition an issue to the next status in its workflow.</p>
			<p>In the final section of this chapter, we will look at how you can use automations to schedule recurring tasks.</p>
			<h1 id="_idParaDest-73"><a id="_idTextAnchor059"/>Scheduling tasks</h1>
			<p>One of the first things people think about when you mention automation is the ability to create issues <a id="_idIndexMarker120"/>on a scheduled basis, and with automation in Jira, this is a relatively straightforward task to achieve. In conjunction with the rest of the components we have already discussed, this gives you great flexibility in terms of what you can achieve.</p>
			<p>In this section, we will look at how you can use the <strong class="bold">Scheduled</strong> trigger to perform a variety of tasks that need to be performed at defined intervals.</p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor060"/>Scheduled trigger</h2>
			<p>The <strong class="bold">Scheduled trigger</strong> allows us <a id="_idIndexMarker121"/>to run rules at specified intervals. We can use either a fixed rate interval in our rule, or we can use a <strong class="bold">cron</strong> expression to <a id="_idIndexMarker122"/>create a more complex schedule.</p>
			<p>Fixed rate intervals are pretty straightforward; you specify how often the rule should trigger in minutes, hours, or days, and the automation engine will initiate execution of the rule based on the interval.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">When you use a fixed rate interval of hours or days, the automation engine will consider the starting time of the interval to be the time you saved or updated the rule. For example, if you have a schedule running daily and you save the rule at 09:21, it will run at 09:21 every day until you edit and save the rule at a different time.</p>
			<p>Cron expressions give you greater flexibility over when your rule will trigger. Using cron expressions allows you to define schedules such as kicking off the rule every Monday and Friday at 8:30 a.m. You can <a id="_idIndexMarker123"/>find much more detailed information on creating cron expressions in Jira at <a href="https://support.atlassian.com/jira-software-cloud/docs/construct-cron-expressions-for-a-filter-subscription/">https://support.atlassian.com/jira-software-cloud/docs/construct-cron-expressions-for-a-filter-subscription/</a>.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Writing cron expressions is not always intuitive or straightforward. I'd recommend that you use a site such as CronMaker (<a href="https://www.cronmaker.com">https://www.cronmaker.com</a>) to help you build cron expressions that are compatible with Jira automation. Note that Jira cron expressions have a <strong class="bold">seconds</strong> field, whereas some cron expression generators only support resolution down to minutes.</p>
			<p>Let's first <a id="_idIndexMarker124"/>take a look at how we can use a fixed rate interval in a scheduled rule.</p>
			<h2 id="_idParaDest-75"><a id="_idTextAnchor061"/>Creating a rule to close out stale issues</h2>
			<p>In this <a id="_idIndexMarker125"/>example, we'll look at how we can resolve any requests that have been waiting for customer feedback for longer than 5 days:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select the <code>status = "Waiting for customer" AND updated &gt; -5d</code></p><p>Your rule should look like the following screenshot:</p><div><img src="img/Figure_2.19_B16551.jpg" alt="Figure 2.20 – Scheduling a fixed rate rule&#13;&#10;"/></div><p class="figure-caption">Figure 2.20 – Scheduling a fixed rate rule</p></li>
				<li>Next, we'll add a comment to the issue that will fire a notification to the customer that we're auto-closing their request, so we'll select <code>Dear {{issue.reporter.displayName}},</code></p><p><code>We haven't heard from you for a while, so we're closing this issue.</code></p><p><code>If you feel this is incorrect, please reply to this message and we'll re-open this request for you.</code></p><p><code>Kind regards,</code></p><p><code>The Service Team</code></p></li>
				<li>Then <a id="_idIndexMarker126"/>we'll transition the issue to <strong class="bold">Resolved</strong>. Select <strong class="bold">New action</strong>, <strong class="bold">Transition issue</strong>, and set the <strong class="bold">Destination status</strong> field to <strong class="bold">Resolved</strong>.</li>
				<li>Finally, click <code>Auto-resolve stale issues</code>, and then click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>Now that we've seen how the fixed rate interval works, let's take a look at how to use a cron expression to create a more precise schedule.</p>
			<h2 id="_idParaDest-76"><a id="_idTextAnchor062"/>Creating a rule to generate recurring start-of-week tasks</h2>
			<p>Next, let's <a id="_idIndexMarker127"/>look at how we can use the Scheduled trigger to create weekly tasks for the Service Management every Monday morning. We will create a single main task to track this and add sub-tasks as required to this main task. The due date for this task should be within 1 day:</p>
			<ol>
				<li value="1">In your Service Management project, navigate to <strong class="bold">Project settings</strong>, click the <strong class="bold">Automation</strong> tab, and then click on <strong class="bold">Create rule</strong>.</li>
				<li>Select the <code>0 0 9 ? * MON *</code></p><p>Your trigger should look like the following screenshot:</p><div><img src="img/Figure_2.20_B16551.jpg" alt="Figure 2.21 – Setting a scheduled trigger with a cron expression&#13;&#10;"/></div><p class="figure-caption">Figure 2.21 – Setting a scheduled trigger with a cron expression</p></li>
				<li>Select <code>Task</code></p><p><code>Start of week checks</code></p><p><code>{{now.plusDays(1)}}</code></p></li>
				<li>Next, select <strong class="bold">Branch rule / related issues</strong> and <strong class="bold">All created issues</strong> as <strong class="bold">Type of related issue</strong> and then click <strong class="bold">Save</strong>.</li>
				<li>Finally, click <strong class="bold">New action</strong>, <strong class="bold">Create sub-tasks</strong>, and add as many sub-tasks as required for the actions you want to check. For this example, we'll add two sub-tasks: <strong class="bold">Check weekend access logs</strong> and <strong class="bold">Other tasks</strong>.<p>Your rule should look similar to the following:</p><div><img src="img/Figure_2.21_B16551.jpg" alt="Figure 2.22 – Creating a scheduled weekly task&#13;&#10;"/></div><p class="figure-caption">Figure 2.22 – Creating a scheduled weekly task</p></li>
				<li>Finally, click <code>Start-of-week checks</code>, and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this <a id="_idIndexMarker129"/>section, we have seen how to use the Scheduled trigger to automate both the creation of tasks on a regular basis as well as how we can leverage scheduling to perform maintenance tasks at defined intervals.</p>
			<h1 id="_idParaDest-77"><a id="_idTextAnchor063"/>Summary</h1>
			<p>In this chapter, you have learned how we can use automation rules to work with issues in Jira. We have explored rule conditions in more detail and how you can use these to accurately target issues in your rules. </p>
			<p>Next, we introduced branch rules and learned how to author rules that target not only the issue that triggered a rule, but also its related issues, and then we introduced the most common actions involved in making changes to your issues.</p>
			<p>We then learned how to use the advanced field editor for those situations where the standard rule actions are not sufficient and also learned how to transition issues through their workflows automatically.</p>
			<p>Finally, we looked at how to use the scheduling capability of rules to perform tasks on a regular basis using both fixed rate scheduling and cron expressions for finer control over our schedules.</p>
			<p>These skills form the basis of working with issues in automation rules and we'll be using all of them throughout the rest of this book.</p>
			<p>In the next chapter, we'll be learning about smart values and smart value functions and how we can use these to take your automation rules to the next level.</p>
		</div>
	</body></html>