<html><head></head><body>
        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Security and Monitoring</h1>
            

            <article>
                
<div class="packtquote2">"Showing a strong success and visible benefits is key to getting others to agree to try your way of doing things.<br class="title-page-name"/>
                                                                                                                    - Frederic Rivain</div>
<p class="calibre2">Security is one of the most important parts of application life cycle management, hence, this service increases value in the context of DevOps.</p>
<p class="calibre2">In this chapter, we will cover user management, monitoring, and some sections of troubleshooting as well.</p>
<p class="calibre2">We will see how to create users and manage users in both Jenkins and VSTS. With open source and commercial tools, things don't change much in terms of functionality, but they might change with regard to the ease of doing it and extent to which support is available.</p>
<p class="calibre2">We will cover the following topics in this chapter:</p>
<ul class="calibre10">
<li class="calibre11">User management in Jenkins</li>
<li class="calibre11">User management in <strong class="calibre1">Visual Studio Team Services</strong> (<strong class="calibre1">VSTS</strong>)</li>
<li class="calibre11">Monitoring Jenkins and Microsoft Azure</li>
<li class="calibre11">Azure Web App troubleshooting and monitoring</li>
</ul>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Security in Jenkins and VSTS</h1>
            

            <article>
                
<p class="calibre2">Security is a major concern with respect to Jenkins and VSTS. However, it is not limited to that aspect only. Security is more about an overall perspective that includes application and infrastructure security. Infrastructure security becomes more crucial considering the fact that we operate in the cloud environment.</p>
<p class="calibre2">In this chapter, we will cover user management in Jenkins and VSTS.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">User management in Jenkins</h1>
            

            <article>
                
<p class="calibre2">Security is all about <strong class="calibre1">authentication</strong> and <strong class="calibre1">authorization</strong>, which are parts of the AAA trio:</p>
<div class="CDPAlignCenter"><img class="image-border83" src="../images/00052.jpeg"/></div>
<p class="calibre2">For security configuration, go to <span>Manage Jenkins</span> and click on <span>Configure Global Security</span> in Jenkins:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00307.jpeg"/></div>
<p class="calibre2">To enable security in Jenkins, click on <span>Enable Security</span>. By default, security is enabled in Jenkins:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00055.jpeg"/></div>
<p class="calibre2">We need to change <span>TCP port for JNLPagents</span> to <span>Random</span> so agents can be configured.</p>
<p class="calibre2">For <span>Access Control</span> in <span>Authentication</span>, select <span>Jenkins' own user database</span> in the <span>Security Realm</span> section.</p>
<p class="calibre2">Check <span>Allow users to sign up</span> so new users can create an account:</p>
<div class="CDPAlignCenter"><img class="image-border84" src="../images/00045.jpeg"/></div>
<p class="calibre2">In <span>Authorization</span>, select <span>Matrix-based security</span> to provide rights to all available users as required:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00059.jpeg"/></div>
<p class="calibre2">We can also select <span>Project-based matrix Authorization Strategy</span>. In this case, we need to go to the individual build job or project and go to its configuration:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00062.jpeg"/></div>
<p class="calibre2">Check <span>Enable project-based security</span> and give rights to individual users:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00064.jpeg"/></div>
<p class="calibre2">It often happens that we accidently lock our Jenkins by not providing rights to admin users specifically and then saving the security configuration.</p>
<p class="calibre2">In such a scenario, to restore Jenkins access, go to <span>JENKINS_HOME</span> in any operating system on which you have installed Jenkins.</p>
<p class="calibre2">Open <kbd class="calibre15">Config.xml</kbd>, change the value of <kbd class="calibre15">useSecurity</kbd> to <kbd class="calibre15">false</kbd> and restart Jenkins:</p>
<div class="CDPAlignCenter"><img class="image-border85" src="../images/00067.gif"/></div>
<p class="calibre2">In the next section, we will see user management in VSTS.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">User management in VSTS</h1>
            

            <article>
                
<p class="calibre2">For configuration and user management, follow these steps:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Open the newly created project <span>PetClinic</span> and click on the settings icon. On the <span>Project profile</span> page, the team information is available. Click on <span>PetClinic Team</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00069.jpeg"/></div>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">By default, the admin account is already available as a team member. Click on <span>+Add...</span> to add a new team member for collaboration:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00071.jpeg"/></div>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">Use sign-in addresses or group aliases and click on <span>Save changes</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00074.jpeg"/></div>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">Verify the team members of the <span>PetClinic Team</span> in the dashboard:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00313.jpeg"/></div>
<ol start="5" class="calibre17">
<li value="5" class="calibre11">Go to the main page of the team project and verify the <span>Team Members</span> section as well:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border86" src="../images/00079.jpeg"/></div>
<p class="calibre2">We have successfully added a team member to the main team of the project. This is how we can create a project and manage a team.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Monitoring Jenkins and Microsoft Azure</h1>
            

            <article>
                
<p class="calibre2">Azure App Service/Azure Web Apps comes with diagnose and solve problems to find out about resource health and solutions to some common problems.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Monitoring Jenkins</h1>
            

            <article>
                
<p class="calibre2">In Jenkins, we can monitor master and different agents with the use of a monitoring plugin:</p>
<ol class="calibre17">
<li value="1" class="calibre11">Go to <span>Manage Jenkins</span>|<span>Manage Plugins</span> and install <span>Monitoring Plugins</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00061.jpeg"/></div>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">After installing it successfully, go to <span>Manage Jenkins</span> and select <span>Monitoring of Jenkins master</span>.</li>
</ol>
<ol start="3" class="calibre17">
<li value="3" class="calibre11">Click on <span>Jenkins nodes</span> in the same section to watch monitoring of agents of Jenkins:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border87" src="../images/00082.jpeg"/></div>
<ol start="4" class="calibre17">
<li value="4" class="calibre11">Verify the statistics of JavaMelody monitoring taken at a specific timestamp in the browser:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00084.jpeg"/></div>
<ol start="5" class="calibre17">
<li value="5" class="calibre11">Click on <span>Other charts</span> to get more information on different aspects of Jenkins, such as buffer memory, threads count, swap space, and so on:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00086.jpeg"/></div>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00171.jpeg"/></div>
<ol start="6" class="calibre17">
<li value="6" class="calibre11">Scroll down and get detailed information on <span>Threads</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00208.jpeg"/></div>
<ol start="7" class="calibre17">
<li value="7" class="calibre11">Click on <span>Debugging logs</span> to get more details:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00255.jpeg"/></div>
<ol start="8" class="calibre17">
<li value="8" class="calibre11">In the bottom section, we can find the debugging logs:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border88" src="../images/00018.jpeg"/></div>
<ol start="9" class="calibre17">
<li value="9" class="calibre11">We can also monitor different <span>Build Jobs</span> using the <span>Build MonitorView</span> plugin.</li>
</ol>
<ol start="10" class="calibre17">
<li value="10" class="calibre11">Go to <span>Manage Jenkins</span>|<span>Manage Plugins</span> and install the <span>Build Monitor View</span> plugin:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00153.jpeg"/></div>
<ol start="11" class="calibre17">
<li value="11" class="calibre11">Once it is successfully installed, go to the <span>Jenkins</span> dashboard and click on the <span>+</span> sign.</li>
<li value="12" class="calibre11">Provide <span>View name</span>.</li>
<li value="13" class="calibre11">Select <span>Build Monitor View</span> and click <span>OK</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00174.jpeg"/></div>
<ol start="14" class="calibre17">
<li value="14" class="calibre11">Select the number of jobs you want to monitor.</li>
</ol>
<ol start="15" class="calibre17">
<li value="15" class="calibre11">Click on <span>OK</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00189.jpeg"/></div>
<ol start="16" class="calibre17">
<li value="16" class="calibre11">From a single window, we can monitor the status of all <span>Build Jobs</span> configured in <span>Build Monitor View</span>:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border89" src="../images/00203.jpeg"/></div>
<p class="calibre2">In this book, we have deployed applications on Microsoft Azure Web Apps too, so let's see how to monitor Azure Web Apps and troubleshoot in the next section.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Azure Web Apps troubleshooting and monitoring</h1>
            

            <article>
                
<p class="calibre2">Let's deep dive into <span>Diagnose and solve</span> problems to get more details:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00223.jpeg"/></div>
<ol class="calibre17">
<li value="1" class="calibre11">Go to Azure <span>App Services</span> and select the Azure web application that we created earlier. Click on <span>Diagnose and solve problems</span>.</li>
<li value="2" class="calibre11">Another pane will be opened that will have the <span>RESOURCE HEALTH</span> indicator and <span>SOLUTIONS TO COMMON PROBLEMS</span>.</li>
<li value="3" class="calibre11">We can see that the <span>MyPetClinic</span> Azure web application is available and running normally based on the status and the green indicator.</li>
</ol>
<p class="calibre2">In my encounters with Azure Web Apps, I have faced HTTP 5xx errors many times due to various reasons. It is also important to identify the root cause of an issue to fix it. However, there are some quick solution/suggestions given here:</p>
<ol class="calibre17">
<li value="1" class="calibre11">In <span>RESOURCE HEALTH</span>, click on <span>More details</span> to get the existing status of the <span>MyPetClinic</span> Azure web application:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00291.jpeg"/></div>
<ol start="2" class="calibre17">
<li value="2" class="calibre11">Click on <span>View History</span> to find details of the Azure web application, regarding when it was available and unavailable:</li>
</ol>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00310.jpeg"/></div>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Azure App Services - HTTP live traffic</h1>
            

            <article>
                
<p class="calibre2">In <span>SOLUTIONS TO COMMON PROBLEMS</span>, we can assess live traffic to know whether existing resources can manage the current load or not.</p>
<p class="calibre2">If live traffic is normal, then it may not be an issue and we should go a step further to troubleshoot the problem:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00034.jpeg"/></div>
<p class="calibre2">We can get HTTP live traffic based on one or all hostnames available in Azure <span>App Services</span>.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Azure App Services - CPU and memory consumption</h1>
            

            <article>
                
<p class="calibre2">We can also get details regarding CPU and memory percentage to find the performance of the Azure web application and whether it is required to go for scaling operations:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00049.jpeg"/></div>
<p class="calibre2">We already know that there is a main Azure web application, and other deployment slots are also available. We can get details of Azure Web Apps or the <span>Sites In Service Plan</span> too:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00037.jpeg"/></div>
<p class="calibre2">Here, we are looking at the details of the <span>MyPetClinic(dev)</span> deployment slot of Azure Web Apps:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00167.jpeg"/></div>
<p class="calibre2">At a time, we can pick and choose the slots or select all of them to see CPU and memory utilization in the <strong class="calibre1">App Service plan</strong> (<strong class="calibre1">ASP</strong>):</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00179.jpeg"/></div>
<p class="calibre2">Similarly, we can verify <span>Http Statistics</span> for the main Azure web application and deployment slots hosted in a specific ASP:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00004.jpeg"/></div>
<p class="calibre2">We can also verify <span>Network Statistics</span> for the main Azure web application and deployment slots hosted in a specific ASP:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00005.jpeg"/></div>
<p class="calibre2">If we keep the cursor on a specific location of the chart, then we will get all the details of that specific point for the main and other deployment slots:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00010.jpeg"/></div>
<p class="calibre2">So far, we have seen the diagnose and solve problems section. In the next section, we will look at details related to activity logs.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Azure App Services - Activity log</h1>
            

            <article>
                
<p class="calibre2"><span>Activity log</span> shows what actions have been performed in the Azure web application based on <span>Subscription</span>, <span>Resource group</span>, <span>Resource</span>, <span>Resource type</span>, <span>Operation</span>, <span>Timespan</span>, <span>Event category</span>, <span>Event severity</span>, and <span>Event initiated by:</span></p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00013.jpeg"/></div>
<p class="calibre2">We can see different operations, such as update, write, and delete operations.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Azure Application Insights for application monitoring</h1>
            

            <article>
                
<p class="calibre2">In the Azure resource management portal, go to Azure <span>App Services</span>, select the Azure web application, and go to the <span>MONITORING</span> section; click on <span>Application Insights</span>.</p>
<p class="calibre2"><span>Application Insights</span> helps us to identify and diagnose issues in Azure web applications. When we create an Azure web application, we have the option to create <span>Application Insights</span> associated with the Azure web application; if we haven't done it, then we can create a new Application Insights resource too for our Azure web application:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00315.jpeg"/></div>
<p class="calibre2">Once the <span>Application Insights</span> resource is created, we can access it from the Azure web application also. Let's try to check the availability of the Azure web application from different regions.</p>
<p class="calibre2">In the <span>INVESTIGATE</span> tab, click on <span>Availability</span>. There is no web test or data available:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00056.jpeg"/></div>
<p class="calibre2">Let's add a web test. Click on <span>+Add web test</span>. Provide <span>Test name</span>, <span>URLping test</span> in <span>Test type</span>, and <span>URL</span> to test the availability:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00065.jpeg"/></div>
<p class="calibre2">In <span>Test frequency</span>, select <span>5 minutes</span>, and in <span>Test locations</span>, select any five locations from where we want to test the availability of an Azure web application:</p>
<div class="CDPAlignCenter"><img class="image-border90" src="../images/00046.jpeg"/></div>
<p class="calibre2">Set <span>HTTP response: 200</span> as <span>Success criteria</span> and <span>Alerts</span> also. After all these configurations, click on <span>Create</span>:</p>
<div class="CDPAlignCenter"><img class="image-border91" src="../images/00169.jpeg"/></div>
<p class="calibre2">It will start pinging the Azure web application after some time, from the time zone we have configured in the web test. We can see <span>TOTAL SUCCESSFUL TESTS</span>, <span>TOTAL FAILED TESTS, AVERAGE RESPONSE TIME</span>, and other details:</p>
<div class="CDPAlignCenter"><img class="image-border6" src="../images/00072.jpeg"/></div>
<p class="calibre2">In the <span>Application Insights</span> portal, we can see the history of web tests as well.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Azure web application monitoring</h1>
            

            <article>
                
<p class="calibre2">We have seen different types of log files in the Kudu editor. Let's see them in the Azure portal.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Diagnostics logs</h1>
            

            <article>
                
<p class="calibre2">To enable or disable diagnostics logs, we need to go to Azure <span>App Services</span> in the Azure portal, click on the <span>MyPetClinic</span> Azure web application, and, in the <span>MONITORING</span> section, click on <span>Diagnostics logs</span>:</p>
<div class="CDPAlignCenter"><img class="image-border92" src="../images/00196.jpeg"/></div>
<p class="calibre2">We can enable or disable different kinds of logs based on the need and environment:</p>
<div class="CDPAlignCenter"><img class="image-border93" src="../images/00209.jpeg"/></div>
<p class="calibre2">Once changes are done, click on the <span>Save</span> button.</p>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    

        <section>

            <header>
                </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
            

            <article>
                
<p class="calibre2">Security and monitoring are concepts that are too vast to be accommodated in one chapter, as they cover different aspects at huge length.</p>
<p class="calibre2">In this chapter, we have covered some aspects of user management and monitoring in Jenkins and VSTS. We have also covered how to diagnose a problem and troubleshoot it in Microsoft Azure App Services or Azure Web Apps.</p>
<p class="calibre2">This is the end of our journey in this book; however, there is no end to education.</p>
<p class="calibre2">The famous quote from Jiddu Krishnamurti says:</p>
<div class="packtquote1">"There is no end to education. It is not that you read a book, pass an examination, and finish with education. The whole of life, from the moment you are born to the moment you die, is a process of learning"</div>


            </article>

            <footer class="calibre5">
                
            </footer>

        </section>
    
<p class="calibre2">This book was downloaded from AvaxHome!</p>
<p class="calibre2">Visit my blog with more new books:</p>
<p class="calibre2"><a href="https://tr.im/avaxhome" class="calibre4">https://avxhm.se/blogs/AlenMiler</a></p></body></html>