<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch08"/>Chapter 8. Configuring JIRA User Directories to Connect with LDAP, Crowd, and JIRA User Server</h1></div></div></div><p>In companies with thousands of employees, there are several internal tools and systems. There are tools to track time, leave management, and intranet portals. It's very difficult to manage user accounts on multiple applications; companies use <strong>Lightweight Directory Access Protocol </strong>(<strong>LDAP</strong>) servers for user management, where a single user account works on more than one tool and users don't need to remember multiple passwords. JIRA also supports integration with LDAP. This is a great feature; it really helps system administrators to manage users. Apart from LDAP, we will also discuss how to connect JIRA to another JIRA instance for user management, as well as for <strong>Crowd</strong>, which is a single sign-on software from Atlassian.</p><p>This chapter will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Authentication mechanism in JIRA</li><li class="listitem" style="list-style-type: disc">Allowing other applications to connect to JIRA</li><li class="listitem" style="list-style-type: disc">Synchronizing user and group information</li></ul></div><div><div><div><div><h1 class="title"><a id="ch08lvl1sec55"/>Authentication mechanism in JIRA</h1></div></div></div><p>JIRA is a web-based tool used by multiple users, each having different permissions depending on the group they are part of or what role they are performing in the project. JIRA has a built-in authentication mechanism known as <strong>JIRA internal directory</strong>, but it's possible to connect JIRA to external directories as well. Let's take a look at how this is done.</p><div><div><div><div><h2 class="title"><a id="ch08lvl2sec70"/>JIRA internal directory</h2></div></div></div><p>JIRA comes with an internal directory that is enabled by default; the first administrative user is a part of the internal directory, and, until you add another directory, all additional users are added in this internal directory. JIRA stores this in its own database.</p></div><div><div><div><div><h2 class="title"><a id="ch08lvl2sec71"/>Configuring LDAP</h2></div></div></div><p>LDAP is an application protocol to query and modify information in directory services. In medium-to large-scale companies, where there are hundreds or thousands of users, everyone has their e-mails, phone numbers, and other details stored on a directory server. Users can find each other in this directory. Each user's login details are also stored, and various applications can rely on directory services for authentication.</p><p>Instead of JIRA's internal authentication, it's possible to connect to existing directory services through LDAP:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to JIRA <strong>Administration</strong> | <strong>User management</strong> | <strong>User Directories</strong> (under <strong>USER DIRECTORIES</strong>). You will notice <strong>JIRA Internal Directory</strong> already added there, but after we add additional directories, such as LDAP or Crowd, the order in which the user is searched is defined using the <strong>Order</strong> column. Users may be present in one or more directories, but they will be searched for first in the directory that is listed at the top:<p>
</p><div><img src="img/image_08_001.jpg" alt="Configuring LDAP"/></div><p>
</p></li><li class="listitem">Click on <strong>Add Directory</strong>. A popup will appear. Select <strong>Microsoft Active Directory</strong> and click on <strong>Next</strong>.</li><li class="listitem">In the following screenshot, we need to configure the LDAP user directory. First, fill in the <strong>Server Settings</strong>:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Enter the <strong>Name</strong> as <code class="literal">Active Director server</code> or any other useful name.</li><li class="listitem" style="list-style-type: disc">Select the <strong>Directory Type</strong> as <strong>Microsoft Active Directory</strong>.</li><li class="listitem" style="list-style-type: disc">Enter the <strong>Hostname</strong> of your LDAP server.</li><li class="listitem" style="list-style-type: disc">Enter the <strong>Port</strong> number of your LDAP server.</li><li class="listitem" style="list-style-type: disc">Enter the <strong>Username</strong> of your LDAP server. It's usually in a format such as <code class="literal">user@domain.name</code> or <code class="literal">cn=username,dc=domain,dc=com</code>.</li><li class="listitem" style="list-style-type: disc">Enter the <strong>Password</strong>.</li></ul></div><p>
</p><div><img src="img/image_08_002.jpg" alt="Configuring LDAP"/></div><p>
</p></li><li class="listitem">Then, enter the <strong>LDAP Schema</strong> settings:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Enter <strong>Base DN</strong>; it's usually in the <code class="literal">dc=domain,dc=local</code> format. Ask your LDAP administrators for specific information:</li></ul></div><p>
</p><div><img src="img/image_08_003.jpg" alt="Configuring LDAP"/></div><p>
</p></li><li class="listitem">Now, set <strong>LDAP Permissions</strong> as <strong>Read Only</strong>, where the user information is only retrieved from the LDAP server. In this case, the password can only be changed from the LDAP server and not from the JIRA application. However, if you want users who are newly logged in to be automatically added to one or more JIRA groups, then select <strong>Read Only, with Local Groups</strong> and enter the name of the groups in the <strong>Default Group Memberships:</strong> field:<p>
</p><div><img src="img/image_08_004.jpg" alt="Configuring LDAP"/></div><p>
</p></li><li class="listitem">Click on the <strong>Save and Test</strong> button to save the configuration.</li></ol></div><p>Now, a new user who is already a part of the LDAP server can log in to the JIRA instance using the same username and password. Also, this user will be added to the additional JIRA groups that we configured previously.</p><div><div><div><div><h3 class="title"><a id="ch08lvl3sec19"/>Understanding Base DN</h3></div></div></div><p>The LDAP directory used in companies could have thousands of employees; it may not be necessary to give JIRA access to all the users in the company. For instance, consider a scenario when there are users in the U.S. as well as in Asia, and access of JIRA needs to be given only to users in the U.S. Now, LDAP also has its own groups known as domains that can be leveraged to limit access to JIRA.</p><p>Refer to the following table to understand the possible Base DN for corresponding LDAP domains:</p><div><table border="1"><colgroup><col/><col/><col/></colgroup><tbody><tr><td>
<p>
<strong>LDAP domain</strong>
</p>
</td><td>
<p>
<strong>Base DN</strong>
</p>
</td><td>
<p>
<strong>Remarks</strong>
</p>
</td></tr><tr><td>
<p>
<code class="literal">example.com</code>
</p>
</td><td>
<p>
<code class="literal">dc=example,dc=com</code>
</p>
</td><td>
<p>All users in the LDAP directory can access JIRA</p>
</td></tr><tr><td>
<p>
<code class="literal">us.example.com</code>
</p>
</td><td>
<p>
<code class="literal">dc=us,dc=example,dc=com</code>
</p>
</td><td>
<p>Only U.S. users can access JIRA</p>
</td></tr><tr><td>
<p>
<code class="literal">asia.example.com</code>
</p>
</td><td>
<p>
<code class="literal">dc=asia,dc=example,dc=com</code>
</p>
</td><td>
<p>Only Asian users can access JIRA</p>
</td></tr></tbody></table></div><p>Contact your JIRA administrator to understand the LDAP domain. Also, make sure that if you are using LDAP, then any user with an active account can log in to JIRA and your license limit can exhaust quickly.</p></div></div><div><div><div><div><h2 class="title"><a id="ch08lvl2sec72"/>Connecting to Crowd</h2></div></div></div><p>Crowd is another application from Atlassian for single sign-on. This application can be used to manage multiple user directories.</p><div><div><div><div><h3 class="title"><a id="ch08lvl3sec20"/>Implementing Atlassian Crowd</h3></div></div></div><p>Crowd supports various types of directory. It can use its own Crowd internal directory or it can also connect to the LDAP directory already used in the organization. As a first step, at least one of these directories should be configured in Crowd. Then, make sure the group that is required to authenticate the users is added in the directory that you add and configure in Crowd. For instance, <strong>jira-software-users</strong> is a group defined in JIRA. Users who are part of this group can login to JIRA. Just make sure this group is also added to your Crowd directory. Finally, to communicate with JIRA an application needs to be created in Crowd. Remember the application name and application password; you will need them when configuring Crowd in JIRA.</p><p>Organizations with an existing Crowd instance can connect their JIRA to utilize single sign-on:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to JIRA <strong>Administration</strong> | <strong>User management</strong> | <strong>User Directories</strong> (under <strong>USER DIRECTORIES</strong>).</li><li class="listitem">Click on the <strong>Add Directory</strong> button and select <strong>Directory Type:</strong> as <strong>Atlassian Crowd</strong>:<p>
</p><div><img src="img/image_08_005.jpg" alt="Implementing Atlassian Crowd"/></div><p>
</p></li><li class="listitem">On the next screen, fill in <strong>Server Settings</strong>:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Enter the <strong>Name</strong> of the Crowd server</li><li class="listitem" style="list-style-type: disc">Enter the <strong>Server URL</strong> of your crowd instance</li><li class="listitem" style="list-style-type: disc">Enter the name of the <strong>Application Name</strong>; this application needs to be created in Crowd by the administrator</li><li class="listitem" style="list-style-type: disc">Provide the <strong>Application Password</strong> given to you by the Crowd administrator</li></ul></div></li><li class="listitem">Then, select <strong>Crowd Permissions</strong> as <strong>Read/Write</strong> if you want the changes to be applied to the Crowd server, or <strong>Read Only</strong> if you just want to retrieve the information.</li><li class="listitem">First, click on <strong>Test Settings</strong> and if everything works, then you will be able to <strong>Save and Test</strong> the connection to the Crowd server.</li></ol></div></div></div><div><div><div><div><h2 class="title"><a id="ch08lvl2sec73"/>Connecting to a JIRA user server</h2></div></div></div><p>In large organizations, there could be more than one instance of JIRA used by various teams or projects. Users may need to access all these instances to track projects; in such cases, separate accounts need to be created for the same person. It's not only cumbersome for the JIRA administrator, but also difficult for the user to remember one more username and password. JIRA allows you to connect to another JIRA instance for user management:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to JIRA <strong>Administration</strong> | <strong>User management</strong> | <strong>User Directories</strong> (under <strong>USER DIRECTORIES</strong>).</li><li class="listitem">Click on the <strong>Add Directory</strong> button and select <strong>Directory Type:</strong> as <strong>Atlassian JIRA</strong>:<p>
</p><div><img src="img/image_08_006.jpg" alt="Connecting to a JIRA user server"/></div><p>
</p></li><li class="listitem">On the next screen, fill in <strong>Server Settings</strong>:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Enter the <strong>Name</strong> of the JIRA server</li><li class="listitem" style="list-style-type: disc">Enter the <strong>Server URL</strong> of your JIRA instance</li><li class="listitem" style="list-style-type: disc">Enter the name of the <strong>Application Name</strong>; this application needs to be created in JIRA by the administrator</li><li class="listitem" style="list-style-type: disc">Provide the <strong>Application Password</strong> given to you by the JIRA administrator</li></ul></div></li><li class="listitem">Then, select <strong>JIRA Server Permissions</strong> as <strong>Read/Write</strong> if you want the changes to be applied to the JIRA server, or <strong>Read Only</strong> if you just want to retrieve the information.</li><li class="listitem">First, click on <strong>Test Settings</strong> and if everything works, then you will be able to <strong>Save and Test</strong> the connection to the JIRA server.</li></ol></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec56"/>Allowing other applications to connect to JIRA</h1></div></div></div><p>In the previous section, we connected one JIRA instance to another for user management. The instance used as a JIRA user server needs to have the application created so that other instances can connect to it:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to JIRA <strong>Administration</strong> | <strong>User management</strong> | <strong>JIRA User Server</strong>.<p>Click on the <strong>Add application</strong> button in the top-right corner:</p><p>
</p><div><img src="img/image_08_007.jpg" alt="Allowing other applications to connect to JIRA"/></div><p>
</p></li><li class="listitem">On the next screen, enter <strong>Application name</strong> as <code class="literal">jira-user-server</code> or something meaningful.</li><li class="listitem">Enter the <strong>Password</strong> for this application.</li><li class="listitem">Finally, enter the IP address of the actual JIRA server in the <strong>IP Addresses</strong> field. This step is quite important. Without this step, the connection may not work.</li></ol></div><p>The JIRA user server URL, application name, and password are important features to note here and need to be used in the JIRA instance that will connect to it. Allowing other applications from Atlassian, such as Confluence, to connect to JIRA to share the user base is possible because JIRA internally uses a trimmed version of Crowd.</p></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec57"/>Synchronizing user and group information</h1></div></div></div><p>Now that we have seen how to connect JIRA to LDAP, Crowd, and another JIRA server, it's also important to understand how the user information is synchronized. Any new user who is a part of the directory should be able to log in to a JIRA instance, but all new users who have recently been added to the directory will not be able to access JIRA until the user list is synchronized.</p><p>Go to JIRA <strong>Administration</strong> | <strong>User management</strong> | <strong>User Directories</strong> (under <strong>USER DIRECTORIES</strong>). Here, you will see the list of user directories added in the instance. There is a <strong>Synchronise</strong> link against each entry:</p><p>
</p><div><img src="img/image_08_008.jpg" alt="Synchronizing user and group information"/></div><p>
</p><p>Click on the <strong>Synchronise</strong> link and JIRA will compare and fetch the list of users from the JIRA server; if there are new users on the server, they will be created in the instance. This will also create the groups in our JIRA instance.</p><p>Note that the users created via this synchronization will not be editable, and you cannot delete them if the permission is set in the <strong>Read Only</strong> mode.</p></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec58"/>Summary</h1></div></div></div><p>In this chapter, you learned how to integrate JIRA with LDAP, Crowd, and a JIRA user server. This way, users don't need to remember multiple logins for different tools, and it's also much easier for the administrators to manage users efficiently from a single place. You also learned how to create the application link on the JIRA server, and discussed the synchronization of user accounts.</p><p>Until now, we have seen the power of JIRA and the flexibility it offers. JIRA can be customized very easily; we know that more functionality can be added to JIRA by installing add-ons from the marketplace. While some of these add-ons are free, others need to be purchased. It's also possible to create your own add-on to bring a new feature in JIRA and modify it. In the next chapter, we will take a look at how to create these add-ons along with some simple examples.</p></div></body></html>