<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-204"><a id="_idTextAnchor562"/>13</h1>
<h1 id="_idParaDest-205"><a id="_idTextAnchor563"/>Getting Started with Ansible Automation Controller</h1>
<p>Ansible is very powerful, but it does require the user to use the CLI. In some situations, this is not the best option, such as in cases where you need to trigger an Ansible job from another job (where APIs would be better) or in cases where the person that should trigger a job should only be able to trigger that specific job. For these cases, AWX and Ansible Automation Controller are the best options to use.</p>
<p>The only differences between AWX and Ansible Automation Controller are that AWX is the upstream and open source version, while Ansible Automation Controller is the Red Hat and downstream component that is officially supported as part of the Ansible Automation Platform but for a price, and also the delivery method. AWX is available as a Kubernetes Operator that can run on any Kubernetes cluster, while Ansible Automation Controller is either installable via the Kubernetes Operator on a Red Hat OpenShift installation or on an RHEL 8.2+ machine, at the time of writing. In this chapter, we will use AWX and talk about AWX, but everything we will discuss also applies to Ansible Automation Controller.</p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>Installing AWX</li>
<li>Running your first playbook from AWX:<ul><li>Creating an AWX project</li><li>Creating an inventory</li><li>Creating a job template</li><li>Running a job</li></ul></li>
<li>Controlling access to AWX:<ul><li>Creating a user</li><li>Creating a team</li><li>Creating an organization</li><li>Assigning permissions in AWX</li></ul></li>
</ul>
<h1 id="_idParaDest-206"><a id="_idTextAnchor564"/>Technical requirements</h1>
<p>Although there are a couple of ways to install AWX, we are going to use the suggested AWX installation, which is the operator-based one. For this reason, you will need to have a Kubernetes cluster available.</p>
<p>The easiest way to have one on your machine is to use minikube.</p>
<p>On Linux machines, it is enough to download it from GitHub (<a href="https://github.com/kubernetes/minikube">https://github.com/kubernetes/minikube</a>) and run it with the following command:</p>
<pre class="console">
minikube start --cpus=4 --memory=6g --addons=ingress</pre> <p>In the next section, we will use the <code>kubectl</code> command. To have it available using minikube, you will need to execute the following:</p>
<pre class="console">
alias kubectl="minikube kubectl --"</pre> <p>On other operating systems, the process<a id="_idIndexMarker727"/> might be different, and I suggest checking minikube’s official documentation (<a href="https://minikube.sigs.k8s.io/docs/start/">https://minikube.sigs.k8s.io/docs/start/</a>) to see which installation method better suits your platform and needs.</p>
<p>Although we will give specific examples of hostnames in this chapter, you are free to substitute them with your own hostname and/or IP address; details of how to do this will be provided at the appropriate places.<a id="_idTextAnchor565"/><a id="_idTextAnchor566"/></p>
<h1 id="_idParaDest-207"><a id="_idTextAnchor567"/>Installing AWX</h1>
<p>Before we discuss AWX, it is best<a id="_idIndexMarker728"/> if you have it installed on your machine so that you can follow the explanations and immediately start to use AWX.</p>
<p>The easiest way to install AWX Operator is using Kustomize.</p>
<p>We will need to create a file called <code>kustomization.yaml</code> with the following content:</p>
<pre class="source-code">
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - github.com/ansible/awx-operator/config/default?ref=2.3.0
images:
  - name: quay.io/ansible/awx-operator
    newTag: 2.3.0
namespace: awx</pre> <p>Note that version 2.3.0 is the most current at the time of writing. To find out which is the latest available version, go to <a href="https://github.com/ansible/awx-operator/releases">https://github.com/ansible/awx-operator/releases</a>.</p>
<p>Now that we have the kustomization file ready, we can apply it with the following command:</p>
<pre class="console">
kubectl apply -k .</pre> <p>Once the previous command<a id="_idIndexMarker729"/> has finished, we shall be able to see the AWX Operator controller manager pod running:</p>
<pre class="console">
$ kubectl get pods -n awx
NAME                                               READY   STATUS    RESTARTS   AGE
awx-operator-controller-manager-23f4d5a324-hdk2x   2/2     Running   0          7s</pre> <p>We can now create the <code>awx.yaml</code> file with the following content:</p>
<pre class="source-code">
---
apiVersion: awx.ansible.com/v1beta1
kind: AWX
metadata:
  name: awx
spec:
  service_type: nodeport</pre> <p>We can now edit the <code>kustomization.yaml</code> file to add the reference to the <code>awx.yaml</code> file. By doing so, we will obtain the following result:</p>
<pre class="source-code">
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - github.com/ansible/awx-operator/config/default?ref=2.3.0
  - awx.yaml
images:
  - name: quay.io/ansible/awx-operator
    newTag: 2.3.0
namespace: awx</pre> <p>We can now apply<a id="_idIndexMarker730"/> the new configuration file:</p>
<pre class="console">
$ kubectl apply –k .</pre> <p>Now, run the following commands to see that everything worked properly:</p>
<pre class="console">
$ kubectl get pods -n awx -l "app.kubernetes.io/managed-by=awx-operator"
NAME                   READY   STATUS    RESTARTS   AGE
awx-43a2624db1-hjw3e   4/4     Running   0          4m01s
awx-postgres-0         1/1     Running   0          4m11s
$ kubectl get svc -n awx -l "app.kubernetes.io/managed-by=awx-operator"
NAME           TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)        AGE
awx-postgres   ClusterIP   None           &lt;none&gt;        5432/TCP        4m14s
awx-service    NodePort    10.100.81.35   &lt;none&gt;        80:32754/TCP    4m04s</pre> <p>Be aware that you may need to wait a few minutes before AWX is completely deployed and all the pods are running.</p>
<p>Once AWX has been fully deployed, it is possible to open a browser and connect to the AWX service. To obtain the URL, you can execute the following command:</p>
<pre class="console">
$ minikube service -n awx awx-service –url</pre> <p>The default administration username is <code>admin</code>. To find the password, you will need to execute the following command:</p>
<pre class="console">
$ kubectl get secret -n awx awx-admin-password -o jsonpath="{.data.password}" | base64 --decode ; echo</pre> <p>Now that you have learned<a id="_idIndexMarker731"/> the necessary steps to install AWX, let’s take a look at how to create a project in <a id="_idTextAnchor568"/>AWX.</p>
<h1 id="_idParaDest-208"><a id="_idTextAnchor569"/>Running your first playbook from AWX</h1>
<p>As in Ansible, in AWX, the goal<a id="_idIndexMarker732"/> is running an Ansible<a id="_idIndexMarker733"/> playbook. Each<a id="_idIndexMarker734"/> playbook that is run is called a <strong class="bold">job</strong>. Since AWX gives you more flexibility and automation than Ansible, it requires a little bit more configuration before you can run your first job, so let’s dive into it, starting with creating an AWX p<a id="_idTextAnchor570"/>roject.</p>
<h2 id="_idParaDest-209"><a id="_idTextAnchor571"/>Creating an AWX project</h2>
<p>AWX uses the term <strong class="bold">project</strong> to identify a repository of Ansible<a id="_idIndexMarker735"/> playbooks. AWX projects<a id="_idIndexMarker736"/> support the placement of playbooks in all major <strong class="bold">Source Control Management</strong> (<strong class="bold">SCM</strong>) systems, such as Git and SVN, but also support playbooks on the filesystem or playbooks provided by Red Hat Insights. To create a project, follow these steps:</p>
<ol>
<li>First of all, you need to go to <strong class="bold">Projects</strong> from the left-hand side menu bar, then click the <strong class="bold">Add</strong> button in the top-left section of the screen. This will open a window, similar to the following:</li>
</ol>
<div><div><img alt="Figure 13.1 – The Create New Project window" height="675" src="img/B20846_13_001.jpg" width="1413"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.1 – The Create New Project window</p>
<ol>
<li value="2">By filling in the name (<code>Sample Project</code>) and selecting <strong class="bold">Git</strong> for <strong class="bold">Source Control Type</strong>, the window<a id="_idIndexMarker737"/> will grow with new parameters:</li>
</ol>
<div><div><img alt="Figure 13.2 – The Create New Project window – Git details" height="1221" src="img/B20846_13_002.jpg" width="1568"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.2 – The Create New Project window – Git details</p>
<ol>
<li value="3">You can now add the SCM URL (<a href="https://github.com/ansible/ansible-tower-samples">https://github.com/ansible/ansible-tower-samples</a>) and click the <strong class="bold">Save</strong> button, which should now be clickable.</li>
</ol>
<p>As we mentioned at the beginning of this section, projects are used to store and use Playbooks in AWX. As you can imagine, there are many interesting additional configurations for AWX projects – the most interesting one, in my view, is <code>Update Revision </code><code>on Launch</code>.</p>
<p>If flagged, this option instructs Ansible to always update the playbook’s repository before running any playbook from that project. This ensures that it always executes the latest version of the playbook. This is an important feature to enable as, if you don’t have it checked, there is the possibility (and sooner or later, this will happen in your environment) that someone notices that there is a problem in a playbook and fixes it, and then they run the playbook, feeling sure that they are running the latest version. They then forget to run the synchronization task before running the playbook, effectively running the older version of the playbook. This could lead to major problems if the previous version was fairly buggy.</p>
<p>The downside of using this option is that every time you execute a playbook, two playbooks are effectively run, adding time to your task execution. I think this is a very small downside and one that does not offset the benefits of using this option.</p>
<p>With that, you have learned<a id="_idIndexMarker738"/> the necessary steps to create a project in AWX (and Ansible Automation Controller). Now, let’s learn how to create an i<a id="_idTextAnchor572"/>nventory.</p>
<h2 id="_idParaDest-210"><a id="_idTextAnchor573"/>Creating an inventory</h2>
<p>As with Ansible Core, to make AWX<a id="_idIndexMarker739"/> aware of the machines present in your environment, we can use inventories. Inventories, in the AWX world, are not that different from their equivalents in Ansible Core.</p>
<p>Let’s learn how to create our first inventory in AWX by following these steps:</p>
<ol>
<li>Click on the <strong class="bold">Inventory</strong> option in the left-hand side menu bar. You will be redirected to the <strong class="bold">Inventory</strong> window, where you can create your first inventory by clicking the <strong class="bold">Add</strong> button in the top-left section of the screen. This is different from when we created a new project as this button does not immediately open the creation form; first, it will ask you whether you want to create an inventory or a smart inventory.</li>
<li>After choosing the <strong class="bold">Inventory</strong> option, a box similar to the following will appear:</li>
</ol>
<div><div><img alt="Figure 13.3 – The Create new inventory window" height="922" src="img/B20846_13_003.jpg" width="1449"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.3 – The Create new inventory window</p>
<ol>
<li value="3">In this window, you need to set a name and then save it. After you have clicked <strong class="bold">Save</strong>, the <strong class="bold">Permissions</strong>, <strong class="bold">Groups</strong>, <strong class="bold">Hosts</strong>, <strong class="bold">Sources</strong>, and <strong class="bold">Completed Jobs</strong> tabs will become clickable<a id="_idIndexMarker740"/> so that you can continue with the configuration.</li>
</ol>
<p>Since an empty inventory is not useful in any way, we are going to add <code>localhost</code> to it.</p>
<ol>
<li value="4">To do this, select the <strong class="bold">Hosts</strong> tab, then click on the button with a white plus sign on a green background at the top left of the screen. This will open a window, as follows:</li>
</ol>
<div><div><img alt="Figure 13.4 – The Create new host window" height="633" src="img/B20846_13_004.jpg" width="1504"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.4 – The Create new host window</p>
<ol>
<li value="5">We then need to add the hostname (<code>localhost</code>) and instruct Ansible to use the local connection by adding the following code to the <strong class="bold">Variables</strong> box:<pre class="source-code">
---
ansible_connection: local
ansible_python_interpreter: '{{ ansible_playbook_python }}'</pre></li> <li>We can now click <strong class="bold">Save</strong>, saving our inventory.</li>
</ol>
<p>In AWX, an inventory<a id="_idIndexMarker741"/> is something very similar to an Ansible Core inventory, but with additional features, such as built-in dynamic inventory support, which means you don’t need to edit configuration files or install additional Python modules. To enable<a id="_idIndexMarker742"/> this, simply go to the <strong class="bold">Sources</strong> tab within an inventory<a id="_idIndexMarker743"/> to choose to auto-populate the inventory with information from a source of truth, such as a public cloud provider inventory (<strong class="bold">Amazon Web Services</strong> (<strong class="bold">AWS</strong>), Azure, and <strong class="bold">Google Cloud Platform</strong> (<strong class="bold">GCP</strong>) are all supported), a private cloud inventory (such as VMware or OpenStack), or other systems, such as Red Hat Satellite or a custom script.</p>
<p>A special note about the inventory sources is that the <strong class="bold">Sourced from a Project</strong> option provides a form such as the following if chosen:</p>
<div><div><img alt="Figure 13.5 – The Create new source window" height="1257" src="img/B20846_13_005.jpg" width="1412"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.5 – The Create new source window</p>
<p>This is a very interesting feature, in my opinion, since it allows the user to check a dynamic inventory script of their design into a Git repository (either in its own repository or one where you also put in playbooks) and AWX pulls that information from the repository.</p>
<p>As for projects, when you add a source to your inventory, you might choose to select the <strong class="bold">Update on launch</strong> option, which behaves in the same way as the <strong class="bold">Update on launch</strong> option behaves for projects. For the same reasons that were discussed in the <em class="italic">Creating an AWX project</em> section, I strongly suggest that you use this option as well.</p>
<p>At the very beginning<a id="_idIndexMarker744"/> of the inventory creation process, we had the option to add an inventory<a id="_idIndexMarker745"/> or a smart inventory. What is a smart inventory? <strong class="bold">Smart inventories</strong> are inventories that are populated by AWX, starting from the hosts present in other inventories, and are filtered using the specific smart host filter that the user selected during creation. This can be incredibly useful for dynamically creating inventories with a specific type of host in them based on a filter and saves the need for manually creating lots of different groups – or worse, having to add the same host multiple times.</p>
<p>With that, you have learned<a id="_idIndexMarker746"/> the necessary steps to create an inventory in AWX. Now, let’s learn how to create a<a id="_idTextAnchor574"/> job template.</p>
<h2 id="_idParaDest-211"><a id="_idTextAnchor575"/>Creating a job template</h2>
<p>Now that we have the playbooks<a id="_idIndexMarker747"/> in our projects and the hosts in our<a id="_idIndexMarker748"/> inventories, we can start creating a <strong class="bold">job template</strong>.</p>
<p>A job template in AWX is a collection of the configurations that are needed to perform a job. This is very similar to the <code>ansible-playbook</code> command-line options. The reason why we need to create a job template is so that playbook runs can be launched with little or no user input, meaning they can be delegated to teams who might not know all the details of how a playbook works, or can even be run on a scheduled basis without anyone present. Let’s take a look:</p>
<ol>
<li>First of all, you need to click the <strong class="bold">Templates</strong> option from the left-hand side menu bar.</li>
<li>You can now create a new template by clicking the <strong class="bold">Add</strong> button at the top left of the screen. It will ask you whether you want to create a job template or a workflow template – you need to choose <strong class="bold">Job template</strong>. The following window will appear:</li>
</ol>
<div><div><img alt="Figure 13.6 – The Create New Job Template window" height="2210" src="img/B20846_13_006.jpg" width="1452"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.6 – The Create New Job Template window</p>
<p>As you can see, there are quite<a id="_idIndexMarker749"/> a few fields in this view. The only information needed to proceed is the name (we are going to use <code>Hello World</code>), the inventory (we are going to choose <code>Sample Inventory</code>, which we created in the <em class="italic">Creating an inventory</em> section), the project (we are going to choose the <code>Sample Project</code> project we created in the <em class="italic">Creating an AWX project</em> section), and the playbook (we are going to choose <code>hello_world.yml</code>, which is the only playbook available).</p>
<p>Then, we can click <code>localhost</code>, we don’t need to create or specify any credentials. However, if you were running a job template against one or more remote hosts, you would need to create a machine credential and associate it with your job template. A machine credential is, for example, an SSH username and password or an SSH username and a private key – these are stored securely in the backend database of AWX, meaning you can delegate playbook-related tasks to other teams without actually giving them passwords or SSH keys.</p>
<p>The first thing we had to choose was whether we were creating a job template or a workflow template. We chose <strong class="bold">Job Template</strong> since we want to be able to create simple jobs out of this template. It’s also possible to create more complex jobs, which are the composition of multiple job templates, with flow control features between one job and the next. This allows for more complex situations and scenarios where you might want to have multiple jobs (such as creating an instance, customizing a company, setting up Oracle Database, setting up a MySQL database, and so on), but you also want to have a one-click deployment that would, for instance, set up the machine, apply all the company customization, and install the MySQL database.</p>
<p>You might also have another deployment that uses the same components except the last one, and in its place, it uses the Oracle Database to create an Oracle Database machine. This allows you to have extreme flexibility and reuse a lot of components, creating multiple, nearly identical playbooks.</p>
<p>It’s interesting to note that many fields in the <code>limit</code> field, which operates in the same way as <code>--limit</code> when used with the <code>ansible-playbook</code> command) or can also be used as a sanity check, as it prompts the user with the value (and gives them a chance to modify it) before the playbook is run. However, it could potentially block scheduled job runs, so exercise caution when enabling this feature.</p>
<p>Now that you have learned the necessary steps<a id="_idIndexMarker750"/> to create a job template in AWX, let’s learn how<a id="_idTextAnchor576"/> to create a job.</p>
<h2 id="_idParaDest-212"><a id="_idTextAnchor577"/>Running a job</h2>
<p>A job, as its name<a id="_idIndexMarker751"/> suggests, is an instance of a job template. This means that to perform any action on our machine, we have to create a job template instance – or, more simply, a job – by following these steps:</p>
<ol>
<li>Now that we have set the job template, we can run the job itself. To do so, we need to go to <strong class="bold">Templates</strong> from the left-hand side of the page.</li>
<li>Find the job template you want to run (in our case, this is going to be <code>Hello World</code>) and click on the little rocket on the right-hand side of the page that corresponds to the correct job template, as shown in the following screenshot:</li>
</ol>
<div><div><img alt="Figure 13.7 – Templates list window" height="533" src="img/B20846_13_007.jpg" width="1647"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.7 – Templates list window</p>
<p>When a job<a id="_idIndexMarker752"/> is running, AWX allows us to follow the job’s execution in the job’s output, as shown in the following screenshot:</p>
<div><div><img alt="Figure 13.8 – Job output window" height="858" src="img/B20846_13_008.jpg" width="1280"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.8 – Job output window</p>
<ol>
<li value="3">By clicking the <strong class="bold">Details</strong> tab, we can see additional<a id="_idIndexMarker753"/> details about the job:</li>
</ol>
<div><div><img alt="Figure 13.9 – The Details window" height="1590" src="img/B20846_13_009.jpg" width="1643"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.9 – The Details window</p>
<p>One of the great things about AWX and Ansible Automation Controller is that they archive this job’s execution output in the backend database, meaning that, at any point in the future, you can come back and query a job run to see what changed and what happened. This is incredibly powerful and useful for occasions such as auditing and policy enforcement.</p>
<p>Now that you have learned<a id="_idIndexMarker754"/> the necessary steps to create a job in AWX, let’s learn how<a id="_idTextAnchor578"/> to create a user.</p>
<h1 id="_idParaDest-213"><a id="_idTextAnchor579"/>Controlling access to AWX</h1>
<p>In my opinion, one of the biggest<a id="_idIndexMarker755"/> advantages of AWX compared to Ansible is the fact that AWX allows multiple users to connect and control/perform actions. This allows a company to have a single AWX installation for different teams, a whole organization, or even multiple organizations.</p>
<p>A <strong class="bold">role-based access control</strong> (<strong class="bold">RBAC</strong>) system is in place to manage the<a id="_idIndexMarker756"/> users’ permissions.</p>
<p>Both AWX and Ansible Automation Controller<a id="_idIndexMarker757"/> can link to central directories, such as <strong class="bold">Lightweight Directory Access Protocol</strong> (<strong class="bold">LDAP</strong>) and Azure Active Directory – however, we can also create user accounts locally on the AWX server itself. Let’s start by creating our first <a id="_idTextAnchor580"/>user<a id="_idIndexMarker758"/> account locally!</p>
<h2 id="_idParaDest-214"><a id="_idTextAnchor581"/>Creating a user</h2>
<p>One of the big advantages<a id="_idIndexMarker759"/> of AWX is the ability to manage multiple users. This allows us to create a user in AWX for each person that is using the AWX system so that we can ensure they are only granted the permissions that they need. Also, by using individual accounts, we can ensure that we can see who carried out what action by using the audit logs. To create a user, follow these steps:</p>
<ol>
<li>Go to the left-hand side menu bar and select the <strong class="bold">Users</strong> option.</li>
<li>You will see the list of users and also create a new one by clicking on the button with a white plus sign on a green background at the top-left side of the screen. A form similar to the following will appear:</li>
</ol>
<div><div><img alt="Figure 13.10 – The Create New User window" height="940" src="img/B20846_13_010.jpg" width="1608"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.10 – The Create New User window</p>
<p>By adding an email address, username, and password (with confirmation), you can create a new user.</p>
<p>Users can be of three types:</p>
<ul>
<li><strong class="bold">A normal user</strong>: Users of this type do not have any inherited<a id="_idIndexMarker760"/> permissions and they need to be awarded specific permissions to be able to do anything</li>
<li><strong class="bold">A system auditor</strong>: Users of this type have full read-only privileges<a id="_idIndexMarker761"/> on the whole AWX installation</li>
<li><strong class="bold">A system administrator</strong>: Users of this type have full privileges<a id="_idIndexMarker762"/> on the whole AWX installation</li>
</ul>
<p>Now that you have learned<a id="_idIndexMarker763"/> the necessary steps to create a user in AWX, let’s h<a id="_idTextAnchor582"/>ave a brief look at teams.</p>
<h2 id="_idParaDest-215"><a id="_idTextAnchor583"/>Creating a team</h2>
<p>Although having individual user<a id="_idIndexMarker764"/> accounts is an incredibly powerful tool, especially for enterprise use cases, it would be extremely inconvenient and cumbersome to have to set permissions for each object (such as a job template or an inventory) on an individual basis. Every time someone joins a team, their user account has to be manually configured with the correct permissions against every object and, similarly, be removed if they leave.</p>
<p>AWX and Ansible Automation Controller have the same concept of user grouping that you would find in most other RBAC systems. The only slight<a id="_idIndexMarker765"/> difference is that in the user interface, they are referred to as <strong class="bold">teams</strong>, rather than groups. However, you can create teams simply and easily and then add and remove users as you need to. Doing this through the user interface is very straightforward and you will find the process similar to the way that most RBAC systems handle user groups, so we won’t go into any more specific details here.</p>
<p>When you go to <strong class="bold">Teams</strong> and click the <strong class="bold">Add</strong> button, you will see an interface similar to the following, prompting you to provide some very basic information:</p>
<div><div><img alt="Figure 13.11 – The Create New Team window" height="648" src="img/B20846_13_011.jpg" width="1625"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.11 – The Create New Team window</p>
<p>Once you have your teams set up, I recommend that you assign your permissions to teams, rather than through individual users, as this will make managing AWX object permissions much easier as your organization grows. Speaking of organizations, let’s take a look at the conce<a id="_idTextAnchor584"/>pt<a id="_idIndexMarker766"/> of organizations in AWX.</p>
<h2 id="_idParaDest-216"><a id="_idTextAnchor585"/>Creating an organization</h2>
<p>Sometimes, you will have multiple<a id="_idIndexMarker767"/> independent groups of people that you need to manage independent machines. For those kinds of scenarios, the use of organizations can help you. An organization is a tenant of AWX, with its own unique user accounts, teams, projects, inventories, and job templates – it’s almost like having a separate instance of AWX! To create an organization, you need to follow these steps:</p>
<ol>
<li>To create a new organization, you need to go to the left-hand side of the screen and select the <strong class="bold">Organizations</strong> option.</li>
<li>You can then see the existing organizations and proceed to create a new one by clicking on the button with a white plus sign on a green background in the top-left section of the screen.</li>
</ol>
<p>A window similar to the following will appear:</p>
<div><div><img alt="Figure 13.12 – The Create New Organization window" height="893" src="img/B20846_13_012.jpg" width="1617"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.12 – The Create New Organization window</p>
<p>Since the only mandatory field is <strong class="bold">Name</strong>, you can just fill this in and click <strong class="bold">Save</strong>.</p>
<p>Once you’ve created the organization, you can assign any kind of resource to an organization, such as projects, templates, inventories, users, and so on. Organizations are a simple concept to grasp but also powerful in terms of segregating roles and responsibilities in AWX. Finally, before we complete this section, let’s take a look at a<a id="_idTextAnchor586"/>ssigning<a id="_idIndexMarker768"/> permissions in AWX.</p>
<h2 id="_idParaDest-217"><a id="_idTextAnchor587"/>Assigning permissions in AWX</h2>
<p>Through our journey of configuring<a id="_idIndexMarker769"/> our first project, inventory, and job template in AWX, you will have noticed that most of the screens we have navigated to have a button on them called <strong class="bold">Access</strong>. As we navigate the user interface with the administrator account, we get to see all the options – but of course, you would not want to give every single user administrator permission.</p>
<p>Individual users (or the teams that they belong to) can be granted permission on a per-object basis. So, for example, you could have a team of database administrators who only have access to see and execute playbooks on an inventory of database servers, using job templates that are specific to their role. Linux system administrators could then have access to the inventories, projects, and job templates that are specific to their role. AWX hides objects that users don’t have privileges to access, which means the database administrators never see the Linux system administrator objects, and vice versa.</p>
<p>There are several different privilege levels that you can award to users (or teams), including the following:</p>
<ul>
<li><strong class="bold">Admin</strong>: Users that have this permission<a id="_idIndexMarker770"/> can change all aspects of the resource</li>
<li><strong class="bold">Execute</strong> (only for job templates): Users that have this permission<a id="_idIndexMarker771"/> can run the job template</li>
<li><strong class="bold">Use</strong>: Users that have this permission<a id="_idIndexMarker772"/> can use the resource in a job template</li>
<li><strong class="bold">Update</strong>: Users that have this permission<a id="_idIndexMarker773"/> can update the resource</li>
<li><strong class="bold">Read</strong>: Users that have this permission<a id="_idIndexMarker774"/> can view the settings of the resource</li>
</ul>
<p>That concludes our brief look at RBAC in AWX and our look at this powerful tool. AWX is a great addition to the power of Ansible in an enterprise setting and helps ensure that your users can run Ansible playbooks in a manner that is well-managed, secure, and auditable. We have only scratched the surface in this chapter, but hopefully, this chapter has given you a flavor of how AWX can help your team’s <a id="_idTextAnchor588"/>or enterprise’s automation journey.</p>
<h1 id="_idParaDest-218"><a id="_idTextAnchor589"/>Summary</h1>
<p>AWX and Ansible Automation Controller are powerful, complementary tools that powerfully support the use of Ansible in an enterprise or team-based environment. They can help secure credentials that you would otherwise have to distribute widely, audit the history of playbook runs, and enforce the version control of playbooks. The web-based user interface of these tools creates a low barrier for entry for end users, meaning playbook runs can easily be delegated to teams who otherwise have little knowledge of Ansible (so long as suitable escalation paths are put in place should problems arise). In short, when implementing Ansible in a corporate setting, its usage should not be considered complete without the addition of Ansible Automation Controller or AWX.</p>
<p>In this chapter, you learned how to install AWX on your Linux host, as well as the necessary steps to run your very first playbook from AWX. You also learned about RBAC in AWX and how this can support large, multi-user environments in a corporate setting.</p>
<p>In the next chapter, we will deep dive into the concept of execution environments, which allow you to streamline your automation and keep it functioning even when you’re updating Ansible, AWX<a id="_idTextAnchor590"/>, or Ansible Automation Controller.</p>
<h1 id="_idParaDest-219"><a id="_idTextAnchor591"/>Questions</h1>
<p>Answer the following questions to test your knowledge of this chapter:</p>
<ol>
<li>Which objects can you create in Ansible Automation Controller?<ol><li>Users</li><li>Jobs</li><li>Job templates</li><li>Modules</li><li>Projects</li></ol></li>
<li>True or false? AWX is the upstream version of Red Hat Ansible Automation Controller:<ol><li>True</li><li>False</li></ol></li>
</ol>
</div>
</div></body></html>