["```\n{\n\"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n\"contentVersion\": \"1.0.0.0\",\n\"parameters\": {\n\"name\": {\n\"type\": \"string\"\n},\n\"location\": {\n\"type\": \"string\"\n},\n\"sku\": {\n\"type\": \"string\"\n},\n\"gatewayType\": {\n\"type\": \"string\",\n\"defaultValue\": \"Vpn\",\n\"allowedValues\": [\n\"Vpn\",\n\"ExpressRoute\"\n]\n},\n\"vpnType\": {\n\"type\": \"string\",\n\"defaultValue\": \"RouteBased\",\n\"allowedValues\": [\n\"RouteBased\",\n\"PolicyBased\"\n]\n},\n\"existingVirtualNetworkName\": {\n\"type\": \"string\"\n},\n\"newSubnetName\": {\n\"type\": \"string\"\n},\n\"subnetAddressPrefix\": {\n\"type\": \"string\"\n},\n\"newPublicIpAddressName\": {\n\"type\": \"string\"\n}\n},\n\"resources\": [\n{\n\"apiVersion\": \"2017-06-01\",\n\"name\": \"[parameters('name')]\",\n\"type\": \"Microsoft.Network/virtualNetworkGateways\",\n\"location\": \"[parameters('location')]\",\n\"dependsOn\": [\n\"Microsoft.Network/virtualNetworks/PacktVnet/subnets/GatewaySubnet\",\n\"[concat('Microsoft.Network/publicIPAddresses/', parameters('newPublicIpAddressName'))]\"\n],\n\"properties\": {\n\"gatewayType\": \"[parameters('gatewayType')]\",\n\"ipConfigurations\": [\n{\n\"name\": \"default\",\n\"properties\": {\n\"privateIPAllocationMethod\": \"Dynamic\",\n\"subnet\": {\n\"id\": \"[resourceId('PacktIaaS', 'Microsoft.Network/virtualNetworks/subnets', parameters('existingVirtualNetworkName'), parameters('newSubnetName'))]\"\n},\n\"publicIpAddress\": {\n\"id\": \"[resourceId('PacktIaaS', 'Microsoft.Network/publicIPAddresses', parameters('newPublicIpAddressName'))]\"\n}\n}\n}\n],\n\"vpnType\": \"[parameters('vpnType')]\",\n\"sku\": {\n\"name\": \"[parameters('sku')]\",\n\"tier\": \"[parameters('sku')]\"\n}\n}\n},\n{\n\"apiVersion\": \"2018-04-01\",\n\"type\": \"Microsoft.Network/virtualNetworks/subnets\",\n\"name\": \"[concat(parameters('existingVirtualNetworkName'), '/', parameters('newSubnetName'))]\",\n\"location\": \"[parameters('location')]\",\n\"properties\": {\n\"addressPrefix\": \"[parameters('subnetAddressPrefix')]\"\n}\n},\n{\n\"apiVersion\": \"2017-08-01\",\n\"type\": \"Microsoft.Network/publicIPAddresses\",\n\"name\": \"[parameters('newPublicIpAddressName')]\",\n\"location\": \"[parameters('location')]\",\n\"properties\": {\n\"publicIPAllocationMethod\": \"Dynamic\"\n}\n}\n]\n}\n```", "```\n{\n\"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n\"contentVersion\": \"1.0.0.0\",\n\"parameters\": {\n\"localNetworkGatewayName\": {\n\"type\": \"string\"\n},\n\"location\": {\n\"type\": \"string\"\n},\n\"gatewayIpAddress\": {\n\"type\": \"string\"\n},\n\"addressPrefixes\": {\n\"type\": \"array\"\n}\n},\n\"resources\": [\n{\n\"name\": \"[parameters('localNetworkGatewayName')]\",\n\"type\": \"Microsoft.Network/localNetworkGateways\",\n\"apiVersion\": \"2017-06-01\",\n\"location\": \"[parameters('location')]\",\n\"properties\": {\n\"localNetworkAddressSpace\": {\n\"addressPrefixes\": \"[parameters('addressPrefixes')]\"\n},\n\"gatewayIpAddress\": \"[parameters('gatewayIpAddress')]\"\n}\n}\n]\n}\n```"]