<html><head></head><body>
        <section>

            <header>
                <h1 class="header-title">Monitor Your GitHub Repos with Docker and Prometheus</h1>
            </header>

            <article>
                
<p>By <strong>Brian Christner</strong></p>
<p>GitHub is full of great code, information, and interesting statistics. GitHub repositories are full of statistics that make perfect candidates to graph with Grafana. The best way to graph this data is, of course, with Docker and Prometheus.</p>
<p>Prometheus contains an impressive list of <em>Exporters </em>(<a href="https://prometheus.io/docs/instrumenting/exporters/">https://prometheus.io/docs/instrumenting/exporters/</a>). These Exporters range from APIs to IoT. They can also integrate with Prometheus and Grafana which produce some beautiful graphs.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Docker, Prometheus, and Grafana</h1>
            </header>

            <article>
                
<p>My base setup for anything monitoring related is the Docker, Prometheus, and Grafana stack. That is the baseline I work from and add components like Exporters. I have created the <em>GitHub-Monitoring Repo </em>(<a href="https://github.com/vegasbrianc/github-monitoring">https://github.com/vegasbrianc/github-monitoring</a>). It contains a Docker compose file which makes this stack simplified and easy to start.<br/></p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Getting started</h1>
            </header>

            <article>
                
<p>Prerequisite Ensure you have a Docker host running the latest versions of Docker engine and compose. Next, clone the <em>GitHub-Monitoring </em>(<a href="https://github.com/vegasbrianc/github-monitoring">https://github.com/vegasbrianc/github-monitoring</a>) project to your Docker machine.</p>
<p>We can start configuring the project based on your requirements. Please edit the <em>Prometheus Targets </em>(<a href="https://github.com/vegasbrianc/github-monitoring/blob/master/prometheus/prometheus.yml">https://github.com/vegasbrianc/github-monitoring/blob/master/prometheus/prometheus.yml</a>) if you need to track additional Exporters or targets. They are located in the static configs section at the end of the file. The Exporter uses the name metrics with port <kbd>9171</kbd>:</p>
<pre>
<strong>static_configs:<br/>-<span class="ruby"> <span class="hljs-symbol">targets:</span> [<span class="hljs-string">'node exporter:9100'</span>,<span class="hljs-string">'localhost:9090'</span>, <span class="hljs-string">'metrics:9171'</span>]</span></strong>
</pre>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Configuration</h1>
            </header>

            <article>
                
<p>Create a GitHub token to use for this project. That prevents us from hitting API limits imposed by GitHub for non-authenticated traffic.</p>
<p>Navigate to <em>Create GitHub Token </em>(<a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a>) where we will create a token for this project.</p>
<p>Please do the steps that follow:</p>
<ul>
<li>Provide a description of the token.</li>
<li>Select scopes (our project only requires the <kbd>repo</kbd> permissions).</li>
<li>Click the generate token button.</li>
<li>Copy the token ID and store it in a safe place. That is the equivalent of a password so don't keep it in a public place.</li>
</ul>
<p>Edit the <kbd>docker-compose.yml</kbd> (<a href="https://github.com/vegasbrianc/github-monitoring/blob/master/docker-compose.yml">https://github.com/vegasbrianc/github-monitoring/blob/master/docker-compose.yml</a>) file with your favorite editor. Scroll to the end of the file where you will find the metrics service section.<br/>
First, replace the <kbd>GITHUB_TOKEN=&lt;GitHub API Token see README&gt;</kbd> with the token you generated earlier. Next, replace the <kbd>REPOS</kbd> with your desired repositories you want to track. In my example, I have selected the Docker and <kbd>freeCodeCamp</kbd> repositories as they offer lots of movement and stats.<br/>
The configuration is as follows: </p>
<pre>
<strong>metrics:<br/>  tty: true<br/>  stdin_open: true<br/>expose:<br/>  -<span class="ruby"> <span class="hljs-number">9171</span><br/></span>image: infinityworks/github-exporter:latest<br/>environment:<br/> -<span class="ruby"> <span class="hljs-constant">REPOS</span>=freeCodeCamp/freeCodeCamp,docker/docker<br/></span> -<span class="ruby"> <span class="hljs-constant">GITHUB_TOKEN</span>=&lt;<span class="hljs-constant">GitHub</span> <span class="hljs-constant">API</span> <span class="hljs-constant">Token</span> see <span class="hljs-constant">README</span>&gt;<br/></span>networks:<br/> -<span class="ruby"> back-tier</span></strong>
</pre>
<p>Once configurations are complete, we can start it up. Run the command that follows from the <kbd>github-monitoring project</kbd> directory:</p>
<pre>
<strong>docker-compose up</strong>
</pre>
<p>That's it. Docker Compose builds the entire Grafana and Prometheus stacks auto-magically. The compose file also connects the new GitHub Exporter to our baseline stack. I choose to run docker-compose without the <kbd>-d</kbd> flag initially. That makes it easier for troubleshooting since log entries are printed directly to the terminal.</p>
<p>The Grafana Dashboard is now accessible via: <kbd>http://&lt;Host IP Address&gt;:3000</kbd> (example: <kbd>http://localhost:3000</kbd>).</p>
<p>Please use <kbd>admin</kbd> as username and <kbd>foobar</kbd> as password (it is defined in the <kbd>config.monitoring</kbd> file that sets out a few environment variables).</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Post configuration</h1>
            </header>

            <article>
                
<p>Now we need to create the Prometheus Datasource to connect Grafana to Prometheus:</p>
<ul>
<li>Click the Grafana menu from the top-left corner (looks like a fireball)</li>
<li>Click <span class="packt_screen">Data Sources</span></li>
<li>Click the green button <span class="packt_screen">Add Data Source</span></li>
</ul>
<p>Refer to the following image to add a Grafana Data source:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="261" src="assets/grafana-add-datasource.png" width="234"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure A-1: Add Grafana Data Source</div>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Install dashboard</h1>
            </header>

            <article>
                
<p>I created a Dashboard template which is available on <em>GitHub Stats Dashboard</em>(<a href="https://grafana.net/dashboards/1559">https://grafana.net/dashboards/1559</a>). Download the dashboard and select from the Grafana menu -&gt; <span class="packt_screen">Dashboards</span> -&gt; <span class="packt_screen">Import</span></p>
<p>This dashboard is a starting point to help you get started with graphing your GitHub Repos. Please let me know if you have any changes you would like to see in the dashboard, so I can update Grafana site as well.</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" height="388" src="assets/grafana-dashboard.png" width="619"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure A-2: GitHub Grafana Dashboard</div>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">Conclusion</h1>
            </header>

            <article>
                
<p>Prometheus in combination with Docker is a powerful yet simple way to monitor different data sources. The GitHub Exporter is one of the many amazing Exporters available to Prometheus.</p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    

        <section>

            <header>
                <h1 class="header-title">About the author</h1>
            </header>

            <article>
                
<p><strong>Brian Christner</strong> hails from Arizona but now resides in the Alps of Switzerland. Brian spent a large portion of his career in the casino industry where he made sure the house always won. Brian is a nominated member of the Docker Captain's program and a seasoned cloud architect. He is also a cloud subject matter expert in the topics of Docker, Cloud Foundry, IaaS, PaaS, DevOps, CI/CD and, of course, container monitoring. Brian is passionate about advocating for cloud and containers. When Brian is not busy trying to containerize everything he can be found riding his mountain bike or skiing in the Swiss Alps.</p>
<p>Twitter - <kbd>@idomyowntricks</kbd></p>
<p>Website - <a href="http://www.brianchristner.io">www.brianchristner.io</a></p>


            </article>

            <footer style="margin-top: 5em;">
                
            </footer>

        </section>
    </body></html>