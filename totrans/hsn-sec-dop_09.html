<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Case Study - Security and Privacy by Design</h1>
                
            
            <article>
                
<p class="calibre2">We have discussed secure architecture and design principles, threat modeling, and secure coding practices. In this chapter, we will examine a case study to discuss the implementation of security by design and privacy by design. The case study will show us the common challenges a DevOps team may have to face when applying security practices, and how the security team may help to provide best practices, tools, a security framework, and a training kit.</p>
<p class="calibre2">The case study will begin with a security assessment by OWASP ASVS, and will further identify the required security improvements, such as authentication, authorization, session management, data input/output controls, and privacy by design. We will look at some of the suggested tools and open source security framework implementations. In addition, the third-party components will also introduce vulnerabilities and security risks. We will also discuss the processes and tools that are used to review and manage the open source frameworks and dependencies.</p>
<p class="calibre2">We will cover the following topics in this chapter:</p>
<ul class="calibre10">
<li class="calibre11">Secure architecture review</li>
<li class="calibre11">Privacy by design</li>
<li class="calibre11">Summary of security and privacy frameworks</li>
<li class="calibre11">Third-party component management</li>
</ul>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Case study background</h1>
                
            
            <article>
                
<p class="calibre2">Richard is the CTO of an online bookstore and manages around 500 developers. Richard would like to work with the security team to apply standard security practices during the architecture review, design review, and third-party framework review, and also apply secure coding. Both Richard and the security team reached the consensus that they should have the following in order to prepare for the next stage of their business development:</p>
<ul class="calibre10">
<li class="calibre11">Secure design checklist</li>
<li class="calibre11">Recommended secure design pattern</li>
<li class="calibre11">A list of reusable third-party components</li>
</ul>
<p class="calibre2">Let's look at how the security team helps Richard through the stages of development.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Secure architecture review</h1>
                
            
            <article>
                
<p class="calibre2">To evaluate the existing security architecture of the e-commerce site, the security team decides to work with architects to do an initial architecture review based on OWASP ASVS practices. To do the assessment, the project team can either use an online portal or EXCEL. In this case, the project security architecture review was done by using EXCEL checklist before an in-house security assessment portal was used. The following table contains some resources and documentation concerning these two tools that you may find useful:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre90">
<p class="cdpaligncenter1"><strong class="calibre4">OWASP assessment tool</strong></p>
</td>
<td class="calibre91">
<p class="cdpaligncenter1"><strong class="calibre4">Reference of resources</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre90">
<div class="cdpaligncenter2">On-line Demo</div>
</td>
<td class="calibre91">
<ul class="calibre10">
<li class="calibre11">OWASP ASVS Assessment Generator
<ul class="calibre89">
<li class="calibre11">Demo site: <a href="http://ibuildingsnl.github.io/owasp-asvs-report-generator/index.html" class="calibre9">http://ibuildingsnl.github.io/owasp-asvs-report-generator/index.html</a></li>
<li class="calibre11">Source: <a href="https://github.com/ibuildingsnl/owasp-asvs-report-generator" class="calibre9">https://github.com/ibuildingsnl/owasp-asvs-report-generator</a></li>
</ul>
</li>
<li class="calibre11">OWASP Security Knowledge Framework
<ul class="calibre89">
<li class="calibre11">Demo site: <a href="https://demo.securityknowledgeframework.org/project-new" class="calibre9">https://demo.securityknowledgeframework.org/project-new</a> </li>
<li class="calibre11">username: admin password: test-skf.</li>
<li class="calibre11">Source: <a href="https://github.com/blabla1337/skf-flask" class="calibre9">https://github.com/blabla1337/skf-flask</a></li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre90">
<div class="cdpaligncenter2">Off-line EXCEL</div>
</td>
<td class="calibre91">
<ul class="calibre10">
<li class="calibre11"><a href="https://github.com/shenril/owasp-asvs-checklist" class="calibre9">https://github.com/shenril/owasp-asvs-checklist</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2"/>
<p class="calibre2">The result of the OWASP ASVS assessment can be presented as a diagram to show you which security areas need further improvements:</p>
<div class="cdpaligncenter2"><img src="../images/00033.jpeg" class="calibre92"/></div>
<p class="calibre2">After some of the pilot projects, the security teams grew more familiar with the OWASP ASVS assessment, and there are more projects that require a security assessment. For ease of project data management and cross-reference review, the security team decided to build and customize an in-house assessment portal based on one of the following open source frameworks instead of EXCEL:</p>
<ul class="calibre10">
<li class="calibre11"><a href="https://github.com/ibuildingsnl/owasp-asvs-report-generator" class="calibre9">https://github.com/ibuildingsnl/owasp-asvs-report-generator</a></li>
<li class="calibre11"><a href="https://github.com/blabla1337/skf-flask" class="calibre9">https://github.com/blabla1337/skf-flask</a></li>
</ul>
<p class="calibre2"/>
<p class="calibre2">In order to establish a <strong class="calibre4">secure design checklist</strong>, the security team introduced the OWASP ASVS practices, built an in-house knowledge base, and went through a self-assessment with the project teams. To establish the secure design pattern and a list of reusable security frameworks, the security team decided to propose an open source security framework based on the assessment results of the OWASP ASVS. This is because some of the security frameworks also included security best practices, such as web security frameworks, Spring security, and Shiro. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Authentication</h1>
                
            
            <article>
                
<p class="calibre2">Based on the OWASP ASVS assessment of the project, the security team identified that they were not meeting one of the authentication security requirements.</p>
<div class="packt_infobox"><strong class="calibre81">OWASP ASVS authentication</strong>:<br class="calibre82"/>
<br class="calibre82"/>
OWASP ASVS authentication verifies that secrets, API keys, and passwords are not included in the source code, or in online source code repositories.</div>
<p class="calibre2">The security team further investigated the existing practices of secrets management. The CTO, Richard, clarified that the issue was becoming a headache for both the development and operation team. In the development and testing environment, developers may keep the password or keys in a separate configuration file. However, <span class="calibre6">to filter these files</span><span class="calibre6"> and to separate them in a different version controls repository really take lots of communication, and creates collaboration overhead.</span></p>
<p class="calibre2">To mitigate the risks, the security team proposed some security practices. They advised that the sensitive information should be encrypted when source codes are committed into a repository. Both the testing and operation teams will do regular scanning on the source code repository for any sensitive information. The following diagram shows the revised development workflow model:</p>
<p class="cdpaligncenter1"><img class="alignnone19" src="../images/00034.jpeg"/></p>
<p class="calibre2"/>
<p class="mce-root"><span class="calibre6">The security team also suggested some tools to integrate into the existing practices of the development, testing, and operation teams' daily usage. Here are some of the open source tools that may be used in secret management: </span></p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre93">
<div class="cdpaligncenter2"><strong class="calibre1">Tools</strong></div>
</td>
<td class="calibre94">
<div class="cdpaligncenter2"><strong class="calibre1">Scenario and tools</strong></div>
</td>
</tr>
<tr class="calibre20">
<td class="calibre93">
<div class="cdpaligncenter2"><span>Git Secret</span></div>
</td>
<td class="calibre94">
<p class="calibre2">Developers may need a tool that can handle sensitive files that are to be encrypted when committed and decrypted when checked out transparently.<span class="calibre6"> </span><span class="calibre6">If your development team is using Git as the primary source code repository, the following tools can be applied to reduce the leakage of secrets such as API key, passwords, or encryption key.</span></p>
<ul class="calibre10">
<li class="calibre11">Git-Secret</li>
<li class="calibre11">BlackBox</li>
<li class="calibre11">Git-Crypt</li>
<li class="calibre11">Git-Remote-gcrypt</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre93">
<div class="cdpaligncenter2">Truffle</div>
<div class="cdpaligncenter2">DumpsterDiver</div>
</td>
<td class="calibre94">
<p class="calibre2">Developers, QA, or operations teams prefer to search source code or configuration files regularly to identify whether there is any potential secret leakage in the files.</p>
<p class="calibre2">The TruffleHog can do the secrets search on the GIT repository, and DumpsterDiver searches for the secrets on the local files. </p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">Once the security team evaluates the tools, the next stage is to perform pilot testing with some of the development and operations teams before large-scale deployment. The purpose of the pilot testing was to make the process smooth and to customize the tools for better usability.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Authorization</h1>
                
            
            <article>
                
<p class="calibre2">The authorization security requirements can refer to the 'OWASP ASVS V4: Access control verification requirements'. For example, the OWASP ASVS self-assessment results showed the need for centralized mechanism protection. </p>
<div class="packt_tip">Centralized Mechanism Protection: You should verify that there is a centralized mechanism (including libraries that call external authorization services) for protecting access to each type of protected resource.</div>
<p class="calibre2"><span class="calibre6">To achieve the centralized mechanism protection, the security team decided to introduce the API gateway architecture that was designed so that all the API interfaces were controlled by the API gateway/manager, such as authentication, the API key, monitoring, ACL, logging, and rate limiting. </span>The security team discussed this with the CTO, Richard, and realized that the existing security controls were implemented by each service, and the implementation was also subject to change for each service. <span class="calibre6">Richard would like to have a common security framework for the purposes of not only consistent access control behaviors, but also the central management of security policies.</span></p>
<p class="calibre2"><span class="calibre6">A central security policies management is critical for those services that need to interact with external partners:</span></p>
<p class="cdpaligncenter1"><img class="alignnone20" src="../images/00035.jpeg"/></p>
<p class="calibre2">There are a number of API manager options in the market. The following table lists some open source API manager solutions. One of the key advantages of adopting open source frameworks or tools is that you are able to make further customizations based on your business needs:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre95">
<p class="cdpaligncenter1"><strong class="calibre4">API manager</strong></p>
</td>
<td class="calibre96">
<p class="cdpaligncenter1"><strong class="calibre4">Open source reference</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre95">
<div class="cdpaligncenter2">Kong</div>
</td>
<td class="calibre96">
<ul class="calibre10">
<li class="calibre11"><a href="https://github.com/Kong/kong" class="calibre9">https://github.com/Kong/kong</a></li>
<li class="calibre11"><a href="https://getkong.org/" class="calibre9">https://getkong.org/</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre95">
<div class="cdpaligncenter2">API umbrella</div>
</td>
<td class="calibre96">
<ul class="calibre10">
<li class="calibre11"><a href="https://github.com/NREL/api-umbrella" class="calibre9">https://github.com/NREL/api-umbrella</a></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre95">
<div class="cdpaligncenter2">WSO2 API Manager</div>
</td>
<td class="calibre96">
<ul class="calibre10">
<li class="calibre11"><a href="https://github.com/wso2/product-apim" class="calibre9">https://github.com/wso2/product-apim</a></li>
</ul>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Session management</h1>
                
            
            <article>
                
<p class="calibre2">The CTO also pointed out some existing challenges to the session management implementation. The existing session management needs to tie with specific container technology and does not support various kinds of client application access, such as standalone or non-web application. The CTO would like to have the session management support heterogeneous client access, and wants it to be container-independent. In addition, the team wants to implement the CSRF token in different ways, and this could result in potential risks and extra effort. The CTO expects the team to provide a common library to have consistent CSRF protection.</p>
<p class="calibre2">After assessing the challenges and needs of session management, the security team works on the evaluation of feasible security frameworks and prepares a security kit that may include the information in the following table. The purpose of the security kit is to help the development team to apply related security practices and tools during the development process:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Stage</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Security references and tools</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Threats analysis</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">CWE-6 Insufficient Session-ID Length</li>
<li class="calibre11">CWE-352 Cross-Site Request Forgery (CSRF)</li>
<li class="calibre11">CWE-384 Session Fixation</li>
<li class="calibre11">CWE-488 Exposure of Data Element to the Wrong Session</li>
<li class="calibre11">CWE-613 Insufficient Session Expiration:</li>
</ul>
<p class="calibre2">Tips to query a specific CWE. Just specify the CWE ID number at the end of the URL below. For example, the CWE-613 will be <a href="https://cwe.mitre.org/data/definitions/613.html" class="calibre9">https://cwe.mitre.org/data/definitions/613.html</a>.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Secure design</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">OWASP ASVS V3 Session Management</li>
<li class="calibre11">OWASP Top 10 A2 Broken Authentication</li>
<li class="calibre11">OWASP Session Management Cheat Sheet</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Secure architecture</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Apache Shiro Session Management</li>
<li class="calibre11">OWASP CSRFGuard: <a href="https://www.owasp.org/index.php/Category:OWASP_CSRFGuard_Project" class="calibre9">https://www.owasp.org/index.php/Category:OWASP_CSRFGuard_Project</a></li>
</ul>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Data input/output</h1>
                
            
            <article>
                
<p class="calibre2">Each project team implements the data input validation differently. Some project teams may miss filtering certain illegal characters, some may not know how to encode the output correctly, and some may neglect to do path or URL canonicalization before validation. These data input/output handling issues could cause some security problems. Therefore, the CTO wants the security team to help provide the appropriate security framework and also create hands-on tutorials for their staff members.</p>
<p class="calibre2">The security team proposes a security training kit that includes coding rules, the coding framework, scanning tools, and some case studies.</p>
<p class="calibre2"/>
<div class="packt_infobox"><strong class="calibre81">Data input/output training kit</strong>:<strong class="calibre81"><br class="calibre82"/></strong><br class="calibre82"/>
The purpose of the training kit is to provide security best practices, tools, and implementation guides for data input validation and also data output encoding to avoid XSS attacks.<br class="calibre82"/>
<br class="calibre82"/>
<strong class="calibre81">General secure coding rules</strong>:<strong class="calibre81"><br class="calibre82"/></strong><br class="calibre82"/>
Canonicalization and normalization must occur before validation.<br class="calibre82"/>
Output encoding should be used to avoid XSS attacks.</div>
<p class="calibre2"><span class="calibre6">The following table shows the preliminary agenda of the security training kit:</span></p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Security Framework/tools</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Security Controls</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">OWASP HTML Sanitizer Project (<a href="https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer_Project" class="calibre9">https://www.owasp.org/index.php/OWASP_Java_HTML_Sanitizer_Project</a>)</p>
</td>
<td class="calibre28">
<p class="calibre2">This is for Java to perform HTML sanitization to protect against XSS attacks.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Commons Validator (<a href="https://commons.apache.org/proper/commons-validator/" class="calibre9">https://commons.apache.org/proper/commons-validator/</a>)</p>
</td>
<td class="calibre28">
<p class="calibre2">This is a general data validator that provides data format validation, such as email, credit card, date, URL, and so on.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">ValidateJS (<a href="https://validatejs.org/" class="calibre9">https://validatejs.org/</a>)</p>
</td>
<td class="calibre28">
<p class="calibre2">This is a frontend JavaScript data validator.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">OWASP Java Encoder (<a href="https://www.owasp.org/index.php/OWASP_Java_Encoder_Project" class="calibre9">https://www.owasp.org/index.php/OWASP_Java_Encoder_Project</a>)</p>
</td>
<td class="calibre28">
<p class="calibre2">This works in a similar way to the HTML sanitizer. It's used to perform output encoding to avoid XSS attacks.</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">Secure coding scanning tools</p>
<ul class="calibre10">
<li class="calibre11">The Checker Framework: <a href="https://checkerframework.org/" class="calibre9">https://checkerframework.org/</a></li>
<li class="calibre11">Find security bugs: <a href="https://find-sec-bugs.github.io" class="calibre9">https://find-sec-bugs.github.io</a></li>
</ul>
<p class="calibre2">Examples of security risks:</p>
<ul class="calibre10">
<li class="calibre11">FIO16-J: Canonicalizes path names before validating them</li>
<li class="calibre11">IDS07-J: Sanitizes untrusted data passed to the <kbd class="calibre12">Runtime.exec()</kbd> method</li>
<li class="calibre11">IDS00-J: Prevents SQL injection</li>
<li class="calibre11">IDS16-J: Prevents XML injection</li>
<li class="calibre11">IDS08-J: Sanitizes untrusted data included in a regular expression</li>
<li class="calibre11">IDS06-J: Excludes unsanitized user input from format strings</li>
</ul>
<p class="calibre2"/>
<p class="calibre2">More can be found at <a href="https://wiki.sei.cmu.edu/confluence/display/java/2+Rules" class="calibre9">https://wiki.sei.cmu.edu/confluence/display/java/2+Rules</a><span class="calibre6">.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Privacy by design</h1>
                
            
            <article>
                
<p class="calibre2">The team realizes the importance of privacy and also receives some awareness training related to privacy laws. However, there is still a gap between translating the legal languages into technical <span class="calibre6">security</span><span class="calibre6"> requirements. The CTO would like the security team to help to provide common privacy design solutions and to make <em class="calibre16">privacy by design</em> manifest in technical guidelines for the software engineering team. As well as having the existing data tasking implementation being done by each project team, the CTO plans to have common libraries for consistent data-masking behaviors and to reduce implementation efforts across the teams. There are also other issues raised by the operation, such as sensitive information classification and privacy assessment scanning. The role of the security team is not only to introduce industry best practices but also to evaluate feasible tools or frameworks that support the privacy by design during the DevOps process. Some resources to help you in this stage of the process are listed in the following table:</span></p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre97">
<div class="cdpaligncenter2"><strong class="calibre1">Challenges of privacy by design</strong></div>
</td>
<td class="calibre98">
<div class="cdpaligncenter2"><strong class="calibre1">Suggestions by the security team</strong></div>
</td>
</tr>
<tr class="calibre20">
<td class="calibre97">
<p class="calibre2">How do you translate 'privacy by design' into technical security requirements?</p>
</td>
<td class="calibre98">
<ul class="calibre10">
<li class="calibre11">Privacy design patterns: <a href="https://privacypatterns.org/patterns/" class="calibre9">https://privacypatterns.org/patterns/</a></li>
<li class="calibre11">NIST SP 800-122 Guide to Protecting the Confidentiality of PII</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre97">
<p class="calibre2">Developers need a data-masking implementation API to handle the sensitive information.</p>
</td>
<td class="calibre98">
<p class="calibre2">The ARX De-Identifier Data anonymization tool.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre97">
<p class="calibre2">The operations team needs to classify PII attributes with the existing database and configure the access security policies.</p>
</td>
<td class="calibre98">
<p class="calibre2">Evaluate the Apache Atlas framework for the data governance and access control. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre97">
<p class="calibre2">The DevOps team needs an automatic privacy-scanning tool to evaluate the privacy status of all web services.</p>
</td>
<td class="calibre98">
<p class="calibre2">Try to apply the Web privacy assessment by 'PrivacyScore'.  </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre97">
<p class="calibre2">The developer team needs a common library to implement the consistent Cookie Consent behaviors for all the web services.</p>
</td>
<td class="calibre98">
<p class="calibre2">The open source CookieConsent library may be a good candidate to evaluate.</p>
<p class="calibre2"> </p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary of security and privacy frameworks </h1>
                
            
            <article>
                
<p class="calibre2">The adoption of any security framework requires not only the consideration of business needs but also the fit into the existing architecture. Here is the summary of the industry practices, tools, and frameworks that we discussed in this case study:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Security improvement area</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Open source security and privacy framework</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="cdpaligncenter4"><span>Authentication</span></td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Gluu: it's for multiple-factor authentication and social login.</li>
<li class="calibre11">CAPTCHA is commonly used to prevent machine logins. The HCaptcha, ReCaptcha, Patcha are the open source solutions to be considered. </li>
<li class="calibre11">Git-Secret: For the protection of sensitive information in source code repositories, consider using the tool for the development team.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Authorization</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Gluu: It also provides the user consent management</li>
<li class="calibre11">Apache Shiro Session Management</li>
<li class="calibre11">OWASP CSRF Guard can generate a secure token to protect the CSRF attack.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">API manager</div>
</td>
<td class="calibre28">
<p class="calibre2">The following open source frameworks can be considered to apply the API manager to secure the external restful API interfaces.</p>
<ul class="calibre10">
<li class="calibre11">Kong</li>
<li class="calibre11">API umbrella</li>
<li class="calibre11">WSO2 API Manager</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Data input/output</div>
</td>
<td class="calibre28">
<p class="calibre2">Depends on the programming language, there may be various kinds of data validator framework. </p>
<ul class="calibre10">
<li class="calibre11">OWASP Java HTML Sanitizer Project: It's a <span> HTML Sanitizer written in Java to protect against XSS.</span></li>
<li class="calibre11">Commons validator: It's a Java validator library</li>
<li class="calibre11">ValidateJS: It's a JavaScript validator library. </li>
<li class="calibre11">OWASP Java Encoder: It's a Java encoder library which is mainly used to prevent XSS.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Privacy</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Data anonymization tool: <a href="http://arx.deidentifier.org/" class="calibre9">http://arx.deidentifier.org/</a></li>
<li class="calibre11">Data governance: <a href="https://atlas.apache.org/index.html" class="calibre9">https://atlas.apache.org/index.html</a></li>
<li class="calibre11">Web privacy assessment: <a href="http://privacyscore.org/" class="calibre9">http://privacyscore.org/</a></li>
<li class="calibre11">Cookie Consent: <a href="https://github.com/insites/cookieconsent" class="calibre9">https://github.com/insites/cookieconsent</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Third-party component management</h1>
                
            
            <article>
                
<p class="calibre2">To mitigate the security risks of third-party components, the team defines a process to evaluate the third-party components. However, the CTO identified that the manual inspection of open source licenses to collect related information really took a lot of effort, and, in doing so, the team also made some mistakes, such as allowing information to go missing or incorrectly inputting data. The CTO met with the security team, discussing such matters as the feasibility of automating the process of scanning the whole project and creating an identity license for each component, and other such related information. The stages and key activities of this review are shown in the following table:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Stages</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Key activities of the third-party component review</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Requirements</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Evaluate open source framework components from legal, license, security, and support perspectives </li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Design</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Keep the open source information in a central database, including details such as the open source name, version, sources, and licenses</li>
<li class="calibre11">Threat and security analysis of the components, ensuring that there is no backdoor, no hard-coded encryption key, and no hidden malware</li>
<li class="calibre11">Ensure that a channel is provided for software updates and patches</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Implementation</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">The third-party components must be verified with secure code-scanning tools</li>
<li class="calibre11">All the security updates and changes should be documented as part of the change management</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Verification</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">The scope of security testing includes all the third-party components</li>
<li class="calibre11">License declaration should be implemented in the project</li>
<li class="calibre11">The licenses' compliance should be confirmed with the legal department</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Release</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Known CVE or vulnerabilities must be uncovered</li>
<li class="calibre11">Ensure the integrity of all the binary files</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2">Maintenance</div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">A security update plan must be drawn up and implemented</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">Without a proper tool or automation tool, security practices can be a big overhead to the development team. After understanding the challenges of the execution, the security team identified three key areas:</p>
<ul class="calibre10">
<li class="calibre11">Code scanning for license information</li>
<li class="calibre11">Binary scan for known vulnerabilities</li>
<li class="calibre11">Binary scan and runtime behavior monitoring for potential backdoors and malicious behaviors</li>
</ul>
<p class="calibre2"/>
<p class="calibre2">Here are some recommended scanning tools for the third-party components: </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Purposes</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Suggested Open Source tools</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Open source licenses check</p>
</td>
<td class="calibre28">
<p class="calibre2">The following projects help to identify and retrieve critical information from the open source components such as vulnerabilities, <span class="calibre6"> license, and copyright status.</span></p>
<ul class="calibre10">
<li class="calibre11">AboutCode</li>
<li class="calibre11">FOSSology</li>
<li class="calibre11">Ninka</li>
<li class="calibre11">Linux Foundation open source scanning</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Known vulnerabilities check</p>
</td>
<td class="calibre28">
<p class="calibre2">OWASP Dependency Check, OWASP Dependency Track, and OpenVAS are the suggested open source tools to scan software vulnerabilities. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Malware and suspicious behaviors analysis</p>
</td>
<td class="calibre28">
<p class="calibre2">Cuckoo: It's a sandbox used to analyze static and dynamic behaviors of an unknown file. </p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">In this case study, we reviewed a typical e-commerce website's adoption of security practices for the requirement, architecture, security framework, design review, and threat-modeling stages. We discussed the role of the security team and also the challenges for the DevOps team in adopting the security practices.</p>
<p class="calibre2">The team did an architecture assessment by applying OWASP ASVS. The team identified that there are some security areas that can be improved, including authentication, authorization, session management, and data-input validation. In addition, the team was also looking for advice on the implementation of privacy by design.</p>
<p class="calibre2">For the authentication process, they discovered that some of the sensitive information, such as the encryption key, password, or secrets, may accidentally be committed in the source code repositories. The security team suggested applying monitoring or encryption tools (Git-Secret) to prevent developers from committing credentials into Git repositories in plain text.</p>
<p class="calibre2"/>
<p class="calibre2">For the authorization process, because of the REST API's open interface with third-party partners, the architecture requires a central security access control. The API manager was introduced to manage all the API's ACL, logging, authorization, and rate limiting. Open source solutions, such as Kong and WSO2 API Manager, were introduced to the team for further evaluation. In addition to the API access control, the team was also looking for a secure session management framework to handle various kinds of client technologies and to secure the system against a CSRF attack. To address the problem of the secure session management, the security team proposed a security kit that included threat analysis with examples of CWE, OWASP cheat sheets for secure design, and open source frameworks with Shiro and CSRF Guard for implementation.</p>
<p class="calibre2">When it comes to data-input validation and output encoding, the security team prepared a training kit that included the secure coding rules, security framework, and code-scanning tools. For the implementation, some of the open source frameworks were suggested based on their security needs, such as HTTP Sanitizer, common validator, ValidateJS, and Java Encoder.</p>
<p class="calibre2">Privacy by design is critical not only for legal compliance but also for personal data protection. The project team was confused about how to translate those legal requirements into software engineering technical requirements. The security team suggested some industry best practices and tools based on the likely scenarios. For example, the developers needed their API to correctly implement data masking. The operations team needed to classify the data classification of the PII attributes with the existing database and configure the access security policies. The DevOps team needed an automatic privacy-scanning tool to evaluate the privacy status of all web services. The developer team needed a common library to implement the consistent Cookie Consent behaviors for all the web services. Privacy by design will put our requirements into practice more easily if we apply the right tools and framework.</p>
<p class="calibre2">Last but not least, we discussed third-party component management. There were lots of open source frameworks and tools applied to the security practices. The third party components also introduced legal and security risks. We introduced some practices and tools to mitigate those risks.</p>
<p class="calibre2">We have looked in great detail at threat modeling, security requirements, secure architecture, framework, security by design, and security by privacy, in the development stage. In the coming chapters, we will begin to explore security testing in greater detail.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Questions</h1>
                
            
            <article>
                
<ol class="calibre13">
<li value="1" class="calibre11">Which of the following are secrets that we don't want to be included in the source code?
<ol class="calibre14">
<li value="1" class="calibre11">API keys</li>
<li value="2" class="calibre11">Passwords</li>
<li value="3" class="calibre11">Encryption key</li>
<li value="4" class="calibre11">All of the above</li>
</ol>
</li>
</ol>
<ol start="2" class="calibre13">
<li class="calibre11" value="2">What can't an API gateway do?
<ol class="calibre14">
<li class="calibre11" value="1">Access the control list</li>
<li class="calibre11" value="2">Rate limiting</li>
<li class="calibre11" value="3">Antivirus</li>
<li class="calibre11" value="4">API key authentication</li>
</ol>
</li>
<li class="calibre11" value="3">Which one of the following is related to the security of the session management? 
<ol class="calibre14">
<li class="calibre11" value="1">Insufficient session ID length</li>
<li class="calibre11" value="2">Cross-Site Request Forgery (CSRF)</li>
<li class="calibre11" value="3">Session fixation</li>
<li class="calibre11" value="4">All of the above</li>
</ol>
</li>
<li class="calibre11" value="4">True or False: For the data validation, does the canonicalization and normalization occur after validation? </li>
<li class="calibre11" value="5">What is data anonymization used for?
<ol class="calibre14">
<li class="calibre11" value="1">It's to perform the data masking of sensitive information</li>
<li class="calibre11" value="2">It's for data governance</li>
<li class="calibre11" value="3">Web privacy assessment</li>
<li class="calibre11" value="4">Cookie Consent</li>
</ol>
</li>
<li class="calibre11" value="6">What can the AboutCode, FOSSology, and Ninka tools do?
<ol class="calibre14">
<li class="calibre11" value="1">Open source licenses check</li>
<li class="calibre11" value="2">Known vulnerabilities check</li>
<li class="calibre11" value="3">Suspicious behaviors analysis</li>
<li class="calibre11" value="4">Intrusion defense</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Further reading</h1>
                
            
            <article>
                
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">OWASP Secure Application Design</strong>: <a href="https://www.owasp.org/index.php/OWASP_Secure_Application_Design_Project" class="calibre9">https://www.owasp.org/index.php/OWASP_Secure_Application_Design_Project</a></li>
<li class="calibre11"><strong class="calibre1">Microsoft MSDN Security Checklist: Architecture and Design Review</strong>: <a href="https://msdn.microsoft.com/en-us/library/ff647464.aspx" class="calibre9">https://msdn.microsoft.com/en-us/library/ff647464.aspx</a></li>
<li class="calibre11"><strong class="calibre1">SANS Web Application Security Design Checklist</strong>: <a href="https://www.sans.org/reading-room/whitepapers/securecode/security-checklist-web-application-design-1389" class="calibre9">https://www.sans.org/reading-room/whitepapers/securecode/security-checklist-web-application-design-1389</a></li>
<li class="calibre11"><strong class="calibre1">Microsoft Design Guidelines for Secure Web Applications</strong><span>: </span><a href="https://msdn.microsoft.com/en-us/library/ff648647.aspx" class="calibre9">https://msdn.microsoft.com/en-us/library/ff648647.aspx</a></li>
<li class="calibre11"><strong class="calibre1">Core Security Patterns</strong><span>: </span><a href="http://coresecuritypatterns.com/downloads/patterns.pdf" class="calibre9">http://coresecuritypatterns.com/downloads/patterns.pdf</a></li>
<li class="calibre11"><strong class="calibre1">OWASP ASVS Assessment Tool</strong>: <a href="https://www.owasp.org/index.php/OWASP_ASVS_Assessment_tool" class="calibre9">https://www.owasp.org/index.php/OWASP_ASVS_Assessment_tool</a></li>
<li class="calibre11"><strong class="calibre1">Microsoft's guide for data classification (PDF)</strong>: <a href="https://download.microsoft.com/download/0/A/3/0A3BE969-85C5-4DD2-83B6-366AA71D1FE3/Data-Classification-for-Cloud-Readiness.pdf" class="calibre9">https://download.microsoft.com/download/0/A/3/0A3BE969-85C5-4DD2-83B6-366AA71D1FE3/Data-Classification-for-Cloud-Readiness.pdf</a></li>
<li class="calibre11"><strong class="calibre1">Carnegie Mellon University: Guidelines for Data Classification</strong>: <a href="https://www.cmu.edu/iso/governance/guidelines/data-classification.html#classification" class="calibre9">https://www.cmu.edu/iso/governance/guidelines/data-classification.html#classification</a></li>
<li class="calibre11"><strong class="calibre1">OVIC Privacy and Data Protection Checklists and Tools</strong><span>: </span><a href="https://www.cpdp.vic.gov.au/menu-resources/resources-privacy/resources-privacy-checklists-and-tools" class="calibre9">https://www.cpdp.vic.gov.au/menu-resources/resources-privacy/resources-privacy-checklists-and-tools</a></li>
<li class="calibre11"><strong class="calibre1">Microsoft GDPR Compliance Assessment</strong>: <a href="https://assessment.microsoft.com/gdpr-compliance" class="calibre9">https://assessment.microsoft.com/gdpr-compliance</a></li>
<li class="calibre11"><strong class="calibre1">ENISA Privacy and Data Protection by Design</strong><span>: </span><a href="https://www.enisa.europa.eu/publications/privacy-and-data-protection-by-design/" class="calibre9">https://www.enisa.europa.eu/publications/privacy-and-data-protection-by-design/</a></li>
<li class="calibre11"><strong class="calibre1">SP 800-122 Guide to protecting the confidentiality of personally identifiable information (PII)</strong>: <a href="https://csrc.nist.gov/publications/detail/sp/800-122/final" class="calibre9">https://csrc.nist.gov/publications/detail/sp/800-122/final</a></li>
<li class="calibre11"><strong class="calibre1">Data Anonymization for </strong><span><strong class="calibre1">production data dumps</strong>:</span> <a href="https://github.com/sunitparekh/data-anonymization" class="calibre9">https://github.com/sunitparekh/data-anonymization</a></li>
<li class="calibre11"><strong class="calibre1">CSA Code of Conduct for GDPR Compliance</strong><span>: </span><a href="https://cloudsecurityalliance.org/media/press-releases/cloud-security-alliance-issues-code-of-conduct-self-assessment-and-certification-tools-for-gdpr-compliance/" class="calibre9">https://cloudsecurityalliance.org/media/press-releases/cloud-security-alliance-issues-code-of-conduct-self-assessment-and-certification-tools-for-gdpr-compliance/</a></li>
</ul>


            </article>

            
        </section>
    </body></html>