<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Secure Coding Best Practices</h1>
                
            
            <article>
                
<p class="calibre2">Secure architecture design and threat modeling are followed by the secure coding phase. In the coding phase, we would like to avoid the use of unsafe APIs, buffer overflow, sensitive information leakage, and so on. It's difficult for every developer to be familiar with all secure coding rules. Therefore, how to apply secure coding tools and tips to spot major security issue will be discussed in this chapter.</p>
<p class="calibre2"><span class="calibre6">We will cover the following topics in this chapter:</span></p>
<ul class="calibre10">
<li class="calibre11">Secure coding industry best practices</li>
<li class="calibre11">Establishing secure coding baselines</li>
<li class="calibre11">Secure coding awareness training</li>
<li class="calibre11">Tool evaluation</li>
<li class="calibre11">Tool optimization</li>
<li class="calibre11">High-risk module review</li>
<li class="calibre11">Manual code review tools</li>
<li class="calibre11">Secure code scanning tools</li>
<li class="calibre11">Secure compiling</li>
<li class="calibre11">Common issues in practice</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Secure coding industry best practices</h1>
                
            
            <article>
                
<p class="calibre2">Secure coding is the foundation of secure software. We have done threat modeling and secure architecture design. These require secure coding to make them happen. Secure coding can be a challenge for the development team since developers are occupied with working on new features, and there may be hundreds of secure coding rules to learn. Before we discuss secure coding practices in more detail, we will review existing secure coding standards we can refer to.</p>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">Depending on programming languages, secure coding standards are summarized in the following table:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Reference standards</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Description and reference</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">CERT Secure Coding</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This provides secure coding standards for C, C++, Java, Perl, and Android.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Find Security Bugs</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This provides bug patterns with samples of vulnerable code and solution for Java.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">CWE</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This provides vulnerable source code samples from the perspective of common software weaknesses. The coding samples cover C, C++, Java, and PHP.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Android</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Android Application Secure Design and Secure Coding Guidebook</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">OWASP SKF</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">OWASP Security Knowledge Framework.</li>
<li class="calibre11">It can be used as an internal security knowledge base, which includes OWASP ASVS and secure coding knowledge.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">PHP Security</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">OWASP PHP Security Cheat Sheet</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">OWASP Code Review</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">OWASP Code Review Project</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Apple Secure Coding Guide</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Apple Secure Coding Guide</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Go</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11"><span>Secure Coding Practices for GO language</span></li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">JavaScript</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">JavaScript Secure Coding Practices</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Python</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">OWASP Python Security Project</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"><br class="calibre5"/>
We understand the secure coding baseline and standards. Furthermore, the key challenge is how to apply these secure coding rules to developers' daily coding activities. The following are the recommended approaches to proceed with the secure coding practices.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Establishing secure coding baselines</h1>
                
            
            <article>
                
<p class="calibre2">Secure coding baselines are the minimum secure coding requirements and a checklist for the project team to move to the next stage. Secure coding baselines are also part of the release criteria. It's always suggested you use secure coding guidelines based on industry best practices or standards, such as <strong class="calibre4">CERT Secure Coding</strong>, as described in the preceding table.</p>
<p class="calibre2">Define secure coding baselines based on each programming language, such as PHP, Python, JavaScript, Android, and iOS. The secure coding baseline is better to include the information not only secure coding rules but also examples of security risks, vulnerable code examples, and suggested ones. Here is an example.</p>
<p class="calibre2"/>
<div class="packt_infobox"><strong class="calibre81">Secure code issue – predictable random numbers</strong>:<br class="calibre82"/>
<br class="calibre82"/>
The use of a predictable random number can result in vulnerabilities in the session ID, token, or encryption initialization vector. It's suggested to use <kbd class="calibre83">java.security.SecureRandom</kbd> instead of <kbd class="calibre83">java.util.Random:</kbd><br class="calibre82"/>
<br class="calibre82"/>
<strong class="calibre81"><kbd class="calibre83">// Vulnerable Code</kbd></strong><br class="calibre82"/>
<kbd class="calibre83">Random rnd = New Random ();</kbd><br class="calibre82"/>
<br class="calibre82"/>
<strong class="calibre81"><kbd class="calibre83">// Suggested Code</kbd></strong><br class="calibre82"/>
<kbd class="calibre83">SecureRandom rnd = SecureRandom();</kbd></div>
<p class="calibre2"><span class="calibre6">All projects must be scanned with specified code scanning tools before releases.</span> Some organizations may also define release criteria for secure coding practices. Here are some examples:</p>
<ul class="calibre10">
<li class="calibre11">All the warnings from scanning results that were generated by scanning tools must be checked</li>
<li class="calibre11">All compiler warnings (not just errors) should be checked and cleared</li>
<li class="calibre11">The number of open defects in the scanning results cannot exceed a certain percentage per line of code</li>
</ul>
<p class="calibre2">In addition, the secure coding baselines require related developer tools and training in practice; otherwise, those secure coding rules will be just documents.  </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Secure coding awareness training</h1>
                
            
            <article>
                
<p class="calibre2">The purpose of secure coding training is to inform the development team of the forthcoming secure coding practices we are going to perform. At the initial stage of the secure coding awareness training, the focus will be mainly on the following:</p>
<ul class="calibre10">
<li class="calibre11">What are secure coding standards or baselines?</li>
<li class="calibre11">What are common industry secure coding issues?</li>
<li class="calibre11">How will they impact on a developer's daily tasks?</li>
<li class="calibre11">Release criteria for secure code scanning</li>
</ul>
<p class="calibre2"/>
<p class="calibre2">A case study or scenario-based vulnerable source code example will have better training effects than simply secure coding rules. The following are good references in this area and provide a lot of vulnerable and secure best practice code samples:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">OWASP Security Knowledge Framework</strong>: <a href="https://www.securityknowledgeframework.org/" class="calibre9">https://www.securityknowledgeframework.org/</a></li>
<li class="calibre11"><strong class="calibre1">Android Application Secure Design and Secure Coding Guidebook</strong>: <a href="http://www.jssec.org/dl/android_securecoding_en.pdf" class="calibre9">http://www.jssec.org/dl/android_securecoding_en.pdf</a></li>
<li class="calibre11"><strong class="calibre1">Find Security Bugs Patterns for Java</strong>: <a href="https://find-sec-bugs.github.io/" class="calibre9">https://find-sec-bugs.github.io/</a></li>
<li class="calibre11"><strong class="calibre1">OWASP Teammentor</strong>: <a href="https://owasp.teammentor.net/angular/user/index" class="calibre9">https://owasp.teammentor.net/angular/user/index</a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Tool evaluation</h1>
                
            
            <article>
                
<p class="calibre2">Once the team realizes the importance and the challenge of secure coding, it will look for some tools to make the secure coding easier. The evaluation of a scanning tool may include the following considerations:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Considerations</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Description</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Usability</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">The target users of the code scanning tools are developers. The usability includes the capability to scan parts of the source code, differential scans, scanning reports, tracing back to original source code, and so on.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Budget</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">If it's an IDE plugin commercial tool, we need to consider how many concurrent users' licenses it will need.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Programming languages support</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Most tools support C/C++ and Java, but do not support script languages, such as Python, JavaScript, or PHP.</li>
<li class="calibre11">Do a survey of the programming languages used by in-house projects and prioritize the programming languages that are going to be supported.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Detection rate and false positive rates</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">It's common for any scanning tools to have false positive rates, depending on the scanning engine and rules. A high false positive is not a bad thing, and it can also mean the scanner takes a more conservative approach. Find the tool that best fits the projects instead of the most well-known. </li>
<li class="calibre11">To evaluate the detection rate, we may use known vulnerable projects.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Scanning rules update</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">It's important that the tool is constantly updated with rules and scanners. One of the key advantages of a commercial tool is that the tool will have up-to-date scanning rules.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2"/>
<p class="calibre2">Generally, there are two approaches for code scanning. One is static code scanning with IDE plugin. It works like a spellcheck and is more intuitive for a developer to learn and correct security issues. The other one is to do code scanning with a daily build that generates a daily scanning report. Developers will need to look into the daily scanning report to fix or to comment on security issues by batch. This approach may not be that intuitive for developers, but the compiled security scanning may provide better accuracy. To promote adoption of these two kinds of scanning tool, starting with a small-scale pilot team is suggested. There are some commercial and open source tools available in these two kinds of scanning approach. </p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4"> </strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Pros</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Cons</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">IDE plugin static code scanning</strong></p>
</td>
<td class="calibre28">
<p class="calibre2">Intuitive to developers (works like a spellcheck).</p>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">It may have higher false positives.</li>
<li class="calibre11">It requires every developer to install the plugin</li>
<li class="calibre11">The detection capability is limited.</li>
<li class="calibre11">The license costs for every developer.</li>
<li class="calibre11">Requires enforcement uses of the tool for every developer.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Daily complied scanning</strong></p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Security scanning accuracy based on the project integration and compiled scan.</li>
<li class="calibre11">Centrally manages the scanning rules and results.</li>
<li class="calibre11">It is easy to build security metrics and monitor the results for every project.</li>
</ul>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Fully buildable source code is required.</li>
<li class="calibre11">The scanning results need further assignment for developers to check. When a developer is assigned to check the reports, he may not be familiar with other modules.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"> </p>
<p class="calibre2">Evaluation of code scanning tools consists of a detection rate, false positive rate, potential overhead, and usability for the development team. The vulnerable code projects <span class="calibre6">for the evaluation of static code scanning tools </span>are listed in the following table:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre84">
<p class="cdpaligncenter1"><strong class="calibre4">Vulnerable projects</strong></p>
</td>
<td class="calibre85">
<p class="cdpaligncenter1"><strong class="calibre4">Description</strong></p>
</td>
<td class="calibre86">
<p class="cdpaligncenter1"><strong class="calibre4">Programming languages</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre84">
<p class="calibre2"><strong class="calibre4">NIST Software Assurance Reference Dataset Project</strong></p>
</td>
<td class="calibre85">
<p class="mce-root">The project provides on-purpose insecure code examples which can be used to test the detection rate of secure code scanning tools</p>
</td>
<td class="calibre86">
<p class="cdpaligncenter1">Java, C/C++, C#, PHP</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre84">
<p class="calibre2"><strong class="calibre4">OWASP Node JS Goat</strong></p>
</td>
<td class="cdpalignleft1">
<p class="calibre2">It's a vulnerable website to practice OWASP top 10 security testing and is built by NodeJS.</p>
</td>
<td class="calibre86">
<p class="cdpaligncenter1">Node JS</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre84">
<p class="calibre2"><strong class="calibre4">OWASP WebGoat .Net</strong></p>
</td>
<td class="cdpalignleft1">
<p class="calibre2"><span class="calibre6">It's a vulnerable website to practice OWASP top 10 security testing and is built by .NET.</span></p>
</td>
<td class="calibre86">
<p class="cdpaligncenter1">.NET</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre84">
<p class="calibre2"><strong class="calibre4">OWASP WebGoat PHP</strong></p>
</td>
<td class="cdpalignleft1">
<p class="calibre2"><span class="calibre6">It's a vulnerable website to practice OWASP top 10 security testing and is built by PHP.</span></p>
</td>
<td class="calibre86">
<p class="cdpaligncenter1">PHP</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre84">
<p class="calibre2"><strong class="calibre4">OWASP Rail</strong><strong class="calibre4">sGoat</strong></p>
</td>
<td class="cdpalignleft1">
<p class="calibre2"><span class="calibre6">It's a vulnerable </span><span class="calibre6">website to practice OWASP top 10 security testing and is built by Ruby.</span></p>
</td>
<td class="calibre86">
<p class="cdpaligncenter1">Ruby on Rails</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">Once the security team has selected scanning tools after testing the results, the security team may engage with more development teams to discuss adoption of the tools. Before the adoption of the tools, it's suggested to conduct hands-on training via demo usage of the results, handling the scanning results, and using the scanning tools.</p>
<p class="calibre2">This stage of training is focused more on <em class="calibre16">how</em> instead of <em class="calibre16">what</em>. Examples of hands-on tutorials are how to use scanning tools, how to review security issues, how to fix based on the scanning results, how to disable some scanning rules, and so on.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Tool optimization</h1>
                
            
            <article>
                
<p class="calibre2">Once the teams have been using the code scanning tools for a while, the security team may help to optimize the tools, processes, or rules based on user feedback. Here are some key factors to be optimized for a large-scale code scanning adoption:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Key factors</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Suggestions</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Scanning rules customization</p>
</td>
<td class="calibre28">
<p class="calibre2">The purpose of rules customization is to help the project team reduce false positives. The security team may help to disable some rules that don't apply to the projects or change rules that always result in false positives.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Recommendation fixes</p>
</td>
<td class="calibre28">
<p class="calibre2">Ideally, IDE plugins will present not only security warnings but also suggested fixes. However, if the tools you are using don't support the team, using the OWASP Security Knowledge Framework can be an alternative.  </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Integration</p>
</td>
<td class="calibre28">
<p class="calibre2">Integrate code scanning tools into Jenkins, and developers' IDE plugins. Automation framework. Integration with Jenkins is one of the basics of CI/CD.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Reporting</p>
</td>
<td class="calibre28">
<p class="calibre2">The team may request further quality metrics reports, such as incremental scanning reports based on previous checked results or top common issue cross-projects.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2">Automation platform</p>
</td>
<td class="calibre28">
<p class="calibre2">Moving to the next level of secure coding automation involves integrating several tools together on an automation platform. Try the following open source tools to build your own secure coding automation platform:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">SWAMP-in-a-Box</strong>: </li>
<li class="calibre11"><strong class="calibre1">JackHammer</strong>: </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">High-risk module review</h1>
                
            
            <article>
                
<p class="calibre2">The automation code scanning tool can help to detect most source code security issues. However, there is still a need for high-risk modules. In addition to source code scanning tools, we will also apply blackbox or <strong class="calibre4">Dynamic Application Security Testing</strong> (<span class="calibre6"><strong class="calibre4">DAST</strong>),</span> which will be discussed in later chapters. Think like a hacker. Which modules will a hacker be interested in? What information can be most valuable to a hacker? What might be the weakest link in the whole application? The following table  lists high-risk modules that require further review:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1"><strong class="calibre4">High-risk modules</strong></p>
</td>
<td class="calibre88">
<p class="cdpaligncenter1"><strong class="calibre4">Security Review Focuses</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Authentication</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Accounts registration</li>
<li class="calibre11">Login and CAPTCHA</li>
<li class="calibre11">Password recovery or reset</li>
<li class="calibre11">Password changes</li>
<li class="calibre11">Identity and password storage and access control</li>
<li class="calibre11">Account lockout control after multiple failures</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Authorization</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Sensitive resource access</li>
<li class="calibre11">Administration management</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Configuration</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">There are two kinds of review in the configuration:
<ul class="calibre89">
<li class="calibre11">Secure configurations of the applications, such as turning off debug mode and enabling TLS communication.</li>
<li class="calibre11">The impact of the configuration for each software release.</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Finance</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Payment functions</li>
<li class="calibre11">Order and shopping carts</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">File handling</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">File upload</li>
<li class="calibre11">File download</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Database</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Database query</li>
<li class="calibre11">Database add, update, and delete</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">API interface</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Restful API interfaces</li>
<li class="calibre11">Third-party integration interfaces</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Legacy</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Modules that don't support secure communication</li>
<li class="calibre11">Modules that may still use weak encryption algorithms</li>
<li class="calibre11">Uses of banned or dangerous APIs</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Encryption</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Uses of banned encryption algorithms</li>
<li class="calibre11">Hardcoded sensitive information or comments in the source code during development, such as IP, email, password, or hidden hotkey</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre87">
<p class="cdpaligncenter1">Session</p>
</td>
<td class="calibre88">
<ul class="calibre10">
<li class="calibre11">Concurrent session control and detection</li>
<li class="calibre11">The randomness of the session ID and expiration period</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Manual code review tools</h1>
                
            
            <article>
                
<p class="calibre2">A manual code review may take some time. A manual code review without proper tools and strategies can be like looking for a needle in a haystack. As previously discussed, we only do a manual code review for specific high-risk modules, not for whole projects. In addition to the selection of target scopes, tools can also help us to do a manual code review more efficiently. Here are some open source recommended tools that will help make source code reviews more efficient, although these are not specialized for this purpose:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Tools</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Usage scenario</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">AndroGuard</strong></p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This includes lots of Python analysis modules to do a reverse-engineering analysis of Android applications.</li>
<li class="calibre11">The generated graph can be viewed by Gephi.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Doxygen</strong></p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This supports a wide range of program languages to generate online HTML or PDF documentation. It can also generate a functions call graph that can be viewed by Graphviz.</li>
<li class="calibre11">It's useful to give us an overview of the program and to identify the modules with high-risk that we should focus on.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">Kscope</strong></p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This tool can analyze C source code with a tree of calling functions and a call graph.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">OpenGrok</strong></p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This provides Google-like syntax and a RegExp full-text source code search. It can also do cross-referencing based on the search results.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">WinMerge</strong></p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This can compare the differences between two files and folders. The comparison results are presented in visual colors. It's useful when we are looking for code changes between different releases. </li>
<li class="calibre11">For non-Windows platforms, KDiff3 or Meld are alternative open source options:
<ul class="calibre89">
<li class="calibre11"><a href="http://kdiff3.sourceforge.net/" class="calibre9">http://kdiff3.sourceforge.net/</a></li>
<li class="calibre11"><a href="http://meldmerge.org/" class="calibre9">http://meldmerge.org/</a></li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="calibre2"><strong class="calibre4">NCC Code Navi</strong></p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">The key advantage of the NCC Code Navi tool is the capability to do a keywords search across source code files. Right-clicking to launch a CERT search coding search is also useful.</li>
</ul>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Secure code scanning tools</h1>
                
            
            <article>
                
<p class="calibre2">In terms of source code scanning, there is no-one-size-fits-all solution. There are also no scanning tools that can find zero false positives with a 100% accurate detection rate. Therefore, for the same programming language, it's common that we may apply at least two scanning tools for a cross-reference check.</p>
<p class="calibre2"/>
<p class="calibre2">Here are some commonly used open-source secure coding analysis tools, as in 2018. Note that we only list open source tools here:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Tools</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Background and key characteristics of the scanning tool</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Retire.JS</strong></div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Detection of vulnerable JavaScript libraries, such as jQuery, AngularJS, Node, and so on.</li>
<li class="calibre11">It provides the command line, grunt plugin, and also OWASP ZAP plugin for integration scanning.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Clang Static Analyzer</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This provides standalone command line analysis for C, C++, and Objective C.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Flawfinder</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">A simple C/C++ code scanning tool. It's a Python command line scanning tool and can be easily customized based on the needs.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">DREK</strong></div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This acts like GREP to search specific security issue by regular expressions, but it can generate scanning results in PDF or HTML format.</li>
<li class="calibre11">It's easy to extend any scanning rules by regular expressions. It can be used to scan any programming languages.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Pylint</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">Pylint<span class="calibre6"> is a source code checker for the Python programming language. </span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">PHPMD</strong></div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">PHP Mess Detector is a PHP source code scanner.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">DawnScanner</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">Security scanner for Ruby Web applications.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">SpotBugs</strong></div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This provides a standalone GUI and command line.</li>
<li class="calibre11">SpotBugs can also be used as an Eclipse plugin. It's the successor of FindBugs.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">CPP Check</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This is a static code analysis tool for C/C++.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Mobile Security Framework (</strong><span><strong class="calibre1">MobSF)</strong></span></div>
</td>
<td class="calibre28">
<p class="calibre2">The Mobile Security Framework is a fully automated scanning tool for Android apps. A developer can just upload the APK to the MSF, and the MSF will do all the analysis automatically.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><span><strong class="calibre1">Clang Static Analyzer</strong></span></div>
</td>
<td class="calibre28">
<p class="calibre2">This is a code analysis tool for C/C++ and Objective C.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">ESLint</strong></div>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">This provides command-line code scanning with JavaScript.</li>
<li class="calibre11">Refer here for the secure code scanning rules: <a href="https://eslint.org/docs/rules/" class="calibre9">https://eslint.org/docs/rules/</a>.</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">JSHint</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This is for JavaScript code scanning, and also provides command line tools by NodeJS.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Infer</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This is a static code analyzer for Java, C/C++, and Objective C, provided by Facebook.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Phan</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">Phan is a static analyzer for PHP.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">PHP Security Checker</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This checks PHP project dependencies for known security issues.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">OWASP Dependency check</strong></p>
</td>
<td class="calibre28">
<p class="calibre2">This supports a wide range of programming frameworks and checks the disclosed vulnerabilities with updated NVD data feeds. The tool can run as a command line or via integration with Jenkins.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">VisualCodeGrepper</strong> (<strong class="calibre1">VCG</strong>)</div>
</td>
<td class="calibre28">
<p class="calibre2">VCG is a language-independent scanning tool. The scanning rules can also be easily customized by regular expressions. There are also default rules for commonly banned APIs. It provides a GUI and command line to scan any piece of source code.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">PMD</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This is a source code analyzer for Java and JavaScript. It's mainly for common programming flaws.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Graudit</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This is a simple script to find potential security issues by using GREP to search for specific code patterns. The signatures database templates provide clues for what to look for.  </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">SonarQube</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">This provides support for more than 20 languages and can integrate with CI frameworks. It is also UI-friendly for quality code scanning results. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Brakeman</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">Static analysis security scanner for Ruby on Rails. </p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">bandit</strong></div>
</td>
<td class="calibre28">
<p class="calibre2">Security analysis for Python source code.</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Error Prone</strong></div>
</td>
<td class="calibre28">
<p class="calibre2"><span class="calibre6">Error Prone detects potential Java errors during compile time.</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Dawn</strong></p>
</td>
<td class="calibre28">
<p class="calibre2"><span class="calibre6">Dawn is a static analysis security scanner for Ruby web applications.</span></p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"><br class="calibre5"/>
Here is another categorization by language:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Programming language</strong></p>
</td>
<td class="calibre28">
<p class="cdpaligncenter1"><strong class="calibre4">Scanning tools</strong></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">C/C++</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Infer</li>
<li class="calibre11">CPP Check</li>
<li class="calibre11">Flawfinder</li>
<li class="calibre11">Clang Static Analyzer</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Java</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Infer</li>
<li class="calibre11">SpotBugs</li>
<li class="calibre11">PMD</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Android</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">MobSF</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">PHP</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Phan</li>
<li class="calibre11">PHPMD</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Ruby</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">DawnScanner</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Python</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">Pylint</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">JavaScript</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">ESLint</li>
<li class="calibre11"><span>JSHint</span></li>
<li class="calibre11">Retire.JS</li>
<li class="calibre11">PMD</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Dependencies vulnerabilities</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11">OWASP Dependency check</li>
<li class="calibre11">PHP Security Checker</li>
<li class="calibre11">Retire.JS</li>
</ul>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">
<p class="cdpaligncenter1">Language-independent</p>
</td>
<td class="calibre28">
<ul class="calibre10">
<li class="calibre11"><span>SonarQube</span></li>
<li class="calibre11">DREK</li>
<li class="calibre11"><span>Graudit</span></li>
<li class="calibre11">VisualCodeGrepper</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"><br class="calibre5"/>
Due to rules and detection engine capabilities, the scanning results may vary for the same programming language. Using two scanning tools for the same language is recommended. For example, one commercial tool for daily compiled scanning and another open source tool for developers' IDE plugins. The use of commercial scanning tools helps to tell customers how the services are tested while open source scanning tools give flexibility for further customization and large-scale deployment without budget constraints. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Secure compiling</h1>
                
            
            <article>
                
<p class="calibre2">Memory corruption and buffer overflow may result in exploit code injection attacks. For the C/C++ programming language, these can be protected by compiler options.  By a properly secured configuration of a C/C++ compiler (GCC, MS Visual Studio), the application will be able to add an additional layer of runtime defenses against exploit code injection attacks. These are also mostly ignored by a development team. The common secure options are summarized in the following table:</p>
<table border="1" class="calibre18">
<tbody class="calibre19">
<tr class="calibre20">
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Protection techniques</strong></div>
</td>
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">Secure options</strong></div>
</td>
<td class="calibre28">
<div class="cdpaligncenter2"><strong class="calibre1">OS/Compiler</strong></div>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>Address Space Layout Randomization (ASLR</span><span>) </span><br class="title-page-name"/>
<p class="calibre2"> </p>
</td>
<td class="calibre28">
<p class="calibre2"><kbd class="calibre12">echo 1 &gt;/proc/sys/kernel/randomize_va_space </kbd></p>
</td>
<td class="calibre28">
<p class="calibre2">Android, Linux OS</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28">Stack-based buffer overrun protection</td>
<td class="calibre28">
<p class="calibre2"><kbd class="calibre12"><span>-fstack-protector</span></kbd></p>
<p class="calibre2"><kbd class="calibre12"><span>–fstack-protector-all</span></kbd></p>
</td>
<td class="calibre28">gcc</td>
</tr>
<tr class="calibre20">
<td class="calibre28">GOT Table Protection</td>
<td class="calibre28"><span><kbd class="calibre12">-Wl</kbd>,<kbd class="calibre12">-z</kbd>, <kbd class="calibre12">relro</kbd> </span></td>
<td class="calibre28"><span>gcc</span></td>
</tr>
<tr class="calibre20">
<td class="calibre28">Dynamic link path</td>
<td class="calibre28"><kbd class="calibre12">-Wl,--disable-new-dtags,--rpath [path]</kbd></td>
<td class="calibre28"><span>gcc</span></td>
</tr>
<tr class="calibre20">
<td class="calibre28">Non-executable stack</td>
<td class="calibre28"><kbd class="calibre12">-Wl,-z,noexecstack </kbd></td>
<td class="calibre28"><span>gcc</span></td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>Image randomization</span></td>
<td class="calibre28"><kbd class="calibre12"><span>–fpie –pie </span></kbd></td>
<td class="calibre28">
<p class="calibre2"><span class="calibre6">gcc</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>Insecure C runtime function detection</span></td>
<td class="calibre28">
<p class="calibre2"><kbd class="calibre12"><span>–D_FORTIFY_SOURCE=2 </span></kbd></p>
<p class="calibre2"><kbd class="calibre12"><span>–Wformat-security</span></kbd></p>
</td>
<td class="calibre28">
<p class="calibre2"><span class="calibre6">gcc</span></p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>Stack-based buffer overrun defenses (Canary)</span></td>
<td class="calibre28"><kbd class="calibre12">/GS</kbd></td>
<td class="calibre28">
<p class="calibre2">MS (Microsoft)Visual C++</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>Address Space Layout Randomization (ASLR)</span></td>
<td class="calibre28"><kbd class="calibre12"><span>/DYNAMICBASE</span></kbd></td>
<td class="calibre28">
<p class="calibre2">MS Visual C++</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>CPU-level No-eXecute (NX) support. Data Execution Prevention (DEP)</span></td>
<td class="calibre28"><kbd class="calibre12"><span>/NXCOMPAT</span></kbd></td>
<td class="calibre28">
<p class="calibre2">MS Visual C++</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>Safe-structured exception handling</span></td>
<td class="calibre28"><kbd class="calibre12">/SAFESEH</kbd></td>
<td class="calibre28">
<p class="calibre2">MS Visual C++</p>
</td>
</tr>
<tr class="calibre20">
<td class="calibre28"><span>Enable additional security check</span></td>
<td class="calibre28"><kbd class="calibre12">/SDL</kbd></td>
<td class="calibre28">
<p class="calibre2">MS Visual C++</p>
</td>
</tr>
</tbody>
</table>
<p class="calibre2"><br class="calibre5"/>
For further reference and a description of each protection technique, here are some references:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">SAFECode Development Practices</strong>: <a href="https://www.safecode.org/publication/SAFECode_Dev_Practices0211.pdf" class="calibre9">https://www.safecode.org/publication/SAFECode_Dev_Practices0211.pdf</a></li>
<li class="calibre11"><strong class="calibre1">OWASP C-based ToolChain Hardening</strong>: <a href="https://www.owasp.org/index.php/C-Based_Toolchain_Hardening" class="calibre9">https://www.owasp.org/index.php/C-Based_Toolchain_Hardening</a></li>
<li class="calibre11"><strong class="calibre1">Linux Audit ASLR</strong>: <a href="https://linux-audit.com/linux-aslr-and-kernelrandomize_va_space-setting/" class="calibre9">https://linux-audit.com/linux-aslr-and-kernelrandomize_va_space-setting/</a></li>
<li class="calibre11"><strong class="calibre1">MS Security Best Practice for C++</strong>: <a href="https://msdn.microsoft.com/en-us/library/k3a3hzw7.aspx" class="calibre9">https://msdn.microsoft.com/en-us/library/k3a3hzw7.aspx</a></li>
<li class="calibre11"><strong class="calibre1">Secure Compiler and linker flags for GCC</strong>: <a href="https://developers.redhat.com/blog/2018/03/21/compiler-and-linker-flags-gcc/" class="calibre9">https://developers.redhat.com/blog/2018/03/21/compiler-and-linker-flags-gcc/</a></li>
</ul>
<p class="calibre2"/>
<p class="calibre2">To verify whether the application or the environment has been configured with secure options, the following tools are useful: </p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">CheckSec</strong>: <a href="http://www.trapkit.de/tools/checksec.html" class="calibre9">http://www.trapkit.de/tools/checksec.html</a></li>
<li class="calibre11"><strong class="calibre1">BinScope</strong>: <a href="https://www.microsoft.com/en-us/download/details.aspx?id=44995" class="calibre9">https://www.microsoft.com/en-us/download/details.aspx?id=44995</a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Common issues in practice</h1>
                
            
            <article>
                
<p class="calibre2">There are many commercial and open source secure coding tools. Does any tool offer a low false positive rate with a high detection rate?</p>
<p class="calibre2">Answer: There are no perfect or outstanding tools that offer high detection rates with low false positive rates. Every tool offers a different scanning results. T<span class="calibre6">he high positive rate can also mean more conservative scanning, which identifies more potential or suspicious code issues. </span>You will find the detection rate and scanning results also vary with different tools. Tool A may be able to detect an issue that tool B can't, and vice versa. In practice, it's also suggested to use at least two tools for code scanning as a cross-reference review.</p>
<p class="calibre2">The scanning results may list over 1,000 issues. Is there any advice on how to handle these issues?</p>
<p class="calibre2">Answer: For a large-scale project, it's very common to have such issues. It can be overwhelming for the developer team to check all of the issues identified by the scanning tool. Here are some possible approaches to consider:</p>
<ul class="calibre10">
<li class="calibre11">Filter and evaluate those issues scored as high-risk first.</li>
<li class="calibre11">Customize the scanning rules for the project to filter those rules that are irrelevant to the project.</li>
<li class="calibre11">Do an incremental scan for the scopes of source code that were newly added or recently changed. This may depend on whether the scanning tool provides incremental scanning capability.</li>
<li class="calibre11">Categorize common issues for the same root/cause. Maybe 50% of issues are caused by the same root/cause, such as the use of the same module. </li>
</ul>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">We have discussed secure coding industry best practices, such as CERT, CWE, Android secure coding, OWASP Code Review, and the Apple secure coding guide. Based on those secure coding rules, we established secure coding baselines as part of the security policy and release criteria. To allow the team to be familiar with secure coding, a training portal was prepared. It was suggested that the secure coding knowledge portal should provide not only coding rules but also case studies.</p>
<p class="calibre2">To apply secure coding to developers' daily tasks, secure coding tools must be adopted. We evaluated secure coding tools, taking into account usability, budget, programming language support, detection rates, and scanning rule maintenance. To evaluate the detection rate of a scanning tool, we also introduced some vulnerable projects that can be used as testing projects.</p>
<p class="calibre2">Secure coding rules and best practices are guidelines. They require the right secure coding tools to make them happen, and also the right approaches to make them more effective and efficient.  Therefore, we discussed code review approaches and also examples of high-risk modules. For a more efficient manual code review for high-risk modules, we also listed some tools that can help.  Finally, we listed some common open source secure code scanning tools for different programming languages.</p>
<p class="calibre2">In the next chapter, we will present a case study to walk through security requirements, threat modeling, secure architecture, design, and implementation for the development stage.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Questions</h1>
                
            
            <article>
                
<ol class="calibre13">
<li value="1" class="calibre11">Which one of the following is not included in CERT Secure Coding standards? 
<ol class="calibre14">
<li value="1" class="calibre11">C/C++</li>
<li value="2" class="calibre11">Java</li>
<li value="3" class="calibre11">Android</li>
<li value="4" class="calibre11">PHP</li>
</ol>
</li>
</ol>
<ol start="2" class="calibre13">
<li class="calibre11" value="2">Find Security Bugs is mainly used for which of the following programming language? 
<ol class="calibre14">
<li class="calibre11" value="1">C/C++</li>
<li class="calibre11" value="2">Python</li>
<li class="calibre11" value="3">Java</li>
<li class="calibre11" value="4">Go</li>
</ol>
</li>
<li class="calibre11" value="3">Which one of the following can be a release criterion for secure coding?
<ol class="calibre14">
<li class="calibre11" value="1">All source code must be reviewed with specified code scanning tools.</li>
<li class="calibre11" value="2">All of the compiler warnings should be checked and cleared.</li>
<li class="calibre11" value="3">All the warnings in scanning results which were generated by scanning tools must be checked</li>
<li class="calibre11" value="4">All of above</li>
</ol>
</li>
<li class="calibre11" value="4">What's the main purpose of using vulnerable projects to evaluate code scanning tools?
<ol class="calibre14">
<li class="calibre11" value="1">Detection rate and false positive rates</li>
<li class="calibre11" value="2">Budget</li>
<li class="calibre11" value="3">Licenses</li>
<li class="calibre11" value="4">Performance</li>
</ol>
</li>
<li value="5" class="calibre11">Which one of the following does not mitigate against buffer overflow exploit code injection? 
<ol class="calibre14">
<li value="1" class="calibre11">Address Space Layout Randomization (ASLR)</li>
<li value="2" class="calibre11">CSRF Token</li>
<li value="3" class="calibre11">Stack-based buffer overrun protection</li>
<li value="4" class="calibre11">Non-Executable Stack</li>
</ol>
</li>
<li class="calibre11" value="6">Which one of the following is not used to scan dependency vulnerabilities?
<ol class="calibre14">
<li class="calibre11" value="1">OWASP Dependency check</li>
<li class="calibre11" value="2">PHP Security Checker</li>
<li class="calibre11" value="3">Retire.JS</li>
<li class="calibre11" value="4">VisualCodeGrepper</li>
</ol>
</li>
<li class="calibre11" value="7">Which one is an automated mobile security testing framework?
<ol class="calibre14">
<li class="calibre11" value="1">MobSF</li>
<li class="calibre11" value="2">OpenGrok</li>
<li class="calibre11" value="3">Retire.JS</li>
<li class="calibre11" value="4">SonarQube</li>
</ol>
</li>
</ol>
<ol start="8" class="calibre13">
<li value="8" class="calibre11">Which of the following tools is not used for the Android security assessment?
<ol class="calibre14">
<li value="1" class="calibre11">AndroGuard</li>
<li value="2" class="calibre11">MobSF (Mobile Security Framework)</li>
<li value="3" class="calibre11">Flawfinder</li>
<li value="4" class="calibre11">SpotBugs</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Further reading</h1>
                
            
            <article>
                
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1">NIST 500-297 Report on the Static Analysis Tool</strong>: <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.500-297.pdf" class="calibre9">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.500-297.pdf</a></li>
<li class="calibre11"><strong class="calibre1">Android Secure Coding</strong><span>: </span><a href="https://www.jssec.org/dl/android_securecoding_en.pdf" class="calibre9">https://www.jssec.org/dl/android_securecoding_en.pdf</a></li>
<li class="calibre11"><strong class="calibre1">OWASP PHP Security Cheat Sheet</strong>: <a href="https://www.owasp.org/index.php/PHP_Security_Cheat_Sheet" class="calibre9">https://www.owasp.org/index.php/PHP_Security_Cheat_Sheet</a></li>
<li class="calibre11"><strong class="calibre1">PHP Security Manual</strong>: <a href="https://php.net/manual/en/security.php" class="calibre9">https://php.net/manual/en/security.php</a></li>
<li class="calibre11"><strong class="calibre1">OWASP Code Review</strong>: <a href="http://Https://www.owasp.org/index.php/Category:OWASP_Code_Review_Project" class="calibre9">https://www.owasp.org/index.php/Category:OWASP_Code_Review_Project</a></li>
<li class="calibre11"><strong class="calibre1">OWASP Secure Coding Practices</strong>: <a href="https://www.owasp.org/index.php/OWASP_Secure_Coding_Practices_-_Quick_Reference_Guide" class="calibre9">https://www.owasp.org/index.php/OWASP_Secure_Coding_Practices_-_Quick_Reference_Guide</a></li>
<li class="calibre11"><strong class="calibre1">Apple Secure Coding Guide</strong>: <a href="https://developer.apple.com/library/content/documentation/Security/Conceptual/SecureCodingGuide/Introduction.html" class="calibre9">https://developer.apple.com/library/content/documentation/Security/Conceptual/SecureCodingGuide/Introduction.html</a></li>
<li class="calibre11"><strong class="calibre1">Salesforce Security</strong>: <a href="https://developer.salesforce.com/devcenter/security" class="calibre9">https://developer.salesforce.com/devcenter/security</a></li>
<li class="calibre11"><strong class="calibre1">OWASP Python Security</strong>: <a href="http://www.pythonsecurity.org/" class="calibre9">http://www.pythonsecurity.org/</a></li>
<li class="calibre11"><strong class="calibre1">SAFE Practices for Secure Development of Cloud Applications</strong>: <a href="https://safecode.org/wp-content/uploads/2018/01/SAFECode_CSA_Cloud_Final1213.pdf" class="calibre9">https://safecode.org/wp-content/uploads/2018/01/SAFECode_CSA_Cloud_Final1213.pdf</a></li>
<li class="calibre11"><strong class="calibre1">C/C++ Banned API</strong>: <a href="https://github.com/Microsoft/ChakraCore/blob/master/lib/Common/Banned.h" class="calibre9">https://github.com/Microsoft/ChakraCore/blob/master/lib/Common/Banned.h</a></li>
<li class="calibre11"><strong class="calibre1">Awesome Static Code Analysis</strong>: <a href="https://github.com/mre/awesome-static-analysis" class="calibre9">https://github.com/mre/awesome-static-analysis</a></li>
<li class="calibre11"><strong class="calibre1">Oracle Secure Coding Guidelines for Java</strong>: <a href="http://www.oracle.com/technetwork/java/seccodeguide-139067.html" class="calibre9">http://www.oracle.com/technetwork/java/seccodeguide-139067.html</a> </li>
<li class="calibre11"><strong class="calibre1">FindSecBugs Java Bugs Patterns</strong>: <a href="https://Find-sec-bugs.github.io/bugs.htm" class="calibre9">https://Find-sec-bugs.github.io/bugs.htm</a></li>
<li class="calibre11"><strong class="calibre1">SEI CERT Secure Coding Standards</strong>: <a href="https://wiki.sei.cmu.edu/confluence/display/seccode/SEI+CERT+Coding+Standards" class="calibre9">https://wiki.sei.cmu.edu/confluence/display/seccode/SEI+CERT+Coding+Standards</a></li>
<li class="calibre11">
<p class="calibre2"><strong class="calibre4">MITRE CWE White Paper V3.1</strong>: <a href="https://cwe.mitre.org/data/published/cwe_v3.1.pdf" class="calibre9">https://cwe.mitre.org/data/published/cwe_v3.1.pdf</a></p>
</li>
<li class="calibre11">
<p class="calibre2"><strong class="calibre4">CheckMarx Go Secure Coding:</strong> <a href="https://checkmarx.gitbooks.io/go-scp/" class="calibre9">https://checkmarx.gitbooks.io/go-scp/</a></p>
</li>
<li class="calibre11">
<p class="calibre2"><strong class="calibre4">CheckMarx JavaScript Secure Coding:</strong> <a href="https://checkmarx.gitbooks.io/js-scp/" class="calibre9">https://checkmarx.gitbooks.io/js-scp/</a></p>
<p class="calibre2"/>
</li>
</ul>


            </article>

            
        </section>
    </body></html>