<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Securing Your Content</h1></div></div></div><p>We now know how to create rich and engaging content and how to involve our colleagues in the content creating process. We have been using Confluence for a while now and more and more information has become available.</p><p>In this chapter we will learn how to keep our private content private. We will look at the different ways of securing content, but we will also take a look at how we can secure a complete Confluence installation.</p><p>The topics we will discuss in this chapter are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Global permissions</li><li class="listitem" style="list-style-type: disc">Space permissions and page restrictions</li><li class="listitem" style="list-style-type: disc">Secure administrator sessions</li><li class="listitem" style="list-style-type: disc">Some security best practices</li></ul></div><div><div><div><div><h1 class="title"><a id="ch06lvl1sec41"/>Accessing the content</h1></div></div></div><p>So far, all content we have <a id="id507" class="indexterm"/>created can be viewed and edited by anyone who has access to Confluence, and even without logging in if you're enabled an anonymous login. When your company's information and documentation is in Confluence, allowing anyone to view or edit them might not be the best security setting.</p><p>Confluence gives you all the tools to make your installation as open or as closed as you would like it to be. While we go over the options and how to enable them, please keep the following points in mind:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Confluence is a tool<a id="id508" class="indexterm"/> for communication and collaboration; allowing your users to view and edit as much content as possible. This will help you getting the most out of the transparent knowledge exchange in your organization.<p>So, restrict a space or page only if you have a good reason for doing so.</p></li><li class="listitem" style="list-style-type: disc">Confluence keeps track of every change made to a page or blog post. This makes it easy to see who changed what and, if required, revert the content to a previously saved state.</li></ul></div><p>In a situation<a id="id509" class="indexterm"/> where everybody works on documents on their own desktop, people aren't used to getting feedback and input. This can be a cultural shift that a company has to go through while starting to work with Confluence. Before restricting access to a space, page, or blog post, ask yourself, "Why should this document be private and what is the harm in making it more visible within my organization?"</p><div><div><div><div><h2 class="title"><a id="ch06lvl2sec86"/>Global permissions</h2></div></div></div><p>Global permissions<a id="id510" class="indexterm"/> are site-wide permissions and can be assigned only by system administrators and Confluence administrators. Global permissions can be assigned to groups, individual users, and anonymous users.</p><p>Before we go into how to change the different global permissions, it's good to know the different administrator roles:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Super user</strong>: Any user that<a id="id511" class="indexterm"/> belongs to the confluence-administrators group has full administrative <a id="id512" class="indexterm"/>access to Confluence. A super user can also view and edit all content even if it is restricted by permissions.</li><li class="listitem" style="list-style-type: disc"><strong>System Administrator</strong>: Users with the <a id="id513" class="indexterm"/>System Administrator global <a id="id514" class="indexterm"/>permission have full administrative access to Confluence but cannot view or edit the content they don't have permissions to.</li><li class="listitem" style="list-style-type: disc"><strong>Confluence Administrator</strong>: Users with the <a id="id515" class="indexterm"/>Confluence<a id="id516" class="indexterm"/> Administrator global permission have restricted access to the Confluence administrative functions. Confluence administrators cannot, for example, install new add-ons. More detail on which functions are restricted are in the <em>Comparing the administration roles</em> section.</li></ul></div><div><div><h3 class="title"><a id="tip12"/>Tip</h3><p>
<strong>The Confluence administrator permission and the confluence-administrators group are not related</strong>.</p><p>Although the name suggests they are related, they are not. Granting a user or group the Confluence Administrator permission is not the same as adding the user to the confluence-administrators group.</p></div></div><p>How the different roles are related to each other is illustrated in the following diagram:</p><div><img src="img/9526_06_09.jpg" alt="Global permissions"/></div><div><div><h3 class="title"><a id="note21"/>Note</h3><p>As a user within the confluence-administrators group is allowed to view and edit all content, it is recommended to use a different user account for day-to-day work. With the System Administrator permission, all administrative functions can be performed but your administrators aren't allowed to view all content.</p><p>A super user account would only be needed if restricted content can't be accessed by anyone anymore. The super user can still access the content and restore the restrictions.</p></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec81"/>Updating global permissions</h3></div></div></div><p>If you are a Confluence administrator, you can add users and groups to the global permissions to determine their permissions.</p><p>To view the <a id="id517" class="indexterm"/>global permissions:</p><div><ol class="orderedlist arabic"><li class="listitem">Browse to the Administration Console (<strong>Administration</strong> | <strong>Confluence Admin</strong>).</li><li class="listitem">Choose <strong>Global Permissions</strong> in the left-hand side menu. The next screen would be as shown in the following screenshot:<div><img src="img/9526_06_01.jpg" alt="Updating global permissions"/></div></li></ol></div><p>To add <a id="id518" class="indexterm"/>permissions<a id="id519" class="indexterm"/> for a group, perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Select <strong>Edit Permissions</strong>; this will show the <strong>Edit Global Permissions</strong> screen.</li><li class="listitem">Type the group name in the <strong>Grant browse permission to</strong> box in the groups section. You can also search for the group name.</li><li class="listitem">Click on <strong>Add</strong>.</li><li class="listitem">The group <a id="id520" class="indexterm"/>will be added to the list and you can edit the permissions.</li><li class="listitem">When all the relevant checkboxes are checked, click on the <strong>Save All</strong> button at the bottom of the page.</li></ol></div><p>To add permissions<a id="id521" class="indexterm"/> for a <a id="id522" class="indexterm"/>user, perform the following steps:</p><div><div><h3 class="title"><a id="note22"/>Note</h3><p>Before adding permissions to users, first consider the management overhead. Adding them to a group and assigning permissions to that group will result in less maintenance in the long run.</p></div></div><div><ol class="orderedlist arabic"><li class="listitem">Select <strong>Edit Permissions</strong>; this will show the <strong>Edit Global Permissions</strong> screen.</li><li class="listitem">Type the <a id="id523" class="indexterm"/>username in the <strong>Grant browse permission to</strong> box in the <strong>Individual Users</strong> section. You can also search for the username.</li><li class="listitem">Click on <strong>Add</strong>. The user will then be added to the list and you can edit its permissions.</li></ol></div><p>To add or edit the<a id="id524" class="indexterm"/> permissions of<a id="id525" class="indexterm"/> groups and users, perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Select or clear the checkbox under the relevant permissions for the relevant user or group. A selected box indicates that the permission is granted.</li><li class="listitem">To allow anonymous access to your Confluence installation, select the <strong>Use Confluence</strong> option in the <strong>Anonymous Access</strong> section.</li><li class="listitem">Choose <strong>Save All</strong> to save your changes.<div><img src="img/9526_06_02.jpg" alt="Updating global permissions"/></div></li></ol></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec82"/>Overview of the global permissions</h3></div></div></div><p>In the previous steps we learned <a id="id526" class="indexterm"/>how to manage the different global permissions. In the following table those different global permissions are explained. These permissions are also displayed in the previous screenshot.</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Permission</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<strong>can use</strong>
<a id="id527" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This allows a user to access your Confluence site.</p>
<p>Users with this permission count towards the number of users on your license.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Attach Files to User Profile</strong>
<a id="id528" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This permission is no longer relevant since the introduction of personal spaces, and can be ignored.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Update User Status</strong>
<a id="id529" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This allows users to update their status messages.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Personal Space</strong>
<a id="id530" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This allows users to create and maintain a personal space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Create Space(s)</strong>
<a id="id531" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This permission allows users to create new spaces within Confluence. When a space is created, the creator is automatically the Space admin for that space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Confluence Administrator</strong>
<a id="id532" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This <a id="id533" class="indexterm"/>permission allows users to access the Administration Console that controls the site-wide administration. Users with this permission can perform a <em>subset of all</em> administrative functions.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>System Administrator</strong>
<a id="id534" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This permission allows users to access the Administration Console that controls the site-wide administration. Users with this permission can perform <em>all</em> administrative functions.</p>
</td></tr></tbody></table></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec83"/>Comparing the administration roles</h3></div></div></div><p>We have already learned <a id="id535" class="indexterm"/>that a user with System Administrator permission is allowed to perform all administrative functions within Confluence. A user with Confluence Administrator permission is only allowed to administrate just a subset of those functions.</p><p>You can give the Confluence Administrator permission to users who should be able to perform most administrative functions, but should not be able to perform functions that can compromise the security of the Confluence system.</p><p>The following functions are granted to the System Administrator permission but excluded from the Confluence <a id="id536" class="indexterm"/>Administrator permission to ensure your Confluence instance integrity and security.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">General configuration – only the following options are excluded:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Change the server base URL</li><li class="listitem" style="list-style-type: disc">Enable/disable remote API</li><li class="listitem" style="list-style-type: disc">Enable/disable compress HTTP response</li><li class="listitem" style="list-style-type: disc">Change connection timeouts</li></ul></div></li><li class="listitem" style="list-style-type: disc">Backup administration</li><li class="listitem" style="list-style-type: disc">External gadgets</li><li class="listitem" style="list-style-type: disc">Mail servers</li><li class="listitem" style="list-style-type: disc">User macros</li><li class="listitem" style="list-style-type: disc">In-App notifications</li><li class="listitem" style="list-style-type: disc">Attachment storage</li><li class="listitem" style="list-style-type: disc">PDF export</li><li class="listitem" style="list-style-type: disc">Office connector</li><li class="listitem" style="list-style-type: disc">Add-ons – only the following options are excluded:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Upgrade add-ons</li><li class="listitem" style="list-style-type: disc">Install new add-ons</li><li class="listitem" style="list-style-type: disc">Confluence upgrade check</li></ul></div></li><li class="listitem" style="list-style-type: disc">Security configuration – only the following options are excluded:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">External user management</li><li class="listitem" style="list-style-type: disc">Append wildcards to user and group searches.</li><li class="listitem" style="list-style-type: disc">Enable custom stylesheets for spaces.</li><li class="listitem" style="list-style-type: disc">Show system information on the 500 page.</li><li class="listitem" style="list-style-type: disc">Maximum RSS items</li><li class="listitem" style="list-style-type: disc">RSS timeout</li><li class="listitem" style="list-style-type: disc">XSRF protection</li><li class="listitem" style="list-style-type: disc">Anti XSS mode</li></ul></div></li><li class="listitem" style="list-style-type: disc">Change the global stylesheet</li><li class="listitem" style="list-style-type: disc">Add custom HTML</li><li class="listitem" style="list-style-type: disc">Backup and restore</li><li class="listitem" style="list-style-type: disc">Mail queue</li><li class="listitem" style="list-style-type: disc">Cache statistics</li><li class="listitem" style="list-style-type: disc">Scheduled jobs</li><li class="listitem" style="list-style-type: disc">Logging and profiling</li><li class="listitem" style="list-style-type: disc">Atlassian <a id="id537" class="indexterm"/>support tools</li></ul></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec84"/>Notes on global permissions</h3></div></div></div><p>Some things to keep <a id="id538" class="indexterm"/>in mind while working with global permissions are that users with:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The Confluence Administrators permission are able to access the global permissions page and change the permissions, excluding permissions for the confluence-administrators group</li><li class="listitem" style="list-style-type: disc">The Confluence Administrators permission cannot grant themselves the System Administrator permission</li><li class="listitem" style="list-style-type: disc">The Confluence Administrators permission cannot add themselves to the confluence-administrators group and become super users</li><li class="listitem" style="list-style-type: disc">The System Administrators permission can change the permissions of the confluence-administrators group on the global permissions page</li><li class="listitem" style="list-style-type: disc">The System Administrators permission are able to add themselves to the confluence-administrators group and become super users</li></ul></div></div></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec87"/>Space permissions</h2></div></div></div><p>Every space has its own set of <a id="id539" class="indexterm"/>permissions. These permissions determine the access to the space for specific users and groups. In order to assign these permissions, a user must be space administrator, that is, they should have the Admin permissions for that space.</p><div><div><div><div><h3 class="title"><a id="ch06lvl3sec85"/>Overview of the permissions</h3></div></div></div><p>The following is the list of <a id="id540" class="indexterm"/>different permissions you can set on a space level:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Permission</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>View<a id="id541" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user can view this space's content. This includes pages and blog posts. Without this permission the user cannot access the space at all.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Pages – Add<a id="id542" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user can add and edit pages in this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Pages – Restrict<a id="id543" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is <a id="id544" class="indexterm"/>allowed to apply page-level restrictions.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Pages – Remove<a id="id545" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to remove pages in this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Blog – Add<a id="id546" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to create and edit blog posts.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Blog – Remove<a id="id547" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to remove blog posts in this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Comments – Add<a id="id548" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to make comments in this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Comments – Remove<a id="id549" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to remove any comments in this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Attachments – Add<a id="id550" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to add attachments to this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Attachments – Remove<a id="id551" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to remove any attachments in this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Mail – Remove<a id="id552" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to delete mail items.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Space – Export<a id="id553" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user is allowed to export content from this space.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Space - Admin<a id="id554" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>The user has administrative permissions over this space.</p>
</td></tr></tbody></table></div><div><div><h3 class="title"><a id="note23"/>Note</h3><p>If, by mistake, all administrative access to a space is removed, nobody has access to administer the space anymore. This could, for example, happen if somebody who was a space administrator leaves the company or a group with Space Administrator permissions is removed from Confluence. In such a case, somebody from the confluence-administrators group needs to help you to fix the permissions.</p></div></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec86"/>Managing space permissions</h3></div></div></div><p>Permissions can be <a id="id555" class="indexterm"/>granted to groups or to individual users. You need to be a space administrator to assign space permissions. A Confluence administrator can also set the default permissions that will be applied when a space is created; this is explained in the following section.</p><p>To access the space permissions, you will need to perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to the space and choose <strong>Space tools</strong> on the left sidebar.</li><li class="listitem">Select <strong>Permissions</strong> followed by <strong>Permissions</strong>.</li></ol></div><div><div><h3 class="title"><a id="note24"/>Note</h3><p>Note that the permissions menu is only displayed if you are a space administrator or super user.</p></div></div><p>On the space permission screen you will notice the following three sections:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Groups</strong>: A list of the <a id="id556" class="indexterm"/>groups that already have permission to access the space</li><li class="listitem" style="list-style-type: disc"><strong>Individual Users</strong>: A list of <a id="id557" class="indexterm"/>users that already have permission to access the space</li><li class="listitem" style="list-style-type: disc"><strong>Anonymous Access</strong>: Permissions<a id="id558" class="indexterm"/> that are granted to this space for anonymous users<div><img src="img/9526_06_03.jpg" alt="Managing space permissions"/></div></li></ul></div><p>To assign permissions to<a id="id559" class="indexterm"/> groups, perform the <a id="id560" class="indexterm"/>following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on the <strong>Edit Permissions</strong> button below the group section.</li><li class="listitem">To assign a permission, check the relevant checkbox.</li><li class="listitem">To remove a permission, uncheck the checkbox below the relevant permission.</li><li class="listitem">To add a new group to the list, type the group name in the textbox in the group section and click on <strong>Add</strong>. You can also search for groups using the magnify icon next to the textbox.<div><div><h3 class="title"><a id="note25"/>Note</h3><p>For bulk actions:</p><p>Click on the cogwheel in the actions column.</p><p>Choose <strong>Select All</strong> or <strong>Deselect All</strong> to perform the bulk action.</p></div></div></li><li class="listitem">Click on <strong>Save All</strong> to apply the changes.</li></ol></div><p>To assign <a id="id561" class="indexterm"/>permissions to users:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on the <a id="id562" class="indexterm"/><strong>Edit Permissions</strong> button below the <strong>Individual User</strong> section.</li><li class="listitem">To assign a permission, check the relevant checkbox.</li><li class="listitem">To remove a permission, uncheck the checkbox below the relevant permission.</li><li class="listitem">To add a new user to the list, type the username in the textbox in the <strong>Individual User</strong> section and click on <strong>Add</strong>. You can also search for users by using the magnify icon next to the textbox.<div><div><h3 class="title"><a id="note26"/>Note</h3><p>For bulk actions:</p><p>Click the cogwheel in the actions column.</p><p>Choose <strong>Select All</strong> or <strong>Deselect All</strong> to perform the bulk action.</p></div></div></li><li class="listitem">Click on <strong>Save All</strong> to apply the changes.</li></ol></div><p>To assign<a id="id563" class="indexterm"/> permissions to<a id="id564" class="indexterm"/> anonymous users:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on the <strong>Edit Permissions</strong> button below the <strong>Anonymous User</strong> section.</li><li class="listitem">To assign a permission, check the relevant checkbox.</li><li class="listitem">To remove a permission, uncheck the checkbox below the relevant permission.</li><li class="listitem">Click on <strong>Save all </strong>to apply the changes.</li></ol></div><p>Anonymous users can't be granted space administration rights or the permission to restrict pages.</p></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec87"/>Setting default space permissions</h3></div></div></div><p>Confluence administrators <a id="id565" class="indexterm"/>can set the default permissions that will be applied to every new space that is created. The default permissions are only configurable for groups, not for individual or anonymous users.</p><p>To set the default space permissions:</p><div><ol class="orderedlist arabic"><li class="listitem">Browse to the Administration Console (<strong>Administration</strong> | <strong>Confluence Admin</strong>).</li><li class="listitem">Choose <strong>Space Permissions</strong> in the left-hand menu.</li><li class="listitem">Choose <strong>Edit Permissions</strong>.</li><li class="listitem">Add groups and change permissions as described in how to assign permissions to <a id="id566" class="indexterm"/>groups in the previous section.<p> </p><div><img src="img/9526_06_04.jpg" alt="Setting default space permissions"/></div><p>
</p></li></ol></div></div></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec88"/>Page restrictions</h2></div></div></div><p>Page restrictions <a id="id567" class="indexterm"/>are the lowest tier where you are able to control access to your content. With page restrictions you can control who can view or edit individual pages.</p><div><div><div><div><h3 class="title"><a id="ch06lvl3sec11"/>Page restriction hierarchy</h3></div></div></div><p>Before we get to how to <a id="id568" class="indexterm"/>set and<a id="id569" class="indexterm"/> manage page restrictions, it good to know how Confluence handles permissions and restrictions. Permissions and page restrictions work in a hierarchical manner. This means that a user who can access and modify global permissions can define which users can access and modify space permissions. Space administrators can then define which users have access to create and modify pages. These users can then apply viewing and editing restrictions to a page. Child pages inherit the viewing and editing restrictions from their parent.</p><p>If you translate this into a diagram, it will look something like this:</p><div><img src="img/9526_06_05.jpg" alt="Page restriction hierarchy"/></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec01"/>Inheritance</h4></div></div></div><p>I already mentioned that child<a id="id570" class="indexterm"/> pages inherit the view restrictions set on the parent page. This is also true for child pages of those child pages and so on. If a view restriction is set to a page that already has inherited restrictions from its parent, users must satisfy both restrictions in order to see that page.</p><p>Edit restrictions are not inherited from the parent page, only from the space. Edit restrictions have to be reapplied to child pages.</p></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec12"/>Managing page restrictions</h3></div></div></div><p>We will first talk about <a id="id571" class="indexterm"/>viewing page restrictions.</p><p>When you are viewing a page with page restrictions applied to it, you will notice a small padlock icon in the byline of the page, directly below the page title. If you click on that icon, the page restrictions dialog will appear, displaying the full details on the page restrictions.</p><p>When you are editing a page, you will notice a restrictions button at the bottom of the screen. Clicking on this button will also display the page restrictions dialog.</p><p>Next we will take a look at setting page restrictions. In order to set page restrictions, perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Browse to the relevant page.</li><li class="listitem">Choose <strong>Tools</strong> | <strong>Restrictions</strong> to open the <strong>Page Restrictions</strong> dialog.</li><li class="listitem">Select the restriction option you want to set (view or edit).</li><li class="listitem">Choose the users and groups you want to be able to view or edit the page.<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">To include yourself, click on <strong>Me</strong>.</li><li class="listitem" style="list-style-type: disc">To select a particular user or group, type the user's username or the group name into the textbox. Click on <strong>Restrict</strong><strong> </strong>to allow that user or group to view or edit the page.</li><li class="listitem" style="list-style-type: disc">To search for a user or group click on the <strong>Person…</strong> or <strong>Group…</strong> button.</li></ul></div></li><li class="listitem">Click on <strong>Save</strong> <a id="id572" class="indexterm"/>to apply the new restrictions, as shown in the following screenshot:<div><img src="img/9526_06_06.jpg" alt="Managing page restrictions"/></div></li></ol></div><p>To remove<a id="id573" class="indexterm"/> page restrictions, perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the <strong>Page Restrictions</strong> dialog by using the padlock icon or select <strong>Tools</strong> | <strong>Restrictions</strong>.</li><li class="listitem">Click on the <strong>Remove restriction</strong> link next to a user or group to remove them from the restriction. Hereby, you will disallow them to view or edit the page, unless there are no restrictions.</li><li class="listitem">Click on <strong>Save</strong>.</li></ol></div><p>Next we will look at viewing restricted pages. As a space administrator you can view all pages that are restricted. From within this view, it is also possible to remove page restrictions. For example, you may need to do this when there is nobody who can access a certain page anymore.</p><div><ol class="orderedlist arabic"><li class="listitem">Go to the <a id="id574" class="indexterm"/>space and choose <strong>Space Tools</strong> on the left sidebar.</li><li class="listitem">Select <strong>Permissions</strong> followed by <strong>Restricted Pages</strong>.<div><div><h3 class="title"><a id="note27"/>Note</h3><p>Note that the permissions menu is only displayed if you are a space administrator or super user.</p></div></div></li><li class="listitem">Clicking on the unlock icon will remove the restriction.<div><img src="img/9526_06_07.jpg" alt="Managing page restrictions"/></div></li></ol></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec42"/>Confluence security</h1></div></div></div><p>So far we have been talking about <a id="id575" class="indexterm"/>permissions and restrictions, which are of course a huge part of how to keep your data secure. But there are a few best practices and features in place to reduce the risk of your Confluence installation being corrupted and prevent the wrong people from getting access.</p><div><div><div><div><h2 class="title"><a id="ch06lvl2sec89"/>Secure administrator sessions</h2></div></div></div><p>Confluence protects <a id="id576" class="indexterm"/>access to its administrative functions by a special administrator<a id="id577" class="indexterm"/> session. When a user attempts to access the Administration Console or space administration, they are prompted to log in again. This logs the administrator into a temporary secure session that grants access to those administration screens. In other parts of the documentation this feature is also referred to as <a id="id578" class="indexterm"/>
<strong>WebSudo</strong>.</p><div><img src="img/9526_06_08.jpg" alt="Secure administrator sessions"/></div><p>The administrator session has a rolling timeout of 10 minutes (default). This means that if there is no activity in the Confluence or space administration for 10 minutes, the user will be logged out of the administrator session. If the user does click on any administrative function, the timeout will be reset.</p><p>To configure the <a id="id579" class="indexterm"/>secure administrator sessions:</p><div><ol class="orderedlist arabic"><li class="listitem">Browse to the Administration Console (<strong>Administration</strong> | <strong>Confluence Admin</strong>).</li><li class="listitem">Choose <strong>Security Configuration</strong> in the left-hand menu.</li><li class="listitem">Edit the settings:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">To disable secure administrator sessions, uncheck the <strong>Enable</strong> checkbox next to <strong>Secure administrator sessions</strong>.</li><li class="listitem" style="list-style-type: disc">To change the timeout of the sessions, update the value next to <strong>minutes before automatic invalidation</strong>.</li></ul></div></li><li class="listitem">Click on <a id="id580" class="indexterm"/><strong>Save</strong>.</li></ol></div><p>If your Confluence instance uses a custom build authentication mechanism, the extra login might cause problems as it checks the authentication against Confluence instead your own custom authentication server. Disabling password confirmation would be a valid solution.</p><p>An administrator can always manually end the secure session by clicking on <strong>Drop access</strong> in the banner displayed at the top of their screen as shown in the following screenshot:</p><div><img src="img/9526_06_10.jpg" alt="Secure administrator sessions"/></div></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec90"/>Atlassian security advisory</h2></div></div></div><p>Software such as<a id="id581" class="indexterm"/> Confluence<a id="id582" class="indexterm"/> is not flawless and every now and then a vulnerability is discovered. When such a vulnerability is discovered, Atlassian will calculate its severity based on the industry-standard <strong>Common Vulnerability Scoring System</strong> (<strong>CVSS</strong>).</p><div><div><h3 class="title"><a id="note28"/>Note</h3><p>For more information about <a id="id583" class="indexterm"/>CVSS, visit <a class="ulink" href="http://www.first.org/cvss/cvss-guide.html">http://www.first.org/cvss/cvss-guide.html</a>.</p></div></div><p>Based upon the CVSS scores, the severity will be mapped according to the following guidelines:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>CVSS score range</p>
</th><th style="text-align: left" valign="bottom">
<p>Severity in advisory</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>0 – 2.9</p>
</td><td style="text-align: left" valign="top">
<p>Low</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>3 – 5.9</p>
</td><td style="text-align: left" valign="top">
<p>Medium</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>6 – 7.9</p>
</td><td style="text-align: left" valign="top">
<p>High</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>8 – 10</p>
</td><td style="text-align: left" valign="top">
<p>Critical</p>
</td></tr></tbody></table></div><p>The following is a summary of the factors usually resulting in a specific severity. These ratings don't take your personal installation details into account, but are based upon an <a id="id584" class="indexterm"/>average installation.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Critical</strong>: This means<a id="id585" class="indexterm"/> the information required in order to exploit the vulnerability is widely available to attackers.<p>The exploitation is usually straightforward, meaning that the attackers don't need any special credentials or knowledge about individuals in your installation.</p><p>The exploitation of the vulnerability results in root-level compromise of your servers or other infrastructure devices.</p><div><div><h3 class="title"><a id="note29"/>Note</h3><p>For critical vulnerability, it is advised that you patch or upgrade as soon as possible, unless you have other measures in place. For example, if your Confluence installation is not accessed from the Internet.</p></div></div></li><li class="listitem" style="list-style-type: disc"><strong>High</strong>: Here, the exploitation doesn't result in elevated privileges.<p>The exploitation doesn't result in significant data loss or corruption.</p><p>And, the vulnerability is difficult to exploit.</p></li><li class="listitem" style="list-style-type: disc"><strong>Medium</strong>: The denial-of-service vulnerabilities are difficult to set up.<p>These vulnerabilities affect only nonstandard configurations or obscure applications.</p><p>This includes exploits that require an attacker to reside on the same local network as the victim.</p><p>This includes vulnerabilities that require the attacker to manipulate individual victims via social engineering tactics.</p><p>This includes vulnerabilities where exploitation provides only very limited access.</p></li><li class="listitem" style="list-style-type: disc"><strong>Low</strong>: Vulnerabilities in the low range normally have very little impact on an organization's business. Exploitation of such vulnerabilities usually requires local or physical system access.</li></ul></div><p>When a critical severity vulnerability is discovered, and resolved, Atlassian will inform their customers using the following channels:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Atlassian will post a security advisory in the latest documentation of Confluence at the same time as a fix for the vulnerability is released. Check the following link:<p>
<a class="ulink" href="https://confluence.atlassian.com/display/DOC/Confluence+Security+Overview+and+Advisories">https://confluence.atlassian.com/display/DOC/Confluence+Security+Overview+and+Advisories</a>
</p></li><li class="listitem" style="list-style-type: disc">Atlassian <a id="id586" class="indexterm"/>will send a copy of the security advisory to the "Technical Alerts" mailing list.</li></ul></div><p>If you want to <a id="id587" class="indexterm"/>track noncritical vulnerabilities, you can monitor the issue trackers for Confluence at <a class="ulink" href="https://jira.atlassian.com/browse/CONF">https://jira.atlassian.com/browse/CONF</a>. Security issues will be marked with a "security" label.</p></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec91"/>Limiting access to Confluence administration</h2></div></div></div><p>The Confluence <a id="id588" class="indexterm"/>Administration Console plays a <a id="id589" class="indexterm"/>vital role in keeping your Confluence installation running and making sure your users have the permissions they should have.</p><p>One way of further securing the Administration Console is limiting its access to certain machines on your network or on the Internet. If you are using an Apache web server in front of your Confluence installation, this would work as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">The first step is to create a file in a common location on your server. We will use this file to include the Apache configuration needed, making sure we only have one location to change instead of many. We can do that in the following manner:<div><ol class="orderedlist arabic"><li class="listitem">Create a file called <code class="literal">local_machines_only.conf</code> in your apache configuration directory.</li><li class="listitem">In this file add the following lines (only the bold part):</li></ol></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Order Deny, Allow</strong>: Look for the Deny rules first, then the Allow</li><li class="listitem" style="list-style-type: disc"><strong>Deny from All</strong>: Deny access for everybody</li><li class="listitem" style="list-style-type: disc"><strong>Allow from 192.168.1.5 #Arthurs machine</strong>: Allow access from Arthur's machine based upon IP</li></ul></div><div><div><h3 class="title"><a id="note30"/>Note</h3><p>More on access control with Apache at <a class="ulink" href="http://httpd.apache.org/docs/2.2/howto/access.html">http://httpd.apache.org/docs/2.2/howto/access.html</a>.</p></div></div></li><li class="listitem">The next step is to add a long list of locations to your Apache Virtual Host configurations. The following configuration assumes you've installed Confluence under the context path <code class="literal">/confluence</code>, that is, <code class="literal">http://mycompany.com/confluence</code>. If this is not true for your installation, <a id="id590" class="indexterm"/>change the locations <a id="id591" class="indexterm"/>in the following configuration accordingly:<div><pre class="programlisting">&lt;Location /confluence/admin&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/oauth/consumers/list&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/oauth/view-consumer-info&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/oauth/service-providers/list&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/oauth/service-providers/add&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/oauth/consumers/add&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/oauth/consumers/add-manually&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/oauth/update-consumer-info&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/pages/templates/listpagetemplates.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/pages/templates/createpagetemplate.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/spacepermissions.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/pages/listpermissionpages.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/removespace.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/importmbox.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/viewmailaccounts.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/addmailaccount.action?&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/importpages.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/flyingpdf/flyingpdf.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/exportspacehtml.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/spaces/exportspacexml.action&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/embedded-crowd&gt;
  Include local_machines_only.conf
&lt;/Location&gt;
&lt;Location /confluence/plugins/servlet/upm&gt;
  Include local_machines_only.conf
&lt;/Location&gt;</pre></div></li></ol></div><p>This will make<a id="id592" class="indexterm"/> sure the administrative<a id="id593" class="indexterm"/> functions can only be accessed by the specified machines and IPs.</p></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec92"/>Best practices</h2></div></div></div><p>How you set up your<a id="id594" class="indexterm"/> Confluence roles, permissions, and internal <a id="id595" class="indexterm"/>processes makes a big difference in keeping your Confluence installation secure. The following are some tips you could consider. None of these make your installation a full 100 percent secure, but they slow down or turn around any attacker.</p><p>In general you could say, "Don't put convenience go before security."</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Keep the number of Confluence administrators as low as possible, but having just one is also not without risks.</li><li class="listitem" style="list-style-type: disc">Restrict the number of users with powerful roles or group memberships. If only one group of users should have access to some particular data, restrict access to the data to those users. Do not give all staff access to sensitive data when there is no need.</li><li class="listitem" style="list-style-type: disc">Confluence administrators should have separate accounts for their administrative role and for their day-to-day work.</li><li class="listitem" style="list-style-type: disc">Lock down administrative access as much as possible. If there is no reason to perform administrative tasks from outside the office, use the previously mentioned method to restrict access to a known IP address.</li><li class="listitem" style="list-style-type: disc">Get documented procedures in place, for when people are leaving departments or the company, so that you can make sure those people cannot access you Confluence anymore.</li><li class="listitem" style="list-style-type: disc">The <a id="id596" class="indexterm"/>Confluence database user should only <a id="id597" class="indexterm"/>have the permissions to read and write to the Confluence database, and should not be allowed to perform administrative database functions.</li><li class="listitem" style="list-style-type: disc">Regularly monitor your security requirements as things change over time. Before you know it, you will have 10 administrators instead of three, or your Apache configuration will be modified when upgrading your systems.</li></ul></div><p>Keep in mind that these tips may only be a small part of your entire infrastructure. Apply those that make sense to your company and security requirements.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec43"/>Summary</h1></div></div></div><p>We have learned more about how to keep our content private using space permissions and page restrictions. Confluence has a hierarchical permission structure starting with super users who are allowed to change all permissions and view all content. With regard to security, a good rule to follow is to limit the number of users with administrative access to an absolute minimum.</p><p>It's important to note that restricting permissions can help to limit access to content that you create, but this works against the intended use and benefits of the application. Confluence is a wiki and as such is intended to encourage collaboration and sharing. Keep this in mind when you limit access to areas of your Confluence instance to specific users and groups.</p><p>The next chapter will go into customizing the look and feel of Confluence, so that it incorporates your company's branding.</p></div></body></html>