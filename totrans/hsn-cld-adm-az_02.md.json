["```\n{\n \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\n \"contentVersion\": \"1.0.0.0\",\n \"parameters\": {\n \"virtualMachines_PacktVM1_name\": {\n \"defaultValue\": \"PacktVM1\",\n \"type\": \"String\"\n },\n \"virtualNetworks_PacktVNet_name\": {\n \"defaultValue\": \"PacktVNet\",\n \"type\": \"String\"\n },\n \"networkInterfaces_packtvm1240_name\": {\n \"defaultValue\": \"packtvm1240\",\n \"type\": \"String\"\n },\n \"publicIPAddresses_PacktVM1_ip_name\": {\n \"defaultValue\": \"PacktVM1-ip\",\n \"type\": \"String\"\n },\n \"networkSecurityGroups_PacktVM1_nsg_name\": {\n \"defaultValue\": \"PacktVM1-nsg\",\n \"type\": \"String\"\n },\n \"subnets_DMZ_name\": {\n \"defaultValue\": \"DMZ\",\n \"type\": \"String\"\n },\n \"subnets_default_name\": {\n \"defaultValue\": \"default\",\n \"type\": \"String\"\n },\n \"securityRules_default_allow_rdp_name\": {\n \"defaultValue\": \"default-allow-rdp\",\n \"type\": \"String\"\n },\n \"adminUsername\": {\n \"type\": \"string\",\n \"metadata\": {\n \"description\": \"Default Admin username\"\n }\n },\n \"adminPassword\": {\n \"type\": \"securestring\",\n \"metadata\": {\n \"description\": \"Default Admin password\"\n }\n }\n },\n \"variables\": {},\n \"resources\": [\n {\n \"type\": \"Microsoft.Compute/virtualMachines\",\n \"name\": \"[parameters('virtualMachines_PacktVM1_name')]\",\n \"apiVersion\": \"2017-12-01\",\n \"location\": \"westeurope\",\n \"scale\": null,\n \"properties\": {\n \"hardwareProfile\": {\n \"vmSize\": \"Standard_B1s\"\n },\n \"storageProfile\": {\n \"imageReference\": {\n \"publisher\": \"MicrosoftWindowsServer\",\n \"offer\": \"WindowsServer\",\n \"sku\": \"2016-Datacenter\",\n \"version\": \"latest\"\n },\n \"osDisk\": {\n \"osType\": \"Windows\",\n \"name\": \"[concat(parameters('virtualMachines_PacktVM1_name'),'_OsDisk_1_b6ae3bba44ef491f8c2acd7bfb5aa975')]\",\n \"createOption\": \"FromImage\",\n \"caching\": \"ReadWrite\",\n \"managedDisk\": {\n \"storageAccountType\": \"Standard_LRS\"\n },\n \"diskSizeGB\": 127\n },\n \"dataDisks\": []\n },\n \"osProfile\": {\n \"computerName\": \"[parameters('virtualMachines_PacktVM1_name')]\",\n \"adminUsername\": \"[parameters('adminUsername')]\",\n \"adminPassword\": \"[parameters('adminPassword')]\",\n \"windowsConfiguration\": {\n \"provisionVMAgent\": true,\n \"enableAutomaticUpdates\": true\n },\n \"secrets\": []\n },\n \"networkProfile\": {\n \"networkInterfaces\": [\n {\n \"id\": \"[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_packtvm1240_name'))]\"\n }\n ]\n },\n \"diagnosticsProfile\": {\n \"bootDiagnostics\": {\n \"enabled\": true,\n \"storageUri\": \"https://nagiosdiag316.blob.core.windows.net/\"\n }\n }\n },\n \"dependsOn\": [\n \"[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_packtvm1240_name'))]\"\n ] \n },\n {\n \"type\": \"Microsoft.Network/networkInterfaces\",\n \"name\": \"[parameters('networkInterfaces_packtvm1240_name')]\",\n \"apiVersion\": \"2018-02-01\",\n \"location\": \"westeurope\",\n \"scale\": null,\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"resourceGuid\": \"2d51720b-041b-4248-ab04-8dd9fd3fa7d9\",\n \"ipConfigurations\": [\n {\n \"name\": \"ipconfig1\",\n \"etag\": \"W/\\\"b681e202-2d98-4d28-a30d-aaf93b9f1243\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"privateIPAddress\": \"10.1.1.4\",\n \"privateIPAllocationMethod\": \"Static\",\n \"publicIPAddress\": {\n \"id\": \"[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_PacktVM1_ip_name'))]\"\n },\n \"subnet\": {\n \"id\": \"[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_PacktVNet_name'), parameters('subnets_DMZ_name'))]\"\n },\n \"primary\": true,\n \"privateIPAddressVersion\": \"IPv4\"\n }\n }\n ],\n \"dnsSettings\": {\n \"dnsServers\": [],\n \"appliedDnsServers\": [],\n \"internalDomainNameSuffix\": \"gbyhmwrx0mmutogdwlxg2i521c.ax.internal.cloudapp.net\"\n },\n \"macAddress\": \"00-0D-3A-2E-EA-03\",\n \"enableAcceleratedNetworking\": false,\n \"enableIPForwarding\": false,\n \"networkSecurityGroup\": {\n \"id\": \"[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_PacktVM1_nsg_name'))]\"\n },\n \"primary\": true\n },\n \"dependsOn\": [\n \"[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_PacktVM1_ip_name'))]\",\n \"[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_PacktVNet_name'), parameters('subnets_DMZ_name'))]\",\n \"[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_PacktVM1_nsg_name'))]\"\n ]\n },\n {\n \"type\": \"Microsoft.Network/networkSecurityGroups\",\n \"name\": \"[parameters('networkSecurityGroups_PacktVM1_nsg_name')]\",\n \"apiVersion\": \"2018-02-01\",\n \"location\": \"westeurope\",\n \"scale\": null,\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"resourceGuid\": \"11b65174-a94e-44e1-947c-dd140c45a6c8\",\n \"securityRules\": [\n {\n \"name\": \"default-allow-rdp\",\n \"etag\": \"W/\\\"9b7736d4-5a76-4804-a63f-6cd1875f1d5c\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"protocol\": \"TCP\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"3389\",\n \"sourceAddressPrefix\": \"*\",\n \"destinationAddressPrefix\": \"*\",\n \"access\": \"Allow\",\n \"priority\": 1000,\n \"direction\": \"Inbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n }\n }\n ],\n \"defaultSecurityRules\": [\n {\n \"name\": \"AllowVnetInBound\",\n \"etag\": \"W/\\\"9b7736d4-5a76-4804-a63f-6cd1875f1d5c\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"description\": \"Allow inbound traffic from all VMs in VNET\",\n \"protocol\": \"*\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"*\",\n \"sourceAddressPrefix\": \"VirtualNetwork\",\n \"destinationAddressPrefix\": \"VirtualNetwork\",\n \"access\": \"Allow\",\n \"priority\": 65000,\n \"direction\": \"Inbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n }\n },\n {\n \"name\": \"AllowAzureLoadBalancerInBound\",\n \"etag\": \"W/\\\"9b7736d4-5a76-4804-a63f-6cd1875f1d5c\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"description\": \"Allow inbound traffic from azure load balancer\",\n \"protocol\": \"*\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"*\",\n \"sourceAddressPrefix\": \"AzureLoadBalancer\",\n \"destinationAddressPrefix\": \"*\",\n \"access\": \"Allow\",\n \"priority\": 65001,\n \"direction\": \"Inbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n }\n },\n {\n \"name\": \"DenyAllInBound\",\n \"etag\": \"W/\\\"9b7736d4-5a76-4804-a63f-6cd1875f1d5c\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"description\": \"Deny all inbound traffic\",\n \"protocol\": \"*\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"*\",\n \"sourceAddressPrefix\": \"*\",\n \"destinationAddressPrefix\": \"*\",\n \"access\": \"Deny\",\n \"priority\": 65500,\n \"direction\": \"Inbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n }\n },\n {\n \"name\": \"AllowVnetOutBound\",\n \"etag\": \"W/\\\"9b7736d4-5a76-4804-a63f-6cd1875f1d5c\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"description\": \"Allow outbound traffic from all VMs to all VMs in VNET\",\n \"protocol\": \"*\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"*\",\n \"sourceAddressPrefix\": \"VirtualNetwork\",\n \"destinationAddressPrefix\": \"VirtualNetwork\",\n \"access\": \"Allow\",\n \"priority\": 65000,\n \"direction\": \"Outbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n }\n },\n {\n \"name\": \"AllowInternetOutBound\",\n \"etag\": \"W/\\\"9b7736d4-5a76-4804-a63f-6cd1875f1d5c\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"description\": \"Allow outbound traffic from all VMs to Internet\",\n \"protocol\": \"*\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"*\",\n \"sourceAddressPrefix\": \"*\",\n \"destinationAddressPrefix\": \"Internet\",\n \"access\": \"Allow\",\n \"priority\": 65001,\n \"direction\": \"Outbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n }\n },\n {\n \"name\": \"DenyAllOutBound\",\n \"etag\": \"W/\\\"9b7736d4-5a76-4804-a63f-6cd1875f1d5c\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"description\": \"Deny all outbound traffic\",\n \"protocol\": \"*\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"*\",\n \"sourceAddressPrefix\": \"*\",\n \"destinationAddressPrefix\": \"*\",\n \"access\": \"Deny\",\n \"priority\": 65500,\n \"direction\": \"Outbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n }\n }\n ]\n },\n \"dependsOn\": []\n },\n{\n \"type\": \"Microsoft.Network/publicIPAddresses\",\n \"sku\": {\n \"name\": \"Basic\",\n \"tier\": \"Regional\"\n },\n \"name\": \"[parameters('publicIPAddresses_PacktVM1_ip_name')]\",\n \"apiVersion\": \"2018-02-01\",\n \"location\": \"westeurope\",\n \"scale\": null,\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"resourceGuid\": \"972b3091-fe6e-49cc-bd06-22d260608254\",\n \"ipAddress\": \"40.74.60.181\",\n \"publicIPAddressVersion\": \"IPv4\",\n \"publicIPAllocationMethod\": \"Dynamic\",\n \"idleTimeoutInMinutes\": 4,\n \"ipTags\": []\n },\n \"dependsOn\": []\n },\n{\n \"type\": \"Microsoft.Network/virtualNetworks\",\n \"name\": \"[parameters('virtualNetworks_PacktVNet_name')]\",\n \"apiVersion\": \"2018-02-01\",\n \"location\": \"westeurope\",\n \"scale\": null,\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"resourceGuid\": \"5a767030-d337-4919-b8c3-b2ee6e23fcda\",\n \"addressSpace\": {\n \"addressPrefixes\": [\n \"10.1.0.0/16\",\n \"10.2.0.0/16\"\n ]\n },\n \"subnets\": [\n {\n \"name\": \"default\",\n \"etag\": \"W/\\\"98f91850-e7b2-40b6-8043-1caa5bf4865a\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"addressPrefix\": \"10.1.0.0/24\",\n \"serviceEndpoints\": []\n }\n },\n {\n \"name\": \"DMZ\",\n \"etag\": \"W/\\\"98f91850-e7b2-40b6-8043-1caa5bf4865a\\\"\",\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"addressPrefix\": \"10.1.1.0/24\",\n \"serviceEndpoints\": []\n }\n }\n ],\n \"virtualNetworkPeerings\": [],\n \"enableDdosProtection\": false,\n \"enableVmProtection\": false\n },\n \"dependsOn\": []\n },\n{\n \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\n \"name\": \"[concat(parameters('networkSecurityGroups_PacktVM1_nsg_name'), '/', parameters('securityRules_default_allow_rdp_name'))]\",\n \"apiVersion\": \"2018-02-01\",\n \"scale\": null,\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"protocol\": \"TCP\",\n \"sourcePortRange\": \"*\",\n \"destinationPortRange\": \"3389\",\n \"sourceAddressPrefix\": \"*\",\n \"destinationAddressPrefix\": \"*\",\n \"access\": \"Allow\",\n \"priority\": 1000,\n \"direction\": \"Inbound\",\n \"sourcePortRanges\": [],\n \"destinationPortRanges\": [],\n \"sourceAddressPrefixes\": [],\n \"destinationAddressPrefixes\": []\n },\n \"dependsOn\": [\n \"[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_PacktVM1_nsg_name'))]\"\n ]\n },\n{\n \"type\": \"Microsoft.Network/virtualNetworks/subnets\",\n \"name\": \"[concat(parameters('virtualNetworks_PacktVNet_name'), '/', parameters('subnets_default_name'))]\",\n \"apiVersion\": \"2018-02-01\",\n \"scale\": null,\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"addressPrefix\": \"10.1.0.0/24\",\n \"serviceEndpoints\": []\n },\n \"dependsOn\": [\n \"[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_PacktVNet_name'))]\"\n ]\n },\n{\n \"type\": \"Microsoft.Network/virtualNetworks/subnets\",\n \"name\": \"[concat(parameters('virtualNetworks_PacktVNet_name'), '/', parameters('subnets_DMZ_name'))]\",\n \"apiVersion\": \"2018-02-01\",\n \"scale\": null,\n \"properties\": {\n \"provisioningState\": \"Succeeded\",\n \"addressPrefix\": \"10.1.1.0/24\",\n \"serviceEndpoints\": []\n },\n\"dependsOn\": [\n\"[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_PacktVNet_name'))]\"\n]\n}\n]\n}\n```"]