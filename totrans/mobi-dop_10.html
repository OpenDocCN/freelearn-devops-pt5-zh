<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Debugging the Application</h1>
                </header>
            
            <article>
                
<p>Debugging, in application development, is the process of identifying an issue or a problem, using a debugging tool or IDE that provides debugging methods. It involves stepping through the code and analyzing the variables and methods, and their values, to pinpoint the exact place of the issue.</p>
<p>If you have been an application developer for some time now, you should have an idea about how important debugging is in the process of application development, and even if you are a new developer or just starting out, this chapter will help you get started with debugging terminology, how to debug Xamarin applications in Visual Studio, and how to troubleshoot other issues that might arise during development.</p>
<p>In this chapter, you'll be learning in depth about the following topics:</p>
<ul>
<li>Debugging a Xamarin application in Visual Studio</li>
<li>Debugging and troubleshooting in the Android emulator</li>
<li>Debugging Mono class libraries and using debug logs</li>
<li>Debugging Git connections</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Terminology</h1>
                </header>
            
            <article>
                
<p>It's better first to get an idea of the different terms used in the process of debugging. These are commonly used terms and are common to all debugging platforms:</p>
<ul>
<li><strong>Bug</strong>: A bug is a defect or a problem that is stopping the program or the application from performing its expected functions.</li>
<li><strong>Debug</strong>: You might have guessed it by now, but a <em>debug</em>, as the name suggests, involves removing bugs from the system or program. It usually denotes finding the problem by digging into the program and resolving it after it is identified by correcting the erroneous code.</li>
<li><strong>Breakpoint</strong>: As the name suggests, a breakpoint is a point where you want to break the running application, and by <em>break</em>, we mean <em>pause</em>. So, it is a point in your application program's code where you want to pause the running application and see what's happened, or what's happening. It is very useful and a critical tool in debugging an application.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Debugging with Xamarin on Visual Studio</h1>
                </header>
            
            <article>
                
<p>Visual Studio is a great IDE for debugging any application, whether it's a web, mobile, or a desktop application. It uses the same debugger that comes with the IDE for all three, and is very easy to follow.</p>
<p>To keep the chapter easy to follow, we'll be using the same Android application we developed and tested on Xamarin while debugging in Visual Studio.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using the output window</h1>
                </header>
            
            <article>
                
<p>The output window in Visual Studio is a window where you can see the output of what's happening. To view the output window in Visual Studio, follow these steps:</p>
<ol>
<li>Go to <span class="packt_screen">View</span> and click <span class="packt_screen">Output</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/d2666fc5-ead0-4eed-8376-cac9ab217289.png" style=""/></div>
<ol start="2">
<li>This will open a small window at the bottom where you can see the current and useful output being written by Visual Studio. For example, this is what is shown in the output windows when we rebuild the application:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/914e709c-5b7c-48a7-85ed-86b3d916a1e6.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using the Console class to show useful output</h1>
                </header>
            
            <article>
                
<p>The <kbd>Console</kbd> class can be used to print some useful information, such as logs, to the output window to get an idea of what steps are being executed. This can help if a method is failing after certain steps, as that will be printed in the output window.</p>
<p>To achieve this, C# has the <kbd>Console</kbd> class, which is a static class. This class has methods such as <kbd>Write()</kbd> and <kbd>WriteLine()</kbd> to write anything to the output window. The <kbd>Write()</kbd> method writes anything to the output window, and the <kbd>WriteLine()</kbd> method writes the same way with a new line at the end:</p>
<ol>
<li>Look at the following screenshot and analyze how <kbd>Console.WriteLine()</kbd> is used to break down the method into several steps (it is the same <kbd>Click</kbd> event method that was written while developing <strong>PhoneCallApp</strong>):</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/64ec0a79-f53f-44f3-b3a2-d3d2cce6a633.png" style=""/></div>
<ol start="2">
<li>Add <kbd>Console.WriteLine()</kbd> to your code, as shown in the preceding screenshot.</li>
<li>Now, run the application, perform the operation, and see the output written as per your code:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/17ab4d18-7ce4-4e3d-82bd-641f9f52946c.png"/></div>
<ol start="4">
<li>This way, <kbd>Console.WriteLine()</kbd> can be used to write useful step-based outputs/logs to the output window, which can be analyzed to identify issues while debugging.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using breakpoints</h1>
                </header>
            
            <article>
                
<p>As described earlier, breakpoints are a great way to dig deep into the code without much hassle. They can help check variables and their values, and the flow at a point or line in the code.</p>
<p>Using breakpoints is very simple:</p>
<ol>
<li>The simplest way to add a breakpoint on a line is to click on the margin, which is on the left side, in front of the line, or click on the line and hit the <em>F9</em> key:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/44e7bc47-ccf2-4d1e-876d-d728bbeb00fe.png"/></div>
<ol start="2">
<li>You'll see a red dot in the margin area where you clicked when the breakpoint is set, as shown in the preceding screenshot.</li>
<li>Now, run the application and perform a call button click on it; the flow should stop at the breakpoint and the line will turn yellow when it does:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/557f584c-d820-42cf-b023-19503cfc11e0.png"/></div>
<ol start="4">
<li>At this point, you can inspect the values of variables before the breakpoint line by hovering over them:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/f40ee58e-74ef-432b-9245-a4172a2bb523.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Setting a conditional breakpoint</h1>
                </header>
            
            <article>
                
<p>You can also set a conditional breakpoint in the code, which is basically telling Visual Studio to pause the flow only when a certain condition is met:</p>
<ol>
<li>Right-click on the breakpoint set in the previous steps, and click <span class="packt_screen">Conditions</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/cfe0067f-f068-485c-b71c-f3c7572ea414.png"/></div>
<ol start="2">
<li>This will open a small window over the code to set a condition for the breakpoint. For example, in the following screenshot, a condition is set to when <kbd>phoneNumber == "9900000700"</kbd>.</li>
</ol>
<p style="padding-left: 60px">So, the breakpoint will only be hit when this condition is met; otherwise, it'll not be hit.</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/5eab04cb-f10a-43ec-9c09-a6d11dccaa54.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Stepping through the code</h1>
                </header>
            
            <article>
                
<p>When a breakpoint has been reached, the debug tools enable you to get control over the program's execution flow. You'll see some buttons in the toolbar, allowing you to run and step through the code:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/0e88f13a-2051-4592-a046-b45d70022d89.png"/></div>
<p>You can hover over these buttons to see their respective names:</p>
<ul>
<li><strong>Step Over (F10)</strong>: This executes the next line of code. Step Over will execute the function if the next line is a function call, and will stop after the function:</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/4ba3d133-5d2e-4efa-8f58-fe7d2b94bf8d.png" style=""/></div>
<ul>
<li><strong>Step Into (F11)</strong>: Step Into will stop at the next line in the case of a function call, allowing you to continue line-by-line debugging of the function. If the next line is not a function, it will behave the same as Step Over:</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/1478de05-8c82-41a7-a959-41f024ef3d0f.png" style=""/></div>
<ul>
<li><strong>Step Out (Shift + F11)</strong>: This will return to the line where the current function was called:</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/3b8a3dad-3a84-4b54-9e8c-56c242d9b8f2.png" style=""/></div>
<ul>
<li><strong>Continue</strong>: This will continue the execution and run until the next breakpoint is reached:</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/8c1ecc57-086c-4f43-bb21-352fee02d2a2.png" style=""/></div>
<ul>
<li><strong>Stop Debugging</strong>: This will stop the debugging process:</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/67446282-e1e0-4736-9246-1e3d910da205.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using a watch</h1>
                </header>
            
            <article>
                
<p>A watch is a very useful function in debugging; it allows us to see the values, types, and other details related to variables, and evaluate them in a better way than hovering over the variables.</p>
<p>There are two types of watch tools available in Visual Studio:</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">QuickWatch</h1>
                </header>
            
            <article>
                
<p>QuickWatch is similar to watch, but as the name suggests, it allows us to evaluate the values at the time. Follow these steps to use QuickWatch in Visual Studio:</p>
<ol>
<li>Right-click on the variable you want to analyze and click on <span class="packt_screen">QuickWatch</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/b99e641a-97f0-4f4f-9985-4300c3792dfc.png" style=""/></div>
<ol start="2">
<li>This will open a new window where you can see the type, value, and other details related to the variable:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/b6694928-0489-4cf7-b741-572b5ac7c8ef.png"/></div>
<ol start="3">
<li>This is very useful when a variable has a long value or string that cannot be read and evaluated properly by just hovering over the variable.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding a watch</h1>
                </header>
            
            <article>
                
<p>Adding a watch is similar to QuickWatch, but it is more useful when you have multiple variables to analyze, and looking at each variable's value can take a lot of time.</p>
<p>Follow these steps to add a watch on variables:</p>
<ol>
<li>Right-click on the variable and click <span class="packt_screen">Add Watch</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/209a1258-3810-461d-bdca-1199b718ca1a.png"/></div>
<ol start="2">
<li>This will add the variable to watch and show you its value always, as well as reflect any time it changes at runtime.</li>
<li>You can also see these variable values in a particular format for different data types, so you can have an XML value shown in XML format, or a JSON object value shown in <kbd>.json</kbd> format:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/c892b4d5-8cd5-4de2-b01c-cae08aff451f.png"/></div>
<ol start="4">
<li>It is a lifesaver when you want to evaluate a variable's value in each step of the code, and see how it changes with every line.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Debugging Mono class libraries</h1>
                </header>
            
            <article>
                
<p>Xamarin ships with the source code for Mono class libraries, and you can use this to debug the Xamarin (formerly known as Mono) source code:</p>
<ol>
<li>To be able to use this option, go to <span class="packt_screen">Debug</span> | <span class="packt_screen">Options</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/c218a48e-58fc-4e4d-bab2-4993c254a18d.png"/></div>
<ol start="2">
<li>Then, go to <span class="packt_screen">General</span>, uncheck the <span class="packt_screen">Enable Just My Code</span> option, and click <span class="packt_screen">OK</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/30870a66-4f60-4194-a905-108a3fcce11f.png"/></div>
<ol start="3">
<li>Once this is disabled, we can step into Mono class libraries and debug them.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Android debug log</h1>
                </header>
            
            <article>
                
<p>As mentioned in previous sections of this chapter, we have seen how to use the <kbd>Console.WriteLine()</kbd> method to write some output steps while debugging in Visual Studio.</p>
<p>However, on a mobile platform like Android, there is no console and it is only available for us during debugging in Visual Studio. Android devices provide a log that you can utilize while coding Android apps. This is also known as <strong>logcat</strong> due to the command used to retrieve this log.</p>
<p>To access this from Visual Studio, follow these steps:</p>
<ol>
<li>Either you can directly click on the Device Log (logcat) icon from the Android tools in the toolbar, or you can go to <span class="packt_screen">Tools</span> | <span class="packt_screen">Android</span> | <span class="packt_screen">Device Log</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/7cc0030c-c0cc-442f-a11d-eb312c1ba319.png"/></div>
<ol start="2">
<li>This will open a new window where you can choose the device your application is running on. The application needs to be running on a physical device to be clear, since it is debugging when the app is running on the device and the log is provided by Android devices:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/0747136a-b98a-4f28-bf85-ef6428fb1a72.png" style=""/></div>
<ol start="3">
<li>Select the device from the dropdown that lists running applications.</li>
</ol>
<ol start="4">
<li>When the device is selected, it automatically starts to add log entries from a running app in the table. Switching between devices will stop and start the device logging:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/0f9bfdaa-d071-41ba-a616-9d722f0265e6.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Accessing logcat from the command line</h1>
                </header>
            
            <article>
                
<p>Another option to view the debug log is via the command line:</p>
<ol>
<li>Open a console window and navigate to the Android SDK <kbd>platform-tools</kbd> folder (such as <kbd>C:\Program Files (x86)\Android\android-sdk\platform-tools</kbd>).</li>
</ol>
<ol start="2">
<li>If only one device is attached, the log can be viewed with the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>$ adb logcat </strong>  </pre>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/cd338533-5a46-43fb-944a-b6be8007caa8.png"/></div>
<ol start="3">
<li>If more than one device is attached, then the device must be identified. For example, <kbd>adb -d logcat</kbd> shows the log of the only physical device connected, while <kbd>adb -e logcat</kbd> shows the log of the only emulator running.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Writing to the debug log</h1>
                </header>
            
            <article>
                
<p>You can log messages to the debug log using the <kbd>Android.Util.Log</kbd> class. It has different levels of logging:</p>
<ul>
<li>Info</li>
<li>Debug</li>
<li>Warning</li>
<li>Error</li>
</ul>
<p>All these levels are self-explanatory.</p>
<ol>
<li>Let's replace the <kbd>Console.WriteLine()</kbd> written in the previous section with <kbd>Log.Debug()</kbd> to write the logs into logcat:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/7138e50d-218a-4a5f-8104-13dd4ec38cee.png"/></div>
<ol start="2">
<li>Go to the logcat (<span class="packt_screen">Device Log</span>) window and filter tags with the tag given in the code to see only the logs we have written in the code. In this case, the tag will be <span class="packt_screen">PhoneCall</span>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/35966dc5-bd19-4e1e-be00-cb48314452b5.png"/></div>
<ol start="3">
<li>This is a very simple and straightforward way of debugging and monitoring an application running on a physical device.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Debugging Git connections</h1>
                </header>
            
            <article>
                
<p>Git is essential for saving code into repositories, but there can be some times when it is not working as expected, just like with our application. To debug Git when you are not able to fetch or clone code from the repo, try the following steps:</p>
<ul>
<li><strong>Check your connectivity</strong>: This will be the first thing to check when you are facing any issues with Git. It might be possible that your connection is not as you think it is. Ping any public domain site, such as <a href="https://www.google.com"><span class="URLPACKT">https://www.google.com</span></a>, to check your connectivity:</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/759ac85a-a4a4-4124-9fc1-17a6ef118a82.png"/></div>
<p style="padding-left: 60px">If you get a response like the one shown in the preceding screenshot and are able to ping successfully, that means your connection is totally fine.</p>
<ul>
<li><strong>GIT_TRACE</strong>: This configuration option gives us a more verbose trace to Git network connections and all the internal commands it goes through. Type your <kbd>git</kbd> command with <kbd>GIT_TRACE = 1</kbd> and it should give you a detailed verbose trace for it:
<ol>
<li>Add a new environment variable named <kbd>GIT_TRACE</kbd> <span>and give it the value of</span> <kbd>1</kbd><span>.</span></li>
</ol>
</li>
</ul>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/0a2999e8-97e7-4f54-8b2c-94078c59ccf0.png" style=""/></div>
<ol>
<li style="list-style-type: none">
<ol start="2">
<li>Run the <kbd>git</kbd> command and get details to identify the issue:</li>
</ol>
</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img src="assets/4afd75ff-9b85-440e-8311-7e173620c41a.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we covered debugging in different ways and learned to use the tools available in Visual Studio and Xamarin (Android) for debugging. This chapter also explained the Android Device Log, also known as logcat, to read and write logs when debugging applications on a physical device. In the next chapter, we'll be going through the entire development, testing, and debugging process with some case studies.</p>


            </article>

            
        </section>
    </body></html>