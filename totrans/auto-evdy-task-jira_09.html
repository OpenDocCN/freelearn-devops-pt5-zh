<html><head></head><body>
		<div><h1 id="_idParaDest-128"><em class="italic"><a id="_idTextAnchor107"/>Chapter 6</em>: Automating Jira Service Management</h1>
			<p>Today, Jira Service Management is used by many organizations to provide customer support portals, <strong class="bold">human resources</strong> (<strong class="bold">HR</strong>) services, and <strong class="bold">information technology</strong> (<strong class="bold">IT</strong>) service desks, among others.</p>
			<p>The most common use case for Jira Service Management, however, is as an <strong class="bold">IT Service Management</strong> (<strong class="bold">ITSM</strong>) solution to enable the efficient provision of IT services within an organization.</p>
			<p>One of the best ways to improve efficiency and drive down the cost per ticket in an IT service desk request is to automate mundane tasks and processes wherever possible.</p>
			<p>Some of the most common tasks wherein automation provides immediate benefits are the categorization and routing of tickets, keeping customers updated as to the status of their requests, maintaining <strong class="bold">service-level agreement</strong> (<strong class="bold">SLA</strong>) compliance, freeing up support staff from repetitive tasks, and closing out older requests to ensure they are not clogging up your request queues.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Processing incoming requests</li>
				<li>Monitoring SLA compliance</li>
				<li>Automating common and repetitive tasks</li>
			</ul>
			<p>By the end of this chapter, you will have a better understanding of how you can use automation rules in Jira Service Management to improve the efficiency of your service desks. In addition, reducing the amount of human intervention necessary to complete common tasks will also reduce the cost per ticket of service desk requests.</p>
			<h1 id="_idParaDest-129"><a id="_idTextAnchor108"/>Technical requirements</h1>
			<p>The requirements for this chapter are as follows:</p>
			<ul>
				<li><strong class="bold">Jira Cloud environment</strong>: If you don't already have access to Jira, you can create a free Jira Cloud account at <a href="https://www.atlassian.com/software/jira/free">https://www.atlassian.com/software/jira/free</a> and ensure that you have both <strong class="bold">Jira Software</strong> and <strong class="bold">Jira Service Management</strong> selected.</li>
				<li><strong class="bold">Jira Server environment</strong>: If you are using Jira Server (available from <a href="https://www.atlassian.com/software/jira/download">https://www.atlassian.com/software/jira/download</a>), ensure you have licenses for both Jira Software and Jira Service Management. In addition, you will also need to ensure that you install the <em class="italic">Automation for Jira</em> app available from the Atlassian Marketplace.</li>
				<li><strong class="bold">Microsoft Azure Active Directory (Azure AD)</strong>: Azure AD is Microsoft's cloud-based identity service. You can sign up for a free Azure account at <a href="https://azure.microsoft.com/free">https://azure.microsoft.com/free</a>.</li>
			</ul>
			<p>In both instances, you will need to have at least <strong class="bold">Project Administrator</strong> access to a Service Management project and a Scrum Software project to be able to follow the examples in this chapter. For the examples in this chapter, we have used the <em class="italic">IT Service project template</em> to create the Service Management project and the <em class="italic">Scrum Software project template</em> to create the software project.</p>
			<p>You can download the latest code samples for this chapter from this book's official GitHub repository at <a href="https://github.com/PacktPublishing/Automate-Everyday-Tasks-in-Jira">https://github.com/PacktPublishing/Automate-Everyday-Tasks-in-Jira</a>. Please visit the following link to check the CiA videos: <a href="https://bit.ly/2NhMFp9">https://bit.ly/2NhMFp9</a></p>
			<h1 id="_idParaDest-130"><a id="_idTextAnchor109"/>Processing incoming requests</h1>
			<p>One of the more<a id="_idIndexMarker300"/> time-consuming tasks in a service desk is the categorization and routing of incoming requests to the correct teams. </p>
			<p>Having a mature service request catalog and using this as a basis to create relevant request types in the Jira Service Management portal solves the initial categorization issue when customers create requests; however, in many organizations requests are still received via email, and these generally require human intervention to categorize and route to the relevant team.</p>
			<p>In this section, we will look at automation rules to automatically triage incoming requests and then route <a id="_idIndexMarker301"/>them to the correct teams for processing. </p>
			<p>In our first example, we will look at how we can use automation rules to triage requests originating from incoming emails. </p>
			<h2 id="_idParaDest-131"><a id="_idTextAnchor110"/>Creating a rule to triage email requests</h2>
			<p>One of the benefits of having <a id="_idIndexMarker302"/>a well-structured customer portal is that you can make use of your organization's service request catalog to drive the correct selection of service requests using request types, and at <a id="_idIndexMarker303"/>the same time using pre-selected components in each service request to narrow down the categorization of the request.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To pre-define a value for any field in a request type, add that field to the request form as a hidden field. Doing this will force you to supply the field with a default value that you can then rely on in later automations.</p>
			<p>This approach ensures that tickets reaching your service desk queues have already been categorized with the correct components, which we can use to drive the automations.</p>
			<p>However, email requests are still widely used to create service desk requests, and these typically end up in a service queue that requires human intervention to triage and correctly categorize.</p>
			<p>In this example, we'll use an automation rule to triage and categorize incoming emails with the correct components based on the presence of specific keywords in the email. To keep things simple, we'll only examine the issue summary, which is set from the email subject.</p>
			<p>Let's take a look at the rule, as follows:</p>
			<ol>
				<li>In your Jira Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the <strong class="bold">Project Settings</strong> menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Select the <strong class="bold">Issue created</strong> trigger and click <strong class="bold">Save</strong>.</li>
				<li>Then, select <code>Request Type</code></p><p><code>equals</code></p><p><code>Emailed request</code></p></li>
				<li>Next, select <code>Summary</code></p><p><code>contains</code></p><p><code>vpn</code></p></li>
				<li>Select <code>Components</code> field from the <code>VPN Server</code> component and click <strong class="bold">Save</strong>.</li>
				<li>Click on <code>Summary</code></p><p><code>contains</code></p><p><code>password</code></p></li>
				<li>Now, select <code>Components</code> field from the <code>Active Directory</code> component and click <strong class="bold">Save</strong>.</li>
				<li>The rule should now look similar to the one shown in the following screenshot:<div><img src="img/B16551_Figure_6.1.jpg" alt="Figure 6.1 – Triaging incoming email requests&#13;&#10;"/></div><p class="figure-caption">Figure 6.1 – Triaging incoming email requests</p></li>
				<li>You could continue to <a id="_idIndexMarker306"/>add else-if <a id="_idIndexMarker307"/>blocks for as many components as you need; however, for this example, we'll stop here and name the rule <code>Triage email requests</code>, and then click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>Now that we've learned how to categorize incoming requests that we've received via email, let's see how we can <a id="_idIndexMarker308"/>extend this <a id="_idIndexMarker309"/>to route and assign requests to the correct teams.</p>
			<h2 id="_idParaDest-132"><a id="_idTextAnchor111"/>Creating a rule to automatically route requests</h2>
			<p>Using automation<a id="_idIndexMarker310"/> rules to automatically categorize incoming requests will help shorten the response time for ticket handling. However, we can take this one step further and automatically route and assign the request to the correct team, further shortening the response and resolution times.</p>
			<p>In this example, we are going to<a id="_idIndexMarker311"/> make use of the ability to pre-define components for each request type and use these to assign incoming requests to the correct team. In addition, we will ensure that the automatic categorization rule we created previously can feed into this rule.</p>
			<p>We will be referring to the <em class="italic">Network Team</em> and <em class="italic">System Administrator Team</em> user groups, so you will need to create these user groups in your instance for this rule to work correctly.</p>
			<p>Let's get started with the rule, as follows:</p>
			<ol>
				<li value="1">In your Jira Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the <strong class="bold">Project Settings</strong> menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Select the <code>Issue Created</code> and <code>Issue Updated</code>, then click <strong class="bold">Save</strong>.</li>
				<li>Next, select <code>Components</code></p><p><code>contains any of</code></p><p><code>VPN Server</code></p></li>
				<li>Then, select <code>User in a group</code></p><p><code>Balanced workload</code></p><p><code>Network Team</code></p></li>
				<li>Click on <code>Components</code></p><p><code>contains any of</code></p><p><code>Active Directory</code></p></li>
				<li>Click on <code>Summary</code></p><p><code>does not contain</code></p><p><code>password</code></p></li>
				<li>Now, select <code>User in a group</code></p><p><code>Balanced workload</code></p><p><code>System Administrator Team</code></p></li>
				<li>You can continue to add further Else-If blocks to route more requests; however, for this example, we'll only create these two conditions.</li>
				<li>Before we save<a id="_idIndexMarker314"/> this rule, we need to ensure that it can be triggered by the rule that categorizes incoming emails. </li>
				<li>Click on <code>Route incoming requests</code></p><p><strong class="bold">Allow rule trigger</strong>: Ensure<a id="_idIndexMarker315"/> the checkbox is selected</p><p>Your rule should now look similar to the one shown in the following screenshot:</p><div><img src="img/B16551_Figure_6.2.jpg" alt="Figure 6.2 – Routing incoming requests&#13;&#10;"/></div><p class="figure-caption">Figure 6.2 – Routing incoming requests</p></li>
				<li>Finally, click <strong class="bold">Save</strong> and then click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this section, we have learned<a id="_idIndexMarker316"/> how to use automation<a id="_idIndexMarker317"/> rules to process incoming requests to Jira Service Management by firstly categorizing them where appropriate, and then routing them to the correct teams for resolution.</p>
			<p>In the next section, we will look at how to use automation rules to monitor SLA compliance.</p>
			<h1 id="_idParaDest-133"><a id="_idTextAnchor112"/>Monitoring SLA compliance</h1>
			<p>SLAs are important <a id="_idIndexMarker318"/>metrics that are set to ensure that IT services are delivered within an agreed time period with respect to their priority and nature.</p>
			<p>To maintain the agreed SLA compliance ratio of requests, we need to ensure that where possible, their priority is automatically increased when they are about to breach their SLA so that they gain a higher chance of their SLAs being met.</p>
			<p>Additionally, this should be accompanied by appropriate notifications to the assigned agent, the service desk team, and the service desk manager, allowing for the appropriate response should the agent not be able to deliver a resolution with the SLA.</p>
			<p>In this section, we will look at how to use automation rules to keep abreast of SLAs and how to manage requests when these are breached. </p>
			<p>Let's look at an example by creating a rule to monitor the <em class="italic">Time to first response</em> SLA and notify the appropriate persons as applicable. </p>
			<h2 id="_idParaDest-134"><a id="_idTextAnchor113"/>Creating a rule to monitor SLA breaches</h2>
			<p>To maintain the <a id="_idIndexMarker319"/>SLA success rate, we want to avoid requests breaching their SLAs in the first instance.</p>
			<p>In this example, we are going to monitor the <em class="italic">Time to first response</em> SLA for high-priority requests and either notify a Slack channel if the request is unassigned or send a message to the assigned agent if the request has been automatically assigned. In addition, we will also send a notification to the service desk manager to alert them of the fact that the SLA is about to be breached so that they can take the appropriate action.</p>
			<p>Let's get started with the rule, as follows:</p>
			<ol>
				<li value="1">In your Jira Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the <strong class="bold">Project Settings</strong> menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Select the <code>Time to first response</code></p><p><code>will breach in the next 30 minutes</code></p></li>
				<li>Next, select <code>Priority</code></p><p><code>is one of</code></p><p><code>Highest</code>, <code>High</code></p></li>
				<li>The service desk manager needs to be notified irrespective of whether we send a general Slack notification or notify the request's assignee, so we'll send this notification first.<p>Select <code>Manager</code></p><p><code>{{issue.key}} is about to breach its SLA</code></p><p><code>An unassigned high-priority issue, {{issue.key}} - {{issue.summary}} is about to breach its "Time to first response" SLA in 30 minutes.</code></p><p><code>A notification has also been sent to the #service-desk Slack channel.</code></p><p><code>Regards,</code></p><p><code>Your friendly SLA bot.</code></p></li>
				<li>Then, select <code>Assignee</code></p><p><code>is empty</code></p></li>
				<li>Now, select <code>:fire: &lt;{{issue.toUrl}}|{{issue.key}} - {{issue.summary}}&gt; is currently unassigned and will breach its 'Time to first response' SLA in 30 minutes.</code></pre><p><code>#service-desk</code></p></li>
				<li>Then, click <strong class="bold">Add else</strong> in the rule-chain view on the left, and then click <strong class="bold">Save</strong>.</li>
				<li>Select <code>Assignee</code></p><p><code>{{issue.key}} is about to breach its Time to first response SLA</code></p><p><code>Hi {{issue.assignee.displayName.split(" ").first}},</code>
<code>You have been assigned {{issue.key}} - {{issue.summary}} which is about to breach its Time to first response SLA in 30 minutes.</code>
<code>Please take appropriate action to ensure we meet our SLA targets.</code>
<code>Thanks,</code>
<code>Your friendly SLA bot.</code></pre><p>Now that you have <a id="_idIndexMarker322"/>configured the <strong class="bold">Send email</strong> action, your rule should look similar to the one shown in the following screenshot:</p><div><img src="img/B16551_Figure_6.3.jpg" alt="Figure 6.3 – Monitoring SLA breaches&#13;&#10;"/></div><p class="figure-caption">Figure 6.3 – Monitoring SLA breaches</p></li>
				<li>Finally, name your rule <code>Time to first response monitor</code> and click <strong class="bold">Turn it on</strong> to save and enable the rule.</li>
			</ol>
			<p>In this section, we learned how to <a id="_idIndexMarker323"/>monitor requests whose SLAs are about breach or that have already breached, and how to automatically prioritize and escalate these requests.</p>
			<p>Next, we will look at how to improve service desk efficiency by automating common and repetitive tasks using automation rules.</p>
			<h1 id="_idParaDest-135"><a id="_idTextAnchor114"/>Automating common and repetitive tasks</h1>
			<p>There are a number of requests<a id="_idIndexMarker324"/> received daily by IT service desks that are repetitive and mundane, and that are prime candidates for automation.</p>
			<p>By automating tasks, not only are you reducing the need for human intervention and potential errors during the completion of these tasks, but you are also enabling increased productivity for the end user by reducing the time taken to fulfill their request.</p>
			<p>In this section, we will take a look at using automation to handle password resets, which is quite possibly one of the most common requests handled by service desks. </p>
			<p>Let's look at an automation rule that will automatically reset a user password when the user raises a password reset request in the service desk.</p>
			<h2 id="_idParaDest-136"><a id="_idTextAnchor115"/>Creating a rule to automatically reset passwords</h2>
			<p>Probably one of the more frequent<a id="_idIndexMarker325"/> and time-consuming tasks faced by IT service desks is the request to reset a user's password, making it a prime candidate for automation.</p>
			<p>To demonstrate how we could<a id="_idIndexMarker326"/> achieve this with automation rules in Jira Service Management, we are going to make use of <strong class="bold">Microsoft's Azure AD</strong> service, which<a id="_idIndexMarker327"/> has a well-defined <strong class="bold">REpresentational State Transfer</strong> <strong class="bold">application programming interface</strong> (<strong class="bold">REST API</strong>).</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">We are going to assume that the only common information between users in Jira Cloud (or Jira Server) and Azure AD are the users' email addresses, as Jira Cloud does not allow access to user account names.</p>
			<p>To begin, we first need to ensure that Jira is registered as an app with Azure AD and has the appropriate permissions assigned. </p>
			<p>Let's start by completing the configuration we require in Azure AD, as follows:</p>
			<ol>
				<li value="1">Navigate to the <strong class="bold">Azure Active Directory</strong> component in your Azure portal and select <strong class="bold">App registrations</strong>, and then click on <strong class="bold">New registration</strong>.</li>
				<li>Name your new app <code>Service Desk Autobot</code> and click <strong class="bold">Register</strong>.<p>You should now be<a id="_idIndexMarker328"/> presented with a screen <a id="_idIndexMarker329"/>similar to the one shown in the following screenshot. You will need to copy the <strong class="bold">Application (client) ID (1)</strong> and <strong class="bold">Directory (tenant) ID (2)</strong> IDs to use later in our rule:</p><div><img src="img/B16551_Figure_6.4.jpg" alt="Figure 6.4 – Registering Jira as an app with Azure AD&#13;&#10;"/></div><p class="figure-caption">Figure 6.4 – Registering Jira as an app with Azure AD</p></li>
				<li>The next step is to create a client secret that we can use to authenticate with from our automation rule. To do this, navigate to <strong class="bold">Certificates &amp; secrets</strong> in the menu and click on <strong class="bold">New client secret</strong> in the <strong class="bold">Client secrets</strong> section.<p>Add an optional description and select the length of time you want this secret to be valid for, and click <strong class="bold">Add</strong>.</p><p>Your screen should now<a id="_idIndexMarker330"/> look similar to the one shown in the following screenshot. Copy the newly added <strong class="bold">client secret (1)</strong> ID to a safe <a id="_idIndexMarker331"/>place for use later in our automation rule:</p><div><img src="img/B16551_Figure_6.5.jpg" alt="Figure 6.5 – Creating a client secret in Azure AD for Jira&#13;&#10;"/></div><p class="figure-caption">Figure 6.5 – Creating a client secret in Azure AD for Jira</p></li>
				<li>We now need to give our new app the correct permissions in order to be able to reset passwords in Azure AD.</li>
				<li>Navigate to the <strong class="bold">API permissions</strong> menu item and then click <strong class="bold">Add a permission</strong>. Then, select <strong class="bold">Microsoft Graph</strong>.</li>
				<li>Next, select <code>Directory</code>, and check the <strong class="bold">Directory.ReadWrite.All</strong> permission. Finally, click <strong class="bold">Add permissions</strong>, as shown in the following screenshot:<div><img src="img/B16551_Figure_6.6.jpg" alt="Figure 6.6 – Adding the correct Azure AD permissions for Jira&#13;&#10;"/></div><p class="figure-caption">Figure 6.6 – Adding the correct Azure AD permissions for Jira</p></li>
				<li>To simplify the interaction<a id="_idIndexMarker333"/> with our automation rule, we want to pre-authorize the permissions we just granted, so click on <code>&lt;tenant&gt;</code>.<p>The status for both <strong class="bold">Microsoft Graph </strong>API permissions should now have a green check next to them indicating they have been granted <strong class="bold">Admin</strong> consent, as can be seen in the following screenshot:</p><div><img src="img/B16551_Figure_6.7.jpg" alt="Figure 6.7 – Granting Admin consent to the API permissions&#13;&#10;"/></div><p class="figure-caption">Figure 6.7 – Granting Admin consent to the API permissions</p></li>
				<li>The final step in the Azure portal is to grant the <strong class="bold">Company Administrator</strong> role to your app. To do this, click<a id="_idIndexMarker334"/> on the Cloud Shell icon<a id="_idIndexMarker335"/> immediately to the right of the search bar and copy the following commands to the PowerShell terminal:<pre><strong class="bold">Connect-AzureAD</strong>
<strong class="bold">$displayName = "Service Desk Autobot"; $objectId = (Get-AzureADServicePrincipal -SearchString $displayName).ObjectId</strong>
<strong class="bold">$roleName = "Company Administrator"; $role = Get-AzureADDirectoryRole | Where-Object {$_.DisplayName -eq $roleName}</strong>
<strong class="bold">Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $objectId</strong></pre><p>Your screen should<a id="_idIndexMarker336"/> now look similar to the one shown in the following screenshot:</p></li>
			</ol>
			<div><div><img src="img/B16551_Figure_6.8.jpg" alt="Figure 6.8 – Granting the Company Administrator role to Jira&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.8 – Granting the Company Administrator role to Jira</p>
			<p>Now that we have configured our app in Azure AD and you have a couple of users configured with email addresses that match their Jira email addresses, we can create our automation rule to <a id="_idIndexMarker337"/>automatically reset user passwords when a request is received in Jira Service Management. To do this, follow these steps:</p>
			<ol>
				<li value="1">In your Jira Service Management project, navigate to <strong class="bold">Project settings</strong>, click on the <strong class="bold">Automation</strong> link in the <strong class="bold">Project Settings</strong> menu, and then click <strong class="bold">Create rule</strong>.</li>
				<li>Select the <code>Issue Created</code> and <code>Issue Updated</code>, then click <strong class="bold">Save</strong>.</li>
				<li>Then, select <code>Components</code></p><p><code>contains any of</code></p><p><code>Active Directory</code></p></li>
				<li>Select <code>Summary</code></p><p><code>contains</code></p><p><code>password</code></p></li>
				<li>Next, we'll use the <a href="https://www.passwordrandom.com">https://www.passwordrandom.com</a> external web service to generate a random, temporary<a id="_idIndexMarker339"/> password for the user, so we'll select <code>GET</code></p><p><code>Empty</code></p><p><strong class="bold">Wait for response</strong>: Ensure this is selected</p></li>
				<li>If you validate your webhook configuration, you should receive a response, similar to the following:<pre>{
  "char": [
    "LoyKI6;09jd"
  ]
}</pre><p>Click <strong class="bold">Save</strong> to move on.</p></li>
				<li>In the next step, we <a id="_idIndexMarker340"/>need to log in to Microsoft Azure and retrieve an authentication token. To<a id="_idIndexMarker341"/> complete this step, we will need the <code>resource</code>, <code>client_id</code>, <code>client_secret</code>, and <code>grant_type</code>.</p><p>To URL-encode the data, the field and the value are separated by <code>=</code> and each field-value pair is then separated using <code>&amp;</code>; and finally, the entire text string needs to be URL-encoded, which you can do by pasting the complete string into a service such as <a href="https://www.urlencoder.org">https://www.urlencoder.org</a>.</p></li>
				<li>Select <code>https://login.windows.net/&lt;Directory (tenant) ID&gt;/oauth2/token</code></p><p><code>Content-Type</code></p><p><code>application/x-www-form-urlencoded</code></p><p><code>POST</code></p><p><code>Custom data</code></p><p><code>&lt;Application (client) ID&gt;</code></p><p><code>&lt;Client secret&gt;</code></p><p><code>client_credentials</code></p><p>At this point, your rule <a id="_idIndexMarker343"/>should look similar to the<a id="_idIndexMarker344"/> one shown in the following screenshot: </p><div><img src="img/B16551_Figure_6.9.jpg" alt="Figure 6.9 – Configuring the login web request to Azure AD&#13;&#10;"/></div><p class="figure-caption">Figure 6.9 – Configuring the login web request to Azure AD</p></li>
				<li>A successful login<a id="_idIndexMarker345"/> request to<a id="_idIndexMarker346"/> Microsoft Azure will return the <code>token_type</code> and <code>access_token</code> you will need to <a id="_idIndexMarker347"/>complete the password reset request in the following <code>{{webhookResponse.body.token_type}}</code> and <code>{{webhookResponse.body.access_token}}</code> smart values respectively, as follows:<pre>{
  "token_type": "Bearer",
  "expires_in": "3599",
  "ext_expires_in": "3599",
  "expires_on": "1602958671",
  "not_before": "1602954771",
  "resource": "https://graph.microsoft.com",
  "access_token": "xxxxxx"
} </pre></li>
				<li>Now that we have<a id="_idIndexMarker348"/> successfully logged in to <a id="_idIndexMarker349"/>Microsoft Azure, we can use the authentication response and the reporter's email address to look up the ID of the user in the Azure AD. To do this, we need to select <code>https://graph.microsoft.com/v1.0/users?$filter=startsWith(mail,'{{reporter.emailAddress.urlEncode}}')</code></p><p><code>Authorization</code></p><p><code>{{webhookResponses.get(1).body.token_type}} {{webhookResponses.get(1).body.access_token}}</code></p><p><code>GET</code></p><p><code>Empty</code></p><p><code>{{webhookResponse.body.value.id}}</code> smart value, as follows:</p><pre>{
  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users",
  "value": [
    {
      "businessPhones": [],
      "displayName": "Joe Bloggs",
      "givenName": "Joe",
      "jobTitle": null,
      "mail": "joe.bloggs@company.com",
      "mobilePhone": null,
      "officeLocation": null,
      "preferredLanguage": "en",
      "surname": "Bloggs",
      "userPrincipalName": "jblogs@tenant.onmicrosoft.com",
      "id": "2aa3af1f-c91f-4feb-89dc-de4d200da185"
    }
  ]
}</pre><p class="callout-heading">Tip</p><p class="callout">When receiving responses multiple web requests in an automation rule, each response is added to the <code>{{webhookResponses}}</code> smart value list in the order it was called in the rule, starting at position zero (<code>0</code>). We can therefore use the smart value list functions to retrieve the individual webhook responses when we need to reference them later in the rule. For example, <code>{{webhookResponses.get(1).body}}</code> will retrieve the JSON response from the <em class="italic">second</em> web request, while <code>{{webhookResponses.first.body}}</code> will retrieve the response from the first request.</p></li>
				<li>Now that we have our <a id="_idIndexMarker352"/>authentication data, the ID of the user in Azure AD, and a temporary password from our first web request, we<a id="_idIndexMarker353"/> can combine these to actually perform the password reset.<p>Select <code>https://graph.microsoft.com/v1.0/users/{{webhookResponse.body.value.id}}</code></p><p>First <code>Authorization</code></p><p><code>{{webhookResponses.get(1).body.token_type}} {{webhookResponses.get(1).body.access_token}}</code></p><p>Second <code>Content-Type</code></p><p><code>application/json</code></p><p><code>POST</code></p><p><code>Custom data</code></p><p><strong class="bold">Custom data</strong>:</p><pre>{
    "passwordProfile": {
        "forceChangePasswordNextSignIn": "true",
        "password": "<strong class="bold">{{webhookResponses.first.body.char}}</strong>"
    }
}</pre><p><strong class="bold">Wait for response</strong>: Ensure this <a id="_idIndexMarker354"/>option is selected so that we only continue with the rule if the response is successful. </p><p>The custom data in this <a id="_idIndexMarker355"/>example makes use of the Azure AD password profile structure of the user REST API defined in Microsoft's Graph API, available at <a href="https://docs.microsoft.com/en-us/graph/api/resources/passwordprofile?view=graph-rest-1.0">https://docs.microsoft.com/en-us/graph/api/resources/passwordprofile?view=graph-rest-1.0</a>.</p><p>Your rule should look similar to the one shown in the following screenshot:</p><div><img src="img/B16551_Figure_6.10.jpg" alt="Figure 6.10 – Configuring the reset password request&#13;&#10;"/></div><p class="figure-caption">Figure 6.10 – Configuring the reset password request</p></li>
				<li>To complete the rule, we<a id="_idIndexMarker356"/> need to inform the user that their password has been reset, as well as what the new temporary<a id="_idIndexMarker357"/> password is for them to be able sign in again and change the password to one of their choice.<p>Select <code>Reporter</code></p><p><code>Your request to reset your password has been completed.</code></p><p><code>Dear {{issue.reporter.displayName.split(" ").first}},</code></p><p><code>Your request to reset your password has been completed.</code></p><p><code>The new temporary password which has been generated for you is:</code></p><p><code>{{webhookResponses.first.body.char}}</code></p><p><code>You will be prompted to change this when you next log in.</code></p><p><code>Thank you,</code></p><p><code>The Service Desk Team. </code></p></li>
				<li>Finally, select <code>Password reset bot</code>, and ensure <a id="_idIndexMarker358"/>the <strong class="bold">Allow rule trigger</strong> checkbox is selected. Click <strong class="bold">Save</strong> and then click <strong class="bold">Turn it on</strong> to enable the rule.</li>
			</ol>
			<p>In this section, we have learned how<a id="_idIndexMarker359"/> we can use automation rules to automate common and repetitive tasks faced by service desk teams by looking at one of the most common repetitive tasks—namely, resetting passwords.</p>
			<p>As we have seen, using automation rules to automate these types of repetitive and time-consuming tasks will lead to improved overall efficiency of your service desk, reducing the cost per ticket and also improving end-user satisfaction.</p>
			<h1 id="_idParaDest-137"><a id="_idTextAnchor116"/>Summary</h1>
			<p>In this chapter, you learned how adding automations to Jira Service Management can improve the efficiency of your IT service desks, reducing the cost per ticket and improving overall user satisfaction.</p>
			<p>We learned how categorizing and processing incoming requests early in the request life cycle can increase the response and resolution times of requests as human intervention is no longer required for triage, and we now understand how monitoring SLA compliance with appropriate escalations can help to stay on top of important issues.</p>
			<p>Finally, we learned how using automation bots to perform common and repetitive tasks such as resetting a user's password can drastically improve both the time to resolve a request and the end user's productivity, as they no longer have to wait for a service agent to manually perform the tasks.</p>
			<p>By using the skills learned in this chapter and applying them to more processes within your service desk, you will not only enable your service agents to focus on more meaningful and urgent tasks but will also improve overall user satisfaction with IT services throughout the organization.</p>
			<p>In the next chapter, we will explore how we can use automations to effectively manage Jira Software projects.</p>
		</div>
	</body></html>