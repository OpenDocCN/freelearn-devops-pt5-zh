["```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 512mb \\\n --digitalocean-private-networking \\\n service-discovery\n\n```", "```\ndocker $(docker-machine config service-discovery) run -d \\\n -p \"8400:8400\" \\\n -p \"8500:8500\" \\\n -h \"consul\" \\\n russmckendrick/consul agent -data-dir /data -server -bootstrap-expect 1 -ui-dir /ui -client=0.0.0.0\n\n```", "```\ndocker $(docker-machine config service-discovery) ps\n\n```", "```\nopen http://$(docker-machine ip service-discovery):8500/ui\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 1gb \\\n --digitalocean-private-networking \\\n --swarm --swarm-master \\\n --swarm-discovery=\"consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-store=consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-advertise=eth1:2376\" \\\n chapter04-00\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 1gb \\\n --digitalocean-private-networking \\\n --swarm \\\n --swarm-discovery=\"consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-store=consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-advertise=eth1:2376\" \\\n chapter04-01\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 1gb \\\n --digitalocean-private-networking \\\n --swarm \\\n --swarm-discovery=\"consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-store=consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-advertise=eth1:2376\" \\\n chapter04-02\n\n```", "```\neval $(docker-machine env --swarm chapter04-00)\ndocker info\n\n```", "```\ndocker network create --driver overlay --subnet=10.0.9.0/24 chapter04-overlay-network\n\n```", "```\ndocker network ls\n\n```", "```\ndocker $(docker-machine config chapter04-01) network ls\ndocker $(docker-machine config chapter04-02) network ls\n\n```", "```\ndocker run -itd \\\n --name=chapter04-web \\\n --net=chapter04-overlay-network \\\n -p 80:80 \\\n --env=\"constraint:node==chapter04-01\" \\\n russmckendrick/nginx\n\n```", "```\ndocker run -it \\\n --rm \\\n --net=chapter04-overlay-network \\\n --env=\"constraint:node==chapter04-02\" \\\n russmckendrick/base wget -q -O- http://chapter04-web\n\n```", "```\ndocker run -it \\\n --rm \\\n --net=chapter04-overlay-network \\\n --env=\"constraint:node==chapter04-02\" \\\n russmckendrick/base ping -c 3 chapter04-web\n\n```", "```\ndocker exec chapter04-web ip addr\ndocker exec chapter04-web route -n\ndocker exec chapter04-web ping -c 3 google.com\n\n```", "```\nopen http://$(docker-machine ip chapter04-01)/\n\n```", "```\ndocker rm -f chapter04-web\n\n```", "```\ndocker network create --driver overlay --subnet=10.0.10.0/24 wpoutside\ndocker network create --driver overlay --internal --subnet=10.0.11.0/24 wpinside\n\n```", "```\nversion: '2'\nservices:\n  wordpress:\n    container_name: my-wordpress-app\n    image: wordpress\n    ports:\n      - \"80:80\"\n networks:\n - wpoutside\n - wpinside\n    environment:\n      - \"WORDPRESS_DB_HOST=mysql:3306\"\n      - \"WORDPRESS_DB_PASSWORD=password\"\n - \"constraint:node==chapter04-01\"\n    volumes:\n      - \"uploads:/var/www/html/wp-content/uploads/\"\n  mysql:\n    container_name: my-wordpress-database\n    image: mysql\n networks:\n - wpinside\n    environment:\n      - \"MYSQL_ROOT_PASSWORD=password\"\n - \"constraint:node==chapter04-02\"\n    volumes:\n      - \"database:/var/lib/mysql\"\nvolumes:\n  uploads:\n    driver: local\n  database:\n    driver: local\nnetworks:\n wpoutside:\n external: true\n wpinside:\n external: true\n\n```", "```\ndocker-compose up -d\n\n```", "```\ndocker-compose ps\n\n```", "```\ndocker ps\n\n```", "```\ndocker inspect my-wordpress-app | grep IPAddress\ndocker inspect my-wordpress-database | grep IPAddress\n\n```", "```\ndocker exec my-wordpress-app ping -c 3 google.com\ndocker exec my-wordpress-app ping -c 3 my-wordpress-database\n\n```", "```\ndocker exec my-wordpress-database ping -c 3 my-wordpress-app\ndocker exec my-wordpress-database ping -c 3 google.com\n\n```", "```\ndocker ps\n\n```", "```\nopen http://$(docker-machine ip chapter04-00)/\nopen http://$(docker-machine ip chapter04-01)/\nopen http://$(docker-machine ip chapter04-02)/\n\n```", "```\ndocker-machine stop chapter04-00 chapter04-01 chapter04-02 service-discovery\ndocker-machine rm chapter04-00 chapter04-01 chapter04-02 service-discovery\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 512mb \\\n --digitalocean-private-networking \\\n service-discovery\n\n```", "```\ndocker $(docker-machine config service-discovery) run -d \\\n -p \"8400:8400\" \\\n -p \"8500:8500\" \\\n -h \"consul\" \\\n russmckendrick/consul agent -data-dir /data -server -bootstrap-expect 1 -client=0.0.0.0\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 1gb \\\n --digitalocean-private-networking \\\n --swarm --swarm-master \\\n --swarm-discovery=\"consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-store=consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-advertise=eth1:2376\" \\\n chapter04-00\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 1gb \\\n --digitalocean-private-networking \\\n --swarm \\\n --swarm-discovery=\"consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-store=consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-advertise=eth1:2376\" \\\n chapter04-01\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 1gb \\\n --digitalocean-private-networking \\\n --swarm \\\n --swarm-discovery=\"consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-store=consul://$(docker-machine ip service-discovery):8500\" \\\n --engine-opt=\"cluster-advertise=eth1:2376\" \\\n chapter04-02\n\n```", "```\neval $(docker-machine env --swarm chapter04-00)\ndocker info\n\n```", "```\ndocker-machine ssh chapter04-00 'curl -L git.io/weave -o /usr/local/bin/weave; chmod a+x /usr/local/bin/weave'\n\n```", "```\ndocker-machine ssh chapter04-00 weave launch --init-peer-count 3\n\n```", "```\ndocker-machine ssh chapter04-01 'curl -L git.io/weave -o /usr/local/bin/weave; chmod a+x /usr/local/bin/weave'\ndocker-machine ssh chapter04-01 weave launch --init-peer-count 3\n\n```", "```\ndocker-machine ssh chapter04-01 weave connect \"$(docker-machine ip chapter04-00)\"\n\n```", "```\ndocker-machine ssh chapter04-02 'curl -L git.io/weave -o /usr/local/bin/weave; chmod a+x /usr/local/bin/weave'\ndocker-machine ssh chapter04-02 weave launch --init-peer-count 3\ndocker-machine ssh chapter04-02 weave connect \"$(docker-machine ip chapter04-00)\"\n\n```", "```\ndocker-machine ssh chapter04-00 weave status\n\n```", "```\ndocker network ls\n\n```", "```\nversion: '2'\nservices:\n  wordpress:\n    container_name: \"my-wordpress-app\"\n    image: wordpress\n    ports:\n      - \"80:80\"\n    environment:\n - \"WORDPRESS_DB_HOST=mysql.weave.local:3306\"\n      - \"WORDPRESS_DB_PASSWORD=password\"\n      - \"constraint:node==chapter04-01\"\n hostname: \"wordpress.weave.local\"\n dns: \"172.17.0.1\"\n dns_search: \"weave.local\"\n    volumes:\n      - \"uploads:/var/www/html/wp-content/uploads/\"\n  mysql:\n    container_name: \"my-wordpress-database\"\n    image: mysql\n    environment:\n      - \"MYSQL_ROOT_PASSWORD=password\"\n      - \"constraint:node==chapter04-02\"\n hostname: \"mysql.weave.local\"\n dns: \"172.17.0.1\"\n dns_search: \"weave.local\"\n    volumes:\n      - \"database:/var/lib/mysql\"\nvolumes:\n  uploads:\n    driver: local\n  database:\n    driver: local\nnetworks:\n default:\n driver: weave\n\n```", "```\ndocker-machine ssh chapter04-00 weave dns-args\n\n```", "```\ndocker-compose up -d\ndocker-compose ps\ndocker ps\n\n```", "```\nopen http://$(docker-machine ip chapter04-01)/\n\n```", "```\ndocker-machine ssh chapter04-00 weave status dns\n\n```", "```\ndocker-machine ssh chapter04-00 'curl -L git.io/scope -o /usr/local/bin/scope; chmod a+x /usr/local/bin/scope'\ndocker-machine ssh chapter04-00 scope launch\n\n```", "```\ndocker-machine ssh chapter04-01 'curl -L git.io/scope -o /usr/local/bin/scope; chmod a+x /usr/local/bin/scope'\ndocker-machine ssh chapter04-01 scope launch $(docker-machine ip chapter04-00)\ndocker-machine ssh chapter04-02 'curl -L git.io/scope -o /usr/local/bin/scope; chmod a+x /usr/local/bin/scope'\ndocker-machine ssh chapter04-02 scope launch $(docker-machine ip chapter04-00)\n\n```", "```\nopen http://$(docker-machine ip chapter04-00):4040/\n\n```", "```\ndocker-machine stop chapter04-00 chapter04-01 chapter04-02 service-discovery\ndocker-machine rm chapter04-00 chapter04-01 chapter04-02 service-discovery\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region lon1 \\\n --digitalocean-size 1gb \\\n mesh-london\n\n```", "```\ndocker-machine create \\\n --driver digitalocean \\\n --digitalocean-access-token sdnjkjdfgkjb345kjdgljknqwetkjwhgoih314rjkwergoiyu34rjkherglkhrg0 \\\n --digitalocean-region nyc2 \\\n --digitalocean-size 1gb \\\n mesh-nyc\n\n```", "```\ndocker-machine ssh mesh-london 'curl -L git.io/weave -o /usr/local/bin/weave; chmod a+x /usr/local/bin/weave'\ndocker-machine ssh mesh-london weave launch --password 3UnFh4jhahFC\n\n```", "```\ndocker-machine ssh mesh-nyc 'curl -L git.io/weave -o /usr/local/bin/weave; chmod a+x /usr/local/bin/weave'\ndocker-machine ssh mesh-nyc weave launch --password 3UnFh4jhahFC\ndocker-machine ssh mesh-nyc weave connect \"$(docker-machine ip mesh-london)\"\n\n```", "```\ndocker-machine ssh mesh-nyc weave status\n\n```", "```\ndocker $(docker-machine config mesh-nyc) run -itd \\\n --name=nginx \\\n --net=weave \\\n --hostname=\"nginx.weave.local\" \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/nginx\n\n```", "```\ndocker $(docker-machine config mesh-nyc) ps\n\n```", "```\ndocker $(docker-machine config mesh-london) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base wget -q -O- http://nginx.weave.local\n\n```", "```\ndocker $(docker-machine config mesh-london) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base ping -c 3 nginx.weave.local\n\n```", "```\ndocker-machine create -d virtualbox mesh-local\n\n```", "```\ndocker-machine ssh mesh-local 'sudo curl -L git.io/weave -o /usr/local/bin/weave; sudo chmod a+x /usr/local/bin/weave'\ndocker-machine ssh mesh-local sudo weave launch --password 3UnFh4jhahFC\ndocker-machine ssh mesh-local sudo weave connect \"$(docker-machine ip mesh-london)\"\n\n```", "```\ndocker $(docker-machine config mesh-local) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base wget -q -O- http://nginx.weave.local\n\n```", "```\ndocker $(docker-machine config mesh-local) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base ping -c 3 nginx.weave.local\n\n```", "```\ndocker $(docker-machine config mesh-local) run -itd \\\n --name=vm \\\n --net=weave \\\n --hostname=\"vm.weave.local\" \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/nginx\n\n```", "```\ndocker $(docker-machine config mesh-nyc) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base wget -q -O- http://vm.weave.local\n\n```", "```\ndocker $(docker-machine config mesh-nyc) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base ping -c 3 vm.weave.local\n\n```", "```\ndocker $(docker-machine config mesh-london) run -itd \\\n --name=lonely \\\n russmckendrick/nginx\n\n```", "```\ndocker-machine ssh mesh-london weave attach lonely\n\n```", "```\ndocker $(docker-machine config mesh-nyc) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base wget -q -O- 10.40.0.0\ndocker $(docker-machine config mesh-local) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base ping -c 3 10.40.0.0\n\n```", "```\ndocker-machine ssh mesh-london weave dns-add lonely -h lonely.weave.local\n\n```", "```\ndocker $(docker-machine config mesh-nyc) run -it \\\n --rm \\\n --net=weave \\\n --dns=\"172.17.0.1\" \\\n --dns-search=\"weave.local\" \\\n russmckendrick/base wget -q -O- lonely.weave.local\n\n```", "```\ndocker-machine stop mesh-local mesh-london mesh-nyc\ndocker-machine rm mesh-local mesh-london mesh-nyc\n\n```"]