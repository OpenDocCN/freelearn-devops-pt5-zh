<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Docker in the Cloud</h1></div></div></div><p>The third tool, alongside Docker and Docker Compose, which we installed during <a class="link" href="ch01.html" title="Chapter 1. Installing Docker Locally">Chapter 1</a>, <em>Installing Docker Locally</em> was Docker Machine; this is a command line tool which allows you to manage both local and remote Docker hosts.</p><p>In this chapter, we are going to look at the basic usage of three of the public cloud drivers by using<a id="id140" class="indexterm"/> Docker Machine<a id="id141" class="indexterm"/> to provision Docker hosts in them. We will be launching our Docker hosts in the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Digital Ocean <a class="ulink" href="https://www.digitalocean.com/">https://www.digitalocean.com/</a></li><li class="listitem" style="list-style-type: disc">Amazon Web Services - <a class="ulink" href="https://aws.amazon.com/">https://aws.amazon.com/</a></li><li class="listitem" style="list-style-type: disc">Microsoft Azure - <a class="ulink" href="https://azure.microsoft.com/">https://azure.microsoft.com/</a></li></ul></div><p>All using<a id="id142" class="indexterm"/> a single command.</p><div><div><div><div><h1 class="title"><a id="ch03lvl1sec22"/>Docker Machine</h1></div></div></div><p>Docker Machine <a id="id143" class="indexterm"/>can connect to the following services, provision a Docker host, and configure your local Docker client to be able to communicate with the newly launched remote instance the following:</p><p>As<a id="id144" class="indexterm"/> well <a id="id145" class="indexterm"/>as the three public cloud providers <a id="id146" class="indexterm"/>already mentioned, Docker Machine also supports:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Google<a id="id147" class="indexterm"/> Compute Engine - <a class="ulink" href="https://cloud.google.com/compute/">https://cloud.google.com/compute/</a></li><li class="listitem" style="list-style-type: disc">Rackspace - <a class="ulink" href="http://www.rackspace.co.uk/cloud/">http://www.rackspace.co.uk/cloud/</a></li><li class="listitem" style="list-style-type: disc">IBM Softlayer <a class="ulink" href="http://www.softlayer.com">http://www.softlayer.com</a></li><li class="listitem" style="list-style-type: disc">Exoscale - <a class="ulink" href="https://www.exoscale.ch/">https://www.exoscale.ch/</a></li><li class="listitem" style="list-style-type: disc">VMware vCloud<a id="id148" class="indexterm"/> Air -<a class="ulink" href="http://vcloud.vmware.com/"> http://vcloud.vmware.com/</a></li><li class="listitem" style="list-style-type: disc">It also supports <a id="id149" class="indexterm"/> the following self-hosted <a id="id150" class="indexterm"/>platforms:</li><li class="listitem" style="list-style-type: disc">OpenStack - <a class="ulink" href="https://www.openstack.org/">https://www.openstack.org/</a></li><li class="listitem" style="list-style-type: disc">Microsoft Hyper-V - <a class="ulink" href="http://www.microsoft.com/virtualization/">http://www.microsoft.com/virtualization/</a></li><li class="listitem" style="list-style-type: disc">VMware vSphere - <a class="ulink" href="http://www.vmware.com/uk/products/vsphere/">http://www.vmware.com/uk/products/vsphere/</a></li></ul></div><p>Also, it allows you to launch Docker hosts locally using <a id="id151" class="indexterm"/>VirtualBox - <a class="ulink" href="https://www.virtualbox.org/">https://www.virtualbox.org/</a>. This is great if your local workstation doesn't meet the minimum specifications for Docker for Mac or Windows.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec23"/>The Digital Ocean driver</h1></div></div></div><p>Let us start <a id="id152" class="indexterm"/>creating some instances in the cloud. First, let us launch a machine in Digital Ocean.</p><p>There are two prerequisites for launching an instance with Docker Machine in Digital Ocean, the first is a Digital Ocean account and the second is an API token.</p><p>To sign up for a <a id="id153" class="indexterm"/>Digital Ocean account, please visit <a class="ulink" href="https://www.digitalocean.com/">https://www.digitalocean.com/</a> and click <strong>Sign Up</strong>. Once you have or are logged in to your account, you can generate an API token by clicking on the <strong>API</strong> link in the top menu.</p><p>To grab your token, click on <strong>Generate New Token</strong> and follow the onscreen instructions.</p><div><div><h3 class="title"><a id="tip05"/>Tip</h3><p>You only get one chance to make a record of your token; please make sure you store it somewhere safe as it will allow anyone who has it to launch instances into your account.</p></div></div><p>Once you have the token, you can launch your instance using Docker Machine. To do this, run the following command, making sure to replace the example API token with your own:</p><div><pre class="programlisting">
<strong>docker-machine create \</strong>
<strong>    --driver digitalocean \</strong>
<strong>    --digitalocean-access-token 14760f5bdee403cebb36117c22c83e5ee51188515f493a6c0d281c094c552536 \</strong>
<strong>    dotest</strong>
</pre></div><div><div><h3 class="title"><a id="note13"/>Note</h3><p>Please note, the tokens used in these examples have been revoked.</p></div></div><p>This will launch an instance called <strong>dotest</strong>
<a id="id154" class="indexterm"/> in your Digital Ocean account.</p><p>If you check your Digital Ocean control panel, you should now see the instance which was created by Docker Machine listed:</p><div><img src="img/B06455_03_03.jpg" alt="The Digital Ocean driver"/></div><p>We can also confirm our <a id="id155" class="indexterm"/>Digital Ocean Docker host is running by using the following command:</p><div><pre class="programlisting">
<strong>docker-machine ls</strong>
</pre></div><p>This will return all the machines we have running, confirming their state, IP address, Docker version, and name. There is also a column which lets you know which of the Docker Machine managed Docker hosts your local client is configured to communicate with:</p><div><img src="img/B06455_03_04.jpg" alt="The Digital Ocean driver"/></div><p>By default, your local Docker client is configured to communicate with our local Docker installation; as we launched our local Docker installation using Docker for Mac or Windows, or you have Docker installed on Linux Docker Machine will not list it.</p><p>Let's change it so it interacts with the Digital Ocean instance.</p><p>To do this, you have to change some local environment variables; luckily, Docker Machine provides an easy way to find out what these are and change them.</p><p>To find out what they all you must do is simply run the following command:</p><div><pre class="programlisting">
<strong>docker-machine env dotest</strong>
</pre></div><p>This will tell you exactly what you need to run to change from the <code class="literal">default</code> machine to <code class="literal">dotest</code>; the best thing is that the command itself formats the results in such a way which they can execute, so if we run the command again, but this time in a way where the output will be executed:</p><div><pre class="programlisting">
<strong>eval $(docker-machine env dotest)</strong>
</pre></div><p>Or if you have launched your instance using PowerShell on Windows then use:</p><div><pre class="programlisting">
<strong>docker-machine env dotest | Invoke-Expression</strong>
</pre></div><p>And now if you get a listing from Docker Machine, you will notice that the <code class="literal">dotest</code> environment is now the active one:</p><div><img src="img/B06455_03_05.jpg" alt="The Digital Ocean driver"/></div><p>Now we have our <a id="id156" class="indexterm"/>Digital Ocean instance active, you can run the <code class="literal">docker container run</code> command on your local machine, and they will have been executed on the Digital Ocean instance; let's test this by running the <code class="literal">hello-world</code> container.</p><p>Run the following command:</p><div><pre class="programlisting">
<strong>docker container run hello-world</strong>
</pre></div><p>You should see the image download and then the output of running the <code class="literal">hello-world</code> container if you then run the following command:</p><div><pre class="programlisting">
<strong>docker container ls –a</strong>
</pre></div><p>You should see that the <code class="literal">hello-world</code>
<strong> </strong>container exited a few seconds ago.</p><p>You can SSH into the Digital Ocean instance using the following command:</p><div><pre class="programlisting">
<strong>docker-machine ssh dotest</strong>
</pre></div><p>Once logged in, run the <code class="literal">docker container ls –a</code> command to demonstrate that the <code class="literal">docker container run</code> you ran locally was executed on the Digital Ocean instance.</p><p>The beauty of this setup is that you shouldn't have to SSH to your instances often.</p><div><div><h3 class="title"><a id="note14"/>Note</h3><p>One thing you may have noticed is that all we told Docker Machine is that we want to use Digital Ocean and our API token; at no point did we tell it which region to launch the instance in, what specification we wanted, or even which SSH key to use.</p></div></div><p>Docker Machine has some sensible defaults which are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">digitalocean-image = ubuntu-16-04-x64</li><li class="listitem" style="list-style-type: disc">digitalocean-region = nyc3</li><li class="listitem" style="list-style-type: disc">digitalocean-size = 512mb</li></ul></div><p>As I am based in the UK, let's look at changing the region and specification of the host launched by Docker Machine.</p><p>First, we should remove the <code class="literal">dotest</code> instance by running the following command:</p><div><pre class="programlisting">
<strong>docker-machine rm dotest</strong>
</pre></div><p>This will terminate the 512 MB instance running in NYC3.</p><div><div><h3 class="title"><a id="tip06"/>Tip</h3><p>It is important to terminate instances you are not using as they will will cost you for each hour they are active; remember, one of the key advantages of using Docker Machine is that you can quickly spin up instances both quickly and with as little interaction as possible.</p></div></div><p>Now we have removed<a id="id157" class="indexterm"/> the old instance, let's add some additional flags to our <code class="literal">docker-machine</code> command to launch the new instance in the desired region and specification, we will be calling our new instance <code class="literal">douktest</code>. The updated <code class="literal">docker-machine create</code> command now looks like this (again, remember to replace the example API token with your own):</p><div><pre class="programlisting">
<strong>docker-machine create \</strong>
<strong>    --driver digitalocean \</strong>
<strong>    --digitalocean-access-token 14760f5bdee403cebb36117c22c83e5ee51188515f493a6c0d281c094c552536\</strong>
<strong>    --digitalocean-region lon1 \</strong>
<strong>    --digitalocean-size 1gb \</strong>
<strong>    douktest</strong>
</pre></div><p>You should see similar output from the command as before; once the instance has been deployed, you can make it active by running the following command:</p><div><pre class="programlisting">
<strong>eval $(docker-machine env douktest)</strong>
</pre></div><p>When you enter the control panel, you will notice that the instance has launched in the specified region and at the desired specification:</p><div><img src="img/B06455_03_07.jpg" alt="The Digital Ocean driver"/></div><p>For full details on each of the regions and what machine types are available in each one you can query the Digital Ocean API by running the following command (again, remember to replace the API token):</p><div><pre class="programlisting">
<strong>curl -X GET -H "Content-Type: application/json" -H "Authorization: Bearer 14760f5bdee403cebb36117c22c83e5ee51188515f493a6c0d281c094c552536" "https://api.digitalocean.com/v2/regions" | python -mjson.tool</strong>
</pre></div><p>This will output information about each region.</p><p>One last thing; we <a id="id158" class="indexterm"/>still haven't found out about the SSH key. Each time you run Docker Machine a new SSH key for the instance you are launching is created and uploaded to the provider; each key is stored in the <code class="literal">.docker</code> folder in your users home directory. For example, the key for <code class="literal">douktest</code> can be found by running:</p><div><pre class="programlisting">
<strong>cd ~/.docker/machine/machines/douktest/</strong>
</pre></div><p>Here you will also find the certificates used to authenticate the Docker agent with the Docker installation on the instance and the configuration:</p><div><img src="img/B06455_03_08.jpg" alt="The Digital Ocean driver"/></div><p>So that covers launching a host in Digital Ocean; how about launching something more exciting than the Hello World container?</p><p>No problem, let's use Docker Compose to launch a variation of the WordPress stack we used in <a class="link" href="ch02.html" title="Chapter 2. Launching Applications Using Docker">Chapter 2</a>, <em>Launching Applications Using Docker</em>. Start by going to the <code class="literal">/bootcamp/chapter03/wordpress</code> folder and then run the following command:</p><div><pre class="programlisting">
<strong>docker-machine ls</strong>
</pre></div><p>To check you have your Docker client configured to use your Digital Ocean Docker host. Once you are sure your client is using the remote host, simply run:</p><div><pre class="programlisting">
<strong>docker-compose up -d</strong>
</pre></div><p>This will download the images we need, then launch two containers. This time you will be able to access the WordPress installation on <code class="literal">port 80</code> on your Digital Ocean host. To find the IP of your host, you can run the following command:</p><div><pre class="programlisting">
<strong>docker-machine ip douktest</strong>
</pre></div><p>Or on a Mac or Linux machine to open your browser and go to your installation page run the following command:</p><div><pre class="programlisting">
<strong>open http://$(docker-machine ip douktest)/</strong>
</pre></div><p>The terminal session below shows the output you can expect to see from the previous commands:</p><div><img src="img/B06455_03_10.jpg" alt="The Digital Ocean driver"/></div><p>You will then be able to complete your WordPress installation:</p><div><img src="img/B06455_03_11.jpg" alt="The Digital Ocean driver"/></div><div><div><h3 class="title"><a id="tip07"/>Tip</h3><p>I wouldn't recommend leaving your WordPress installation at the installation screen for long as it is possible that someone could complete the installation on your behalf and get up to no good.</p></div></div><p>Once you have <a id="id159" class="indexterm"/>finished your Digital Ocean, host run the following command to terminate it:</p><div><pre class="programlisting">
<strong>docker-machine rm douktest</strong>
</pre></div><p>Now that we have learned how to launch a Docker host in Digital Ocean let's move on to Amazon Web Services.</p></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec24"/>The Amazon Web Services driver</h1></div></div></div><p>If you don't already<a id="id160" class="indexterm"/> have an <strong>Amazon Web Services</strong> (<strong>AWS</strong>) account, you should sign up for <a id="id161" class="indexterm"/>one at <a class="ulink" href="http://aws.amazon.com/">http://aws.amazon.com/</a>; if you are new to AWS, then you will be eligible for their free tier <a class="ulink" href="http://aws.amazon.com/free/">http://aws.amazon.com/free/</a>.</p><p>I would recommend reading through Amazon's getting started guide if you are unfamiliar with AWS before working through this section of the chapter; you can find the guide at <a class="ulink" href="http://docs.aws.amazon.com/gettingstarted/latest/awsgsg-intro/gsg-aws-intro.html">http://docs.aws.amazon.com/gettingstarted/latest/awsgsg-intro/gsg-aws-intro.html</a>.</p><p>The AWS driver is like the Digital Ocean driver in that it has some sensible defaults, Rather than going into too much detail about how to customize the EC2 instance launched by Docker Machine, we will stick with the defaults. For AWS driver, these are as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">amazonec2-region = us-east-1 (North Virginia)</li><li class="listitem" style="list-style-type: disc">amazonec2-ami = ami-fd6e3bea (Ubuntu 16.04)</li><li class="listitem" style="list-style-type: disc">amazonec2-instance-type = t2.micro</li><li class="listitem" style="list-style-type: disc">amazonec2-root-size = 16GB</li><li class="listitem" style="list-style-type: disc">amazonec2-security-group = docker-machine</li></ul></div><p>Please note, if <strong>amazonec2-security-group</strong> does not exist, it will be created for you by Docker Machine; if it does exist, then Docker Machine will use the pre-existing rules instead.</p><p>Before we launch our instance, we will also need to know our <strong>AWS Access</strong> and <strong>AWS Secret</strong> keys and the <strong>VPC ID </strong>we will be launching our instance into; to get these, please log in to the AWS console which can be found at <a class="ulink" href="https://console.aws.amazon.com/">https://console.aws.amazon.com/</a>.</p><p>Most of you will be logging with your AWS root account. As your AWS root account shouldn't have any Access and Secret keys associated with it we should add a separate user for Docker Machine by going to <strong>Services</strong> | <strong>IAM</strong> | <strong>Users</strong> and then selecting your user and going to the <strong>Security Credential</strong>s tab.</p><p>There you should see a button which says <strong>Add user</strong>, click this and you will be taken to a screen where you can set your user details. Enter the <strong>User name </strong>
<code class="literal">docker-machine</code> and then for the <strong>Access type</strong> tick the <strong>Programmatic access</strong> check box:</p><div><img src="img/B06455_03_13.jpg" alt="The Amazon Web Services driver"/></div><p>When you have<a id="id162" class="indexterm"/> entered the details, click on <strong>Next: Permissions </strong>to be taken to the next step. On the permissions page, click on <strong>Attach existing policies directly</strong> and then in the <strong>Policy type</strong> search box, enter <code class="literal">SystemAdministrator</code> and hit return to filter the policies: </p><p>Tick the check box next to <code class="literal">SystemAdministrator</code> and then click on <strong>Ne</strong>
<strong>xt: Review</strong>:</p><div><img src="img/B06455_03_14.jpg" alt="The Amazon Web Services driver"/></div><p>On the review page, click on <strong>Create user</strong> and after a few seconds, you should receive confirmation your user has been successfully created.</p><p>Make sure you click on <strong>Download .csv</strong> as you will not be shown the Secret access key again. Now you have your Access key ID and Secret access key.</p><p>Before you<a id="id163" class="indexterm"/> find your VPC ID, you should make sure you are in the correct region by ensuring that it says, <strong>N. Virginia</strong> in the top-right of your AWS console; if it doesn't, select it from the drop-down list.</p><div><div><h3 class="title"><a id="note15"/>Note</h3><p>Amazon describes Amazon VPC (Amazon Virtual Private Cloud) as letting you provision a logically isolated section of the AWS Cloud where you can launch resources in a virtual network which you define. You have complete control over your virtual networking environment, including the selection of your own IP address range, the creation of subnets, and configuration of route tables and network gateways.</p></div></div><p>Once you have ensured you are in the correct region, go to <strong>Services</strong> then <strong>VPC</strong> and click on <strong>Your VPCs</strong>; you don't need to worry about creating and configuring a VPC as Amazon provides you with a default VPC in each region. Select the VPC and you should see the something like the following:</p><div><img src="img/B06455_03_17.jpg" alt="The Amazon Web Services driver"/></div><div><div><h3 class="title"><a id="note16"/>Note</h3><p>Make a note of the VPC ID; you should now have enough information to launch your instance using Docker Machine. To do this, run the following command:</p></div></div><div><pre class="programlisting">
<strong>docker-machine create \</strong>
<strong>    --driver amazonec2 \</strong>
<strong>    --amazonec2-access-key AKIAIP26OOEA3D4SLW5A \</strong>
<strong>    --amazonec2-secret-key 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 \</strong>
<strong>    --amazonec2-vpc-id vpc-35c91750 \</strong>
<strong>    awstest</strong>
</pre></div><p>If all goes well, <a id="id164" class="indexterm"/>you should see something like the following output:</p><div><img src="img/B06455_03_18.jpg" alt="The Amazon Web Services driver"/></div><p>You should also be able to see an EC2 instance launched in the AWS Console by clicking on <strong>Services</strong> | <strong>EC2</strong> | <strong>Instances</strong>:</p><div><img src="img/B06455_03_19.jpg" alt="The Amazon Web Services driver"/></div><p>You may have noticed Docker Machine created the security group and assigned an SSH key to the instance without any need for us to get involved, keeping within the principle that you don't need to be an expert in configuring the environments you are launching your Docker instance into.</p><p>Before we terminate the instance, let's switch our local Docker client over to use the AWS instance and launch the <strong>Hello World</strong> container by running the following commands:</p><div><pre class="programlisting">
<strong>eval $(docker-machine env awstest)</strong>
<strong>docker-machine ls</strong>
<strong>docker container run hello-world</strong>
<strong>docker c</strong>
<strong>ontainer ls -a</strong>
</pre></div><p>As you can see, once you have launched an instance using Docker Machine and switch your local Docker client to it, there is no difference in usage between running Docker locally or on a cloud provider.</p><p>Before we<a id="id165" class="indexterm"/> start to rack up cost we should terminate our test AWS instance by running the following command:</p><div><pre class="programlisting">
<strong>docker-machine rm awstest</strong>
</pre></div><p>And then confirm in the AWS console that the instance has terminated correctly:</p><div><img src="img/B06455_03_21.jpg" alt="The Amazon Web Services driver"/></div><p>If you don't do this, the EC2 instance will quite happily sit there costing, you $0.013 per hour until it is terminated.</p><div><div><h3 class="title"><a id="note17"/>Note</h3><p>Please note, this is not Docker for AWS, we will be covering this service in <a class="link" href="ch04.html" title="Chapter 4. Docker Swarm">Chapter 4</a>, <em>Docker Swarm</em>.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec25"/>The Microsoft Azure driver</h1></div></div></div><p>As you may have noticed<a id="id166" class="indexterm"/> from the terminal and browser screenshots, so far, we have been using Docker for Mac; let's look at the Microsoft Azure driver using Docker for Windows.</p><p>First of all, you will need a Microsoft Azure<a id="id167" class="indexterm"/> account; if you don't already have one, you can sign up at <a class="ulink" href="https://azure.microsoft.com/">https://azure.microsoft.com/</a>. Once you have your account, the only piece of information you need to get started is your subscription ID; you can find this in the billing section of the portal.</p><p>Once you have your subscription ID, you can authenticate Docker Machine with Azure, to do this enter the following command, making sure to replace the subscription ID with your own:</p><div><pre class="programlisting">
<strong>docker-machine.exe create --driver azure --azure-subscription-id xxxxxxx-85a6-4ab4-b5c4-c18b54e014</strong>
<strong>98 azuretest</strong>
</pre></div><div><img src="img/B06455_03_22.jpg" alt="The Microsoft Azure driver"/></div><p>You will receive an activation code to authorise Docker Machine; go to <a class="ulink" href="https://aka.ms/devicelogin/">https://aka.ms/devicelogin/</a> and enter the code you have been given:</p><div><img src="img/B06455_03_23.jpg" alt="The Microsoft Azure driver"/></div><p>Clicking <strong>Continue</strong> <a id="id168" class="indexterm"/>will take you a page which then shows you the permissions which Docker Machine is going to grant:</p><div><img src="img/B06455_03_24.jpg" alt="The Microsoft Azure driver"/></div><p>Once you click <strong>Accept,</strong> you should see Docker Machine start bootstrapping the environment. The process will take several minutes; once it completes, you should see something like the following output:</p><div><img src="img/B06455_03_25.jpg" alt="The Microsoft Azure driver"/></div><p>As you can see, <a id="id169" class="indexterm"/>Docker Machine has done the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Created a resource group</li><li class="listitem" style="list-style-type: disc">Configured a network security group</li><li class="listitem" style="list-style-type: disc">Configured a network subnet</li><li class="listitem" style="list-style-type: disc">Created a virtual network</li><li class="listitem" style="list-style-type: disc">Assigned a public IP address</li><li class="listitem" style="list-style-type: disc">Created a network interface</li><li class="listitem" style="list-style-type: disc">Created a storage account</li><li class="listitem" style="list-style-type: disc">Launched a virtual machine</li></ul></div><p>If you go to the resource group within the Azure Portal you should see your virtual machine is launched and ready:</p><div><img src="img/B06455_03_26.jpg" alt="The Microsoft Azure driver"/></div><p>Like the Mac and Linux<a id="id170" class="indexterm"/> versions of Docker Machine we need to configure our local Docker client to communicate with the remote host, to do this we need to run the following command:</p><div><pre class="programlisting">
<strong>docker-machine.exe env --shell powershell azuretest | Invoke-Expression</strong>
</pre></div><p>This is the equivalent of running the following on Mac or Linux:</p><div><pre class="programlisting">
<strong>eval $(docker-machine env azuretest)</strong>
</pre></div><p>You can check that Azure is now active by running:</p><div><pre class="programlisting">
<strong>docker-machine.exe ls</strong>
</pre></div><p>Now that we have our client talking to our Azure remote host, we can launch the <strong>Hello World</strong> container by running:</p><div><pre class="programlisting">
<strong>docker container run hello-world</strong>
<strong>docker container ls -a</strong>
</pre></div><p>As with the Mac and Linux version of Docker Machine, you can SSH into your Azure host by running:</p><div><pre class="programlisting">
<strong>docker-machine.exe ssh azuretest</strong>
</pre></div><p>As you can see from the output below, we can see the <strong>Hello World</strong> container:</p><div><img src="img/B06455_03_28.jpg" alt="The Microsoft Azure driver"/></div><p>From here you can interact <a id="id171" class="indexterm"/>with the Azure host as you would do any other Docker host. Once you are ready to terminate your Azure host, all you need to do is run the following command:</p><div><pre class="programlisting">
<strong>docker-machine.exe rm azuretest</strong>
</pre></div><p>It will take a short while to remove the host and all the resources associated with it, once complete, you should see something like:</p><div><img src="img/B06455_03_29.jpg" alt="The Microsoft Azure driver"/></div><p>Checking the <strong>Activity log</strong> in the docker-machine <strong>Resource group</strong> using the Azure portal should show you the resources being removed:</p><div><img src="img/B06455_03_30.jpg" alt="The Microsoft Azure driver"/></div><p>As highlighted by the <a id="id172" class="indexterm"/>PowerShell output, it is best to check that everything has been properly terminated, the easiest way to do this is to remove the resource group itself, to do this click on the three dots (<strong>...</strong>) on the right-hand side of the <strong>docker-machi</strong>
<strong>ne</strong> resource. </p><p>After you have followed the on-screen prompts, which include typing the name of the resource you are choosing to remove, you should receive confirmation that the resource group has been removed.</p><p>While we have used Windows to look at Azure, the process, other than switching the local client to use the remote host, is the same on Mac and Linux.</p><div><div><h3 class="title"><a id="note18"/>Note</h3><p>Please note, this is not Docker for Azure, we will be covering this service in <a class="link" href="ch04.html" title="Chapter 4. Docker Swarm">Chapter 4</a>, <em>Docker Swarm</em>.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec26"/>References</h1></div></div></div><p>The examples we have used in this chapter have been launching Ubuntu instances. Docker Machine also supports:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Debian <a id="id173" class="indexterm"/>(8.0+) - <a class="ulink" href="https://www.debian.org/">https://www.debian.org/</a></li><li class="listitem" style="list-style-type: disc">Red Hat <a id="id174" class="indexterm"/>Enterprise Linux (7.0+) - <a class="ulink" href="https://www.redhat.com/">https://www.redhat.com/</a></li><li class="listitem" style="list-style-type: disc">CentOS (7+) - <a class="ulink" href="https://www.centos.org/">https://www.centos.org/</a></li><li class="listitem" style="list-style-type: disc">Fedora (21+) - <a class="ulink" href="https://getfedora.org/">https://getfedora.org/</a></li><li class="listitem" style="list-style-type: disc">RancherOS (0.3) - <a class="ulink" href="http://rancher.com/rancher-os/">http://rancher.com/rancher-os/</a></li></ul></div><p>The other thing to <a id="id175" class="indexterm"/>mention about Docker Machine is that by default it operates <a id="id176" class="indexterm"/>an opt-in for crash reporting, considering the number of <a id="id177" class="indexterm"/>different configuration /environment combinations Docker Machine can be used with it is important that Docker gets notified of any problems to help them make a better product.</p><p>If for any reason, you want to opt out, then running the following command will disable crash reporting:</p><div><pre class="programlisting">
<strong>mkdir -p ~/.docker/machine &amp;&amp; touch ~/.docker/machine/no-error-report</strong>
</pre></div><p>For more information on Docker Machine<a id="id178" class="indexterm"/> you can see the official<a id="id179" class="indexterm"/> documentation:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Docker Machine - <a class="ulink" href="https://docs.docker.com/machine/">https://docs.docker.com/machine/</a></li><li class="listitem" style="list-style-type: disc">Docker Machine Drivers - <a class="ulink" href="https://docs.docker.com/machine/drivers/">https://docs.docker.com/machine/drivers/</a></li><li class="listitem" style="list-style-type: disc">Docker <a id="id180" class="indexterm"/>Machine Command Reference - <a class="ulink" href="https://docs.docker.com/machine/reference/">https://docs.docker.com/machine/reference/</a></li></ul></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec27"/>Summary</h1></div></div></div><p>As you can see from examples we have worked through; Docker Machine is a powerful tool as it allows users of all skill levels to be able to launch an instance in a cloud provider without having to roll their sleeves up and get stuck in configuring server instances.</p><p>In our next chapter, we are going to look at launching multiple Docker hosts in the same cloud providers and then configuring a Docker Swarm cluster.</p></div></body></html>