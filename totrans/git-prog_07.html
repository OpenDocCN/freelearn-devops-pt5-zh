<html><head></head><body>
  <div><h1 class="chapterNumber">7</h1>
    <h1 id="_idParaDest-131" class="chapterTitle">Workflow, Notes, and Tags</h1>
    <p class="normal">In this chapter, we will see</p>
    <ul>
      <li class="bullet">The standard workflow using Git</li>
      <li class="bullet">What notes are</li>
      <li class="bullet">How to use notes</li>
      <li class="bullet">What tags are</li>
      <li class="bullet">How to use tags</li>
    </ul>
    <p class="normal">We'll start off by examining the standard workflow.</p>
    <h1 id="_idParaDest-132" class="title">Standard workflow</h1>
    <p class="normal">The standard workflow is pretty much what we've seen in the previous five chapters, except that <a id="_idIndexMarker205"/>you usually would not commit so quickly or often. Typically, it goes like this:</p>
    <ol>
      <li class="numbered">Create a repository.</li>
      <li class="numbered">Either clone that repository from the server, or if it was created locally, push it to the server.</li>
      <li class="numbered">Create a branch.</li>
      <li class="numbered">Code.</li>
      <li class="numbered">Test.</li>
      <li class="numbered">Commit.</li>
      <li class="numbered">Repeat <em class="italic">steps 4-6</em> until you have a block of code that does "something" (e.g. opens a dialog box and processes the result).</li>
      <li class="numbered">Test.</li>
      <li class="numbered">Commit.</li>
      <li class="numbered">Push.</li>
      <li class="numbered">Repeat <em class="italic">steps 4-10</em> until you have fulfilled a requirement (self-imposed or otherwise).</li>
      <li class="numbered">Merge into the main branch (or create a pull request if you are in a team).</li>
    </ol>
    <p class="normal">There are variants on this. Some people like to push after each commit, but that prevents them from using interactive rebase to reorganize their commits. What happens though <a id="_idIndexMarker206"/>if you have pushed your commit and realize that there is additional information you wish you had added to the message?</p>
    <p class="normal">Do <em class="italic">not</em> modify code you've pushed. (Have I said that before?) So, what to do?</p>
    <p class="normal">If the problem is significant (you need to modify the commit contents, etc.) then you'll need to take more drastic measures (see <em class="chapterRef">Chapter 12</em>, <em class="italic">Fixing Mistakes</em> on fixing mistakes). But if it is just a matter of updating the message, consider adding a note.</p>
    <h1 id="_idParaDest-133" class="title">Mirroring your repo</h1>
    <p class="normal">We want to go on to discuss notes, but to do so we need to take a digression into mirroring our <a id="_idIndexMarker207"/>repository so that we can add notes without messing up our existing repo.</p>
    <p class="normal">The repository we want to mirror should have a fair number of commits. You may remember from the previous chapter that I answered the challenge by creating a repository called <code class="Code-In-Text--PACKT-">RockyHorror</code>. Let's open that repo on our local machine and use the log to see the commits:</p>
    <figure class="mediaobject"><img src="img/B17741_07_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.1: What's in the existing repository?</p>
    <div><p class="Information-Box--PACKT-"><strong class="screenText">Note</strong>: You are not going crazy: for this chapter I've switched from PowerShell to the Bash shell.</p>
    </div>
    <h2 id="_idParaDest-134" class="title">Replicating an existing repo</h2>
    <p class="normal">As you can see there are nine commits, which will be enough for our purposes. However, I don't <a id="_idIndexMarker208"/>want to modify this repository (principally so that when you download the code it will look right when you are reading <em class="chapterRef">Chapter 6</em>, <em class="italic">Interactive Rebasing</em>).</p>
    <p class="normal">To get an exact copy of this repository into another, complete with commits, messages, etc., we're going to use Git's --<code class="Code-In-Text--PACKT-">mirror</code> flag. Here's how you do it.</p>
    <p class="normal">Change directory to <code class="Code-In-Text--PACKT-">RockyHorror</code> and make sure you are in the local repository by using the log, using the <code class="Code-In-Text--PACKT-">--oneline</code> flag, as shown previously in <em class="italic">Figure 7.1</em>.</p>
    <p class="normal">Now, we need a repository to put our mirrored version into. Go to GitHub and create a new repository named <code class="Code-In-Text--PACKT-">RockyHorror2</code>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_02.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.2: Creating the new repo</p>
    <p class="normal">As you would expect, you now have a repository, <code class="Code-In-Text--PACKT-">RockyHorror2</code>, on the server but not locally. We are now going to overwrite the files, commits, etc. on the server with the contents of <code class="Code-In-Text--PACKT-">RockyHorror</code>, giving us an exact duplicate to work with.</p>
    <p class="normal">To do this, make sure you are in the original repository (<code class="Code-In-Text--PACKT-">RockyHorror</code>), and then push to the server using the <code class="Code-In-Text--PACKT-">––mirror</code> flag and pushing to the new repository (<code class="Code-In-Text--PACKT-">RockyHorror2</code>). You'll need <a id="_idIndexMarker209"/>the address of your new repo, so start by going to the clone button on the server and copying the address, but <em class="italic">do not clone the repo</em>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_03.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.3: Mirroring to the new repo</p>
    <p class="normal">Okay, let's review. In your terminal (Bash, PowerShell, Terminal, etc.) you are in the directory for <code class="Code-In-Text--PACKT-">RockyHorror</code> and if you call <code class="Code-In-Text--PACKT-">git log --oneline</code> you will get the results shown in <em class="italic">Figure 7.1</em>.</p>
    <p class="normal">Now you are ready to mirror this repo locally. You'll do that from your terminal, but remember, what it is going to do is push a mirror of this repository onto the server, overwriting whatever is already in <code class="Code-In-Text--PACKT-">RockyHorror2</code> (in this case just the <code class="Code-In-Text--PACKT-">README.md</code>, the <code class="Code-In-Text--PACKT-">LICENSE</code>, and the <code class="Code-In-Text--PACKT-">.gitignore</code> file).</p>
    <p class="normal">This will cause Git to take a number of actions, the net effect of which is to copy everything from <code class="Code-In-Text--PACKT-">RockyHorror</code> over to <code class="Code-In-Text--PACKT-">RockyHorror2</code>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_04.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.4: Copying from the server to a local repo</p>
    <p class="normal">You can <a id="_idIndexMarker210"/>now go to GitHub and see that <code class="Code-In-Text--PACKT-">RockyHorror2</code> has been updated to be an exact replica of <code class="Code-In-Text--PACKT-">RockyHorror</code> (If you don't see that, remember to refresh the page):</p>
    <figure class="mediaobject"><img src="img/B17741_07_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.5: Examining the mirrored repo</p>
    <p class="normal">There are a few interesting things to see in <em class="italic">Figure 7.5</em>. First, notice in the upper left that we're in <code class="Code-In-Text--PACKT-">RockyHorror2</code>, but if you look at the <code class="Code-In-Text--PACKT-">README</code> it says <code class="Code-In-Text--PACKT-">RockyHorror</code>. That is because that <code class="Code-In-Text--PACKT-">README</code> came from the original <code class="Code-In-Text--PACKT-">RockyHorror</code> repo. Also notice that the files are not from a few minutes ago, but in my case from 6 days ago; that is because I modified those files 6 days ago in the original repo. The point, which really can be hard to wrap your head around, is that this is an exact duplicate of <code class="Code-In-Text--PACKT-">RockyHorror</code>.</p>
    <p class="normal">Now go to <code class="Code-In-Text--PACKT-">RockyHorror2</code> on your local machine. What? It isn't there? Right, we only mirrored to the server. If we want a local repository we need to clone our new one. You can do that <a id="_idIndexMarker211"/>using the command line, Visual Studio, or GitHub Desktop as we've seen (or any other GUI you like. SourceTree and Fork are very popular as of the time of writing).</p>
    <p class="normal">When you are cloning, make sure you copy the address of the new repo, not the original:</p>
    <figure class="mediaobject"><img src="img/B17741_07_06.png" alt=""/> </figure>
    <p class="packt_figref">Figure 7.6: Ensuring you are in the right place</p>
    <p class="normal">You now can change into the new <code class="Code-In-Text--PACKT-">RockyHorror2</code> directory. Do so and get a log of what is in there:</p>
    <figure class="mediaobject"><img src="img/B17741_07_07.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.7: Getting a log of the mirrored repo</p>
    <p class="normal">A key thing to notice here is that the commits and where <code class="Code-In-Text--PACKT-">HEAD</code> and <code class="Code-In-Text--PACKT-">origin</code> are pointing to are identical to <code class="Code-In-Text--PACKT-">RockyHorror</code> as shown in <em class="italic">Figure 7.1</em>.</p>
    <p class="normal">Notice that <a id="_idIndexMarker212"/>the ID is identical as well. I personally find this almost shocking, but as far as Git is concerned this is just another copy of the same repo. From now on, however, you can change one without affecting the other.</p>
    <h2 id="_idParaDest-135" class="title">Adding and showing notes</h2>
    <p class="normal">Now we are ready to add a note to one of our commits. </p>
    <div><p class="normal">Let me be clear, you do <em class="italic">not</em> have to mirror <a id="_idIndexMarker213"/>your repo to use notes. We only did that here for the <a id="_idIndexMarker214"/>purposes of the book; to ensure that the repos correspond to what is shown in each chapter. Normally, you would just add the note.</p>
    </div>
    <p class="normal">Notes are just bits of text you can attach to a commit after it is already in the repo. A common use for notes is to explain how a commit fits in with other commits, or perhaps to flag a commit for amending or rebasing, or really to add any information you want to paste onto the commit. It does not change the commit; it is like a post-it you tack on.</p>
    <p class="normal">To add the note, you'll use the <code class="Code-In-Text--PACKT-">git notes</code> command with one or more flags. For example, if you have the code in <em class="italic">Figure 7.7</em> and you want to add a note to the commit that currently says "Remove Hello World" all we need to do is to get the ID <code class="Code-In-Text--PACKT-">commit id—bb4927c—</code> and execute like this:</p>
    <pre class="programlisting con"><code class="hljs-con">git notes add -m "Remove from program.cs" bb4927c
</code></pre>
    <p class="normal">If you now run <code class="Code-In-Text--PACKT-">git log</code> you'll see the note in the log listing, prefixed by the word Notes:</p>
    <figure class="mediaobject"><code class="Code-In-Text--PACKT-"><img src="img/B17741_07_08.png" alt=""/></code></figure>
    <p class="packt_figref">Figure 7.8: Seeing the attached note</p>
    <p class="normal">If you want to see your changes along with the note, use the <code class="Code-In-Text--PACKT-">show</code> subcommand:</p>
    <figure class="mediaobject"><img src="img/B17741_07_09.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.9: Seeing your changes with the notes</p>
    <p class="normal">Once again, there <a id="_idIndexMarker215"/>are many subcommands that you can Google <a id="_idIndexMarker216"/>for when the need arises.</p>
    <h2 id="_idParaDest-136" class="title">Tags</h2>
    <p class="normal">It can be convenient to mark a given commit with a name. For example, you might mark one commit <a id="_idIndexMarker217"/>as the developer release, and another as the general release. Each time you <a id="_idIndexMarker218"/>make a new release you add another tag, giving you a quick and clean way to look through the history and see which commits were added before or after each release.</p>
    <p class="normal">Let's look back at <em class="italic">Figure 7.1</em> one more time. We might decide that the commit <code class="Code-In-Text--PACKT-">Enter show times</code> is the last commit in creating the Show object, and we'd like to indicate that. We can do so with a note, but in this case, it may be more convenient to tag that commit.</p>
    <p class="normal">There are two types of tags you might use: a simple tag and an annotated tag. Let's start with a simple tag:</p>
    <figure class="mediaobject"><img src="img/B17741_07_10.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.10: Tag for LastShowCommit</p>
    <p class="normal">In <em class="italic">Figure 7.10</em> we first take <a id="_idIndexMarker219"/>an online log of all the commits. We then add the tag:</p>
    <pre class="programlisting con"><code class="hljs-con">git tag LastShowCommit bf6b900
</code></pre>
    <p class="normal">As you <a id="_idIndexMarker220"/>can see, we use the keyword <code class="Code-In-Text--PACKT-">tag</code> followed by the tag itself (one word, no quotes) followed by the ID of the commit we're tagging.</p>
    <p class="normal">Note that we are tagging a commit, not a given file. This tag applies to all the files in that commit.</p>
    <p class="normal">The second type of tag is an annotated tag, as shown in <em class="italic">Figure 7.11</em>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_11.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.11: Annotated tag</p>
    <p class="normal">When you use the oneline log, this appears just as the other tag did, as shown in <em class="italic">Figure 7.12</em>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_12.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.12: Annotated tag in the oneline log</p>
    <p class="normal">If, however, you <a id="_idIndexMarker221"/>use the <code class="Code-In-Text--PACKT-">show</code> command, you can see the tag with the additional <a id="_idIndexMarker222"/>information you supplied (i.e. the message) when it was created and by whom. It is very similar to a commit, except that no files are affected, and it is marked with the keywords <strong class="screenText">tag</strong> and <strong class="screenText">tagger</strong>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.13: The annotated tag</p>
    <h3 id="_idParaDest-137" class="title">Pointing to a different tag</h3>
    <p class="normal">If you create <a id="_idIndexMarker223"/>a tag but point it to the wrong commit, you can change what it points to by using the force flag. For example, suppose you have the list of commits shown in <em class="italic">Figure 7.14</em>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_14.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.14: List with tag at the wrong commit</p>
    <p class="normal">Notice that the tag <code class="Code-In-Text--PACKT-">TestOfShowObject</code> is pointing to <code class="Code-In-Text--PACKT-">f55eb4e</code>. Unfortunately, we meant to point it to the next commit (<code class="Code-In-Text--PACKT-">e16d191</code>). To do this, we can write:</p>
    <pre class="programlisting con"><code class="hljs-con">git tag -f TestOfShowObject e16d191
</code></pre>
    <p class="normal">We need <a id="_idIndexMarker224"/>the force flag (<code class="Code-In-Text--PACKT-">-f</code>) to ensure that Git doesn't complain with <code class="Code-In-Text--PACKT-">Fatal: tag TestOfShowObjects already exists</code>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_15.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.15: Using the force command to reassign the tag</p>
    <p class="normal">As you can see in <em class="italic">Figure 7.15</em>, Git responds with the message updated tag, the name of the tag, and what it had been pointing to. The tag has now been moved to <code class="Code-In-Text--PACKT-">e16d191</code>, as we hoped.</p>
    <p class="normal">Finally, we can delete a tag with the <code class="Code-In-Text--PACKT-">-d</code> flag:</p>
    <figure class="mediaobject"><img src="img/B17741_07_16.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.16: Deleting the tag</p>
    <p class="normal"><em class="italic">Figure 7.16</em> shows that <a id="_idIndexMarker225"/>Git confirms the deletion and running the log shows that the tag is gone.</p>
    <h1 id="_idParaDest-138" class="title">Summary</h1>
    <p class="normal">In this chapter you learned</p>
    <ul>
      <li class="bullet">The standard workflow using Git</li>
      <li class="bullet">What notes are and how to create them</li>
      <li class="bullet">What tags are and how to create, move, and delete them</li>
    </ul>
    <h1 id="_idParaDest-139" class="title">Challenge</h1>
    <p class="normal">Create a local copy of <code class="Code-In-Text--PACKT-">Panofy</code>. Add a note to one of the commits and ensure it is there. Add a tag to one of the commits and make sure it is there. Finally, change which commit the tag is pointing to.</p>
    <p class="normal">Here is my answer:</p>
    <p class="normal">First, switch directory to <code class="Code-In-Text--PACKT-">Panofy</code>. If it is not on your local machine, clone it:</p>
    <figure class="mediaobject"><img src="img/B17741_07_17.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.17: Switching to the Panofy project</p>
    <p class="normal">As shown in <em class="italic">Figure 7.17</em> when I tried to change directory to <code class="Code-In-Text--PACKT-">Panofy</code> I was told it doesn't exist, so I cloned it from the server.</p>
    <p class="normal">To create a mirror I first create a new repo on the server named <code class="Code-In-Text--PACKT-">Panofy2</code>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_18.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.18: Mirroring</p>
    <p class="normal">As you can see in <em class="italic">Figure 7.18</em>, this time I did not bother creating a license file as all of this will be overwritten when I mirror Panofy over it. To do so I change directory to Panofy (the original repo) and enter:</p>
    <pre class="programlisting con"><code class="hljs-con">git push ––mirror https://github.com/JesseLiberty/Panofy2.git
</code></pre>
    <p class="normal">This takes the repository I'm in (<code class="Code-In-Text--PACKT-">Panofy</code>) and pushes it to the new address, mirroring the original:</p>
    <figure class="mediaobject"><img src="img/B17741_07_19.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.19: Pushing to the mirrored repo on the server</p>
    <p class="normal">I'll switch to <code class="Code-In-Text--PACKT-">Panofy2</code> on the server, and sure enough, the license is now there (from <code class="Code-In-Text--PACKT-">Panofy</code>) along with the <code class="Code-In-Text--PACKT-">Panofy</code> folder as shown in <em class="italic">Figure 7.20</em>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_20.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.20: License for Panofy</p>
    <p class="normal">With that in place, I can safely change <code class="Code-In-Text--PACKT-">Panofy2</code>. The first task is to add a note. Let's start with a log so that we can see what we have:</p>
    <figure class="mediaobject"><img src="img/B17741_07_21.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.21: Adding a note to a commit in the mirrored repo</p>
    <p class="normal">Let's add a note to the commit with the message <code class="Code-In-Text--PACKT-">Add Hello Message</code> that says <code class="Code-In-Text--PACKT-">Traditional first Hello World</code>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_22.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.22: Adding a note</p>
    <p class="normal">In <em class="italic">Figure 7.22</em> we see that this time I did not add the note in the Git statement. Instead I waited for the editor (in my case Visual Studio Code) to open and I put the statement in there. When I closed the file the note was entered, as shown in <em class="italic">Figure 7.23</em>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_23.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.23: Adding the note with an editor</p>
    <p class="normal">Let's look at the log once more:</p>
    <figure class="mediaobject"><img src="img/B17741_07_24.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.24: Examining the log</p>
    <p class="normal">I'll add an annotated tag to the commit that says <code class="Code-In-Text--PACKT-">Update csproj</code>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_25.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.25: Examining an annotated tag</p>
    <p class="normal">There are four arrows in <em class="italic">Figure 7.25</em>. The first points to the creation of the tag. The second shows you the tag name, the third shows you who the tagger (creator of the tag) was, and the final arrow points to the text of the tag itself.</p>
    <p class="normal">Let's look at the log again, as shown in <em class="italic">Figure 7.26</em>:</p>
    <figure class="mediaobject"><img src="img/B17741_07_26.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.26: An annotated tag in the oneline log</p>
    <p class="normal">We can see the tag at <code class="Code-In-Text--PACKT-">877348c</code>, but it turns out we had forgotten to update <code class="Code-In-Text--PACKT-">csproj</code> and fixed that at commit <code class="Code-In-Text--PACKT-">4b080ba</code>. Let's move the tag there:</p>
    <figure class="mediaobject"><img src="img/B17741_07_27.png" alt=""/></figure>
    <p class="packt_figref">Figure 7.27: Moving the tag</p>
    <p class="normal">In this final figure, <em class="italic">Figure 7.27</em>, you can see that we have moved the tag <code class="Code-In-Text--PACKT-">ReleaseCandidate</code> to <code class="Code-In-Text--PACKT-">4b080ba</code> as intended.</p>
  </div>
</body></html>