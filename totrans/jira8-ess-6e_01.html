<html><head></head><body>
		<div><h1 id="_idParaDest-15" class="chapter-number"><a id="_idTextAnchor014"/>1</h1>
			<h1 id="_idParaDest-16"><a id="_idTextAnchor015"/>Getting Started with Jira Data Center</h1>
			<p>In this chapter, we will start by providing a high-level overview of Jira, the various products that run on top of the platform, and then introduce Jira Data Center. After that, we will examine the various deployment options and system requirements for hosting Jira Data Center yourself. Finally, we will get our hands dirty by installing our very own Jira Data Center from scratch, both as a standalone and a clustered deployment.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Understanding the Jira platform</li>
				<li>Introducing Jira Data Center</li>
				<li>System requirements</li>
				<li>Installation package options</li>
				<li>Installing and configuring Jira</li>
				<li>Post-installation configuration</li>
				<li>Clustering</li>
				<li>Zero-downtime upgrade</li>
			</ul>
			<p>By the end of the chapter, you will have learned about the Jira platform and the new Data Center product. You will also learn about the system requirements to install Jira, and how a Jira cluster works. Finally, you will have your own Jira instance up and running.</p>
			<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/>Understanding the Jira platform</h1>
			<p>Jira started as a <a id="_idIndexMarker000"/>popular tool used by software development teams to track and manage their projects. As the IT industry changed over the years, Jira has also grown to meet the demands and challenges faced by its users. Today, Jira has transformed from being a single application to a platform with many applications and solutions that can run on top of it, and it provides additional features and capabilities that go beyond issue tracking.</p>
			<p>Atlassian, the company behind Jira, has several other products that make up the Jira family. These include the following:</p>
			<ul>
				<li><strong class="bold">Jira Software</strong>: This is <a id="_idIndexMarker001"/>a product that focuses on software development. It allows project teams to run their software development projects using traditional waterfall and agile methodologies such as Scrum and Kanban.</li>
				<li><strong class="bold">Jira Work Management</strong>: This is a product that is designed for non-software development <a id="_idIndexMarker002"/>teams, such as marketing, operations, and legal. It is perfect for general-purpose task management.</li>
				<li><strong class="bold">Jira Service Management</strong>: This is a product for service desk teams. It is designed for <a id="_idIndexMarker003"/>running Jira as a support ticketing system, with <a id="_idIndexMarker004"/>a simplified user interface for the end users with a focus on customer satisfaction and <strong class="bold">Service-Level Agreement</strong> (<strong class="bold">SLA</strong>) goals.</li>
			</ul>
			<p>At its core, the Jira platform provides many of its common functionalities for various products, such as <a id="_idIndexMarker005"/>user interface customization, workflows, and email notifications, while Jira Software and Jira Service Desk add specialized features on top of it.</p>
			<p>Of course, being a platform means Jira also allows other third-party developers to develop solutions for it. Atlassian <a id="_idIndexMarker006"/>has a huge thriving ecosystem of products and solutions made by partners that add even more features to Jira. We will look at some of these solutions later in this book.</p>
			<p>In this book, we will primarily focus on Jira Software, but we will also cover all the common features that are shared by all the applications, and how they can be used by them in their specific use cases. For this reason, the term <em class="italic">Jira</em> will be primarily used to refer to Jira Software, unless a specific distinction is needed.</p>
			<p>Now that we have learned about the Jira platform and its various products, it is time to look at the newest member of the Jira family.</p>
			<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>Introducing Jira Data Center</h1>
			<p>One of the biggest challenges users often face with Jira Server is <strong class="bold">scalability</strong>. When an organization’s Jira <a id="_idIndexMarker007"/>deployment grows to thousands of concurrent users and <a id="_idIndexMarker008"/>hundreds of thousands of issues, they will often start to experience performance issues, such as slower response times. While each new major release would include performance improvements, customers often had to archive and export old projects to another Jira instance or split up their one big instance into several smaller instances.</p>
			<p>Some organizations can resolve this problem by migrating to the Jira Cloud offering. However, not everyone can move to the public cloud due to security, regulations, and other reasons, or they prefer to run Jira in their private cloud. This is where <strong class="bold">Jira Data Center</strong> comes in.</p>
			<p>Jira Data Center is the new offering from Atlassian that replaces the old Jira Server and aims to address challenges that are often faced by organizations that need their Jira deployment to be performant, scalable, highly available, and secure.</p>
			<p>With Jira Data Center, you can continue to host Jira yourself, with the aforementioned added benefits. Many <a id="_idIndexMarker009"/>additional features are added, such as support for <strong class="bold">Security Assertion Markup Language</strong> (<strong class="bold">SAML</strong>), Advanced Roadmaps for planning, and improved administrative functions.</p>
			<p class="callout-heading">Additional information</p>
			<p class="callout">You can find a full list of differences between the old Jira Server and Jira Data Center at <a href="https://confluence.atlassian.com/enterprise/jira-server-and-data-center-feature-comparison-953651628.html">https://confluence.atlassian.com/enterprise/jira-server-and-data-center-feature-comparison-953651628.html</a>.</p>
			<p>So, how does Jira Data Center achieve all these benefits and improvements? Unlike Jira Server, where you have a single instance of Jira running, Jira Data Center allows you to run multiple Jira instances <a id="_idIndexMarker010"/>together as a single deployment, called a <strong class="bold">cluster</strong>. The following diagram illustrates a typical Jira Data Center deployment:</p>
			<div><div><img src="img/Figure_1.1_B18644.jpg" alt="Figure 1.1 – Jira Data Center deployment&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.1 – Jira Data Center deployment</p>
			<p>You will have one or more Jira instances, called <strong class="bold">nodes</strong>, running in a single cluster. All the Jira nodes will <a id="_idIndexMarker011"/>connect to the same database and file server, with a load balancer to distribute the traffic <a id="_idIndexMarker012"/>across all the nodes. This way, you have more computing power shared across the cluster, and you can add another node to the cluster at any time to add additional capacity.</p>
			<p>Another good feature of Jira Data Center is that you do not need to run a cluster if you are not ready. You can run your deployment with a single node as a standalone, just as you would with the previous Jira Server. Then, when you need to, you can always convert your deployment into a cluster. Doing so gives you flexibility, as well as all the additional features that <a id="_idIndexMarker013"/>have been introduced in Jira Data Center. With a good understanding of Jira Data Center, let’s look at what we will need for deployment.</p>
			<h1 id="_idParaDest-19"><a id="_idTextAnchor018"/>System requirements</h1>
			<p>Before we can <a id="_idIndexMarker014"/>deploy Jira Data Center, we need to look at the hardware and software required for Jira, and how you want your deployment to be.</p>
			<p>You can deploy Jira in two ways:</p>
			<ul>
				<li><strong class="bold">Standalone</strong>: This is the same deployment as the classic Jira Server, where you have a single <a id="_idIndexMarker015"/>Jira instance serving your users. This is the easier option and does not require as many system resources. If you are just getting started, this is the option for you.</li>
				<li><strong class="bold">Cluster</strong>: This is the deployment <a id="_idIndexMarker016"/>shown in <em class="italic">Figure 1.1</em>, where you can have multiple Jira instances (nodes) running in a cluster, and they all serve your users. If you need scalability, high availability, and other cluster-specific features, this is the option for you.</li>
			</ul>
			<p>If you are unsure which option to start with, you can always start with the standalone option and switch to a cluster when you need all the features and benefits from a clustered deployment.</p>
			<p>Now that we know what deployment options are available for Jira, let’s start looking at the hardware and software you will need.</p>
			<h2 id="_idParaDest-20"><a id="_idTextAnchor019"/>Hardware requirements</h2>
			<p>For evaluation <a id="_idIndexMarker017"/>purposes, where there will only be a small number of users, Jira will run happily on any server that has a 1.5 GHz processor and 1 GB to 2 GB of RAM. As your Jira usage grows, a typical server will have a quad-core 2 GHz+ CPU and 4 GB of RAM dedicated to the Jira application, and at least 10 GB of hard disk space for your database.</p>
			<p>For production deployment, as in most applications, it is recommended that you run Jira on its own dedicated server. There are many factors that you should consider when deciding the extent of the resources to allocate to Jira, especially in terms of how Jira will scale and grow in the future. When deciding on your hardware needs, you should consider the following:</p>
			<ul>
				<li>The number of active (concurrent) users in the system, especially during peak hours</li>
				<li>The number of projects, issues, and comments in the system</li>
				<li>The number of configuration items, such as custom fields and workflows</li>
			</ul>
			<p>At times, it can be difficult to estimate these figures. As a reference, a server running with a 2.0 quad-core CPU and 4 GB of RAM will be sufficient for most instances with around 200 active users. If you start to get into thousands of active users, you will need to have at least 8 GB <a id="_idIndexMarker018"/>of RAM allocated to Jira (JVM). Once you have gone beyond a million issues and thousands of active users for a single Jira instance, simply adding raw system resources (vertical scaling) will start to yield diminishing returns. In such cases, it is often better to consider using the Data Center edition of Jira, which offers better scalability by allowing you to have multiple instances clustered together (horizontal scaling), with the added benefit of providing high availability.</p>
			<p>Officially, Jira only supports x86 hardware and 64-bit derivatives of it. When running Jira on a 64-bit system, you will be able to allocate more than 4 GB of memory to Jira, which is the limit if you are using a 32-bit system. If you are planning to deploy a large instance, it is recommended that you use a 64-bit system.</p>
			<h2 id="_idParaDest-21"><a id="_idTextAnchor020"/>Software requirements</h2>
			<p>Jira has three major requirements when it comes to software: it needs a supported operating system, a Java <a id="_idIndexMarker019"/>environment, and a database to store all of its data. In the following sections, we will discuss each of these requirements and the options that you have to install and run Jira.</p>
			<p class="callout-heading">Additional information</p>
			<p class="callout">You can find the <a id="_idIndexMarker020"/>latest information on software requirements online at <a href="https://confluence.atlassian.com/adminjiraserver/supported-platforms-938846830.html">https://confluence.atlassian.com/adminjiraserver/supported-platforms-938846830.html</a>.</p>
			<h3>Operating systems</h3>
			<p>Jira supports most of the major operating systems, so the choice of which operating system to run Jira <a id="_idIndexMarker021"/>on becomes a matter of expertise, comfort, and, in most cases, the existing organization’s infrastructure and requirements.</p>
			<p>The operating systems supported by Atlassian are Windows and Linux. There is a Jira distribution for <a id="_idIndexMarker022"/>macOS, but this is mostly for evaluation purposes only. <strong class="bold">Amazon Web Services</strong> (<strong class="bold">AWS</strong>) and Microsoft Azure are also supported with quick-start templates.</p>
			<p>With both Windows and Linux, Atlassian provides an executable installer wizard package that bundles all the necessary components to simplify the installation process. There are minimal differences when it comes to installing, configuring, and maintaining Jira on different operating systems. If you do not have any preferences and would like to keep initial costs down, CentOS Linux is a good choice.</p>
			<h3>Java platforms</h3>
			<p>Jira is a Java-based <a id="_idIndexMarker023"/>web application, so it needs to have a Java <a id="_idIndexMarker024"/>environment installed. This can be a <strong class="bold">Java Development Kit</strong> (<strong class="bold">JDK</strong>) or a <strong class="bold">Java Runtime Environment</strong> (<strong class="bold">JRE</strong>). The executable installer <a id="_idIndexMarker025"/>that comes with Windows or Linux includes a JRE. However, if you want to use archive distributions, you will need to make sure that you have the required Java environment installed and configured.</p>
			<p>Jira requires a minimum version of Java 8. If you run Jira on an unsupported Java version or from an unsupported vendor, you may run into unexpected errors. The following table shows the supported Java versions for Jira:</p>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><img src="img/1.png" alt="Table 1.1 – Java platforms&#13;&#10;"/></p>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 1.1 – Java platforms</p>
			<p>You should also keep your Java versions up to date by running the latest patched version of either Java 8 <a id="_idIndexMarker026"/>or 11. This will ensure you have the latest bug and security patches to keep your environment secure.</p>
			<h3>Databases</h3>
			<p>Jira stores all its data <a id="_idIndexMarker027"/>in a relational database. While you can run Jira with <strong class="bold">H2 Database</strong>, the in-memory database that comes bundled with Jira, it is prone to data corruption. You should only use this to set up a new instance quickly for evaluation purposes, where no important data will be stored. For this reason, you must use an enterprise-level database such as MySQL for production systems.</p>
			<p>Most relational databases available on the market today are supported by Jira, and there are no differences when you install and configure Jira. Just like operating systems, your choice of database will come down to your organization’s infrastructure/DevOps team’s expertise, experience, and established corporate IT standards. If you run Windows as your operating system, then you probably want to go with Microsoft SQL Server. On the other hand, if you run Linux, then you may want to go with PostgreSQL and MySQL.</p>
			<p>The following table summarizes the databases that are supported by Jira at the time of writing. It is worth mentioning that both MySQL and PostgreSQL are open source products, so they are excellent options if you are looking to minimize your initial cost:</p>
			<div><div><table id="table001-1" class="T---Table">
						<colgroup>
							<col/>
							<col/>
						</colgroup>
						<tbody>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p><strong class="bold">Database</strong></p>
								</td>
								<td class="T---Table T---Body T---Body">
									<p><strong class="bold">Support Status</strong></p>
								</td>
							</tr>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p>MySQL</p>
								</td>
								<td class="T---Table T---Body T---Body">
									<p>MySQL 5.7, 8.0</p>
									<p><em class="italic">Note that both MariaDB and PerconaDB are not supported</em></p>
								</td>
							</tr>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p>PostgreSQL</p>
								</td>
								<td class="T---Table T---Body T---Body">
									<p>PostgreSQL 10, 11, 12</p>
								</td>
							</tr>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p>Microsoft SQL Server</p>
								</td>
								<td class="T---Table T---Body T---Body">
									<p>SQL Server 2016, 2017, 2019</p>
								</td>
							</tr>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p>Oracle</p>
								</td>
								<td class="T---Table T---Body T---Body">
									<p>Oracle 12c R2, 18c, 19c</p>
									<p><em class="italic">This requires the JDBC 19.3 (ojdbc8) driver</em></p>
								</td>
							</tr>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p>Azure SQL</p>
								</td>
								<td class="T---Table T---Body T---Body"/>
							</tr>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p>Amazon Aurora</p>
								</td>
								<td class="T---Table T---Body T---Body">
									<p>PostgreSQL 10, 11, 12</p>
								</td>
							</tr>
							<tr class="T---Table">
								<td class="T---Table T---Body T---Body">
									<p>H2</p>
								</td>
								<td class="T---Table T---Body T---Body">
									<p>This is bundled with the standalone distribution, for evaluation purposes only</p>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 1.2 – Databases</p>
			<p>Take special note of the driver requirement for each database. Jira comes bundled with drivers for several <a id="_idIndexMarker028"/>of the databases, but some, such as Oracle, will require you to get the driver separately. You need to make sure you get the correct version of the driver to avoid any unexpected errors.</p>
			<p>With the system and database requirements covered, it is time to move on to Jira itself.</p>
			<h1 id="_idParaDest-22"><a id="_idTextAnchor021"/>Installation package options</h1>
			<p>Jira Data Center comes with <a id="_idIndexMarker029"/>several deployment options. The first <a id="_idIndexMarker030"/>choice you need to make is where you would like to deploy Jira. If you want to deploy Jira to AWS or Azure, Atlassian provides quick-start templates so that you can get up and running quickly.</p>
			<p>If you want to deploy Jira to your hardware or other cloud vendors, or simply want to manage how you want the deployment to be, you can use the installation packages available. Jira installation packages come in two flavors:</p>
			<ul>
				<li><strong class="bold">Executable installer</strong>: The executable installer provides a wizard-driven interface that will walk <a id="_idIndexMarker031"/>you through the entire installation process. It even comes with a Java installer to save you some time.</li>
				<li><strong class="bold">TAR.GZ or ZIP archive</strong>: The archive package is similar to the executable installer, except it <a id="_idIndexMarker032"/>does not have an installation wizard, does not bundle Java, and will not configure Jira to run as a service.</li>
			</ul>
			<p>You will also need <a id="_idIndexMarker033"/>to perform some post-installation steps <a id="_idIndexMarker034"/>manually, such as configuring Jira as a service. However, you do get the advantage of learning what goes on under the hood.</p>
			<p>In our exercise, we will be using the installer package, but we will also cover the post-installation steps so that you have a good understanding of the various configuration options available. We will start by installing Java.</p>
			<h2 id="_idParaDest-23"><a id="_idTextAnchor022"/>Installing Java</h2>
			<p>Since we will be using the <a id="_idIndexMarker035"/>installer package that’s bundled with Java, you can skip <a id="_idIndexMarker036"/>this section. However, if you are using the archive option, you need to make sure that you have Java installed on your system.</p>
			<p>Jira 8 requires JRE version 8 as a minimum to run. You can verify the version of Java you have by running <a id="_idIndexMarker037"/>the following command in <strong class="bold">Command Prompt</strong>:</p>
			<pre>    java -version</pre>
			<p>The preceding command tells you which version of Java is running on your system, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_1.2_B18644.jpg" alt="Figure 1.2 – Java version&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.2 – Java version</p>
			<p>If you do not see <a id="_idIndexMarker038"/>a similar output, then chances are you do not have Java installed. You <a id="_idIndexMarker039"/>will need to perform the following steps to set up your Java environment. Start by installing Java on your system:</p>
			<ol>
				<li>Download the latest Java 8 or 11 from <a href="https://www.java.com/en/download/manual.jsp">https://www.java.com/en/download/manual.jsp</a>.</li>
			</ol>
			<p class="callout-heading">Note</p>
			<p class="callout">At the time of writing, the latest version of Java 8 is JDK 8 Update 321.</p>
			<ol>
				<li value="2">Double-click on the downloaded installation file to start the installation wizard.</li>
				<li>Select where you would like to install Java. Alternatively, you can simply accept the default values. The location where you install JDK will be referred to as <code>JAVA_HOME</code> for the remainder of this book.</li>
				<li>Create a new environment variable named <code>JAVA_HOME</code> with the value set to the full path of the location where you installed Java. You can do this as follows:<ol><li>Open the <strong class="bold">System Properties</strong> window by going to <strong class="bold">About your PC</strong> from the Windows <strong class="bold">Start</strong> menu.</li><li>Select the <strong class="bold">Advanced system settings</strong> option.</li><li>Click on the <strong class="bold">Environment Variable</strong> button from the new popup:</li></ol></li>
			</ol>
			<div><div><img src="img/Figure_1.3_B18644.jpg" alt="Figure 1.3 – The JAVA_HOME environment variable&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.3 – The JAVA_HOME environment variable</p>
			<ol>
				<li value="4">Add a new variable (either User or System) called <code>JAVA_HOME</code> and set its value to where you installed Java.</li>
			</ol>
			<p>Now that you <a id="_idIndexMarker040"/>have a good understanding of Jira Data Center, the basic system <a id="_idIndexMarker041"/>requirements, and the various installation options, we are ready to deploy our own Jira instances.</p>
			<h1 id="_idParaDest-24"><a id="_idTextAnchor023"/>Installing and configuring Jira</h1>
			<p>We will start by installing Jira as a standalone deployment. We will perform our installation <a id="_idIndexMarker042"/>on a Windows platform and use PostgreSQL for the database. If you are <a id="_idIndexMarker043"/>planning on using a different platform or database, refer to the vendor documentation on installing the required software for your platform.</p>
			<p>In this section, you will do the following:</p>
			<ul>
				<li>Install a fresh instance of Jira Software</li>
				<li>Connect Jira to a PostgreSQL database</li>
				<li>Configure the Jira instance to work in a cluster environment</li>
			</ul>
			<p>We will continue to use this Jira deployment in subsequent chapters and exercises as we build our help desk implementation.</p>
			<p>For our <a id="_idIndexMarker044"/>deployment, we <a id="_idIndexMarker045"/>will use the following:</p>
			<ul>
				<li>Jira Software 8.21.0</li>
				<li>PostgreSQL 12.9</li>
				<li>Apache web server</li>
				<li>Microsoft Windows</li>
			</ul>
			<p>Let’s begin by installing Jira!</p>
			<h2 id="_idParaDest-25"><a id="_idTextAnchor024"/>Installing Jira</h2>
			<p>Before we install Jira, here <a id="_idIndexMarker046"/>are two important directories we need to mention:</p>
			<ul>
				<li><code>JIRA_INSTALL</code>: This is the directory where the Jira application will be installed</li>
				<li><code>JIRA_HOME</code>: This is the directory that Jira will use to store some of its important configuration and data files</li>
			</ul>
			<p>We will be referring to those two directories throughout this book. Now, on to the installation. There are generally two steps involved:</p>
			<ul>
				<li>Downloading and installing the Jira application</li>
				<li>Running through the Jira setup wizard</li>
			</ul>
			<p>Let’s get started.</p>
			<h3>Obtaining and installing Jira</h3>
			<p>The first step is to <a id="_idIndexMarker047"/>download the latest stable release of Jira. You can download Atlassian Jira from <a href="https://www.atlassian.com/software/jira/update">https://www.atlassian.com/software/jira/update</a>.</p>
			<p>The Atlassian website will <a id="_idIndexMarker048"/>detect the operating system you are using and automatically <a id="_idIndexMarker049"/>suggest an installation package for you to download. If you intend to install Jira on a different operating system from the one you are currently on, make sure that you select the correct operating system package.</p>
			<p>As we mentioned earlier, with Windows, there is a Windows installer package and a self-extracting archive package. For this exercise, we will use the installer package (<code>Windows 64-bit Installer</code>):</p>
			<ol>
				<li value="1">Double-click on the downloaded installation file to start the installation wizard and click on the <strong class="bold">Next</strong> button to continue:</li>
			</ol>
			<div><div><img src="img/Figure_1.4_B18644.jpg" alt="Figure 1.4 – Jira installation step 1&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.4 – Jira installation step 1</p>
			<ol>
				<li value="2">Select the <strong class="bold">Custom Install (recommended for advanced users)</strong> option and click on <a id="_idIndexMarker050"/>the <strong class="bold">Next</strong> button to continue. Using the custom installation will let <a id="_idIndexMarker051"/>us decide where to install Jira and will also provide numerous configuration options, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_1.5_B18644.jpg" alt="Figure 1.5 – Jira installation step 2&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.5 – Jira installation step 2</p>
			<ol>
				<li value="3">Select the <a id="_idIndexMarker052"/>directory where Jira will be installed. This will become <a id="_idIndexMarker053"/>the <code>JIRA_INSTALL</code> directory. Click on the <strong class="bold">Next</strong> button to continue:</li>
			</ol>
			<div><div><img src="img/Figure_1.6_B18644.jpg" alt="Figure 1.6 – Jira installation step 3&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.6 – Jira installation step 3</p>
			<ol>
				<li value="4">Select where <a id="_idIndexMarker054"/>Jira will store its data files, such as attachments and <a id="_idIndexMarker055"/>log files. This will become the <code>JIRA_HOME</code> directory. Click on the <strong class="bold">Next</strong> button to continue:</li>
			</ol>
			<div><div><img src="img/Figure_1.7_B18644.jpg" alt="Figure 1.7 – Jira installation step 4&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.7 – Jira installation step 4</p>
			<ol>
				<li value="5">Select where you would like to create shortcuts to the Start menu and click on the <strong class="bold">Next</strong> button to continue.</li>
				<li>In the <code>8080</code>. If <code>8080</code> has <a id="_idIndexMarker057"/>already been taken by another application, or if you want Jira to run on a different port such as port <code>80</code>, select the <strong class="bold">Set custom value for HTTP and Control ports</strong> option and specify the port numbers you want to use. Click on the <strong class="bold">Next</strong> button to continue:</li>
			</ol>
			<div><div><img src="img/Figure_1.8_B18644.jpg" alt="Figure 1.8 – Jira installation step 6&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.8 – Jira installation step 6</p>
			<ol>
				<li value="7">Select whether <a id="_idIndexMarker058"/>you would like Jira to run as a service. If you enable this <a id="_idIndexMarker059"/>option, Jira will be installed as a system service and can be configured to start automatically with the server; refer to the <em class="italic">Starting and stopping Jira</em> section for more details:</li>
			</ol>
			<div><div><img src="img/Figure_1.9_B18644.jpg" alt="Figure 1.9 – Jira installation step 7&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.9 – Jira installation step 7</p>
			<ol>
				<li value="8">For the final step, review <a id="_idIndexMarker060"/>all the installation options and click on the <strong class="bold">Install</strong> button <a id="_idIndexMarker061"/>to start the installation:</li>
			</ol>
			<div><div><img src="img/Figure_1.10_B18644.jpg" alt="Figure 1.10 – Jira installation step 8&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.10 – Jira installation step 8</p>
			<ol>
				<li value="9">Once the installation is complete, check the <strong class="bold">Launch Jira Software in browser</strong> option <a id="_idIndexMarker062"/>and click on <strong class="bold">Finish</strong>. This will close the installation wizard <a id="_idIndexMarker063"/>and open your web browser so that you can access Jira. This may take a few minutes to load as Jira starts up for the first time:</li>
			</ol>
			<div><div><img src="img/Figure_1.11_B18644.jpg" alt="Figure 1.11 – Jira installation step 9&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.11 – Jira installation step 9</p>
			<p>That’s it! Congratulations, your Jira is <a id="_idIndexMarker064"/>installed and running. Now, let’s learn <a id="_idIndexMarker065"/>how to configure it.</p>
			<h3>The Jira setup wizard</h3>
			<p>If you chose the <code>http://localhost:&lt;port number&gt;</code> in your browser, where <code>&lt;port number&gt;</code> is the number you assigned to Jira in <em class="italic">Step 6</em> of the installation process.</p>
			<p>The easy-to-use setup wizard that comes with Jira will walk you through the process of completing your Jira setup. Here, you will be able to configure the database connections, default language, and much more.</p>
			<p>The steps for this are as follows:</p>
			<ol>
				<li value="1">In the first step of the wizard, we need to select how we want Jira to be set up. Since we are installing Jira for production use, we will select the <strong class="bold">I’ll set it up myself</strong> option, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/Figure_1.12_B18644.jpg" alt="Figure 1.12 – Jira configuration step 1&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.12 – Jira configuration step 1</p>
			<ol>
				<li value="2">For the second step, we will need to select the database we want to use. This is where we configure Jira to use PostgreSQL as its database. If you select the <strong class="bold">Built In</strong> option, Jira <a id="_idIndexMarker067"/>will use its bundled in-memory H2 database, which is good for evaluation purposes. If you want to use a proper database, such as in our case, you should select the <strong class="bold">My Own Database</strong> option:</li>
			</ol>
			<div><div><img src="img/Figure_1.13_B18644.jpg" alt="Figure 1.13 – Jira configuration step 2&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.13 – Jira configuration step 2</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The <strong class="bold">Built In</strong> option is great for getting Jira up and running quickly for evaluation purposes.</p>
			<p>After you have selected the <strong class="bold">My Own Database</strong> option, the wizard will expand for you to provide the database connection details. If you do not have the necessary database driver installed, Jira will prompt you for it.</p>
			<p>Once you have filled in the details for your database, it’s a good idea to click on the <strong class="bold">Test Connection</strong> button to verify that Jira can connect to the database. If everything has been set up correctly, Jira will report a success message. You should be able to <a id="_idIndexMarker068"/>move on to the next step by clicking on the <strong class="bold">Next</strong> button. This may take a few minutes as Jira will now create all the necessary database objects. Once this is done, you will be taken to the next step of the wizard.</p>
			<ol>
				<li value="3">In the third step, you will need to provide some basic details about this Jira instance. Once you have filled in the requisite fields, click on <strong class="bold">Next</strong> to move on to the next step of the wizard:</li>
			</ol>
			<div><div><img src="img/Figure_1.14_B18644.jpg" alt="Figure 1.14 – Jira configuration step 3&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.14 – Jira configuration step 3</p>
			<ol>
				<li value="4">In this step, we need to provide a license key for Jira. If you have already obtained a license from Atlassian, you can paste it into the <strong class="bold">Your License Key</strong> textbox. If you do not have a license, you can generate an evaluation license by clicking on the <strong class="bold">generate a Jira trial license</strong> link. The evaluation license will grant you access <a id="_idIndexMarker069"/>to Jira’s full set of features for 1 month. After the evaluation period ends, you will lose the ability to create new issues, but you can still access your data:</li>
			</ol>
			<div><div><img src="img/Figure_1.15_B18644.jpg" alt="Figure 1.15 – Jira configuration step 4&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.15 – Jira configuration step 4</p>
			<ol>
				<li value="5">Now, you must set up the administrator account for Jira. It is important that you keep the account details somewhere safe and do not lose the password. Since Jira only stores the hashed value of the password instead of the actual password itself, you will not be able to retrieve it. Fill in the administrator account details and click on <strong class="bold">Next</strong>:</li>
			</ol>
			<div><div><img src="img/Figure_1.16_B18644.jpg" alt="Figure 1.16 – Jira configuration step 5&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.16 – Jira configuration step 5</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">This account is important, and it can help you troubleshoot and fix problems later on. Do not lose it!</p>
			<ol>
				<li value="6">Next, you must set up your email server details. Jira will use the information configured here <a id="_idIndexMarker070"/>to send out notification emails. Notifications are a very powerful feature in Jira and one of the primary ways Jira communicates with users. If you do not have your email server information handy, you can skip this step for now by selecting the <strong class="bold">Later</strong> option and clicking on <strong class="bold">Finish</strong>. You can configure your email server settings later, as you will see in <a href="B18644_08.xhtml#_idTextAnchor220"><em class="italic">Chapter 8</em></a>, <em class="italic">Emails and Notifications</em>:</li>
			</ol>
			<div><div><img src="img/Figure_1.17_B18644.jpg" alt="Figure 1.17 – Jira configuration step 6&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.17 – Jira configuration step 6</p>
			<p>Congratulations! You have completed your Jira setup. You should now see the welcome page, and be automatically logged in as the administrator user you created in <em class="italic">Step 5</em>. On the welcome page, you will need to set up a few user preferences, such as the default language <a id="_idIndexMarker071"/>and profile picture. Follow the onscreen prompts to set up the account. Once you are done, you should be presented with the options to create a sample project, a new project from scratch, or import project data from other sources, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_1.18_B18644.jpg" alt="Figure 1.18 – Jira welcome page&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.18 – Jira welcome page</p>
			<p>With that, Jira is fully configured. We will cover the various features and things you can do with it later in this book, but for now, we will look at some additional management and configuration options for Jira, starting with how to start and stop Jira as a service.</p>
			<h3>Starting and stopping Jira</h3>
			<p>Since we used Windows <a id="_idIndexMarker072"/>Installer, Jira is installed as a Windows service. Therefore, you <a id="_idIndexMarker073"/>can start, stop, and restart it via the Windows <strong class="bold">Services</strong> console. In the <strong class="bold">Services</strong> console, look for <strong class="bold">Atlassian Jira</strong>. Here, you will be able to stop and start the application, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_1.19_B18644.jpg" alt="Figure 1.19 – Windows Services&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.19 – Windows Services</p>
			<p>If you installed Jira using the archive options, you can start and stop Jira using the scripts provided in <a id="_idIndexMarker074"/>the <code>JIRA_INSTALL\bin</code> directory, which are <code>start-jira.sh</code> and <code>stop-jira.sh</code> for Linux, and <code>start-jira.bat</code> and <code>stop-jira.bat</code> for <a id="_idIndexMarker075"/>Windows.</p>
			<p>Now that we know how to start and stop Jira, let’s look at some of the additional configurations, such as <strong class="bold">allocating memory</strong>.</p>
			<h1 id="_idParaDest-26"><a id="_idTextAnchor025"/>Post-installation configuration</h1>
			<p>The post-installation configuration steps are optional, depending on your needs and environment. If you set up Jira for evaluation purposes, you probably do not need to perform any of the following steps, but it is always good practice to be familiar with these as a reference.</p>
			<p>You will need to restart Jira after making the changes that will be discussed in the next section.</p>
			<h2 id="_idParaDest-27"><a id="_idTextAnchor026"/>Increasing Jira’s memory</h2>
			<p>The default memory setting for Jira is usually sufficient for a small to medium-sized deployment. As Jira’s <a id="_idIndexMarker076"/>adoption rate <a id="_idIndexMarker077"/>increases, you will find that the amount of memory allocated by default is no longer enough. If Jira is running as a Windows service, as we described in this chapter, you can increase the memory as follows:</p>
			<ol>
				<li value="1">Find the service name for Jira. You can do this by going to the Windows <code>JIRA150215215627</code>.</li>
				<li>Open a new Command Prompt and change the current working directory to the <code>JIRA_INSTALL\bin</code> directory.</li>
				<li>Run the following command by substituting the actual service name for Jira:<pre><strong class="bold">        tomcat8w //ES//&lt;JIRA Windows service name&gt;</strong></pre></li>
				<li>Select the <strong class="bold">Java</strong> tab, update the <strong class="bold">Initial memory pool</strong> and <strong class="bold">Maximum memory pool</strong> sizes, and click on <strong class="bold">OK</strong>:</li>
			</ol>
			<div><div><img src="img/Figure_1.20_B18644.jpg" alt="Figure 1.20 – Jira memory settings&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.20 – Jira memory settings</p>
			<ol>
				<li value="5">Restart Jira to apply the change.</li>
			</ol>
			<p>If you are not <a id="_idIndexMarker078"/>running Jira as a Windows service, you <a id="_idIndexMarker079"/>need to open the <code>setenv.bat</code> file (for Windows) or the <code>setenv.sh</code> file (for Linux) in the <code>JIRA_INSTALL\bin</code> directory. Then, locate the following lines:</p>
			<pre class="source-code">
set JVM_MINIMUM_MEMORY="384m"
set JVM_MAXIMUM_MEMORY="768m"</pre>
			<p>Change the value for the two parameters and restart Jira. Normally, 4 GB (4,096 MB) of memory is enough to support a fairly large instance of Jira used by hundreds of users.</p>
			<p>The initial memory pool or <code>JVM_MINIMUM_MEMORY</code> parameter determines the amount of memory Jira will start with. Usually, the smaller the amount, the faster Jira will start up. The maximum memory pool or <code>JVM_MAXIMUM_MEMORY</code> parameter determines the <a id="_idIndexMarker080"/>maximum amount <a id="_idIndexMarker081"/>of memory Jira can use. If the two values are not the same, Jira will start up with the minimum amount of memory and grow to the maximum as more and more users start to use Jira.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Make sure that you have sufficient physical RAM available before allocating instances to Jira.</p>
			<h2 id="_idParaDest-28"><a id="_idTextAnchor027"/>Changing Jira’s port number and context path</h2>
			<p>As part of the installation process, the installation wizard prompted us to decide which port Jira should <a id="_idIndexMarker082"/>listen to for incoming <a id="_idIndexMarker083"/>connections. If you accepted the default value, then this will be port <code>8080</code>. If you change <a id="_idIndexMarker084"/>your mind and want to change this setting later, you can do <a id="_idIndexMarker085"/>so by locating and opening the <code>server.xml</code> file in a text editor in the <code>JIRA_INSTALL/conf</code> directory. Let’s examine the relevant contents of this file:</p>
			<pre class="source-code">
&lt;Server port="8005" shutdown="SHUTDOWN"&gt;</pre>
			<p>This preceding line specifies the port for the command to shut down Jira. By default, it is port <code>8005</code>. If you already have an application that is running on that port (for example, another instance of Jira), you need to change this to a different port. The following line specifies which port Jira will be running on:</p>
			<pre class="source-code">
&lt;Connector port="8080" protocol="HTTP/1.1"&gt;</pre>
			<p>By default, Jira will be running on port <code>8080</code>. If you already have an application that is running on that port, or if the port is unavailable for some reason, you need to change it to another available port. The following line allows you to specify the context that Jira will be running under:</p>
			<pre class="source-code">
&lt;Context path="/jira" docBase="${catalina.home}/atlassian-jira" reloadable="false" useHttpOnly="true"&gt;</pre>
			<p>By default, the <a id="_idIndexMarker086"/>value is empty, which <a id="_idIndexMarker087"/>means Jira <a id="_idIndexMarker088"/>will be accessible from <code>http://hostname:portnumber</code>. If you <a id="_idIndexMarker089"/>decide to specify a context, the URL will be <code>http://hostname:portnumber/context</code>. In our example, Jira will be accessible from <code>http://localhost:8080/jira</code>.</p>
			<h2 id="_idParaDest-29"><a id="_idTextAnchor028"/>Configuring HTTPS</h2>
			<p>By default, Jira runs <a id="_idIndexMarker090"/>with a standard, non-encrypted HTTP protocol. This is acceptable if you are running Jira in a secured environment, such <a id="_idIndexMarker091"/>as an internal network. However, if you plan to open up access to Jira over the internet, you will need to tighten up security by encrypting sensitive data, such as usernames and passwords that are being sent, by enabling HTTPS (HTTP over SSL).</p>
			<p>For a standalone installation, you will need to do the following, in order:</p>
			<ol>
				<li value="1">Obtain and install a certificate</li>
				<li>Enable HTTPS on your application server (Tomcat)</li>
				<li>Redirect traffic to HTTPS</li>
			</ol>
			<p>First, you need to get a digital certificate. This can be obtained from a certification authority, such as <em class="italic">VeriSign</em> (CA certificate), or a self-signed certificate that’s been generated by you. A CA certificate will not only encrypt data for you but also identify your copy of Jira to the users. A self-signed certificate is useful when you do not have a valid CA certificate and you are only interested in setting up HTTPS for encryption. Since a self-signed certificate is not signed by a certification authority, it is unable to identify your site to the public and users will be prompted with a warning that the site is untrusted when they first visit it. However, for evaluation purposes, a self-signed certificate will suffice until you can get a proper CA certificate.</p>
			<p>For this exercise, we will create a self-signed certificate to illustrate the complete process. If you have a CA certificate, you can skip the following steps:</p>
			<ol>
				<li value="1">Java comes with a handy tool for certificate management, called <code>keytool</code>, which can be found in the <code>JIRA_INSTALL\jre\bin</code> directory if you are using the installer package. If you are using your own Java installation, then you can find it in <code>JAVA_INSTALL\bin</code>.</li>
				<li>To generate a self-signed certificate, run the following commands from Command Prompt:<pre><strong class="bold">keytool -genkey -alias tomcat -keyalg RSA</strong>
<strong class="bold">keytool -export -alias tomcat -file file.cer</strong></pre></li>
				<li>This will create a KeyStore (if one does not already exist) and export the self-signed certificate (<code>file.cer</code>). When you run the first command, you will be asked to set <a id="_idIndexMarker092"/>the password for the <a id="_idIndexMarker093"/>KeyStore and Tomcat. You need to use the same password for both. The default password is <code>changeit</code>. You can specify a different password of your choice, but then you have to let Jira/Tomcat know, as we will see later.</li>
			</ol>
			<p>Now that you have your certificate ready, you need to import it into your trust store for Tomcat to use. Again, you will use the <code>keytool</code> application in Java:</p>
			<pre>keytool -import -alias tomcat -file file.cer
JIRA_INSTALL\jre\lib\security\cacerts</pre>
			<p>This will import the certificate into your trust store, which can be used by JIRA/Tomcat to set up HTTPS.</p>
			<p>To enable HTTPS on Tomcat, open the <code>server.xml</code> file in a text editor from the <code>JIRA_INSTALL/conf</code> directory. Locate the following configuration snippet:</p>
			<pre class="source-code">
&lt;Connector port="8443" maxHttpHeaderSize="8192" SSLEnabled="true"
maxThreads="150" minSpareThreads="25" maxSpareThreads="75"
enableLookups="false" disableUploadTimeout="true"
acceptCount="100" scheme="https" secure="true"
clientAuth="false" sslProtocol="TLS"     useBodyEncodingForURI="true"/&gt;</pre>
			<p>This enables HTTPS for Jira on port <code>8443</code>. If you have selected a different password for your KeyStore, you will have to add the following line to the end of the preceding snippet before the closing tag:</p>
			<pre class="source-code">
keystorePass="&lt;password value&gt;"</pre>
			<p>The last step is to set up Jira so that it automatically redirects from a non-HTTP request to an HTTPS request. Find and open the <code>web.xml</code> file in the <code>JIRA_INSTALL/atlassian-jira/WEB-INF</code> directory. Then, add the following snippet to the end of the file before the closing <code>&lt;/web-app&gt;</code> tag:</p>
			<pre class="source-code">
&lt;security-constraint&gt; &lt;web-resource-collection&gt; &lt;web-resource-name&gt;all-except-attachments&lt;/web-resource-name&gt; &lt;url-pattern&gt;*.js&lt;/url-pattern&gt; &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;
    &lt;url-pattern&gt;*.jspa&lt;/url-pattern&gt;
    &lt;url-pattern&gt;*.css&lt;/url-pattern&gt;
    &lt;url-pattern&gt;/browse/*&lt;/url-pattern&gt;
  &lt;/web-resource-collection&gt;
  &lt;user-data-constraint&gt;
    &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;
  &lt;/user-data-constraint&gt;
&lt;/security-constraint&gt;</pre>
			<p>Now, when <a id="_idIndexMarker094"/>you access Jira with a <a id="_idIndexMarker095"/>normal HTTP URL, such as <code>http://localhost:8080/jira</code>, you will be automatically redirected to its HTTPS equivalent – that is, <code>https://localhost:8443/jira</code>.</p>
			<h1 id="_idParaDest-30"><a id="_idTextAnchor029"/>Clustering</h1>
			<p>So far, our Jira instance is <a id="_idIndexMarker096"/>running in standalone mode, which means it is serving all the requests by itself and is not yet cluster-enabled. Some of the main benefits of running Jira in a cluster are as follows:</p>
			<ul>
				<li><strong class="bold">Improved performance at scale</strong>: By running a cluster with multiple nodes, Jira’s ability to serve concurrent user requests is greatly improved, leading to better response time and overall user satisfaction.</li>
				<li><strong class="bold">High availability and failover</strong>: With multiple nodes running in a cluster, if any individual node becomes unavailable for any reason, other nodes within the cluster can continue to serve your users, thus avoiding downtime.</li>
				<li><strong class="bold">Zero-downtime upgrade</strong>: Usually, when you need to upgrade Jira, there will be downtime involved in the process. When running a Jira cluster, you can upgrade each node individually at a time so that other nodes in the cluster can continue to serve your users.</li>
			</ul>
			<p>To configure Jira to run in a cluster, you must do the following:</p>
			<ol>
				<li value="1">Create a shared file home directory for both nodes to access.</li>
				<li>Add cluster configuration to our current Jira instance.</li>
				<li>Add another Jira instance to be the second node in our cluster. Technically, you can have a single <a id="_idIndexMarker097"/>node cluster, but for this exercise, we will add another node to the cluster so that you can see the cluster in action.</li>
				<li>Add and configure a load balancer to distribute incoming traffic to both nodes.</li>
			</ol>
			<p>Now that we know what we need to run Jira in a cluster, let’s start preparing!</p>
			<h2 id="_idParaDest-31"><a id="_idTextAnchor030"/>Preparing for clustering</h2>
			<p>The first step in <a id="_idIndexMarker098"/>enabling clustering is to prepare the hardware required. For a Jira cluster, you will have the following components:</p>
			<ul>
				<li><strong class="bold">Load balancer</strong>: This can be any load balancer that supports session affinity (sticky sessions), such as Apache and nginx.</li>
				<li><strong class="bold">Jira instance node</strong>: This will contain separate Jira instances that will be part of the cluster.</li>
				<li><strong class="bold">Database</strong>: This is the same database you are using for your standalone deployment. Note that since all Jira nodes will be sharing the same database, the in-memory H2 database will not work in a cluster.</li>
				<li><strong class="bold">Shared file drive</strong>: The Jira cluster needs to have a shared home directory that all Jira nodes can read and write to.</li>
			</ul>
			<p>Ideally, each component listed previously should be running on its own server, so for a two-node cluster, you <a id="_idIndexMarker099"/>will need a minimum of three servers and a shared network drive. You can run multiple Jira nodes on the same server, but you should only do this for evaluation purposes, as it diminishes the benefits of having a cluster.</p>
			<p>When preparing servers for the Jira nodes, you need to ensure the following:</p>
			<ul>
				<li>All node servers are located in the same data center or region (for cloud vendors such as AWS and Azure)</li>
				<li>You have the same software and hardware specifications, including memory, operating system, and Java version</li>
				<li>All nodes are running the same version of Jira</li>
				<li>The nodes have been configured to be in the same timezone</li>
			</ul>
			<h2 id="_idParaDest-32"><a id="_idTextAnchor031"/>Creating JIRA_SHARED_HOME</h2>
			<p>The first step is to create a new directory where the cluster can store its data files. We will refer to this <a id="_idIndexMarker100"/>directory as <code>JIRA_SHARED_HOME</code>. This can be a network drive that allows all Jira nodes to read from and write to. Copy over the following directories from your standalone Jira instance’s <code>JIRA_HOME</code> directory to the new shared directory:</p>
			<ul>
				<li><code>data</code></li>
				<li><code>plugins</code></li>
				<li><code>logos</code></li>
				<li><code>import</code></li>
				<li><code>export</code></li>
				<li><code>caches</code></li>
			</ul>
			<h2 id="_idParaDest-33"><a id="_idTextAnchor032"/>Enabling clustering</h2>
			<p>The second step is to enable clustering <a id="_idIndexMarker101"/>for your first Jira node. This is done by adding a new <code>cluster.properties</code> file to its local <code>JIRA_HOME</code> directory.</p>
			<ol>
				<li value="1">Shut down your Jira standalone instance.</li>
				<li>Create a new file called <code>cluster.properties</code>.</li>
				<li>Add the following lines to the files:<pre># This ID must be unique across the cluster
jira.node.id = node1
# The location of the shared home directory for all Jira nodes
jira.shared.home = /location/to/the/shared/jira_cluster_home
# The following lines are needed if you want to run multiple nodes on the same server
ehcache.listener.hostName=localhost
ehcache.listener.port=40001
ehcache.object.port = 40021</pre></li>
				<li>Start Jira.</li>
			</ol>
			<h2 id="_idParaDest-34"><a id="_idTextAnchor033"/>Adding a node to the load balancer</h2>
			<p>With the first cluster node <a id="_idIndexMarker102"/>up and running, we can add another node. We <a id="_idIndexMarker103"/>need to add this node to the load balancer so that it can start routing traffic to it. The exact configuration will differ, depending on what you use for the load balancer. The following is an example using Apache:</p>
			<pre class="source-code">
&lt;Proxy balancer://jiracluster&gt;
  # Jira node 1
  BalancerMember http://jira1.internal.atlassian.com:8080 route=node1
  # Jira node 2, add this when we have the 2nd node up and running
  # BalancerMember http://jira2.internal.atlassian.com:8080 route=node2
  # Load Balancer Settings
  ProxySet lbmethod=byrequests
  ProxySet stickysession=JSESSIONID
&lt;/Proxy&gt;</pre>
			<p>Note that for <a id="_idIndexMarker104"/>Apache, you will <a id="_idIndexMarker105"/>need to enable the <code>proxy_balancer_module</code> module.</p>
			<h2 id="_idParaDest-35"><a id="_idTextAnchor034"/>Adding new nodes to the cluster</h2>
			<p>To add a <a id="_idIndexMarker106"/>new node <a id="_idIndexMarker107"/>to the cluster, follow these steps:</p>
			<ol>
				<li value="1">Copy over the <code>JIRA_HOME</code> directory from our existing Jira instance to the new node server.</li>
				<li>Install a new Jira instance on the new server.</li>
				<li>Edit the <code>cluster.properties</code> files and change the <code>jira.node.id</code> value.</li>
				<li>Add the new node to the load balancer.</li>
				<li>Start the new Jira node.</li>
			</ol>
			<p>If you are running the second node on the same server, you will also need to change the port numbers for <code>ehcache.listener.port</code> and <code>ehcache.object.port</code> in the <code>cluster.properties</code> file, and the port numbers in the <code>server.xml</code> file, as mentioned in the <em class="italic">Changing Jira’s port number and context path</em> section.</p>
			<p>And with this, you should have a two-node Jira cluster up and running. Now, if you log into Jira and go to <strong class="bold">Administration</strong> | <strong class="bold">System</strong> | <strong class="bold">Clustering</strong>, you should see both nodes listed, with the node currently serving you highlighted in bold, as shown here:</p>
			<div><div><img src="img/Figure_1.21_B18644.jpg" alt="Figure 1.21 – Cluster nodes in Jira&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.21 – Cluster nodes in Jira</p>
			<p>On this page, you <a id="_idIndexMarker108"/>can see all the nodes in your cluster and their status. This is <a id="_idIndexMarker109"/>very useful to help you troubleshoot your cluster if a node becomes unresponsive or is under heavy load.</p>
			<h1 id="_idParaDest-36"><a id="_idTextAnchor035"/>Zero-downtime upgrade</h1>
			<p>As mentioned earlier, when <a id="_idIndexMarker110"/>you are running Jira in a cluster, you can perform a <strong class="bold">zero-downtime upgrade</strong>, also known as a <strong class="bold">rolling upgrade</strong>. With a zero-downtime upgrade, you can upgrade each node in the cluster one at a time. When <a id="_idIndexMarker111"/>a node is being upgraded, other nodes in the cluster will continue serving your users, so they will not experience any downtime.</p>
			<p>Performing a rolling upgrade <a id="_idIndexMarker112"/>consists of the following steps:</p>
			<ol>
				<li value="1">Put Jira into <strong class="bold">Upgrade</strong> mode. This will allow the Jira cluster to have nodes with different versions running at the same time.</li>
				<li>Upgrade each node in the cluster one at a time.</li>
				<li>Finalize the upgrade once all the nodes have been upgraded.</li>
			</ol>
			<p>We will start by putting Jira into <strong class="bold">Upgrade</strong> mode:</p>
			<ol>
				<li value="1">Log into Jira as an administrator.</li>
				<li>Browse to <strong class="bold">Administration</strong> | <strong class="bold">Applications</strong> | <strong class="bold">Jira upgrades</strong>.</li>
				<li>Click <strong class="bold">Put Jira into upgrade mode</strong>:</li>
			</ol>
			<div><div><img src="img/Figure_1.22_B18644.jpg" alt="Figure 1.22 – Zero-downtime upgrade&#13;&#10;"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.22 – Zero-downtime upgrade</p>
			<p>Once Jira has been put into <strong class="bold">Upgrade</strong> mode, you can shut down a node in the cluster and upgrade it. After a <a id="_idIndexMarker113"/>node has been upgraded, you can restart it and repeat this process for other nodes in the cluster.</p>
			<p>After you have upgraded all the nodes in the cluster, you need to finalize the upgrade by doing the following:</p>
			<ol>
				<li value="1">Browsing to <strong class="bold">Administration</strong> | <strong class="bold">Applications</strong> | <strong class="bold">Jira upgrades</strong>.</li>
				<li>Clicking <strong class="bold">Finalize upgrade</strong>.</li>
			</ol>
			<p>Once you have clicked on <strong class="bold">Finalize</strong> <strong class="bold">Upgrade</strong>, this will complete the upgrade process for your cluster. By doing a rolling upgrade like this, you can upgrade your entire cluster without disrupting your users with downtime.</p>
			<h1 id="_idParaDest-37"><a id="_idTextAnchor036"/>Summary</h1>
			<p>Jira is a powerful, yet simple, application, as reflected in its straightforward installation procedures. You have a wide variety of options available so that you can choose how you would like to install and configure your copy. You can mix and match different aspects, such as operating systems and databases, to best suit your requirements. You can run a standalone deployment to get started, and later turn it into a cluster as the adoption of Jira grows in your organization.</p>
			<p>In the next chapter, we will start to explore various aspects of Jira, starting with projects, and how you can use Jira to manage them for business teams.</p>
		</div>
	</body></html>