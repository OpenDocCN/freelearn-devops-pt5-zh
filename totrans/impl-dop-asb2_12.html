<html><head></head><body>
        

                            
                    <h1 class="header-title">Ansible Galaxy</h1>
                
            
            
                
<p>At this point in the book, we should have a pretty solid grasp of DevOps and Ansible and how to effectively implement DevOps patterns and organizational strategies using Ansible 2. From here, we will take a look at community resources provided by Ansible (Ansible Galaxy) and discover how to tap into a wealth of open source community-provided Ansible roles and playbook's.</p>
<p>Ansible's implementation has managed to standardize itself over the years and has become one of the leading DevOps Configuration Management, automation, and delivery solutions in the market. Ansible's success is primarily due to the modularity that is inherent in Ansible, its extensibility, Ansible Tower, and its community-supported Ansible Galaxy solution.</p>
<p>For those unaware of Ansible Galaxy, it is a robust and highly adaptable solution by which community members and playbook developers can create and share Ansible roles. This community-developed sharing solution provides a wealth of automation solutions for the community to partake in.</p>
<p>In this final chapter, we are going to take a look at Ansible's flagship playbook and role distribution solution: The Ansible Galaxy. We are going to explore how to leverage this innovative implementation to retrieve and submit role developments. We are going to explore how this solution works and learn how to make the best use of it.</p>
<p>The topics we are going to explore specifically include the following:</p>
<ul>
<li class="mce-root">Ansible Galaxy Fundamentals</li>
<li class="mce-root">Understanding the command-line options available within Ansible Galaxy</li>
<li>Understanding how to install roles onto your system using Ansible Galaxy</li>
<li class="mce-root">Describing how to create and share with Ansible Galaxy</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Ansible Galaxy Fundamentals</h1>
                
            
            
                
<p>In this section, we are going to take a look at the Ansible Galaxy. We are going to explore what Ansible Galaxy is and how it works. To begin, let's define what Ansible Galaxy is. Ansible Galaxy is a website supported by a command-line interface, which provides an area for <em>role</em> and <em>playbook</em> developers to share and consume their creations. Each entry point into Ansible Galaxy is available independently and allows the community to leverage it as they see fit.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The Ansible Galaxy website</h1>
                
            
            
                
<p>The Ansible Galaxy website is an Ansible-owned and community-supported role and playbook sharing solution. The Ansible Galaxy website hosts thousands of community-created roles and playbooks. The developers of these roles have created them in order to allow others to benefit from their efforts and leverage them to perform automated deployment and configuration management tasks.</p>
<p>At this point, it's a good idea to take a look at the Ansible Galaxy website. The Ansible Galaxy website and community is located at <a href="https://galaxy.ansible.com/">https://galaxy.ansible.com/</a>.</p>
<p>The Ansible Galaxy website should look something like what is shown in the following screenshot:</p>
<p><img class="image-border" src="img/9489a93b-f15e-4921-81b4-d98f23a572d8.png"/></p>
<p>As we can see, the Ansible Galaxy website is broken down into a few distinct menu options. These subsections (highlighted at the top of the site) are as follows:</p>
<ul>
<li>ABOUT</li>
<li>EXPLORE</li>
<li>BROWSE ROLES</li>
<li>BROWSE AUTHORS</li>
</ul>
<p>Let's take a minute to briefly describe each of these sections and their role in the Ansible Galaxy universe:</p>
<ul>
<li>ABOUT: This section of the site provides some critical information related to Ansible Galaxy. This includes some basic tutorials on how to download roles one by one, how to download multiple roles at a time, advanced download options, how to create and share roles, best practices, automated testing techniques, and where to go if you have any questions.</li>
<li>EXPLORE: The explore section provides us with a set of tagged criteria we can browse roles with. These tagged criteria allow us to look at roles available within Ansible Galaxy via the author name, most downloaded, most watched, and more.</li>
<li>BROWSE ROLES: Browse roles are exactly what it sounds like; a role browser and search utility. This is probably the most used section of the website as it allows us to find and grab Ansible roles.</li>
<li>BROWSE AUTHORS: Browse authors are a way for us to search through Ansible Galaxy and find roles created by specific people. This can be especially handy when searching for roles created by someone you know or a popular author.</li>
</ul>
<p>In addition to the Ansible Galaxy main website, you can refer to the <a href="https://www.ansible.com/">https://www.ansible.com/</a> official documentation as well in relation to Ansible Galaxy help. The link for this documentation is <a href="http://docs.ansible.com/ansible/galaxy.html">http://docs.ansible.com/ansible/galaxy.html</a>.<a href="http://docs.ansible.com/ansible/galaxy.html"/></p>
<p>In addition to connecting to the central Ansible Galaxy website, you can can also run your own dedicated and private Ansible Galaxy server. This is because just like Ansible, Ansible Galaxy is also open source. More information on setting up a personal Ansible Galaxy server can be found at <a href="https://github.com/ansible/galaxy">https://github.com/ansible/galaxy</a>.<a href="https://github.com/ansible/galaxy"/></p>
<p>As you explore the Ansible Galaxy website, there are some important things to make note of when searching and using Ansible roles within a given system. These include the following:</p>
<ul>
<li>The role name</li>
<li>Compatible platforms</li>
<li>The installation command</li>
</ul>
<p>Ansible Galaxy website is kind enough to provide us with the command-line solution for each given role. For example, the following screenshot provides a glimpse of how the Ansible Galaxy website outlines the role information for MySQL:</p>
<div><img height="215" width="289" class="image-border" src="img/72d0d1a7-0336-4dd2-b5c8-0a8849f739cb.png"/></div>
<p>And once you click on the preferred role (in our case, it's mysql), we should see something like what is shown in the following screenshot:</p>
<div><img height="500" width="870" class="image-border" src="img/41e779a7-a61b-462b-8247-271f675dc445.png"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">The Ansible Galaxy command-line interface</h1>
                
            
            
                
<p>The Ansible Galaxy command-line interface is provided to users so they can automate the procurement of Ansible roles from the Ansible Galaxy website. This is a highly useful command-line tool, and we will be using it for the remainder of this chapter. To begin, we will want to verify that the Ansible Galaxy command-line tool is installed and functioning properly. Let's try the following command:</p>
<pre>
<strong>#&gt; ansible-galaxy --help</strong>
</pre>
<p>The output of this command should be something like the following:</p>
<div><img height="294" width="714" class="image-border" src="img/b14555cd-c0e0-4d4b-ae3d-a71683e06d64.png"/></div>
<p>Now that we have the pleasantries of how to basically invoke Ansible Galaxy out of the way, we can begin looking at the command-line switches available to the Ansible Galaxy solution.</p>
<p>The complete syntax for the <kbd>ansible-galaxy</kbd> installation (used to install roles on your system, login, and do much more) would look something like the following:</p>
<pre>
<strong>#&gt; ansible-galaxy [ACTION] [options] [-r FILE | role_name(s)[,version] | tar_file(s)]</strong>
</pre>
<p>If this looks slightly confusing, it's OK; it won't shortly. Next, we are going to go through the more important <kbd>ansible-galaxy</kbd> command-line options and you will learn how to use them in greater detail.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Ansible Galaxy command-line options explained</h1>
                
            
            
                
<p>In this section, we are going to take a much closer look at the Ansible Galaxy command-line options and available parameters. The goal will be to really dive into the command line and better understand how the command-line implementation of Ansible Galaxy can make the Ansible administrators' life easier. We just looked (earlier) at an example of the complete syntax of the <kbd>ansible-galaxy</kbd> command. When using Ansible Galaxy, in the <kbd>ansible-galaxy</kbd> command, the formatting is <kbd>&lt;OPTION&gt;</kbd> followed by <kbd>[PARAMS]</kbd>. This is shown here:</p>
<pre>
<strong>#&gt; ansible-galaxy &lt;OPTION&gt; [PARAMS]</strong>
</pre>
<p>So in all reality, the <kbd>&lt;OPTION&gt;</kbd> tag could be any of the following options:</p>
<pre>
[delete|import|info|init|install|list|login|remove|search|setup] [--help]
</pre>
<p>On the other hand, the <kbd>[PARAMS]</kbd> would be any of the option supported sub-arguments. Let's take a look at the primary options available to the <kbd>ansible-galaxy</kbd> command and see what each of these do and take a look at each option's available sub-arguments.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The install subcommand</h1>
                
            
            
                
<p>The <kbd>install</kbd> subcommand is used by Ansible to install roles onto the control server. The general usage of this command is as follows:</p>
<pre>
ansible-galaxy install [options] [-r FILE | role_name(s)[,version] | tar_file(s)]
</pre>
<p>A more realistic example of this command in action might be something like the following:</p>
<pre>
<strong>ansible-galaxy install ANXS.postgresql</strong>
</pre>
<p>As we saw earlier, the Ansible Galaxy website will provide us with the command-line syntax to install a given role, and as we can see, this is generally fairly straightforward.</p>
<p class="mce-root">The <kbd>install</kbd> option provides several options to install roles. These are described next:</p>
<ul>
<li class="mce-root">Using <kbd>username.role[,version]</kbd>: This solution offers us the ability to install a given role that we found within the Ansible Galaxy website. The syntax of this solution based on our previous <kbd>install</kbd> command example allows us to specify, say, <kbd>ansible-galaxy install ANXS.postgresql</kbd>, where <kbd>ANXS</kbd> is the username and <kbd>postgresql</kbd> is the role.</li>
<li class="mce-root">Using a <kbd>filename -r-</kbd> option: This solution offers us the ability to install any number of roles provided within a text file. The text file would have one role per line with the same formatting requirements as the preceding option on each line:</li>
</ul>
<pre style="padding-left: 120px" class="mce-root">
username.role[,version]
</pre>
<ul>
<li class="mce-root">Using a tarball: This option allows us to grab a role from another source (say, GitHub) and install the role by pointing Ansible Galaxy at the <kbd>tar.gz</kbd> file.</li>
<li>Available options:
<ul>
<li class="mce-root"><kbd>-f</kbd>, <kbd>--force</kbd>: Forces the overwriting of an existing role on the system.</li>
<li class="mce-root"><kbd>-i</kbd>, <kbd>--ignore-errors</kbd>: This option ignores errors and allows Ansible Galaxy to continue with the next specified role.</li>
<li class="mce-root"><kbd>-n</kbd>, <kbd>--no-deps</kbd>: This option removes the dependencies from the context of the <kbd>ansible-galaxy</kbd> command. This means that no dependencies will be installed along with the specified role.</li>
<li class="mce-root"><kbd>-p ROLES_PATH</kbd>, <kbd>--roles-path=ROLES_PATH</kbd>: This optional path parameter, allows us to override the directory containing roles. Specifically it allows us to specify an alternate location for Galaxy to download them to. The default implementation for <kbd>roles_path</kbd> configured in the <kbd>ansible.cfg</kbd> file (<kbd>/etc/ansible/roles</kbd> if not configured).</li>
<li class="mce-root"><kbd>-r ROLE_FILE</kbd>, <kbd>--role-file=ROLE_FILE</kbd>: A file containing a list of roles to be imported, as previously specified. This option cannot be used if a role name or <kbd>.tar.gz</kbd> have been specified.</li>
</ul>
</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The delete subcommand</h1>
                
            
            
                
<p>The <kbd>delete</kbd> command option in Ansible Galaxy will remove a role from the <kbd>galaxy.ansible.com</kbd> registry. It is important to note that order to effectively remove a role, you will first need to authenticate using the login option. Some examples of how to use the <kbd>DELETE</kbd> option are provided next:</p>
<pre>
<strong>#&gt; ansible-galaxy delete USER.ROLE</strong>
</pre>
<p>Available parameters are as follows:</p>
<ul>
<li><kbd>-c</kbd>, <kbd>--ignore-certs</kbd>: This specific option tells Ansible Galaxy to ignore TLS certificate errors.</li>
<li class="mce-root"><kbd>-s</kbd>, <kbd>--server</kbd>: This option overrides the default server <a href="https://galaxy.ansible.com">https://galaxy.ansible.com</a>. This is particularly useful when setting up your own Ansible Galaxy server.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The import subcommand</h1>
                
            
            
                
<p>This <kbd>ansible-galaxy</kbd> option allows us to import a role from GitHub into the <kbd>galaxy.ansible.com</kbd> library. In order for this import solution to work, it will require user authentication with <kbd>galaxy.ansible.com</kbd> using the login subcommand. Let's take a look at how to use the <kbd>import</kbd> subcommand to import a role.</p>
<pre>
<strong>$&gt; ansible-galaxy import [options] github_user github_repo</strong> 
</pre>
<p>Available parameters are as follows:</p>
<ul>
<li class="mce-root"><kbd>-c</kbd>, <kbd>--ignore-certs</kbd>: This command-line option tells Ansible Galaxy to ignore SSL certs. The switch also ignores TLS certificate errors.</li>
<li><kbd>-s</kbd>, <kbd>--server</kbd>: Overrides the default server <a href="https://galaxy.ansible.com">https://galaxy.ansible.com</a>.</li>
<li><kbd>--branch</kbd>: This option lets us specify a specific branch to import into Ansible Galaxy. If a specific branch is not defined, the branch found in <kbd>meta/main.yml</kbd> is used.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The ifo subcommand</h1>
                
            
            
                
<p>The <kbd>ansible-galaxy info</kbd> subcommand provides a detailed set of information related to a specific role. The results returned for the role include information from both the remote <em>Ansible Galaxy copy</em> and the <em>local copy</em>. An example of how to use the <kbd>info</kbd> subcommand is provided next:</p>
<pre>
<strong>$&gt; ansible-galaxy info [options] role_name[, version]</strong> 
</pre>
<p>Available options are as follows:</p>
<ul>
<li class="mce-root"><kbd>-p ROLES_PATH</kbd>, <kbd>--roles-path=ROLES_PATH</kbd>: The <kbd>roles-path</kbd> option provides us with the ability to specify a path to the directory containing our Ansible roles. The default location for roles is the <kbd>ROLES_PATH</kbd> specified in the <kbd>ansible.cfg</kbd> file (<kbd>/etc/ansible/roles</kbd> if not configured).</li>
<li class="mce-root"><kbd>-c</kbd>, <kbd>--ignore-certs</kbd>: This ignores TLS certificate errors.</li>
<li class="mce-root"><kbd>-s</kbd>, <kbd>--server</kbd>: This option overrides the default server <a href="https://galaxy.ansible.com">https://galaxy.ansible.com</a> and allows us to specify an alternate one.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The init command</h1>
                
            
            
                
<p class="mce-root">The <kbd>init</kbd> command is used to initialize an empty role structure that could then be uploaded to <a href="https://galaxy.ansible.com/">https://galaxy.ansible.com/</a>. This is a good way to begin Ansible Galaxy role development and is the preferred way to get started in creating the structures needed to begin development. The following is a syntax example of how to use the <kbd>init</kbd> command:</p>
<pre class="mce-root">
<strong>$&gt; ansible-galaxy init [options] role_name</strong>
</pre>
<p>Available options are as follows:</p>
<ul>
<li class="mce-root"><kbd>-f</kbd>, <kbd>--force</kbd>: This option forces the <kbd>init</kbd> structure to automatically overwrite any existing roles in the path.</li>
<li class="mce-root"><kbd>-p INIT_PATH</kbd>, <kbd>--init-path=INIT_PATH</kbd>: This option allows us to specify the path where the skeleton of the new role will be created. The default value for this is the current working directory.</li>
<li class="mce-root"><kbd>--offline</kbd>: This option tells the <kbd>init</kbd> sub-argument to not query the <kbd>galaxy</kbd> API when creating roles.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The list subcommand</h1>
                
            
            
                
<p class="mce-root">The <kbd>list</kbd> subcommand instructs Ansible Galaxy to show what roles are currently installed on the system. Through this command, we can also specify just the role name, and if it's actually installed, only that role will be shown. Let's take a look at an example of how to use this subcommand:</p>
<pre class="mce-root">
<strong>$&gt; ansible-galaxy list [role_name]</strong>
</pre>
<p>Available options are <kbd>-p ROLES_PATH</kbd>, <kbd>--roles-path=ROLES_PATH</kbd>; this path allows us to specify the path to the directory containing our roles. The default value for this option is <kbd>roles_path</kbd>, which is traditionally configured in the <kbd>ansible.cfg</kbd> file located at <kbd>/etc/ansible/roles</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The login subcommand</h1>
                
            
            
                
<p>The Ansible Galaxy <kbd>login</kbd> subcommand provides us with the ability to authenticate between <kbd>ansible-galaxy</kbd> and the local command-line client. This authentication is particularly useful when uploading roles to Ansible Galaxy. Its also useful for importing roles into Ansible Galaxy from GitHub. In these cases (and a couple of others), the <kbd>login</kbd> command sequence is required before the operation can be performed. Let's take a look at the command-line syntax for the <kbd>login</kbd> subcommand:</p>
<pre>
<strong>$&gt; ansible-galaxy login [options]</strong>
</pre>
<p>Available options are as follows:</p>
<ul>
<li class="mce-root"><kbd>-c</kbd>, <kbd>--ignore-certs</kbd>: This option ignores any TLS cert errors that may occur.</li>
<li class="mce-root"><kbd>-s</kbd>, <kbd>--server</kbd>: This option tells Ansible Galaxy to override the default server <a href="https://galaxy.ansible.com">https://galaxy.ansible.com</a>.</li>
<li class="mce-root"><kbd>--github-token</kbd>: If we don't wish to use our GitHub password, or if for your specific GitHub account two-factor authentication has been enabled, we can optionally use the <kbd>--github-token</kbd> parameter to pass a personal access token to the GitHub login solution. It is important to remember that this should be used only <em>if</em> we have two-factor authentication enabled on the GitHub account.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The remove subcommand</h1>
                
            
            
                
<p class="mce-root">In this subsection, we are going to look at the <kbd>remove</kbd> subcommand for Ansible Galaxy. This specific subcommand is used to remove one or more roles. Let's take a quick look at an example of the syntax usage for this command:</p>
<pre class="mce-root">
<strong>$&gt; ansible-galaxy remove rolea roleb ...</strong>
</pre>
<p>Available options are <kbd>-p ROLES_PATH</kbd>, <kbd>--roles-path=ROLES_PATH</kbd>; this path allows us to specify the path to the directory containing our roles. The default value for this option is <kbd>ROLES_PATH</kbd>, which is traditionally configured in the <kbd>ansible.cfg</kbd> file located at <kbd>/etc/ansible/roles</kbd>.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">The search subcommand</h1>
                
            
            
                
<p class="mce-root">The Ansible Galaxy solution has a really handy <kbd>search</kbd> subcommand. This subcommand provides us with the ability to search for specific roles on the Ansible Galaxy server. In addition to basic search functionality, we can also search and filter the results. Let's take a minute to look at the syntax of this useful feature:</p>
<pre class="mce-root">
<strong>$&gt; ansible-galaxy search [options] [searchtermZ searchtermA]</strong>
</pre>
<p>Available options are as follows:</p>
<ul>
<li class="mce-root"><kbd>--galaxy-tags</kbd>: The <kbd>tags</kbd> option provides a <strong>Comma Separated Value</strong> (<strong>CSV</strong>) list of the tags that we want the Galaxy server to filter.</li>
<li class="mce-root"><kbd>--platforms</kbd>: This option allows us to filter roles based on the platforms supported. To use it, we will need to provide a comma-separated list of platforms on which to filter.</li>
<li class="mce-root"><kbd>--author</kbd>: This option allows us to specify the username we want to filter by.</li>
<li class="mce-root"><kbd>-c</kbd>, <kbd>--ignore-certs</kbd>: This ignores TLS certificate errors.</li>
<li class="mce-root"><kbd>-s</kbd>, <kbd>--server</kbd>: This option allows us to change the server URL of Ansible Galaxy. For example, this might be useful if we run our own Ansible Galaxy server.</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">The setup subcommand</h1>
                
            
            
                
<p>The <kbd>setup</kbd> action allows Ansible Galaxy to integrate with Travis CI. This, in turn, will allow Ansible Galaxy to receive notifications from Travis CI upon completion of the build. It is important to note that prior to being able to use this integration, Ansible Galaxy must first be authenticated with the <kbd>galaxy.ansible.com</kbd> library.</p>
<p class="mce-root">An example of how to use the <kbd>setup</kbd> command is provided next:</p>
<pre class="mce-root">
<strong>$ ansible-galaxy setup [options] source github_user github_repo secret</strong> 
</pre>


            

            
        
    

        

                            
                    <h1 class="header-title">The help command</h1>
                
            
            
                
<p>This command-line option displays a brief help message and exits. An example of the output from the <kbd>help</kbd> command is provided next:</p>
<div><img class="image-border" src="img/cbf8417a-92e4-419e-b55e-651125545c8b.png"/></div>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>In this final chapter, we took a look at how to use Ansible Galaxy. Ansible Galaxy is a really useful solution in sharing and communicating Ansible roles. This solution can take a lot of the guess work out of Ansible. Generally, there is a saying within the Ansible Galaxy community: "There's a galaxy role for that", and indeed, there probably is.</p>
<p>As we wrap up our journey through DevOps and Ansible, it's important to remember that implementing DevOps can be a tough challenge for any organization. There are a lot of people who will need to work in concert to develop a unified process, a set of rigid standards while maintaining a flexible atmosphere that technology demands.</p>
<p>In your quest to implement DevOps with Ansible 2, Ansible provides a much-needed automation platform and glue within an organization that can be leveraged as a foundational point for future DevOps-oriented improvements. It is my hope as the author of this book that the knowledge contained within proves to be useful for your organization and that your DevOps implementations are successful.</p>


            

            
        
    </body></html>